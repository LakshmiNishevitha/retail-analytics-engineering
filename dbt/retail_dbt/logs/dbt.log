[0m13:02:48.310464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106286030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afa2d0>]}


============================== 13:02:48.314431 | 4cf3b490-bf9f-45a7-a28b-a31995f17881 ==============================
[0m13:02:48.314431 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:02:48.314891 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt parse', 'warn_error': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True'}
[0m13:02:48.317090 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'retail_dbt'
[0m13:02:48.319019 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.06162221, "process_in_blocks": "0", "process_kernel_time": 0.18989, "process_mem_max_rss": "109461504", "process_out_blocks": "0", "process_user_time": 1.079013}
[0m13:02:48.319443 [debug] [MainThread]: Command `dbt parse` failed at 13:02:48.319366 after 0.06 seconds
[0m13:02:48.319708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106055c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b30710>]}
[0m13:02:48.319967 [debug] [MainThread]: Flushing usage events
[0m13:02:48.684491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:41.226973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ee060>]}


============================== 13:16:41.231295 | 1482430e-5274-4d54-b747-802d6e86764b ==============================
[0m13:16:41.231295 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:16:41.231781 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'static_parser': 'True', 'empty': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_colors': 'True'}
[0m13:16:41.243515 [info ] [MainThread]: dbt version: 1.11.2
[0m13:16:41.243814 [info ] [MainThread]: python version: 3.12.7
[0m13:16:41.244015 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m13:16:41.244194 [info ] [MainThread]: os info: macOS-14.6-arm64-arm-64bit
[0m13:16:42.383175 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:16:42.383605 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:16:42.383837 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:16:42.430033 [info ] [MainThread]: Using profiles dir at /Users/lakshminishevitha/.dbt
[0m13:16:42.430340 [info ] [MainThread]: Using profiles.yml file at /Users/lakshminishevitha/.dbt/profiles.yml
[0m13:16:42.430552 [info ] [MainThread]: Using dbt_project.yml file at /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/dbt_project.yml
[0m13:16:42.431026 [info ] [MainThread]: adapter type: snowflake
[0m13:16:42.431295 [info ] [MainThread]: adapter version: 1.11.0
[0m13:16:42.507518 [info ] [MainThread]: Configuration:
[0m13:16:42.507816 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:16:42.508028 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:16:42.508208 [info ] [MainThread]: Required dependencies:
[0m13:16:42.508441 [debug] [MainThread]: Executing "git --help"
[0m13:16:42.530143 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:16:42.530954 [debug] [MainThread]: STDERR: "b''"
[0m13:16:42.531207 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:16:42.531464 [info ] [MainThread]: Connection:
[0m13:16:42.531691 [info ] [MainThread]:   account: fw65290.us-east-1
[0m13:16:42.531870 [info ] [MainThread]:   user: lamirtha
[0m13:16:42.532037 [info ] [MainThread]:   database: RETAIL_DW
[0m13:16:42.532203 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m13:16:42.532361 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:16:42.532515 [info ] [MainThread]:   schema: STAGING
[0m13:16:42.532674 [info ] [MainThread]:   authenticator: None
[0m13:16:42.532831 [info ] [MainThread]:   oauth_client_id: None
[0m13:16:42.532994 [info ] [MainThread]:   query_tag: None
[0m13:16:42.533152 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:16:42.533305 [info ] [MainThread]:   host: None
[0m13:16:42.533456 [info ] [MainThread]:   port: None
[0m13:16:42.533611 [info ] [MainThread]:   proxy_host: None
[0m13:16:42.533766 [info ] [MainThread]:   proxy_port: None
[0m13:16:42.533917 [info ] [MainThread]:   protocol: None
[0m13:16:42.534072 [info ] [MainThread]:   connect_retries: 1
[0m13:16:42.534221 [info ] [MainThread]:   connect_timeout: None
[0m13:16:42.534374 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:16:42.534535 [info ] [MainThread]:   retry_all: False
[0m13:16:42.534686 [info ] [MainThread]:   insecure_mode: False
[0m13:16:42.534837 [info ] [MainThread]:   reuse_connections: True
[0m13:16:42.534989 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:16:42.535148 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:16:42.535534 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m13:16:42.632357 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:16:42.708338 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:16:42.708614 [debug] [MainThread]: On debug: select 1 as id
[0m13:16:42.708818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:43.331375 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:16:43.331819 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:16:43.333492 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:16:43.333799 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:16:43.334028 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  290404 (08001): 404 Not Found: post fw65290.us-east-1.snowflakecomputing.com:443/session/v1/login-request

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:16:43.337276 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 2.167519, "process_in_blocks": "0", "process_kernel_time": 1.511128, "process_mem_max_rss": "217972736", "process_out_blocks": "0", "process_user_time": 2.860883}
[0m13:16:43.337769 [debug] [MainThread]: Command `dbt debug` failed at 13:16:43.337661 after 2.17 seconds
[0m13:16:43.338066 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:16:43.338291 [debug] [MainThread]: On debug: No close available on handle
[0m13:16:43.338587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210cbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076afbf0>]}
[0m13:16:43.338937 [debug] [MainThread]: Flushing usage events
[0m13:16:43.708274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:00.083799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10158c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f76210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75eb0>]}


============================== 13:17:00.087192 | eeac5b8a-e598-4115-aeef-cd496be68f3f ==============================
[0m13:17:00.087192 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:17:00.087626 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt parse', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m13:17:00.629023 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:17:00.629430 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:17:00.629684 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:17:00.871503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeac5b8a-e598-4115-aeef-cd496be68f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee27c20>]}
[0m13:17:00.917749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeac5b8a-e598-4115-aeef-cd496be68f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecdda60>]}
[0m13:17:00.918519 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m13:17:01.021060 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:17:01.021720 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:17:01.021991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eeac5b8a-e598-4115-aeef-cd496be68f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d330d10>]}
[0m13:17:01.810104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_dbt.staging
- models.retail_dbt.marts
[0m13:17:01.817385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeac5b8a-e598-4115-aeef-cd496be68f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ed7f7d0>]}
[0m13:17:01.820358 [info ] [MainThread]: Performance info: /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/perf_info.json
[0m13:17:01.859401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m13:17:01.861193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m13:17:01.863796 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.831368, "process_in_blocks": "0", "process_kernel_time": 1.872304, "process_mem_max_rss": "211877888", "process_out_blocks": "0", "process_user_time": 2.920071}
[0m13:17:01.864180 [debug] [MainThread]: Command `dbt parse` succeeded at 13:17:01.864104 after 1.83 seconds
[0m13:17:01.864454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11faee9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee39880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee61e80>]}
[0m13:17:01.864713 [debug] [MainThread]: Flushing usage events
[0m13:17:02.175131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:32.930121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107226420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072261e0>]}


============================== 13:31:32.934483 | 9f0340ca-d5d5-4894-b0f0-7059e4fec95d ==============================
[0m13:31:32.934483 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:32.934951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'no_print': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'log_format': 'default'}
[0m13:31:32.946646 [info ] [MainThread]: dbt version: 1.11.2
[0m13:31:32.946923 [info ] [MainThread]: python version: 3.12.7
[0m13:31:32.947121 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m13:31:32.947298 [info ] [MainThread]: os info: macOS-14.6-arm64-arm-64bit
[0m13:31:33.955822 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:31:33.956221 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:31:33.956464 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:31:34.003324 [info ] [MainThread]: Using profiles dir at /Users/lakshminishevitha/.dbt
[0m13:31:34.003645 [info ] [MainThread]: Using profiles.yml file at /Users/lakshminishevitha/.dbt/profiles.yml
[0m13:31:34.003866 [info ] [MainThread]: Using dbt_project.yml file at /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/dbt_project.yml
[0m13:31:34.004343 [info ] [MainThread]: adapter type: snowflake
[0m13:31:34.004542 [info ] [MainThread]: adapter version: 1.11.0
[0m13:31:34.080799 [info ] [MainThread]: Configuration:
[0m13:31:34.081092 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:31:34.081305 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:31:34.081481 [info ] [MainThread]: Required dependencies:
[0m13:31:34.081712 [debug] [MainThread]: Executing "git --help"
[0m13:31:34.103609 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:31:34.104380 [debug] [MainThread]: STDERR: "b''"
[0m13:31:34.104609 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:31:34.104824 [info ] [MainThread]: Connection:
[0m13:31:34.105045 [info ] [MainThread]:   account: fw65290
[0m13:31:34.105219 [info ] [MainThread]:   user: lamirtha
[0m13:31:34.105384 [info ] [MainThread]:   database: RETAIL_DW
[0m13:31:34.105548 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m13:31:34.105705 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:31:34.105861 [info ] [MainThread]:   schema: STAGING
[0m13:31:34.106011 [info ] [MainThread]:   authenticator: None
[0m13:31:34.106161 [info ] [MainThread]:   oauth_client_id: None
[0m13:31:34.106313 [info ] [MainThread]:   query_tag: None
[0m13:31:34.106465 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:31:34.106619 [info ] [MainThread]:   host: None
[0m13:31:34.106770 [info ] [MainThread]:   port: None
[0m13:31:34.106923 [info ] [MainThread]:   proxy_host: None
[0m13:31:34.107079 [info ] [MainThread]:   proxy_port: None
[0m13:31:34.107230 [info ] [MainThread]:   protocol: None
[0m13:31:34.107382 [info ] [MainThread]:   connect_retries: 1
[0m13:31:34.107532 [info ] [MainThread]:   connect_timeout: None
[0m13:31:34.107681 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:31:34.107834 [info ] [MainThread]:   retry_all: False
[0m13:31:34.107983 [info ] [MainThread]:   insecure_mode: False
[0m13:31:34.108134 [info ] [MainThread]:   reuse_connections: True
[0m13:31:34.108284 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:31:34.108436 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:31:34.108874 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m13:31:34.201901 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:31:34.276927 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:31:34.277236 [debug] [MainThread]: On debug: select 1 as id
[0m13:31:34.277446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:35.075486 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:31:35.075788 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:31:35.076929 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:31:35.077183 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:31:35.077377 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  290404 (08001): 404 Not Found: post fw65290.snowflakecomputing.com:443/session/v1/login-request

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:31:35.080215 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 2.2060559, "process_in_blocks": "0", "process_kernel_time": 0.773517, "process_mem_max_rss": "219496448", "process_out_blocks": "0", "process_user_time": 3.598333}
[0m13:31:35.080644 [debug] [MainThread]: Command `dbt debug` failed at 13:31:35.080554 after 2.21 seconds
[0m13:31:35.080907 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:31:35.081110 [debug] [MainThread]: On debug: No close available on handle
[0m13:31:35.081375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d7d3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d972660>]}
[0m13:31:35.081731 [debug] [MainThread]: Flushing usage events
[0m13:31:35.450680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:17.066966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107236210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107235fd0>]}


============================== 13:49:17.071144 | ba8a8925-779a-424a-92fa-481f196dd6e4 ==============================
[0m13:49:17.071144 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:49:17.071591 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'empty': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True'}
[0m13:49:17.083211 [info ] [MainThread]: dbt version: 1.11.2
[0m13:49:17.083489 [info ] [MainThread]: python version: 3.12.7
[0m13:49:17.083697 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m13:49:17.083884 [info ] [MainThread]: os info: macOS-14.6-arm64-arm-64bit
[0m13:49:18.098666 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:49:18.099061 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:49:18.099295 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:49:18.145264 [info ] [MainThread]: Using profiles dir at /Users/lakshminishevitha/.dbt
[0m13:49:18.145576 [info ] [MainThread]: Using profiles.yml file at /Users/lakshminishevitha/.dbt/profiles.yml
[0m13:49:18.145796 [info ] [MainThread]: Using dbt_project.yml file at /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/dbt_project.yml
[0m13:49:18.146271 [info ] [MainThread]: adapter type: snowflake
[0m13:49:18.146544 [info ] [MainThread]: adapter version: 1.11.0
[0m13:49:18.222638 [info ] [MainThread]: Configuration:
[0m13:49:18.222946 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:49:18.223150 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:18.223330 [info ] [MainThread]: Required dependencies:
[0m13:49:18.223552 [debug] [MainThread]: Executing "git --help"
[0m13:49:18.243877 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:18.244614 [debug] [MainThread]: STDERR: "b''"
[0m13:49:18.244850 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:18.245061 [info ] [MainThread]: Connection:
[0m13:49:18.245288 [info ] [MainThread]:   account: piitfvt
[0m13:49:18.245466 [info ] [MainThread]:   user: lamirtha
[0m13:49:18.245635 [info ] [MainThread]:   database: RETAIL_DW
[0m13:49:18.245796 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m13:49:18.245959 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:49:18.246116 [info ] [MainThread]:   schema: STAGING
[0m13:49:18.246271 [info ] [MainThread]:   authenticator: None
[0m13:49:18.246426 [info ] [MainThread]:   oauth_client_id: None
[0m13:49:18.246581 [info ] [MainThread]:   query_tag: None
[0m13:49:18.246741 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:49:18.246899 [info ] [MainThread]:   host: None
[0m13:49:18.247056 [info ] [MainThread]:   port: None
[0m13:49:18.247211 [info ] [MainThread]:   proxy_host: None
[0m13:49:18.247368 [info ] [MainThread]:   proxy_port: None
[0m13:49:18.247517 [info ] [MainThread]:   protocol: None
[0m13:49:18.247667 [info ] [MainThread]:   connect_retries: 1
[0m13:49:18.247819 [info ] [MainThread]:   connect_timeout: None
[0m13:49:18.247966 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:49:18.248121 [info ] [MainThread]:   retry_all: False
[0m13:49:18.248273 [info ] [MainThread]:   insecure_mode: False
[0m13:49:18.248426 [info ] [MainThread]:   reuse_connections: True
[0m13:49:18.248579 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:49:18.248733 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:49:18.249121 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m13:49:18.341068 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:49:18.415320 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:49:18.415612 [debug] [MainThread]: On debug: select 1 as id
[0m13:49:18.415830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:18.807653 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:49:18.808000 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:49:18.809236 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:49:18.813602 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:49:18.813832 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  290404 (08001): 404 Not Found: post piitfvt.snowflakecomputing.com:443/session/v1/login-request

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:49:18.816782 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.8082067, "process_in_blocks": "0", "process_kernel_time": 0.818997, "process_mem_max_rss": "216907776", "process_out_blocks": "0", "process_user_time": 3.178294}
[0m13:49:18.819352 [debug] [MainThread]: Command `dbt debug` failed at 13:49:18.819272 after 1.81 seconds
[0m13:49:18.820880 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:49:18.821070 [debug] [MainThread]: On debug: No close available on handle
[0m13:49:18.822349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4e5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1f8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072af860>]}
[0m13:49:18.822837 [debug] [MainThread]: Flushing usage events
[0m13:49:19.177739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:13.226023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a62540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3a000>]}


============================== 13:55:13.230247 | 204f0354-a08f-4879-89dc-78e2ad11c8d3 ==============================
[0m13:55:13.230247 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:55:13.230689 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m13:55:13.242238 [info ] [MainThread]: dbt version: 1.11.2
[0m13:55:13.242517 [info ] [MainThread]: python version: 3.12.7
[0m13:55:13.242724 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m13:55:13.242915 [info ] [MainThread]: os info: macOS-14.6-arm64-arm-64bit
[0m13:55:14.235706 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:55:14.236155 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:55:14.236398 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:55:14.282739 [info ] [MainThread]: Using profiles dir at /Users/lakshminishevitha/.dbt
[0m13:55:14.283051 [info ] [MainThread]: Using profiles.yml file at /Users/lakshminishevitha/.dbt/profiles.yml
[0m13:55:14.283267 [info ] [MainThread]: Using dbt_project.yml file at /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/dbt_project.yml
[0m13:55:14.283761 [info ] [MainThread]: adapter type: snowflake
[0m13:55:14.284036 [info ] [MainThread]: adapter version: 1.11.0
[0m13:55:14.360978 [info ] [MainThread]: Configuration:
[0m13:55:14.361280 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:55:14.361485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:55:14.361663 [info ] [MainThread]: Required dependencies:
[0m13:55:14.361928 [debug] [MainThread]: Executing "git --help"
[0m13:55:14.383037 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:55:14.383761 [debug] [MainThread]: STDERR: "b''"
[0m13:55:14.384023 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:55:14.384258 [info ] [MainThread]: Connection:
[0m13:55:14.384483 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m13:55:14.384657 [info ] [MainThread]:   user: lamirtha
[0m13:55:14.384822 [info ] [MainThread]:   database: RETAIL_DW
[0m13:55:14.384987 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m13:55:14.385141 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:55:14.385295 [info ] [MainThread]:   schema: STAGING
[0m13:55:14.385453 [info ] [MainThread]:   authenticator: None
[0m13:55:14.385605 [info ] [MainThread]:   oauth_client_id: None
[0m13:55:14.385758 [info ] [MainThread]:   query_tag: None
[0m13:55:14.385909 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:55:14.386064 [info ] [MainThread]:   host: None
[0m13:55:14.386214 [info ] [MainThread]:   port: None
[0m13:55:14.386362 [info ] [MainThread]:   proxy_host: None
[0m13:55:14.386521 [info ] [MainThread]:   proxy_port: None
[0m13:55:14.386669 [info ] [MainThread]:   protocol: None
[0m13:55:14.386816 [info ] [MainThread]:   connect_retries: 1
[0m13:55:14.386966 [info ] [MainThread]:   connect_timeout: None
[0m13:55:14.387113 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:55:14.387276 [info ] [MainThread]:   retry_all: False
[0m13:55:14.387422 [info ] [MainThread]:   insecure_mode: False
[0m13:55:14.387570 [info ] [MainThread]:   reuse_connections: True
[0m13:55:14.387720 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:55:14.387873 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:55:14.388284 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m13:55:14.479860 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:55:14.554445 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:55:14.554747 [debug] [MainThread]: On debug: select 1 as id
[0m13:55:14.554952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:15.522550 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.967 seconds
[0m13:55:15.524720 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:55:15.525344 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:55:15.530239 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3608878, "process_in_blocks": "0", "process_kernel_time": 0.704561, "process_mem_max_rss": "219348992", "process_out_blocks": "0", "process_user_time": 3.458144}
[0m13:55:15.531070 [debug] [MainThread]: Command `dbt debug` succeeded at 13:55:15.530924 after 2.36 seconds
[0m13:55:15.531580 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:55:15.531948 [debug] [MainThread]: On debug: Close
[0m13:55:15.739155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232f6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ce150>]}
[0m13:55:15.739912 [debug] [MainThread]: Flushing usage events
[0m13:55:16.103607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:09.479501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ada8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ada6c0>]}


============================== 14:05:09.483953 | 9b1f7bb0-c80b-464d-b591-cb6cd658b885 ==============================
[0m14:05:09.483953 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:05:09.484438 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:05:10.517874 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:05:10.518289 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:05:10.518533 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:05:10.768309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328d3fb0>]}
[0m14:05:10.814815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ada540>]}
[0m14:05:10.815913 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m14:05:10.917381 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:05:10.989584 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:05:10.989945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df7bf0>]}
[0m14:05:11.952507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_dbt.marts
[0m14:05:11.959836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a3b230>]}
[0m14:05:12.013745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:05:12.017311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:05:12.032654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363182f0>]}
[0m14:05:12.032993 [info ] [MainThread]: Found 6 models, 6 sources, 520 macros
[0m14:05:12.033241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a24170>]}
[0m14:05:12.034415 [info ] [MainThread]: 
[0m14:05:12.034671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:12.034864 [info ] [MainThread]: 
[0m14:05:12.035174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:12.038511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m14:05:12.123921 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m14:05:12.124197 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m14:05:12.124408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:13.649259 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.525 seconds
[0m14:05:13.652065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now create_RETAIL_DW_STAGING_STAGING)
[0m14:05:13.652661 [debug] [ThreadPool]: Creating schema "database: "RETAIL_DW"
schema: "STAGING_STAGING"
"
[0m14:05:13.658720 [debug] [ThreadPool]: Using snowflake connection "create_RETAIL_DW_STAGING_STAGING"
[0m14:05:13.659066 [debug] [ThreadPool]: On create_RETAIL_DW_STAGING_STAGING: create schema if not exists RETAIL_DW.STAGING_STAGING
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_RETAIL_DW_STAGING_STAGING"} */
[0m14:05:13.810122 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.151 seconds
[0m14:05:13.813926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RETAIL_DW_STAGING_STAGING, now list_RETAIL_DW_STAGING_STAGING)
[0m14:05:13.832545 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m14:05:13.832945 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m14:05:13.999188 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.166 seconds
[0m14:05:14.002898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136757b90>]}
[0m14:05:14.008699 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_customers
[0m14:05:14.009134 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m14:05:14.009959 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_order_items
[0m14:05:14.010312 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m14:05:14.009643 [info ] [Thread-1 (]: 1 of 6 START sql view model STAGING_STAGING.stg_customers ...................... [RUN]
[0m14:05:14.010782 [info ] [Thread-2 (]: 2 of 6 START sql view model STAGING_STAGING.stg_inventory_snapshots ............ [RUN]
[0m14:05:14.011201 [info ] [Thread-3 (]: 3 of 6 START sql view model STAGING_STAGING.stg_order_items .................... [RUN]
[0m14:05:14.011603 [info ] [Thread-4 (]: 4 of 6 START sql view model STAGING_STAGING.stg_orders ......................... [RUN]
[0m14:05:14.012076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m14:05:14.012639 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_inventory_snapshots'
[0m14:05:14.013094 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m14:05:14.013519 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_orders'
[0m14:05:14.013859 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_customers
[0m14:05:14.014169 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m14:05:14.014457 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_order_items
[0m14:05:14.014741 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m14:05:14.022407 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m14:05:14.025780 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m14:05:14.027793 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m14:05:14.029727 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m14:05:14.030795 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m14:05:14.031067 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m14:05:14.031311 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_order_items
[0m14:05:14.031526 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_customers
[0m14:05:14.063218 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m14:05:14.065389 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m14:05:14.067885 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m14:05:14.069912 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m14:05:14.071092 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m14:05:14.071659 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m14:05:14.072146 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m14:05:14.072580 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m14:05:14.072815 [debug] [Thread-1 (]: On model.retail_dbt.stg_customers: create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
  
  
  
  as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */;
[0m14:05:14.073066 [debug] [Thread-3 (]: On model.retail_dbt.stg_order_items: create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
  
  
  
  as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */;
[0m14:05:14.073307 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
  
  
  
  as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */;
[0m14:05:14.073544 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
  
  
  
  as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */;
[0m14:05:14.073956 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:14.074260 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:14.074490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:14.408479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m14:05:14.433450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f531d0>]}
[0m14:05:14.434024 [info ] [Thread-1 (]: 1 of 6 OK created sql view model STAGING_STAGING.stg_customers ................. [[32mSUCCESS 1[0m in 0.42s]
[0m14:05:14.434456 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_customers
[0m14:05:14.434734 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_products
[0m14:05:14.435145 [info ] [Thread-1 (]: 5 of 6 START sql view model STAGING_STAGING.stg_products ....................... [RUN]
[0m14:05:14.435514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_products)
[0m14:05:14.435780 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_products
[0m14:05:14.439510 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m14:05:14.440099 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_products
[0m14:05:14.442243 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m14:05:14.442987 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m14:05:14.443261 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
  
  
  
  as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */;
[0m14:05:14.692401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m14:05:14.697211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ec7320>]}
[0m14:05:14.698332 [info ] [Thread-1 (]: 5 of 6 OK created sql view model STAGING_STAGING.stg_products .................. [[32mSUCCESS 1[0m in 0.26s]
[0m14:05:14.699238 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_products
[0m14:05:14.699825 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_stores
[0m14:05:14.700590 [info ] [Thread-1 (]: 6 of 6 START sql view model STAGING_STAGING.stg_stores ......................... [RUN]
[0m14:05:14.701176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.stg_stores)
[0m14:05:14.701702 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_stores
[0m14:05:14.707198 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m14:05:14.708204 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_stores
[0m14:05:14.711958 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m14:05:14.713316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m14:05:14.715453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378678f0>]}
[0m14:05:14.716167 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m14:05:14.716762 [info ] [Thread-2 (]: 2 of 6 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ....... [[32mSUCCESS 1[0m in 0.70s]
[0m14:05:14.717173 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
  
  
  
  as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */;
[0m14:05:14.717678 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m14:05:14.745947 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m14:05:14.748235 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f53a40>]}
[0m14:05:14.749114 [info ] [Thread-4 (]: 4 of 6 OK created sql view model STAGING_STAGING.stg_orders .................... [[32mSUCCESS 1[0m in 0.73s]
[0m14:05:14.749689 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m14:05:14.750480 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m14:05:14.752432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378668d0>]}
[0m14:05:14.752972 [info ] [Thread-3 (]: 3 of 6 OK created sql view model STAGING_STAGING.stg_order_items ............... [[32mSUCCESS 1[0m in 0.74s]
[0m14:05:14.753400 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_order_items
[0m14:05:15.104082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m14:05:15.110225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1f7bb0-c80b-464d-b591-cb6cd658b885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13788d3a0>]}
[0m14:05:15.111248 [info ] [Thread-1 (]: 6 of 6 OK created sql view model STAGING_STAGING.stg_stores .................... [[32mSUCCESS 1[0m in 0.41s]
[0m14:05:15.112070 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_stores
[0m14:05:15.114305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:15.114776 [debug] [MainThread]: Connection 'model.retail_dbt.stg_stores' was left open.
[0m14:05:15.115206 [debug] [MainThread]: On model.retail_dbt.stg_stores: Close
[0m14:05:15.312394 [debug] [MainThread]: Connection 'model.retail_dbt.stg_inventory_snapshots' was left open.
[0m14:05:15.313300 [debug] [MainThread]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m14:05:15.522340 [debug] [MainThread]: Connection 'model.retail_dbt.stg_order_items' was left open.
[0m14:05:15.523680 [debug] [MainThread]: On model.retail_dbt.stg_order_items: Close
[0m14:05:15.751936 [debug] [MainThread]: Connection 'model.retail_dbt.stg_orders' was left open.
[0m14:05:15.752893 [debug] [MainThread]: On model.retail_dbt.stg_orders: Close
[0m14:05:15.969819 [info ] [MainThread]: 
[0m14:05:15.970623 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m14:05:15.972885 [debug] [MainThread]: Command end result
[0m14:05:16.073884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:05:16.075083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:05:16.079609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m14:05:16.079859 [info ] [MainThread]: 
[0m14:05:16.080120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:16.080322 [info ] [MainThread]: 
[0m14:05:16.080537 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:05:16.083251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6624756, "process_in_blocks": "0", "process_kernel_time": 0.771, "process_mem_max_rss": "236584960", "process_out_blocks": "0", "process_user_time": 5.156987}
[0m14:05:16.083588 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:16.083527 after 6.66 seconds
[0m14:05:16.083840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106784530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b020>]}
[0m14:05:16.084095 [debug] [MainThread]: Flushing usage events
[0m14:05:16.518225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:36.682445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fff680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907a300>]}


============================== 14:10:36.686581 | 8b9df108-0b82-4483-a952-9f2b213108cb ==============================
[0m14:10:36.686581 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:10:36.687052 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/lakshminishevitha/.dbt', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs'}
[0m14:10:36.898614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9df108-0b82-4483-a952-9f2b213108cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889e270>]}
[0m14:10:36.914709 [debug] [MainThread]: Set downloads directory='/var/folders/d6/4t9xtyrj4nlgr8z11_ts0xt00000gn/T/dbt-downloads-_h_efu5r'
[0m14:10:36.915126 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:10:37.089324 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:10:37.090592 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:10:37.145100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:10:37.155300 [info ] [MainThread]: Updating lock file in file path: /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/package-lock.yml
[0m14:10:37.157037 [debug] [MainThread]: Set downloads directory='/var/folders/d6/4t9xtyrj4nlgr8z11_ts0xt00000gn/T/dbt-downloads-dmb64sev'
[0m14:10:37.159561 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:10:37.717705 [info ] [MainThread]: Installed from version 1.1.1
[0m14:10:37.718015 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:10:37.718295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b9df108-0b82-4483-a952-9f2b213108cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926bfb0>]}
[0m14:10:37.718591 [info ] [MainThread]: 
[0m14:10:37.718812 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:10:37.721295 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0975046, "process_in_blocks": "0", "process_kernel_time": 0.292753, "process_mem_max_rss": "118439936", "process_out_blocks": "0", "process_user_time": 1.320779}
[0m14:10:37.721735 [debug] [MainThread]: Command `dbt deps` succeeded at 14:10:37.721647 after 1.10 seconds
[0m14:10:37.722063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108471130>]}
[0m14:10:37.722318 [debug] [MainThread]: Flushing usage events
[0m14:10:38.080545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:12.764836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ee750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a46660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a46420>]}


============================== 14:15:12.768821 | b8544946-fa1d-413c-a5e0-0d426897f7ac ==============================
[0m14:15:12.768821 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:15:12.769275 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select marts', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'cache_selected_only': 'False'}
[0m14:15:13.776722 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:15:13.777159 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:15:13.777425 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:15:14.026972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f7d10>]}
[0m14:15:14.074544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f0d1a00>]}
[0m14:15:14.075282 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m14:15:14.180739 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:15:14.271510 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:15:14.271875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f775520>]}
[0m14:15:15.418252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148137770>]}
[0m14:15:15.475429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:15:15.477571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:15:15.493450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1483363c0>]}
[0m14:15:15.493794 [info ] [MainThread]: Found 12 models, 6 sources, 634 macros
[0m14:15:15.494037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14816f9b0>]}
[0m14:15:15.495321 [info ] [MainThread]: 
[0m14:15:15.495576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:15.495764 [info ] [MainThread]: 
[0m14:15:15.496070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:15.499445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m14:15:15.582961 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m14:15:15.583247 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m14:15:15.583453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:16.669152 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.085 seconds
[0m14:15:16.672502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now create_RETAIL_DW_STAGING_ANALYTICS)
[0m14:15:16.673258 [debug] [ThreadPool]: Creating schema "database: "RETAIL_DW"
schema: "STAGING_ANALYTICS"
"
[0m14:15:16.680977 [debug] [ThreadPool]: Using snowflake connection "create_RETAIL_DW_STAGING_ANALYTICS"
[0m14:15:16.681350 [debug] [ThreadPool]: On create_RETAIL_DW_STAGING_ANALYTICS: create schema if not exists RETAIL_DW.STAGING_ANALYTICS
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_RETAIL_DW_STAGING_ANALYTICS"} */
[0m14:15:16.868136 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m14:15:16.872514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RETAIL_DW_STAGING_ANALYTICS, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m14:15:16.873330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m14:15:16.896989 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m14:15:16.900792 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m14:15:16.901087 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m14:15:16.901346 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m14:15:16.901656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:17.045573 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.144 seconds
[0m14:15:17.512261 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.610 seconds
[0m14:15:17.517326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14815f620>]}
[0m14:15:17.521325 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m14:15:17.521808 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_date
[0m14:15:17.522245 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m14:15:17.523181 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m14:15:17.522857 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m14:15:17.523718 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGING_ANALYTICS.dim_date ........................ [RUN]
[0m14:15:17.524188 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGING_ANALYTICS.dim_product ..................... [RUN]
[0m14:15:17.524643 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGING_ANALYTICS.dim_store ....................... [RUN]
[0m14:15:17.525235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_customer)
[0m14:15:17.525944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m14:15:17.526601 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_product'
[0m14:15:17.527123 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_store'
[0m14:15:17.527525 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m14:15:17.527963 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_date
[0m14:15:17.528365 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m14:15:17.528737 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m14:15:17.538355 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m14:15:17.540229 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m14:15:17.543452 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m14:15:17.546251 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m14:15:17.547317 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m14:15:17.547625 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m14:15:17.547862 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_date
[0m14:15:17.553882 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m14:15:17.589779 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m14:15:17.590246 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m14:15:17.592047 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m14:15:17.594156 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m14:15:17.595320 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m14:15:17.595644 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
    
    
    
    as (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */;
[0m14:15:17.596299 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m14:15:17.596872 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m14:15:17.597116 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:17.597628 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m14:15:17.597874 [debug] [Thread-2 (]: On model.retail_dbt.dim_date: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
    
    
    
    as (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */;
[0m14:15:17.598131 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
    
    
    
    as (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */;
[0m14:15:17.598775 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip
from RETAIL_DW.STAGING_STAGING.stg_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m14:15:17.599346 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:19.097620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.498 seconds
[0m14:15:19.127560 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476dc10>]}
[0m14:15:19.128198 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGING_ANALYTICS.dim_date ................... [[32mSUCCESS 1[0m in 1.60s]
[0m14:15:19.128658 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_date
[0m14:15:19.128978 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m14:15:19.129395 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ......... [RUN]
[0m14:15:19.129775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m14:15:19.130044 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m14:15:19.133991 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:15:19.134605 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m14:15:19.136694 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:15:19.137561 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m14:15:19.137825 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    
    
    
    as (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */;
[0m14:15:19.186755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.587 seconds
[0m14:15:19.187392 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.590 seconds
[0m14:15:19.189067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1487c4350>]}
[0m14:15:19.190674 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b04f50>]}
[0m14:15:19.191176 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.66s]
[0m14:15:19.191717 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGING_ANALYTICS.dim_store .................. [[32mSUCCESS 1[0m in 1.66s]
[0m14:15:19.192229 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m14:15:19.192622 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m14:15:19.192919 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m14:15:19.193319 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m14:15:19.193586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m14:15:19.193812 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m14:15:19.199980 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m14:15:19.200435 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m14:15:19.202553 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m14:15:19.203344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.604 seconds
[0m14:15:19.204692 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1487e5430>]}
[0m14:15:19.205984 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m14:15:19.206333 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGING_ANALYTICS.dim_product ................ [[32mSUCCESS 1[0m in 1.68s]
[0m14:15:19.206660 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
)
select
  md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(order_ts as date) as date_key,

  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,

  order_id,
  product_id,
  customer_id,
  store_id,
  status,

  qty,
  unit_price,
  discount_pct,
  gross_sales,
  discount_amount,
  net_sales
from j
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m14:15:19.207090 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m14:15:20.387856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.249 seconds
[0m14:15:20.392129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489ca4e0>]}
[0m14:15:20.393020 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot .... [[32mSUCCESS 1[0m in 1.26s]
[0m14:15:20.394023 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m14:15:20.907271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m14:15:20.911629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8544946-fa1d-413c-a5e0-0d426897f7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b93110>]}
[0m14:15:20.912774 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.72s]
[0m14:15:20.913599 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m14:15:20.915777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:20.916211 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m14:15:20.916605 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m14:15:21.125924 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was left open.
[0m14:15:21.126763 [debug] [MainThread]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m14:15:21.316234 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was left open.
[0m14:15:21.317098 [debug] [MainThread]: On model.retail_dbt.dim_product: Close
[0m14:15:21.552365 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was left open.
[0m14:15:21.552883 [debug] [MainThread]: On model.retail_dbt.dim_store: Close
[0m14:15:21.765506 [info ] [MainThread]: 
[0m14:15:21.765948 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m14:15:21.767459 [debug] [MainThread]: Command end result
[0m14:15:21.871221 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:15:21.872455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:15:21.877517 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m14:15:21.877760 [info ] [MainThread]: 
[0m14:15:21.878017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:21.878217 [info ] [MainThread]: 
[0m14:15:21.878424 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:15:21.881095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.171084, "process_in_blocks": "0", "process_kernel_time": 0.719298, "process_mem_max_rss": "238305280", "process_out_blocks": "0", "process_user_time": 5.392567}
[0m14:15:21.881414 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:21.881353 after 9.17 seconds
[0m14:15:21.881651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a463f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f0d3cb0>]}
[0m14:15:21.881888 [debug] [MainThread]: Flushing usage events
[0m14:15:22.331058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:39.676829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e193d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fe630>]}


============================== 14:16:39.680818 | 839bf3b5-35e9-470c-aa9d-e61f097cea2a ==============================
[0m14:16:39.680818 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:16:39.681272 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select staging', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m14:16:40.591314 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:16:40.591766 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:16:40.592020 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:16:40.761960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dc4a0>]}
[0m14:16:40.809123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12082eb40>]}
[0m14:16:40.810056 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m14:16:40.913916 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:16:41.102289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:41.102665 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:16:41.102876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:41.129050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a1ca10>]}
[0m14:16:41.191066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:16:41.192445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:16:41.206913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d032f0>]}
[0m14:16:41.207258 [info ] [MainThread]: Found 12 models, 6 sources, 634 macros
[0m14:16:41.207514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120da3b30>]}
[0m14:16:41.208757 [info ] [MainThread]: 
[0m14:16:41.208988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:41.209173 [info ] [MainThread]: 
[0m14:16:41.209490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:41.212906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m14:16:41.257680 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m14:16:41.257956 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m14:16:41.258166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:42.285568 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.027 seconds
[0m14:16:42.290535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m14:16:42.297533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m14:16:42.305513 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m14:16:42.307805 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m14:16:42.308082 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m14:16:42.308300 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m14:16:42.308779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:42.483346 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.175 seconds
[0m14:16:42.906414 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.597 seconds
[0m14:16:42.912204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207dbcb0>]}
[0m14:16:42.917836 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_customers
[0m14:16:42.918375 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m14:16:42.919443 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_order_items
[0m14:16:42.919831 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m14:16:42.919055 [info ] [Thread-1 (]: 1 of 6 START sql view model STAGING_STAGING.stg_customers ...................... [RUN]
[0m14:16:42.920446 [info ] [Thread-2 (]: 2 of 6 START sql view model STAGING_STAGING.stg_inventory_snapshots ............ [RUN]
[0m14:16:42.921106 [info ] [Thread-3 (]: 3 of 6 START sql view model STAGING_STAGING.stg_order_items .................... [RUN]
[0m14:16:42.921749 [info ] [Thread-4 (]: 4 of 6 START sql view model STAGING_STAGING.stg_orders ......................... [RUN]
[0m14:16:42.922291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m14:16:42.922737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m14:16:42.923287 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m14:16:42.923791 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_orders'
[0m14:16:42.924170 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_customers
[0m14:16:42.924546 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m14:16:42.924890 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_order_items
[0m14:16:42.925223 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m14:16:42.933783 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m14:16:42.936253 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m14:16:42.938628 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m14:16:42.940699 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m14:16:42.941435 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_customers
[0m14:16:42.941711 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_order_items
[0m14:16:42.941961 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m14:16:42.942176 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m14:16:42.975629 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m14:16:42.977822 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m14:16:42.980039 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m14:16:42.982123 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m14:16:42.983103 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m14:16:42.983640 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m14:16:42.983966 [debug] [Thread-3 (]: On model.retail_dbt.stg_order_items: create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
  
  
  
  as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */;
[0m14:16:42.984549 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m14:16:42.984805 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
  
  
  
  as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */;
[0m14:16:42.985280 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m14:16:42.985512 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:42.985750 [debug] [Thread-1 (]: On model.retail_dbt.stg_customers: create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
  
  
  
  as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */;
[0m14:16:42.985971 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:42.986192 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
  
  
  
  as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */;
[0m14:16:43.331551 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m14:16:43.359757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m14:16:43.361607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467d8b0>]}
[0m14:16:43.361872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c7b8c0>]}
[0m14:16:43.362407 [info ] [Thread-2 (]: 2 of 6 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ....... [[32mSUCCESS 1[0m in 0.44s]
[0m14:16:43.362921 [info ] [Thread-1 (]: 1 of 6 OK created sql view model STAGING_STAGING.stg_customers ................. [[32mSUCCESS 1[0m in 0.44s]
[0m14:16:43.363381 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m14:16:43.363730 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_customers
[0m14:16:43.364022 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m14:16:43.364346 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_stores
[0m14:16:43.364713 [info ] [Thread-2 (]: 5 of 6 START sql view model STAGING_STAGING.stg_products ....................... [RUN]
[0m14:16:43.365066 [info ] [Thread-1 (]: 6 of 6 START sql view model STAGING_STAGING.stg_stores ......................... [RUN]
[0m14:16:43.365380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m14:16:43.365630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m14:16:43.365871 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m14:16:43.366092 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_stores
[0m14:16:43.368459 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m14:16:43.370549 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m14:16:43.371038 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m14:16:43.372711 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_stores
[0m14:16:43.376050 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m14:16:43.379379 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m14:16:43.380744 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m14:16:43.381387 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
  
  
  
  as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */;
[0m14:16:43.382713 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m14:16:43.382967 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
  
  
  
  as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */;
[0m14:16:43.653485 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m14:16:43.658512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219e5460>]}
[0m14:16:43.659599 [info ] [Thread-3 (]: 3 of 6 OK created sql view model STAGING_STAGING.stg_order_items ............... [[32mSUCCESS 1[0m in 0.74s]
[0m14:16:43.660489 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_order_items
[0m14:16:43.672645 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m14:16:43.676239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219e5460>]}
[0m14:16:43.677145 [info ] [Thread-2 (]: 5 of 6 OK created sql view model STAGING_STAGING.stg_products .................. [[32mSUCCESS 1[0m in 0.31s]
[0m14:16:43.677936 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m14:16:43.727676 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m14:16:43.732921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c7b980>]}
[0m14:16:43.734863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m14:16:43.733916 [info ] [Thread-4 (]: 4 of 6 OK created sql view model STAGING_STAGING.stg_orders .................... [[32mSUCCESS 1[0m in 0.81s]
[0m14:16:43.737981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839bf3b5-35e9-470c-aa9d-e61f097cea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e24da0>]}
[0m14:16:43.738677 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m14:16:43.739372 [info ] [Thread-1 (]: 6 of 6 OK created sql view model STAGING_STAGING.stg_stores .................... [[32mSUCCESS 1[0m in 0.37s]
[0m14:16:43.740146 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_stores
[0m14:16:43.741534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:43.741856 [debug] [MainThread]: Connection 'model.retail_dbt.stg_stores' was left open.
[0m14:16:43.742159 [debug] [MainThread]: On model.retail_dbt.stg_stores: Close
[0m14:16:43.936743 [debug] [MainThread]: Connection 'model.retail_dbt.stg_products' was left open.
[0m14:16:43.937446 [debug] [MainThread]: On model.retail_dbt.stg_products: Close
[0m14:16:44.135628 [debug] [MainThread]: Connection 'model.retail_dbt.stg_order_items' was left open.
[0m14:16:44.136492 [debug] [MainThread]: On model.retail_dbt.stg_order_items: Close
[0m14:16:44.338671 [debug] [MainThread]: Connection 'model.retail_dbt.stg_orders' was left open.
[0m14:16:44.339530 [debug] [MainThread]: On model.retail_dbt.stg_orders: Close
[0m14:16:44.542811 [info ] [MainThread]: 
[0m14:16:44.543678 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m14:16:44.545762 [debug] [MainThread]: Command end result
[0m14:16:44.576543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:16:44.577741 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:16:44.582540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m14:16:44.582784 [info ] [MainThread]: 
[0m14:16:44.583038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:44.583236 [info ] [MainThread]: 
[0m14:16:44.583446 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:16:44.587216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.963246, "process_in_blocks": "0", "process_kernel_time": 0.735267, "process_mem_max_rss": "230916096", "process_out_blocks": "0", "process_user_time": 4.249801}
[0m14:16:44.587560 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:44.587494 after 4.96 seconds
[0m14:16:44.587809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012f69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ddc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e193d0>]}
[0m14:16:44.588052 [debug] [MainThread]: Flushing usage events
[0m14:16:45.012726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:39.375631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133466c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113346480>]}


============================== 14:22:39.379552 | f4516747-8a33-479f-b98c-3cbbf6707913 ==============================
[0m14:22:39.379552 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:22:39.380005 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'invocation_command': 'dbt run --select marts', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True'}
[0m14:22:40.398768 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:22:40.399194 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:22:40.399446 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:22:40.650217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a247a10>]}
[0m14:22:40.697825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf0f410>]}
[0m14:22:40.698640 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m14:22:40.802077 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:22:40.999101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:40.999491 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:22:40.999699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:41.025755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a21dee0>]}
[0m14:22:41.087335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:22:41.089167 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:22:41.105127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a57f830>]}
[0m14:22:41.105465 [info ] [MainThread]: Found 12 models, 6 sources, 634 macros
[0m14:22:41.105718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a79d2b0>]}
[0m14:22:41.107006 [info ] [MainThread]: 
[0m14:22:41.107245 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:41.107442 [info ] [MainThread]: 
[0m14:22:41.107760 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:41.111090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m14:22:41.195750 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m14:22:41.196031 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m14:22:41.196247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.990955 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.794 seconds
[0m14:22:41.995964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m14:22:41.996738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m14:22:42.013323 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m14:22:42.014662 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m14:22:42.014929 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m14:22:42.015168 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m14:22:42.015373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:42.190133 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.175 seconds
[0m14:22:42.607780 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.592 seconds
[0m14:22:42.612249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110862bd0>]}
[0m14:22:42.616459 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m14:22:42.616865 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_date
[0m14:22:42.617659 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m14:22:42.617994 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m14:22:42.617364 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m14:22:42.618452 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGING_ANALYTICS.dim_date ........................ [RUN]
[0m14:22:42.618881 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGING_ANALYTICS.dim_product ..................... [RUN]
[0m14:22:42.619283 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGING_ANALYTICS.dim_store ....................... [RUN]
[0m14:22:42.619673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_customer)
[0m14:22:42.620013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m14:22:42.620422 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_product'
[0m14:22:42.620802 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_store'
[0m14:22:42.621107 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m14:22:42.621389 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_date
[0m14:22:42.621680 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m14:22:42.621953 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m14:22:42.636135 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m14:22:42.640041 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m14:22:42.642728 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m14:22:42.645464 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m14:22:42.646800 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m14:22:42.647085 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m14:22:42.647348 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_date
[0m14:22:42.647571 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m14:22:42.686529 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m14:22:42.688699 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m14:22:42.684453 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m14:22:42.690920 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m14:22:42.692067 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m14:22:42.692651 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m14:22:42.693204 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m14:22:42.693481 [debug] [Thread-2 (]: On model.retail_dbt.dim_date: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
    
    
    
    as (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */;
[0m14:22:42.694006 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m14:22:42.694241 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip
from RETAIL_DW.STAGING_STAGING.stg_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m14:22:42.694511 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
    
    
    
    as (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */;
[0m14:22:42.694936 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
    
    
    
    as (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */;
[0m14:22:42.695929 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:22:42.696386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:43.937523 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.242 seconds
[0m14:22:43.960240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m14:22:43.971589 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m14:22:43.972147 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m14:22:43.976010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4a35f0>]}
[0m14:22:43.976261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766dc40>]}
[0m14:22:43.976721 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.35s]
[0m14:22:43.977002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4a3050>]}
[0m14:22:43.977399 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGING_ANALYTICS.dim_date ................... [[32mSUCCESS 1[0m in 1.35s]
[0m14:22:43.977631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b552ed0>]}
[0m14:22:43.977999 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m14:22:43.978367 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGING_ANALYTICS.dim_product ................ [[32mSUCCESS 1[0m in 1.35s]
[0m14:22:43.978809 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_date
[0m14:22:43.979252 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGING_ANALYTICS.dim_store .................. [[32mSUCCESS 1[0m in 1.35s]
[0m14:22:43.979593 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m14:22:43.979978 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m14:22:43.980234 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m14:22:43.980603 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m14:22:43.980922 [info ] [Thread-1 (]: 5 of 6 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ......... [RUN]
[0m14:22:43.981289 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m14:22:43.981631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_inventory_snapshot)
[0m14:22:43.981870 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_sales)
[0m14:22:43.982097 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m14:22:43.982309 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m14:22:43.985945 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:22:43.991821 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m14:22:43.992355 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m14:22:43.992596 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m14:22:43.994705 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:22:43.996815 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m14:22:43.997629 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m14:22:43.998824 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m14:22:43.999066 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    
    
    
    as (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */;
[0m14:22:43.999375 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
)
select
  md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(order_ts as date) as date_key,

  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,

  order_id,
  product_id,
  customer_id,
  store_id,
  status,

  qty,
  unit_price,
  discount_pct,
  gross_sales,
  discount_amount,
  net_sales
from j
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m14:22:44.823922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m14:22:44.828557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2e4bc0>]}
[0m14:22:44.829192 [info ] [Thread-1 (]: 5 of 6 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot .... [[32mSUCCESS 1[0m in 0.85s]
[0m14:22:44.829704 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m14:22:44.992694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m14:22:44.997437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4516747-8a33-479f-b98c-3cbbf6707913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b478260>]}
[0m14:22:44.998151 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.02s]
[0m14:22:44.998754 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m14:22:45.000239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:45.000636 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was left open.
[0m14:22:45.000978 [debug] [MainThread]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m14:22:45.202099 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m14:22:45.202769 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m14:22:45.397919 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was left open.
[0m14:22:45.398757 [debug] [MainThread]: On model.retail_dbt.dim_product: Close
[0m14:22:45.592925 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was left open.
[0m14:22:45.593749 [debug] [MainThread]: On model.retail_dbt.dim_store: Close
[0m14:22:45.797302 [info ] [MainThread]: 
[0m14:22:45.798115 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m14:22:45.799960 [debug] [MainThread]: Command end result
[0m14:22:45.829785 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:22:45.830936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:22:45.836358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m14:22:45.836591 [info ] [MainThread]: 
[0m14:22:45.836827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:45.837049 [info ] [MainThread]: 
[0m14:22:45.837250 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:22:45.839874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5214705, "process_in_blocks": "0", "process_kernel_time": 0.831953, "process_mem_max_rss": "228933632", "process_out_blocks": "0", "process_user_time": 4.183048}
[0m14:22:45.840211 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:45.840149 after 6.52 seconds
[0m14:22:45.840455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133466c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f5b1d0>]}
[0m14:22:45.840691 [debug] [MainThread]: Flushing usage events
[0m14:22:46.242310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:57.364691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bedb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a300>]}


============================== 14:23:57.368579 | a69e709e-a5d5-48a8-b504-8046496cce53 ==============================
[0m14:23:57.368579 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:23:57.369018 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select marts', 'send_anonymous_usage_stats': 'True'}
[0m14:23:57.989656 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:23:57.990053 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:23:57.990298 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:23:58.157513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a8ffb0>]}
[0m14:23:58.204503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054364e0>]}
[0m14:23:58.205066 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m14:23:58.305272 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:23:58.470187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:58.470534 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:23:58.470752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:58.496751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a13320>]}
[0m14:23:58.557213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:23:58.558464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:23:58.568891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145aa3c50>]}
[0m14:23:58.569228 [info ] [MainThread]: Found 12 models, 6 sources, 634 macros
[0m14:23:58.569472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a7b530>]}
[0m14:23:58.570727 [info ] [MainThread]: 
[0m14:23:58.570958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:58.571137 [info ] [MainThread]: 
[0m14:23:58.571446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:58.574824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m14:23:58.616968 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m14:23:58.617250 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m14:23:58.617458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:59.361277 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.744 seconds
[0m14:23:59.367284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m14:23:59.368073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m14:23:59.380520 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m14:23:59.382649 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m14:23:59.382911 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m14:23:59.383166 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m14:23:59.383837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:59.569240 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.186 seconds
[0m14:23:59.944004 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.560 seconds
[0m14:23:59.949954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cdbe60>]}
[0m14:23:59.954141 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m14:23:59.954697 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_date
[0m14:23:59.955117 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m14:23:59.956087 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m14:23:59.955730 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m14:23:59.956695 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGING_ANALYTICS.dim_date ........................ [RUN]
[0m14:23:59.957619 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGING_ANALYTICS.dim_product ..................... [RUN]
[0m14:23:59.958226 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGING_ANALYTICS.dim_store ....................... [RUN]
[0m14:23:59.958774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_customer)
[0m14:23:59.959201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m14:23:59.959715 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_product'
[0m14:23:59.960189 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.dim_store'
[0m14:23:59.960570 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m14:23:59.960917 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_date
[0m14:23:59.961247 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m14:23:59.961581 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m14:23:59.976212 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m14:23:59.983078 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m14:23:59.985888 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m14:23:59.988689 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m14:23:59.989444 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m14:23:59.995416 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m14:24:00.001978 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_date
[0m14:24:00.002200 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m14:24:00.034732 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m14:24:00.036919 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m14:24:00.041539 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m14:24:00.043700 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m14:24:00.044701 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m14:24:00.045301 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m14:24:00.045903 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m14:24:00.046408 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m14:24:00.046640 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
    
    
    
    as (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */;
[0m14:24:00.046893 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
    
    
    
    as (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */;
[0m14:24:00.047134 [debug] [Thread-2 (]: On model.retail_dbt.dim_date: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
    
    
    
    as (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */;
[0m14:24:00.047378 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip
from RETAIL_DW.STAGING_STAGING.stg_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m14:24:00.047603 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:24:00.047829 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:24:01.008951 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m14:24:01.033899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308dc40>]}
[0m14:24:01.034500 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGING_ANALYTICS.dim_date ................... [[32mSUCCESS 1[0m in 1.07s]
[0m14:24:01.034947 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_date
[0m14:24:01.035237 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m14:24:01.035638 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ......... [RUN]
[0m14:24:01.036013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m14:24:01.036272 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m14:24:01.040178 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:24:01.040785 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m14:24:01.044179 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m14:24:01.045116 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m14:24:01.045390 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    
    
    
    as (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */;
[0m14:24:01.085086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.037 seconds
[0m14:24:01.086775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14631a870>]}
[0m14:24:01.087206 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.13s]
[0m14:24:01.087578 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m14:24:01.087836 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m14:24:01.088191 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m14:24:01.088507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m14:24:01.088748 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m14:24:01.093930 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m14:24:01.094404 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m14:24:01.096612 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m14:24:01.098009 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m14:24:01.098309 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
)
select
  md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(order_ts as date) as date_key,

  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,

  order_id,
  product_id,
  customer_id,
  store_id,
  status,

  qty,
  unit_price,
  discount_pct,
  gross_sales,
  discount_amount,
  net_sales
from j
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m14:24:01.221783 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m14:24:01.225923 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460a7b90>]}
[0m14:24:01.226911 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGING_ANALYTICS.dim_store .................. [[32mSUCCESS 1[0m in 1.27s]
[0m14:24:01.227747 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m14:24:01.315492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.267 seconds
[0m14:24:01.320123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146081340>]}
[0m14:24:01.321200 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGING_ANALYTICS.dim_product ................ [[32mSUCCESS 1[0m in 1.36s]
[0m14:24:01.322059 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m14:24:01.969027 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m14:24:01.974053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14632ac90>]}
[0m14:24:01.975222 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot .... [[32mSUCCESS 1[0m in 0.94s]
[0m14:24:01.976101 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m14:24:02.097298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.998 seconds
[0m14:24:02.102402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69e709e-a5d5-48a8-b504-8046496cce53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc5820>]}
[0m14:24:02.103348 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.01s]
[0m14:24:02.104001 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m14:24:02.105608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:02.105996 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m14:24:02.106337 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m14:24:02.301877 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was left open.
[0m14:24:02.302634 [debug] [MainThread]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m14:24:02.495272 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was left open.
[0m14:24:02.496098 [debug] [MainThread]: On model.retail_dbt.dim_product: Close
[0m14:24:02.705772 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was left open.
[0m14:24:02.706647 [debug] [MainThread]: On model.retail_dbt.dim_store: Close
[0m14:24:02.907873 [info ] [MainThread]: 
[0m14:24:02.908852 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m14:24:02.910985 [debug] [MainThread]: Command end result
[0m14:24:02.942911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m14:24:02.944278 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m14:24:02.949162 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m14:24:02.949400 [info ] [MainThread]: 
[0m14:24:02.949655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:02.949852 [info ] [MainThread]: 
[0m14:24:02.950062 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:24:02.951880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6393657, "process_in_blocks": "0", "process_kernel_time": 0.893122, "process_mem_max_rss": "231505920", "process_out_blocks": "0", "process_user_time": 3.884421}
[0m14:24:02.952184 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:02.952121 after 5.64 seconds
[0m14:24:02.952425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106124830>]}
[0m14:24:02.952658 [debug] [MainThread]: Flushing usage events
[0m14:24:03.371409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:55.572571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d24e0>]}


============================== 15:58:55.576558 | fe202a30-ad7d-463d-93a6-69db7ec33930 ==============================
[0m15:58:55.576558 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:58:55.577025 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt'}
[0m15:58:56.584537 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:58:56.584999 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:58:56.585253 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:58:56.831115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1299b3140>]}
[0m15:58:56.878892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ad2e40>]}
[0m15:58:56.879976 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m15:58:56.983600 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:58:57.194368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:58:57.194882 [debug] [MainThread]: Partial parsing: added file: retail_dbt://snapshots/snap_customers.sql
[0m15:58:57.429035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc75280>]}
[0m15:58:57.497697 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m15:58:57.499345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m15:58:57.515392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc75ee0>]}
[0m15:58:57.515751 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m15:58:57.516001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb786b0>]}
[0m15:58:57.517342 [info ] [MainThread]: 
[0m15:58:57.517597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:57.517790 [info ] [MainThread]: 
[0m15:58:57.518101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:57.518679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m15:58:57.601459 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m15:58:57.601762 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m15:58:57.601969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:58.669237 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.067 seconds
[0m15:58:58.679402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m15:58:58.686184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m15:58:58.690814 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m15:58:58.692706 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m15:58:58.693038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m15:58:58.693242 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m15:58:58.693499 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m15:58:58.695380 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m15:58:58.696025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:58.696471 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m15:58:58.696882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:58.856060 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.160 seconds
[0m15:58:59.231706 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m15:58:59.243463 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.547 seconds
[0m15:58:59.246221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d18e0>]}
[0m15:58:59.251678 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m15:58:59.252389 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m15:58:59.252861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m15:58:59.253165 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m15:58:59.261553 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m15:58:59.321005 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m15:58:59.321358 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
[0m15:59:00.124234 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.802 seconds
[0m15:59:00.134572 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m15:59:00.135001 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
[0m15:59:00.254915 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.119 seconds
[0m15:59:00.257255 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m15:59:00.260320 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m15:59:00.260890 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: create or replace transient table RETAIL_DW.ANALYTICS.snap_customers
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers

    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */;
[0m15:59:01.149688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m15:59:01.177594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe202a30-ad7d-463d-93a6-69db7ec33930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e9a00>]}
[0m15:59:01.178397 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 1[0m in 1.92s]
[0m15:59:01.178864 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m15:59:01.180020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:01.180230 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was left open.
[0m15:59:01.180424 [debug] [MainThread]: On snapshot.retail_dbt.snap_customers: Close
[0m15:59:01.384808 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m15:59:01.385550 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m15:59:01.590220 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m15:59:01.591097 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m15:59:01.775393 [info ] [MainThread]: 
[0m15:59:01.776317 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m15:59:01.777529 [debug] [MainThread]: Command end result
[0m15:59:01.807418 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m15:59:01.808669 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m15:59:01.813868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m15:59:01.814128 [info ] [MainThread]: 
[0m15:59:01.814412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:01.814607 [info ] [MainThread]: 
[0m15:59:01.814815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:01.817366 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.3016562, "process_in_blocks": "0", "process_kernel_time": 0.665168, "process_mem_max_rss": "233848832", "process_out_blocks": "0", "process_user_time": 4.446843}
[0m15:59:01.817671 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:59:01.817611 after 6.30 seconds
[0m15:59:01.817916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c590>]}
[0m15:59:01.818156 [debug] [MainThread]: Flushing usage events
[0m15:59:02.205673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:13.834124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa600>]}


============================== 16:00:13.838137 | 6ce862c4-8db4-4542-8e9b-1adc35c75b31 ==============================
[0m16:00:13.838137 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:00:13.838591 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'False'}
[0m16:00:14.672366 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:00:14.672857 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:00:14.673102 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:00:14.845081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ac920>]}
[0m16:00:14.892290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129bd5f10>]}
[0m16:00:14.893531 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:00:14.997463 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:00:15.203139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:15.203664 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/dims/dim_customer.sql
[0m16:00:15.439301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae173b0>]}
[0m16:00:15.508946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:00:15.511006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:00:15.526810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5ac30>]}
[0m16:00:15.527166 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m16:00:15.527417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af91400>]}
[0m16:00:15.528575 [info ] [MainThread]: 
[0m16:00:15.528816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:15.529002 [info ] [MainThread]: 
[0m16:00:15.529323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:15.529940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:00:15.573155 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:00:15.573456 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:00:15.573690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:16.473834 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.900 seconds
[0m16:00:16.485252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:00:16.492189 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:00:16.502349 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:00:16.503955 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:00:16.504267 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:00:16.504479 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:00:16.504723 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:00:16.506567 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:00:16.506790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:16.507306 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:00:16.507838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:16.659030 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.152 seconds
[0m16:00:17.075937 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.569 seconds
[0m16:00:17.082377 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.574 seconds
[0m16:00:17.085381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8b7bc0>]}
[0m16:00:17.090113 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m16:00:17.090855 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m16:00:17.091426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_customer)
[0m16:00:17.091852 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m16:00:17.101853 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m16:00:17.102559 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m16:00:17.128260 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m16:00:17.129382 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m16:00:17.129665 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  dbt_valid_from,
  dbt_valid_to,
  case when dbt_valid_to is null then true else false end as is_current
from RETAIL_DW.ANALYTICS.snap_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m16:00:18.665296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m16:00:18.697300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce862c4-8db4-4542-8e9b-1adc35c75b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11ac0>]}
[0m16:00:18.697852 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.60s]
[0m16:00:18.698283 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m16:00:18.699220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:18.699433 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was left open.
[0m16:00:18.699626 [debug] [MainThread]: On model.retail_dbt.dim_customer: Close
[0m16:00:18.892378 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:00:18.892848 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:00:19.084719 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:00:19.085343 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:00:19.300990 [info ] [MainThread]: 
[0m16:00:19.302104 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m16:00:19.302847 [debug] [MainThread]: Command end result
[0m16:00:19.329515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:00:19.330571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:00:19.334797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:00:19.335031 [info ] [MainThread]: 
[0m16:00:19.335289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:19.335488 [info ] [MainThread]: 
[0m16:00:19.335702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:00:19.338326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.558729, "process_in_blocks": "0", "process_kernel_time": 0.591606, "process_mem_max_rss": "234192896", "process_out_blocks": "0", "process_user_time": 4.391413}
[0m16:00:19.338710 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:19.338644 after 5.56 seconds
[0m16:00:19.338976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aeafc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12add91c0>]}
[0m16:00:19.339229 [debug] [MainThread]: Flushing usage events
[0m16:00:19.691850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:51.775835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f04ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e300>]}


============================== 16:08:51.779885 | 7e4709c3-5031-4209-a329-c680c4459bd5 ==============================
[0m16:08:51.779885 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:08:51.780333 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select dim_customer', 'log_format': 'default', 'no_print': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs'}
[0m16:08:52.803244 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:08:52.803782 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:08:52.804037 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:08:53.052013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221c0620>]}
[0m16:08:53.099797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e39820>]}
[0m16:08:53.100697 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:08:53.206252 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:08:53.412892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:53.413251 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:08:53.413466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:53.448904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122301eb0>]}
[0m16:08:53.519073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:08:53.521194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:08:53.535871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122504470>]}
[0m16:08:53.536218 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m16:08:53.536472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d05160>]}
[0m16:08:53.537582 [info ] [MainThread]: 
[0m16:08:53.537831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:53.538025 [info ] [MainThread]: 
[0m16:08:53.538351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:53.538918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:08:53.617164 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:08:53.617459 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:08:53.617674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:54.482158 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.864 seconds
[0m16:08:54.493785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m16:08:54.494531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:08:54.501509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:08:54.510996 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:08:54.512781 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:08:54.514644 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:08:54.514890 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:08:54.515108 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:08:54.515304 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:08:54.515488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:54.516153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:54.646992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m16:08:55.044245 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.528 seconds
[0m16:08:55.059945 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.544 seconds
[0m16:08:55.063988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224890d0>]}
[0m16:08:55.068686 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m16:08:55.069411 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m16:08:55.069973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_customer)
[0m16:08:55.070400 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m16:08:55.089102 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m16:08:55.089744 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m16:08:55.116207 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m16:08:55.117141 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m16:08:55.117422 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  dbt_valid_from,
  dbt_valid_to,
  case when dbt_valid_to is null then true else false end as is_current
from RETAIL_DW.ANALYTICS.snap_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m16:08:56.400881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.283 seconds
[0m16:08:56.430925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e4709c3-5031-4209-a329-c680c4459bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf1850>]}
[0m16:08:56.431480 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.36s]
[0m16:08:56.431918 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m16:08:56.432854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:56.433070 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was left open.
[0m16:08:56.433264 [debug] [MainThread]: On model.retail_dbt.dim_customer: Close
[0m16:08:56.621762 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:08:56.622490 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:08:56.813139 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was left open.
[0m16:08:56.813823 [debug] [MainThread]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m16:08:57.001564 [info ] [MainThread]: 
[0m16:08:57.002653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m16:08:57.003312 [debug] [MainThread]: Command end result
[0m16:08:57.028399 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:08:57.029497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:08:57.033838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:08:57.034076 [info ] [MainThread]: 
[0m16:08:57.034334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:57.034531 [info ] [MainThread]: 
[0m16:08:57.034744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:08:57.037343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.316952, "process_in_blocks": "0", "process_kernel_time": 0.748017, "process_mem_max_rss": "228147200", "process_out_blocks": "0", "process_user_time": 4.166345}
[0m16:08:57.037658 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:57.037598 after 5.32 seconds
[0m16:08:57.037899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c1fa0>]}
[0m16:08:57.038144 [debug] [MainThread]: Flushing usage events
[0m16:08:57.409878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:45.777462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508e300>]}


============================== 16:09:45.780819 | 7948650e-c257-47a9-b34c-893098bf643f ==============================
[0m16:09:45.780819 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:09:45.781286 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select dim_customer', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m16:09:46.313722 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:09:46.314114 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:09:46.314363 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:09:46.483636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025a2990>]}
[0m16:09:46.531093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e10320>]}
[0m16:09:46.531664 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:09:46.631020 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:09:46.808421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:46.808793 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:09:46.809007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:46.844538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132605790>]}
[0m16:09:46.914924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:09:46.916163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:09:46.926073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1324c1be0>]}
[0m16:09:46.926416 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m16:09:46.926672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132235700>]}
[0m16:09:46.927761 [info ] [MainThread]: 
[0m16:09:46.927994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:46.928180 [info ] [MainThread]: 
[0m16:09:46.928492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:46.929081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:09:46.974405 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:09:46.974689 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:09:46.974903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:47.688585 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.713 seconds
[0m16:09:47.696545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:09:47.703478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:09:47.708391 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:09:47.710206 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:09:47.710523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:09:47.710733 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:09:47.710977 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:09:47.712805 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:09:47.713286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:47.713692 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:09:47.715844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:47.849663 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.137 seconds
[0m16:09:48.239622 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.524 seconds
[0m16:09:48.244323 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.531 seconds
[0m16:09:48.248196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322d7dd0>]}
[0m16:09:48.251075 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m16:09:48.251666 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m16:09:48.252106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_customer)
[0m16:09:48.252466 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m16:09:48.270132 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m16:09:48.270795 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m16:09:48.296885 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m16:09:48.297830 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m16:09:48.298107 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (select
  md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  dbt_valid_from,
  dbt_valid_to,
  case when dbt_valid_to is null then true else false end as is_current
from RETAIL_DW.ANALYTICS.snap_customers
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m16:09:49.047151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m16:09:49.078359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7948650e-c257-47a9-b34c-893098bf643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13427a6c0>]}
[0m16:09:49.078986 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 0.83s]
[0m16:09:49.079488 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m16:09:49.080542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:49.080786 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was left open.
[0m16:09:49.080999 [debug] [MainThread]: On model.retail_dbt.dim_customer: Close
[0m16:09:49.265421 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:09:49.265923 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:09:49.456537 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:09:49.457222 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:09:49.661616 [info ] [MainThread]: 
[0m16:09:49.662118 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m16:09:49.662927 [debug] [MainThread]: Command end result
[0m16:09:49.692594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:09:49.693780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:09:49.698163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:09:49.698396 [info ] [MainThread]: 
[0m16:09:49.698693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:49.698893 [info ] [MainThread]: 
[0m16:09:49.699110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:09:49.701014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.974618, "process_in_blocks": "0", "process_kernel_time": 1.541703, "process_mem_max_rss": "229900288", "process_out_blocks": "0", "process_user_time": 3.24929}
[0m16:09:49.701321 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:49.701259 after 3.97 seconds
[0m16:09:49.701552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f71520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321117c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed0230>]}
[0m16:09:49.701778 [debug] [MainThread]: Flushing usage events
[0m16:09:49.994862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:14.342679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103151490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d366c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36480>]}


============================== 16:16:14.346722 | f5d2c3e1-0502-4665-a7fe-5599ebcbf7be ==============================
[0m16:16:14.346722 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:16:14.347175 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt run --select fact_sales', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None'}
[0m16:16:15.272999 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:16:15.273485 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:16:15.273737 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:16:15.444471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324e930>]}
[0m16:16:15.491438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12830e600>]}
[0m16:16:15.492609 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:16:15.596476 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:16:15.801413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:15.801947 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/facts/fact_sales.sql
[0m16:16:16.039180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293aa5d0>]}
[0m16:16:16.108967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:16:16.110861 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:16:16.125772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12878ac30>]}
[0m16:16:16.126117 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m16:16:16.126370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129380ce0>]}
[0m16:16:16.127490 [info ] [MainThread]: 
[0m16:16:16.127725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:16.127914 [info ] [MainThread]: 
[0m16:16:16.128218 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:16.128802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:16:16.172368 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:16:16.172641 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:16:16.172846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:17.326160 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.153 seconds
[0m16:16:17.337779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:16:17.344710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:16:17.345397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:16:17.361772 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:16:17.362897 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:16:17.365638 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:16:17.365894 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:16:17.366111 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:16:17.366305 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:16:17.366500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:17.366966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:17.521342 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.155 seconds
[0m16:16:17.947617 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.581 seconds
[0m16:16:17.954272 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.587 seconds
[0m16:16:17.957692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291a3020>]}
[0m16:16:17.961377 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m16:16:17.961902 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m16:16:17.962324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.fact_sales)
[0m16:16:17.962600 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m16:16:17.972470 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m16:16:17.973436 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m16:16:17.998593 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m16:16:18.000529 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m16:16:18.000868 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),
cust_scd as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  -- ✅ SCD2-aware customer_key
  c.customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j
left join cust_scd c
  on j.customer_id = c.customer_id
 and j.order_ts >= c.dbt_valid_from
 and (j.order_ts < c.dbt_valid_to or c.dbt_valid_to is null)
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m16:16:20.222567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m16:16:20.251383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d2c3e1-0502-4665-a7fe-5599ebcbf7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1299ff380>]}
[0m16:16:20.251920 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 2.29s]
[0m16:16:20.252355 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m16:16:20.253300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:20.253530 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m16:16:20.253726 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m16:16:20.442751 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:16:20.443478 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:16:20.660395 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:16:20.661186 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:16:20.876664 [info ] [MainThread]: 
[0m16:16:20.877398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m16:16:20.878337 [debug] [MainThread]: Command end result
[0m16:16:20.910171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:16:20.911375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:16:20.915819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:16:20.916052 [info ] [MainThread]: 
[0m16:16:20.916318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:20.916513 [info ] [MainThread]: 
[0m16:16:20.916728 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:16:20.919145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6297884, "process_in_blocks": "0", "process_kernel_time": 0.859534, "process_mem_max_rss": "234618880", "process_out_blocks": "0", "process_user_time": 4.216057}
[0m16:16:20.919490 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:20.919423 after 6.63 seconds
[0m16:16:20.919736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12878ac30>]}
[0m16:16:20.919976 [debug] [MainThread]: Flushing usage events
[0m16:16:21.264688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:48.175370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107009520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109105a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ae810>]}


============================== 16:16:48.178720 | 012df18d-a153-4155-8a70-ee8988956bc0 ==============================
[0m16:16:48.178720 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:16:48.179167 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select fact_sales', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False'}
[0m16:16:48.714394 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:16:48.714793 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:16:48.715044 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:16:48.883377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988bb90>]}
[0m16:16:48.931001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858c560>]}
[0m16:16:48.931561 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:16:49.029109 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:16:49.205669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:49.206016 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:16:49.206223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:49.241647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fed9eb0>]}
[0m16:16:49.311769 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:16:49.313046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:16:49.323135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14210b0b0>]}
[0m16:16:49.323483 [info ] [MainThread]: Found 12 models, 1 snapshot, 6 sources, 634 macros
[0m16:16:49.323739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141cfcda0>]}
[0m16:16:49.324848 [info ] [MainThread]: 
[0m16:16:49.325084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:49.325273 [info ] [MainThread]: 
[0m16:16:49.325592 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:49.326186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:16:49.367847 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:16:49.368136 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:16:49.368347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:50.197495 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.829 seconds
[0m16:16:50.208580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:16:50.209331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:16:50.216362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:16:50.224470 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:16:50.226614 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:16:50.228516 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:16:50.228758 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:16:50.228971 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:16:50.229170 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:16:50.229650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:50.230164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:50.372837 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.143 seconds
[0m16:16:50.800518 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.571 seconds
[0m16:16:50.806580 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.576 seconds
[0m16:16:50.809797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142665340>]}
[0m16:16:50.812542 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m16:16:50.813207 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m16:16:50.813774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.fact_sales)
[0m16:16:50.814172 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m16:16:50.834104 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m16:16:50.834787 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m16:16:50.861322 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m16:16:50.863119 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m16:16:50.863456 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),
cust_scd as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  -- ✅ SCD2-aware customer_key
  c.customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j
left join cust_scd c
  on j.customer_id = c.customer_id
 and j.order_ts >= c.dbt_valid_from
 and (j.order_ts < c.dbt_valid_to or c.dbt_valid_to is null)
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m16:16:51.864542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.000 seconds
[0m16:16:51.892714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '012df18d-a153-4155-8a70-ee8988956bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142792a80>]}
[0m16:16:51.893279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.08s]
[0m16:16:51.893712 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m16:16:51.894677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:51.894928 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m16:16:51.895136 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m16:16:52.084641 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:16:52.085781 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:16:52.289453 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:16:52.289981 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:16:52.488171 [info ] [MainThread]: 
[0m16:16:52.488915 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m16:16:52.489980 [debug] [MainThread]: Command end result
[0m16:16:52.522265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:16:52.523519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:16:52.528015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:16:52.528274 [info ] [MainThread]: 
[0m16:16:52.528534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:52.528732 [info ] [MainThread]: 
[0m16:16:52.528939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:16:52.530663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.406249, "process_in_blocks": "0", "process_kernel_time": 1.937306, "process_mem_max_rss": "232095744", "process_out_blocks": "0", "process_user_time": 2.885057}
[0m16:16:52.530968 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:52.530906 after 4.41 seconds
[0m16:16:52.531203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109720a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108558530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984adb0>]}
[0m16:16:52.531432 [debug] [MainThread]: Flushing usage events
[0m16:16:52.824287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:21.341879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1941d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14a3f0>]}


============================== 16:25:21.345828 | aef6ac6c-363f-4d56-9e26-9df41e9ea950 ==============================
[0m16:25:21.345828 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:25:21.346299 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'write_json': 'True', 'target_path': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80'}
[0m16:25:22.361567 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:25:22.362185 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:25:22.362447 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:25:22.613749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149bd1100>]}
[0m16:25:22.661075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b178950>]}
[0m16:25:22.661810 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:25:22.767036 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:25:22.980781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:25:22.981359 [debug] [MainThread]: Partial parsing: added file: retail_dbt://models/marts/schema.yml
[0m16:25:23.132389 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fact_sales' in
package 'retail_dbt' (models/marts/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m16:25:23.132770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a13ca10>]}
[0m16:25:23.270365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7d8a10>]}
[0m16:25:23.356727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:25:23.358463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:25:23.383763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7edb50>]}
[0m16:25:23.384106 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:25:23.384351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b05fb60>]}
[0m16:25:23.386509 [info ] [MainThread]: 
[0m16:25:23.386761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:23.386951 [info ] [MainThread]: 
[0m16:25:23.387251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:23.391064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:25:23.397338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:25:23.411118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:25:23.487951 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:25:23.488341 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:25:23.488591 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:25:23.488899 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:25:23.489127 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:25:23.489349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:23.489567 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:25:23.489760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:23.490027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:24.418928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.929 seconds
[0m16:25:24.420003 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.930 seconds
[0m16:25:24.429026 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.939 seconds
[0m16:25:24.431713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aef6ac6c-363f-4d56-9e26-9df41e9ea950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b123710>]}
[0m16:25:24.434472 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:25:24.434799 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:25:24.435362 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:25:24.435120 [info ] [Thread-1 (]: 1 of 25 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m16:25:24.435704 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:25:24.435959 [info ] [Thread-2 (]: 2 of 25 START test not_null_dim_customer_customer_key .......................... [RUN]
[0m16:25:24.436691 [info ] [Thread-3 (]: 3 of 25 START test not_null_dim_date_date_key .................................. [RUN]
[0m16:25:24.437105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc)
[0m16:25:24.437459 [info ] [Thread-4 (]: 4 of 25 START test not_null_dim_product_product_key ............................ [RUN]
[0m16:25:24.437780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f)
[0m16:25:24.438113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_dim_date_date_key.881d0a31b6)
[0m16:25:24.438404 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:25:24.438770 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3'
[0m16:25:24.439019 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:25:24.439239 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:25:24.451032 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:25:24.451310 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:25:24.454328 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:25:24.457269 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:25:24.460572 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:25:24.461173 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:25:24.467445 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:25:24.479020 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:25:24.481104 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:25:24.481470 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:25:24.481811 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:25:24.483973 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:25:24.485927 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:25:24.487546 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:25:24.488086 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:25:24.488394 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_date_date_key.881d0a31b6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"} */
[0m16:25:24.488687 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"} */
[0m16:25:24.489158 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:25:24.489794 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:25:24.490149 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"} */
[0m16:25:24.490507 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"} */
[0m16:25:24.491775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:25:25.038086 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m16:25:25.054312 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m16:25:25.053451 [info ] [Thread-3 (]: 3 of 25 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.62s]
[0m16:25:25.056551 [info ] [Thread-2 (]: 2 of 25 PASS not_null_dim_customer_customer_key ................................ [[32mPASS[0m in 0.62s]
[0m16:25:25.057176 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:25:25.057885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m16:25:25.058359 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:25:25.058697 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:25:25.060275 [info ] [Thread-1 (]: 1 of 25 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.62s]
[0m16:25:25.060642 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:25:25.060962 [info ] [Thread-3 (]: 5 of 25 START test not_null_dim_store_store_key ................................ [RUN]
[0m16:25:25.061362 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:25:25.061636 [info ] [Thread-2 (]: 6 of 25 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m16:25:25.061954 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_date_date_key.881d0a31b6, now test.retail_dbt.not_null_dim_store_store_key.507238c054)
[0m16:25:25.062252 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:25:25.062561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m16:25:25.062848 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:25:25.063128 [info ] [Thread-1 (]: 7 of 25 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m16:25:25.063403 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:25:25.067022 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:25:25.067313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m16:25:25.070352 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:25:25.070674 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:25:25.074049 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:25:25.074438 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:25:25.076406 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:25:25.076717 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:25:25.078816 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:25:25.079074 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:25:25.081025 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:25:25.081599 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:25:25.081851 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_store_store_key.507238c054: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_store_store_key.507238c054"} */
[0m16:25:25.082349 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:25:25.082791 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
[0m16:25:25.083284 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:25:25.083689 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
[0m16:25:25.085934 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m16:25:25.087353 [info ] [Thread-4 (]: 4 of 25 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.65s]
[0m16:25:25.087757 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:25:25.088548 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:25:25.089029 [info ] [Thread-4 (]: 8 of 25 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m16:25:25.089514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m16:25:25.089852 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:25:25.093099 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:25:25.093611 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:25:25.096736 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:25:25.097431 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:25:25.097692 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
[0m16:25:25.253849 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m16:25:25.257940 [info ] [Thread-3 (]: 5 of 25 PASS not_null_dim_store_store_key ...................................... [[32mPASS[0m in 0.20s]
[0m16:25:25.258858 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:25:25.259418 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:25:25.260019 [info ] [Thread-3 (]: 9 of 25 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m16:25:25.260673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_store_store_key.507238c054, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m16:25:25.261170 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:25:25.268150 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:25:25.269017 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:25:25.272485 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:25:25.273500 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:25:25.273856 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
[0m16:25:25.360935 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m16:25:25.362261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m16:25:25.365945 [info ] [Thread-4 (]: 8 of 25 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.28s]
[0m16:25:25.368715 [info ] [Thread-1 (]: 7 of 25 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.30s]
[0m16:25:25.369983 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:25:25.370670 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:25:25.371404 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:25:25.372787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m16:25:25.373331 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:25:25.373803 [info ] [Thread-4 (]: 10 of 25 START test not_null_fact_sales_date_key ............................... [RUN]
[0m16:25:25.376277 [info ] [Thread-2 (]: 6 of 25 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.31s]
[0m16:25:25.376755 [info ] [Thread-1 (]: 11 of 25 START test not_null_fact_sales_product_key ............................ [RUN]
[0m16:25:25.377207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m16:25:25.377783 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:25:25.378178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m16:25:25.378554 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:25:25.378947 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:25:25.379300 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:25:25.383770 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:25:25.384146 [info ] [Thread-2 (]: 12 of 25 START test not_null_fact_sales_sales_line_key ......................... [RUN]
[0m16:25:25.387755 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:25:25.388150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m16:25:25.388534 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:25:25.392265 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:25:25.392740 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:25:25.394772 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:25:25.395102 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:25:25.397184 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:25:25.397476 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:25:25.397961 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:25:25.401084 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:25:25.401378 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
[0m16:25:25.402002 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:25:25.402391 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
[0m16:25:25.403063 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:25:25.403344 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
[0m16:25:25.561986 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m16:25:25.563981 [error] [Thread-3 (]: 9 of 25 FAIL 7447 not_null_fact_sales_customer_key ............................. [[31mFAIL 7447[0m in 0.30s]
[0m16:25:25.564488 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:25:25.564812 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:25:25.565164 [info ] [Thread-3 (]: 13 of 25 START test not_null_fact_sales_store_key .............................. [RUN]
[0m16:25:25.565574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m16:25:25.565877 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:25:25.569664 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:25:25.570608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m16:25:25.572058 [info ] [Thread-1 (]: 11 of 25 PASS not_null_fact_sales_product_key .................................. [[32mPASS[0m in 0.19s]
[0m16:25:25.572452 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:25:25.572701 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:25:25.572992 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:25:25.575150 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:25:25.575420 [info ] [Thread-1 (]: 14 of 25 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m16:25:25.575753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m16:25:25.575991 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:25:25.579899 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:25:25.580482 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:25:25.580753 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
[0m16:25:25.581184 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:25:25.583289 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:25:25.584554 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:25:25.584871 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
[0m16:25:25.620955 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m16:25:25.622415 [info ] [Thread-2 (]: 12 of 25 PASS not_null_fact_sales_sales_line_key ............................... [[32mPASS[0m in 0.23s]
[0m16:25:25.622808 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:25:25.623070 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:25:25.623352 [info ] [Thread-2 (]: 15 of 25 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m16:25:25.623661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m16:25:25.623910 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:25:25.627819 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:25:25.628528 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:25:25.630662 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:25:25.631244 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m16:25:25.632658 [info ] [Thread-4 (]: 10 of 25 PASS not_null_fact_sales_date_key ..................................... [[32mPASS[0m in 0.26s]
[0m16:25:25.633050 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:25:25.633325 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:25:25.634262 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:25:25.633583 [info ] [Thread-4 (]: 16 of 25 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m16:25:25.634608 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
[0m16:25:25.634886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m16:25:25.635272 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:25:25.639053 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:25:25.639842 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:25:25.643110 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:25:25.644164 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:25:25.644474 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
[0m16:25:25.750716 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m16:25:25.753116 [info ] [Thread-3 (]: 13 of 25 PASS not_null_fact_sales_store_key .................................... [[32mPASS[0m in 0.19s]
[0m16:25:25.753734 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:25:25.754159 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:25:25.754623 [info ] [Thread-3 (]: 17 of 25 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m16:25:25.755109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m16:25:25.755503 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:25:25.761199 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:25:25.761826 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:25:25.764543 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:25:25.765737 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:25:25.766189 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
[0m16:25:25.871046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m16:25:25.874852 [info ] [Thread-1 (]: 14 of 25 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.30s]
[0m16:25:25.875698 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:25:25.876210 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:25:25.876750 [info ] [Thread-1 (]: 18 of 25 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m16:25:25.877317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m16:25:25.877721 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:25:25.885191 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:25:25.886107 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:25:25.889103 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:25:25.890317 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:25:25.890698 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
[0m16:25:25.924984 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m16:25:25.927544 [info ] [Thread-3 (]: 17 of 25 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.17s]
[0m16:25:25.928226 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:25:25.928696 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:25:25.929188 [info ] [Thread-3 (]: 19 of 25 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m16:25:25.929726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m16:25:25.930135 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:25:25.935552 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:25:25.936213 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:25:25.938641 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:25:25.939651 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:25:25.939967 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
[0m16:25:26.189479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m16:25:26.193401 [info ] [Thread-1 (]: 18 of 25 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.32s]
[0m16:25:26.194162 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:25:26.194622 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:25:26.195240 [info ] [Thread-1 (]: 20 of 25 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m16:25:26.195963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m16:25:26.196485 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:25:26.202987 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:25:26.203672 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:25:26.206479 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:25:26.207715 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:25:26.208083 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
[0m16:25:26.211687 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m16:25:26.213645 [info ] [Thread-4 (]: 16 of 25 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.58s]
[0m16:25:26.214346 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m16:25:26.214823 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:25:26.216570 [info ] [Thread-2 (]: 15 of 25 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.59s]
[0m16:25:26.216964 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:25:26.217346 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:25:26.217697 [info ] [Thread-4 (]: 21 of 25 START test unique_dim_customer_customer_key ........................... [RUN]
[0m16:25:26.217978 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:25:26.218452 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e)
[0m16:25:26.218718 [info ] [Thread-2 (]: 22 of 25 START test unique_dim_date_date_key ................................... [RUN]
[0m16:25:26.218982 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:25:26.219262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_dim_date_date_key.0869fd48f9)
[0m16:25:26.224172 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:25:26.224453 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:25:26.227588 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:25:26.227953 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:25:26.230082 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:25:26.230447 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:25:26.232430 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:25:26.233083 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:25:26.233361 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is not null
group by customer_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"} */
[0m16:25:26.233970 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:25:26.234327 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_date_date_key.0869fd48f9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"} */
[0m16:25:26.248394 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m16:25:26.249836 [info ] [Thread-3 (]: 19 of 25 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.32s]
[0m16:25:26.250228 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:25:26.250488 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:25:26.250770 [info ] [Thread-3 (]: 23 of 25 START test unique_dim_product_product_key ............................. [RUN]
[0m16:25:26.251083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_dim_product_product_key.1753236bd0)
[0m16:25:26.251327 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:25:26.254477 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:25:26.254914 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:25:26.256868 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:25:26.257606 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:25:26.257856 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is not null
group by product_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_product_product_key.1753236bd0"} */
[0m16:25:26.435541 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m16:25:26.440264 [info ] [Thread-2 (]: 22 of 25 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.22s]
[0m16:25:26.441096 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:25:26.441671 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:25:26.442595 [info ] [Thread-2 (]: 24 of 25 START test unique_dim_store_store_key ................................. [RUN]
[0m16:25:26.443186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_date_date_key.0869fd48f9, now test.retail_dbt.unique_dim_store_store_key.9baa94554a)
[0m16:25:26.444036 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:25:26.449517 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:25:26.450337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m16:25:26.450959 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m16:25:26.453067 [info ] [Thread-1 (]: 20 of 25 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.26s]
[0m16:25:26.454892 [info ] [Thread-3 (]: 23 of 25 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.20s]
[0m16:25:26.455371 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:25:26.455745 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:25:26.456049 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:25:26.456287 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:25:26.456644 [info ] [Thread-1 (]: 25 of 25 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m16:25:26.459047 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:25:26.459354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m16:25:26.459684 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:25:26.464751 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:25:26.465608 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:25:26.465945 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is not null
group by store_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_store_store_key.9baa94554a"} */
[0m16:25:26.466723 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m16:25:26.466976 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:25:26.468337 [info ] [Thread-4 (]: 21 of 25 PASS unique_dim_customer_customer_key ................................. [[32mPASS[0m in 0.25s]
[0m16:25:26.470544 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:25:26.471067 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:25:26.472036 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:25:26.472350 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
[0m16:25:26.667367 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m16:25:26.671968 [info ] [Thread-2 (]: 24 of 25 PASS unique_dim_store_store_key ....................................... [[32mPASS[0m in 0.23s]
[0m16:25:26.672884 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:25:26.712391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m16:25:26.715050 [info ] [Thread-1 (]: 25 of 25 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.26s]
[0m16:25:26.715692 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:25:26.717232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:26.717555 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was left open.
[0m16:25:26.717853 [debug] [MainThread]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m16:25:26.913289 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_store_store_key.9baa94554a' was left open.
[0m16:25:26.913874 [debug] [MainThread]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: Close
[0m16:25:27.111353 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_product_product_key.1753236bd0' was left open.
[0m16:25:27.111876 [debug] [MainThread]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: Close
[0m16:25:27.322341 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e' was left open.
[0m16:25:27.322877 [debug] [MainThread]: On test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e: Close
[0m16:25:27.514460 [info ] [MainThread]: 
[0m16:25:27.515115 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m16:25:27.519755 [debug] [MainThread]: Command end result
[0m16:25:27.552886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:25:27.554079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:25:27.560312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:25:27.560556 [info ] [MainThread]: 
[0m16:25:27.560790 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:25:27.560979 [info ] [MainThread]: 
[0m16:25:27.561214 [error] [MainThread]: [31mFailure in test not_null_fact_sales_customer_key (models/marts/schema.yml)[0m
[0m16:25:27.561438 [error] [MainThread]:   Got 7447 results, configured to fail if != 0
[0m16:25:27.561610 [info ] [MainThread]: 
[0m16:25:27.561818 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/marts/schema.yml/not_null_fact_sales_customer_key.sql
[0m16:25:27.562002 [info ] [MainThread]: 
[0m16:25:27.562195 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=25
[0m16:25:27.562550 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:25:27.565070 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.2805395, "process_in_blocks": "0", "process_kernel_time": 0.720841, "process_mem_max_rss": "235831296", "process_out_blocks": "0", "process_user_time": 4.889911}
[0m16:25:27.565369 [debug] [MainThread]: Command `dbt test` failed at 16:25:27.565311 after 6.28 seconds
[0m16:25:27.565612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105576960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b82ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6ded50>]}
[0m16:25:27.565845 [debug] [MainThread]: Flushing usage events
[0m16:25:27.935660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:41.742720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f37260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c427b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c425a0>]}


============================== 16:32:41.746517 | 911b30ca-38fe-404a-8240-976146b5dc53 ==============================
[0m16:32:41.746517 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:32:41.746961 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'False', 'use_colors': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'invocation_command': 'dbt run --select fact_sales', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:32:42.371099 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:32:42.371511 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:32:42.371754 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:32:42.540475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462ebc20>]}
[0m16:32:42.587644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14389e180>]}
[0m16:32:42.588216 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:32:42.686469 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:32:42.885737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:42.886370 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/facts/fact_sales.sql
[0m16:32:43.161664 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fact_sales' in
package 'retail_dbt' (models/marts/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m16:32:43.162060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ad82f0>]}
[0m16:32:43.270226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d67650>]}
[0m16:32:43.352555 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:32:43.353865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:32:43.366149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d4c380>]}
[0m16:32:43.366489 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:32:43.366739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a14140>]}
[0m16:32:43.368049 [info ] [MainThread]: 
[0m16:32:43.368286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:43.368472 [info ] [MainThread]: 
[0m16:32:43.368775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:43.369368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:32:43.409777 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:32:43.410067 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:32:43.410276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:44.584165 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.174 seconds
[0m16:32:44.593121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:32:44.599920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:32:44.604997 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:32:44.606813 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:32:44.607149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:32:44.607359 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:32:44.607630 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:32:44.609475 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:32:44.609974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:44.610383 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:32:44.612611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:44.763556 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.154 seconds
[0m16:32:45.155353 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.545 seconds
[0m16:32:45.164160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.551 seconds
[0m16:32:45.168502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c73950>]}
[0m16:32:45.172020 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m16:32:45.172742 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m16:32:45.173296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.fact_sales)
[0m16:32:45.173719 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m16:32:45.185661 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m16:32:45.187336 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m16:32:45.214233 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m16:32:45.216448 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m16:32:45.216787 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),
cust_scd as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  -- ✅ SCD2-aware customer_key
  c.customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j
left join cust_scd c
  on j.customer_id = c.customer_id
 and cast(j.order_ts as date) >= cast(c.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c.dbt_valid_to as date)
      or c.dbt_valid_to is null
 )
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m16:32:47.069968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.852 seconds
[0m16:32:47.095439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911b30ca-38fe-404a-8240-976146b5dc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc5670>]}
[0m16:32:47.095983 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.92s]
[0m16:32:47.096411 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m16:32:47.097375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:47.097605 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m16:32:47.097796 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m16:32:47.290818 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:32:47.291909 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:32:47.487325 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:32:47.487832 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:32:47.679476 [info ] [MainThread]: 
[0m16:32:47.680479 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m16:32:47.681162 [debug] [MainThread]: Command end result
[0m16:32:47.711608 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:32:47.712759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:32:47.716941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:32:47.717176 [info ] [MainThread]: 
[0m16:32:47.717441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:47.717636 [info ] [MainThread]: 
[0m16:32:47.717842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:32:47.718183 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:32:47.719933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0299587, "process_in_blocks": "0", "process_kernel_time": 0.565552, "process_mem_max_rss": "238321664", "process_out_blocks": "0", "process_user_time": 4.411309}
[0m16:32:47.720239 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:47.720177 after 6.03 seconds
[0m16:32:47.720476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c42780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cec5c0>]}
[0m16:32:47.720703 [debug] [MainThread]: Flushing usage events
[0m16:32:48.093945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:54.914053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b81df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2a5a0>]}


============================== 16:32:54.917077 | ba225423-5756-46b7-bc5b-69e1530162ae ==============================
[0m16:32:54.917077 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:32:54.917531 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select not_null_fact_sales_customer_key', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True'}
[0m16:32:55.462518 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:32:55.462899 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:32:55.463150 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:32:55.629596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f55b050>]}
[0m16:32:55.676514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119196e10>]}
[0m16:32:55.677087 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:32:55.775770 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:32:55.971242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:55.971586 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:32:55.971793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:56.016314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f902c30>]}
[0m16:32:56.102027 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:32:56.103341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:32:56.121984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f902240>]}
[0m16:32:56.122326 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:32:56.122579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd0b1a0>]}
[0m16:32:56.123877 [info ] [MainThread]: 
[0m16:32:56.124109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:56.124292 [info ] [MainThread]: 
[0m16:32:56.124605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:56.128323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:32:56.136240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:32:56.149845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:32:56.181762 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:32:56.182155 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:32:56.182405 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:32:56.182708 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:32:56.182941 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:32:56.183148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:56.183341 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:32:56.183520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:56.183792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:56.953724 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.770 seconds
[0m16:32:56.958067 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.775 seconds
[0m16:32:56.961825 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.778 seconds
[0m16:32:56.964386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba225423-5756-46b7-bc5b-69e1530162ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7ab440>]}
[0m16:32:56.966465 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:32:56.966828 [info ] [Thread-1 (]: 1 of 1 START test not_null_fact_sales_customer_key ............................. [RUN]
[0m16:32:56.967198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m16:32:56.967477 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:32:56.981448 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:32:56.982023 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:32:57.000134 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:32:57.000926 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:32:57.001193 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
[0m16:32:57.268438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m16:32:57.280479 [error] [Thread-1 (]: 1 of 1 FAIL 6503 not_null_fact_sales_customer_key .............................. [[31mFAIL 6503[0m in 0.31s]
[0m16:32:57.281275 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:32:57.282639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:57.282934 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac' was left open.
[0m16:32:57.283205 [debug] [MainThread]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m16:32:57.485906 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was left open.
[0m16:32:57.486667 [debug] [MainThread]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m16:32:57.685208 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:32:57.686048 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:32:57.872072 [info ] [MainThread]: 
[0m16:32:57.872580 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m16:32:57.873393 [debug] [MainThread]: Command end result
[0m16:32:57.905392 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:32:57.906643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:32:57.911626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:32:57.911859 [info ] [MainThread]: 
[0m16:32:57.912097 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:32:57.912299 [info ] [MainThread]: 
[0m16:32:57.912543 [error] [MainThread]: [31mFailure in test not_null_fact_sales_customer_key (models/marts/schema.yml)[0m
[0m16:32:57.912774 [error] [MainThread]:   Got 6503 results, configured to fail if != 0
[0m16:32:57.912946 [info ] [MainThread]: 
[0m16:32:57.913154 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/marts/schema.yml/not_null_fact_sales_customer_key.sql
[0m16:32:57.913328 [info ] [MainThread]: 
[0m16:32:57.913521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:32:57.915254 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.0524392, "process_in_blocks": "0", "process_kernel_time": 1.980369, "process_mem_max_rss": "230735872", "process_out_blocks": "0", "process_user_time": 2.833438}
[0m16:32:57.915551 [debug] [MainThread]: Command `dbt test` failed at 16:32:57.915492 after 3.05 seconds
[0m16:32:57.915800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10081e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2a5a0>]}
[0m16:32:57.916034 [debug] [MainThread]: Flushing usage events
[0m16:32:58.210633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:34.382313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057368a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105736690>]}


============================== 16:43:34.386396 | 0421f040-8e01-40cd-89c1-a002afefbe20 ==============================
[0m16:43:34.386396 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:43:34.386849 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dim_customer', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True'}
[0m16:43:35.221787 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:43:35.222243 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:43:35.222491 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:43:35.393120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeb6750>]}
[0m16:43:35.440150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dace0f0>]}
[0m16:43:35.441484 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:43:35.546309 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:43:35.770644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:43:35.771357 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/facts/fact_sales.sql
[0m16:43:35.771612 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/dims/dim_customer.sql
[0m16:43:35.771843 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/facts/fact_sales.sql
[0m16:43:36.052744 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fact_sales' in
package 'retail_dbt' (models/marts/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m16:43:36.053127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e114f50>]}
[0m16:43:36.164469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e31e180>]}
[0m16:43:36.247165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:43:36.248910 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:43:36.265751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e365f40>]}
[0m16:43:36.266099 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:43:36.266347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15de86090>]}
[0m16:43:36.267639 [info ] [MainThread]: 
[0m16:43:36.267892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:36.268087 [info ] [MainThread]: 
[0m16:43:36.268386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:36.268966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:43:36.312382 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:43:36.312673 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:43:36.312873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:37.111512 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.799 seconds
[0m16:43:37.119685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m16:43:37.120236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:43:37.126033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:43:37.132917 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:43:37.134761 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:43:37.136618 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:43:37.136855 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:43:37.137066 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:43:37.137259 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:43:37.137913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:37.138375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:37.276015 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.139 seconds
[0m16:43:37.690063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.552 seconds
[0m16:43:37.696357 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.558 seconds
[0m16:43:37.698952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d35a00>]}
[0m16:43:37.702727 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m16:43:37.703261 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.dim_customer .................... [RUN]
[0m16:43:37.703683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_customer)
[0m16:43:37.703998 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m16:43:37.715193 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m16:43:37.715873 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m16:43:37.741166 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m16:43:37.742462 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m16:43:37.742771 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
    
    
    
    as (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */;
[0m16:43:39.047621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.304 seconds
[0m16:43:39.073330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0421f040-8e01-40cd-89c1-a002afefbe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4de20>]}
[0m16:43:39.073852 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.dim_customer ............... [[32mSUCCESS 1[0m in 1.37s]
[0m16:43:39.074274 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m16:43:39.075314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:39.075574 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was left open.
[0m16:43:39.075787 [debug] [MainThread]: On model.retail_dbt.dim_customer: Close
[0m16:43:39.272048 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:43:39.272741 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:43:39.470980 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:43:39.471411 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:43:39.672182 [info ] [MainThread]: 
[0m16:43:39.672643 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:43:39.673420 [debug] [MainThread]: Command end result
[0m16:43:39.706822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:43:39.707943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:43:39.712086 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:43:39.712314 [info ] [MainThread]: 
[0m16:43:39.712567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:39.712758 [info ] [MainThread]: 
[0m16:43:39.712977 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:43:39.713319 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:43:39.715354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.386643, "process_in_blocks": "0", "process_kernel_time": 0.604332, "process_mem_max_rss": "236453888", "process_out_blocks": "0", "process_user_time": 4.654482}
[0m16:43:39.715653 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:39.715596 after 5.39 seconds
[0m16:43:39.715883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2a3b90>]}
[0m16:43:39.716114 [debug] [MainThread]: Flushing usage events
[0m16:43:40.090015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:57.089006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096825d0>]}


============================== 16:43:57.092291 | a5b658df-3037-4cf8-a9bf-51529dc3c7b8 ==============================
[0m16:43:57.092291 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:43:57.092740 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fact_sales', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m16:43:57.638668 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:43:57.639060 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:43:57.639314 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:43:57.805752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341d1370>]}
[0m16:43:57.852861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f367b0>]}
[0m16:43:57.853421 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:43:57.951748 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:43:58.147522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:58.147862 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:43:58.148069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:58.192667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347c0770>]}
[0m16:43:58.277379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:43:58.278670 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:43:58.289862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8f9e0>]}
[0m16:43:58.290202 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:43:58.290457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346d99d0>]}
[0m16:43:58.291779 [info ] [MainThread]: 
[0m16:43:58.292026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:58.292217 [info ] [MainThread]: 
[0m16:43:58.292534 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:58.293149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m16:43:58.335150 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m16:43:58.335427 [debug] [ThreadPool]: On list_RETAIL_DW: show terse schemas in database RETAIL_DW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
[0m16:43:58.335638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:59.064548 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.729 seconds
[0m16:43:59.074777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m16:43:59.081680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:43:59.082253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:43:59.094858 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:43:59.097287 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:43:59.099137 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:43:59.099406 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:43:59.099631 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:43:59.099848 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:43:59.100341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:59.100796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:59.240632 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:43:59.657817 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.557 seconds
[0m16:43:59.665686 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.565 seconds
[0m16:43:59.670108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8ef00>]}
[0m16:43:59.673102 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m16:43:59.673766 [info ] [Thread-1 (]: 1 of 1 START sql table model STAGING_ANALYTICS.fact_sales ...................... [RUN]
[0m16:43:59.674234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.fact_sales)
[0m16:43:59.674549 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m16:43:59.694335 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m16:43:59.694971 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m16:43:59.720410 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m16:43:59.722550 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m16:43:59.722902 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
    
    
    
    as (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */;
[0m16:44:00.981419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m16:44:01.008965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b658df-3037-4cf8-a9bf-51529dc3c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b99bb0>]}
[0m16:44:01.009483 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STAGING_ANALYTICS.fact_sales ................. [[32mSUCCESS 1[0m in 1.33s]
[0m16:44:01.009911 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m16:44:01.010846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:01.011050 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was left open.
[0m16:44:01.011239 [debug] [MainThread]: On model.retail_dbt.fact_sales: Close
[0m16:44:01.196904 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:44:01.197499 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:44:01.414971 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was left open.
[0m16:44:01.415752 [debug] [MainThread]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m16:44:01.609593 [info ] [MainThread]: 
[0m16:44:01.610693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m16:44:01.611285 [debug] [MainThread]: Command end result
[0m16:44:01.639641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:44:01.640774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:44:01.645023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:44:01.645253 [info ] [MainThread]: 
[0m16:44:01.645516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:01.645713 [info ] [MainThread]: 
[0m16:44:01.645919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:01.647673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.609254, "process_in_blocks": "0", "process_kernel_time": 1.770265, "process_mem_max_rss": "231981056", "process_out_blocks": "0", "process_user_time": 3.051985}
[0m16:44:01.647970 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:01.647912 after 4.61 seconds
[0m16:44:01.648203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096824e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109682600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133749a60>]}
[0m16:44:01.648435 [debug] [MainThread]: Flushing usage events
[0m16:44:01.942627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:14.386584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b08a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9a570>]}


============================== 16:44:14.389766 | f8e861e3-08b2-416b-a58b-4fd8cf460751 ==============================
[0m16:44:14.389766 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:14.390227 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'target_path': 'None', 'warn_error': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt test --select not_null_fact_sales_customer_key', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False'}
[0m16:44:14.927376 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:44:14.927770 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:44:14.928029 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:44:15.095327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031aea50>]}
[0m16:44:15.142384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12133b0b0>]}
[0m16:44:15.142951 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:44:15.241294 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:44:15.436801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:15.437123 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:44:15.437327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:15.481997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217fdca0>]}
[0m16:44:15.566942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:44:15.568265 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:44:15.588349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d04050>]}
[0m16:44:15.588709 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:44:15.588966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217fdc10>]}
[0m16:44:15.590280 [info ] [MainThread]: 
[0m16:44:15.590531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:15.590722 [info ] [MainThread]: 
[0m16:44:15.591044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:15.594723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:44:15.602598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:44:15.616177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:44:15.648155 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:44:15.648539 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:44:15.648794 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:44:15.649082 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:44:15.649305 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:44:15.649505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:15.649694 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:44:15.649868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:15.650140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:16.399237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.749 seconds
[0m16:44:16.404719 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.755 seconds
[0m16:44:16.411865 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.762 seconds
[0m16:44:16.414356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e861e3-08b2-416b-a58b-4fd8cf460751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217aa9c0>]}
[0m16:44:16.416274 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:44:16.416586 [info ] [Thread-1 (]: 1 of 1 START test not_null_fact_sales_customer_key ............................. [RUN]
[0m16:44:16.416918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m16:44:16.417166 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:44:16.430761 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:44:16.431300 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:44:16.449618 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:44:16.450408 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:44:16.450691 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
[0m16:44:16.738834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m16:44:16.749857 [info ] [Thread-1 (]: 1 of 1 PASS not_null_fact_sales_customer_key ................................... [[32mPASS[0m in 0.33s]
[0m16:44:16.750478 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:44:16.751683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:16.752008 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac' was left open.
[0m16:44:16.752287 [debug] [MainThread]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m16:44:16.948017 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was left open.
[0m16:44:16.948697 [debug] [MainThread]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m16:44:17.137370 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was left open.
[0m16:44:17.138006 [debug] [MainThread]: On list_RETAIL_DW_ANALYTICS: Close
[0m16:44:17.333701 [info ] [MainThread]: 
[0m16:44:17.334403 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m16:44:17.335294 [debug] [MainThread]: Command end result
[0m16:44:17.369342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:44:17.370555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:44:17.375432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:44:17.375667 [info ] [MainThread]: 
[0m16:44:17.375916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:17.376114 [info ] [MainThread]: 
[0m16:44:17.376322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:17.378106 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.042808, "process_in_blocks": "0", "process_kernel_time": 1.942608, "process_mem_max_rss": "235323392", "process_out_blocks": "0", "process_user_time": 2.865487}
[0m16:44:17.378412 [debug] [MainThread]: Command `dbt test` succeeded at 16:44:17.378351 after 3.04 seconds
[0m16:44:17.378644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10158e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121acbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121acbf20>]}
[0m16:44:17.378876 [debug] [MainThread]: Flushing usage events
[0m16:44:17.672368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:43.377343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ba5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ba390>]}


============================== 16:47:43.380627 | cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54 ==============================
[0m16:47:43.380627 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:47:43.381097 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'None', 'quiet': 'False', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m16:47:43.923047 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:47:43.923443 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:47:43.923698 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:47:44.089979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b46c00>]}
[0m16:47:44.136760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a04710>]}
[0m16:47:44.137308 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:47:44.235555 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:47:44.459385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:44.459732 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:47:44.459939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:44.504517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d00e00>]}
[0m16:47:44.589867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:47:44.591134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:47:44.614422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127839700>]}
[0m16:47:44.614781 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:47:44.615040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ac42f0>]}
[0m16:47:44.617179 [info ] [MainThread]: 
[0m16:47:44.617430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:44.617627 [info ] [MainThread]: 
[0m16:47:44.617945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:44.621771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:47:44.629576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:47:44.643103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:47:44.675939 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:47:44.676312 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:47:44.676561 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:47:44.676852 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:47:44.677077 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:47:44.677276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:44.677470 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:47:44.677645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:44.677923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:45.436296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.758 seconds
[0m16:47:45.449118 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.771 seconds
[0m16:47:45.485331 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.808 seconds
[0m16:47:45.489965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff98a12-9e1e-42dc-b99c-fe5aa7fbcb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f1fcb0>]}
[0m16:47:45.494402 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:47:45.494977 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:47:45.495432 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:47:45.496670 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:47:45.496011 [info ] [Thread-1 (]: 1 of 25 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m16:47:45.497517 [info ] [Thread-2 (]: 2 of 25 START test not_null_dim_customer_customer_key .......................... [RUN]
[0m16:47:45.498028 [info ] [Thread-3 (]: 3 of 25 START test not_null_dim_date_date_key .................................. [RUN]
[0m16:47:45.498468 [info ] [Thread-4 (]: 4 of 25 START test not_null_dim_product_product_key ............................ [RUN]
[0m16:47:45.498982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc)
[0m16:47:45.500072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f)
[0m16:47:45.500491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_dim_date_date_key.881d0a31b6)
[0m16:47:45.501019 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3'
[0m16:47:45.501425 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:47:45.501796 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:47:45.502143 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:47:45.502497 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:47:45.525263 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:47:45.525686 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:47:45.528729 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:47:45.531780 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:47:45.532426 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:47:45.545946 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:47:45.550747 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:47:45.552830 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:47:45.553241 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:47:45.553481 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:47:45.555612 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:47:45.557632 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:47:45.558247 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:47:45.558744 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:47:45.559100 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"} */
[0m16:47:45.559415 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"} */
[0m16:47:45.560082 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:47:45.560568 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:47:45.560924 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_date_date_key.881d0a31b6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"} */
[0m16:47:45.561202 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"} */
[0m16:47:45.561951 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:47:45.682924 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:47:45.690509 [info ] [Thread-3 (]: 3 of 25 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.19s]
[0m16:47:45.690955 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:47:45.691222 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:47:45.691513 [info ] [Thread-3 (]: 5 of 25 START test not_null_dim_store_store_key ................................ [RUN]
[0m16:47:45.691828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_date_date_key.881d0a31b6, now test.retail_dbt.not_null_dim_store_store_key.507238c054)
[0m16:47:45.692070 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:47:45.695170 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:47:45.695695 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:47:45.697826 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:47:45.698521 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:47:45.698769 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_store_store_key.507238c054: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_store_store_key.507238c054"} */
[0m16:47:45.818241 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:47:45.820451 [info ] [Thread-3 (]: 5 of 25 PASS not_null_dim_store_store_key ...................................... [[32mPASS[0m in 0.13s]
[0m16:47:45.821010 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:47:45.821380 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:47:45.821780 [info ] [Thread-3 (]: 6 of 25 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m16:47:45.822183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_store_store_key.507238c054, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m16:47:45.822499 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:47:45.826313 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:47:45.826843 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:47:45.829121 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:47:45.829975 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:47:45.830233 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
[0m16:47:45.956748 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m16:47:45.962891 [info ] [Thread-3 (]: 6 of 25 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.14s]
[0m16:47:45.963910 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:47:45.964199 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:47:45.964498 [info ] [Thread-3 (]: 7 of 25 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m16:47:45.964812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m16:47:45.965062 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:47:45.968368 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:47:45.968854 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:47:45.970862 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:47:45.971665 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:47:45.971924 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
[0m16:47:45.998001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m16:47:45.999660 [info ] [Thread-1 (]: 1 of 25 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.50s]
[0m16:47:46.000158 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:47:46.000437 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:47:46.000745 [info ] [Thread-1 (]: 8 of 25 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m16:47:46.001066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m16:47:46.001304 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:47:46.004494 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:47:46.005370 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m16:47:46.006809 [info ] [Thread-2 (]: 2 of 25 PASS not_null_dim_customer_customer_key ................................ [[32mPASS[0m in 0.51s]
[0m16:47:46.007231 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:47:46.007510 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:47:46.007751 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:47:46.008032 [info ] [Thread-2 (]: 9 of 25 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m16:47:46.010208 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:47:46.010481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m16:47:46.010764 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:47:46.015149 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:47:46.015746 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:47:46.016026 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
[0m16:47:46.016429 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:47:46.018363 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:47:46.019300 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:47:46.019577 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
[0m16:47:46.068269 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m16:47:46.070265 [info ] [Thread-4 (]: 4 of 25 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.57s]
[0m16:47:46.070720 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:47:46.071025 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:47:46.071336 [info ] [Thread-4 (]: 10 of 25 START test not_null_fact_sales_date_key ............................... [RUN]
[0m16:47:46.071658 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m16:47:46.071896 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:47:46.075062 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:47:46.075534 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:47:46.077496 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:47:46.078167 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:47:46.078423 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
[0m16:47:46.095970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m16:47:46.097340 [info ] [Thread-3 (]: 7 of 25 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.13s]
[0m16:47:46.097717 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:47:46.097970 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:47:46.098241 [info ] [Thread-3 (]: 11 of 25 START test not_null_fact_sales_product_key ............................ [RUN]
[0m16:47:46.098541 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m16:47:46.098776 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:47:46.101929 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:47:46.102356 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:47:46.104305 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:47:46.104957 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:47:46.105207 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
[0m16:47:46.138464 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:47:46.140230 [info ] [Thread-2 (]: 9 of 25 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.13s]
[0m16:47:46.140712 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:47:46.141299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m16:47:46.141624 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:47:46.143109 [info ] [Thread-1 (]: 8 of 25 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.14s]
[0m16:47:46.143449 [info ] [Thread-2 (]: 12 of 25 START test not_null_fact_sales_sales_line_key ......................... [RUN]
[0m16:47:46.143854 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:47:46.144104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m16:47:46.144357 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:47:46.144635 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:47:46.144915 [info ] [Thread-1 (]: 13 of 25 START test not_null_fact_sales_store_key .............................. [RUN]
[0m16:47:46.148038 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:47:46.148324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m16:47:46.148620 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:47:46.151674 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:47:46.152026 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:47:46.155259 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:47:46.155603 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:47:46.157525 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:47:46.158104 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:47:46.158355 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
[0m16:47:46.158989 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:47:46.159277 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
[0m16:47:46.229143 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m16:47:46.231059 [info ] [Thread-4 (]: 10 of 25 PASS not_null_fact_sales_date_key ..................................... [[32mPASS[0m in 0.16s]
[0m16:47:46.231580 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:47:46.231927 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:47:46.232301 [info ] [Thread-4 (]: 14 of 25 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m16:47:46.232710 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m16:47:46.233032 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:47:46.241002 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:47:46.241573 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:47:46.243912 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:47:46.244873 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:47:46.245155 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
[0m16:47:46.251649 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m16:47:46.252992 [info ] [Thread-3 (]: 11 of 25 PASS not_null_fact_sales_product_key .................................. [[32mPASS[0m in 0.15s]
[0m16:47:46.253365 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:47:46.253617 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:47:46.253877 [info ] [Thread-3 (]: 15 of 25 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m16:47:46.254131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m16:47:46.254353 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:47:46.258617 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:47:46.259076 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:47:46.261112 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:47:46.261991 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:47:46.262265 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
[0m16:47:46.303156 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m16:47:46.304785 [info ] [Thread-2 (]: 12 of 25 PASS not_null_fact_sales_sales_line_key ............................... [[32mPASS[0m in 0.16s]
[0m16:47:46.305218 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:47:46.305514 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:47:46.305848 [info ] [Thread-2 (]: 16 of 25 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m16:47:46.306217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m16:47:46.306505 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:47:46.311132 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:47:46.311612 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:47:46.313600 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:47:46.314479 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:47:46.314763 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
[0m16:47:46.316948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m16:47:46.318455 [info ] [Thread-1 (]: 13 of 25 PASS not_null_fact_sales_store_key .................................... [[32mPASS[0m in 0.17s]
[0m16:47:46.318860 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:47:46.319167 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:47:46.319443 [info ] [Thread-1 (]: 17 of 25 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m16:47:46.319868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m16:47:46.320178 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:47:46.324455 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:47:46.324966 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:47:46.326959 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:47:46.327836 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:47:46.328111 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
[0m16:47:46.372642 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m16:47:46.374283 [info ] [Thread-4 (]: 14 of 25 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.14s]
[0m16:47:46.374732 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:47:46.375024 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:47:46.375328 [info ] [Thread-4 (]: 18 of 25 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m16:47:46.375629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m16:47:46.375869 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:47:46.379544 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:47:46.380016 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:47:46.381996 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:47:46.382854 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:47:46.383112 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
[0m16:47:46.391022 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:47:46.392369 [info ] [Thread-3 (]: 15 of 25 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.14s]
[0m16:47:46.392745 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:47:46.392993 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:47:46.393263 [info ] [Thread-3 (]: 19 of 25 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m16:47:46.393549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m16:47:46.393779 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:47:46.397548 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:47:46.397985 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:47:46.399973 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:47:46.400817 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:47:46.401086 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
[0m16:47:46.448426 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m16:47:46.450082 [info ] [Thread-2 (]: 16 of 25 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.14s]
[0m16:47:46.450530 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:47:46.450830 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:47:46.451151 [info ] [Thread-2 (]: 20 of 25 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m16:47:46.451483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m16:47:46.451757 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:47:46.455666 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:47:46.456142 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:47:46.458102 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:47:46.458970 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:47:46.459233 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
[0m16:47:46.676580 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m16:47:46.682733 [info ] [Thread-4 (]: 18 of 25 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.31s]
[0m16:47:46.683753 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:47:46.684025 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:47:46.684314 [info ] [Thread-4 (]: 21 of 25 START test unique_dim_customer_customer_key ........................... [RUN]
[0m16:47:46.684666 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e)
[0m16:47:46.684918 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:47:46.690063 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:47:46.690613 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:47:46.692665 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:47:46.693695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m16:47:46.694300 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:47:46.695815 [info ] [Thread-1 (]: 17 of 25 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.38s]
[0m16:47:46.696155 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is not null
group by customer_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"} */
[0m16:47:46.696548 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:47:46.696876 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:47:46.697210 [info ] [Thread-1 (]: 22 of 25 START test unique_dim_date_date_key ................................... [RUN]
[0m16:47:46.697527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_dim_date_date_key.0869fd48f9)
[0m16:47:46.697754 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:47:46.701046 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:47:46.701767 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:47:46.703726 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:47:46.704727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m16:47:46.706171 [info ] [Thread-2 (]: 20 of 25 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.25s]
[0m16:47:46.706588 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:47:46.706903 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:47:46.707473 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:47:46.707727 [info ] [Thread-2 (]: 23 of 25 START test unique_dim_product_product_key ............................. [RUN]
[0m16:47:46.708023 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_date_date_key.0869fd48f9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"} */
[0m16:47:46.708300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5, now test.retail_dbt.unique_dim_product_product_key.1753236bd0)
[0m16:47:46.708688 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:47:46.711853 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:47:46.712827 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m16:47:46.714273 [info ] [Thread-3 (]: 19 of 25 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.32s]
[0m16:47:46.714655 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:47:46.714893 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:47:46.715346 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:47:46.717446 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:47:46.717760 [info ] [Thread-3 (]: 24 of 25 START test unique_dim_store_store_key ................................. [RUN]
[0m16:47:46.718305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_dim_store_store_key.9baa94554a)
[0m16:47:46.718553 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:47:46.721690 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:47:46.722370 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:47:46.722671 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is not null
group by product_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_product_product_key.1753236bd0"} */
[0m16:47:46.723093 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:47:46.725145 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:47:46.726128 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:47:46.726414 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is not null
group by store_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_store_store_key.9baa94554a"} */
[0m16:47:46.839835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m16:47:46.842176 [info ] [Thread-1 (]: 22 of 25 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.14s]
[0m16:47:46.842715 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:47:46.843075 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:47:46.843458 [info ] [Thread-1 (]: 25 of 25 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m16:47:46.843870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_date_date_key.0869fd48f9, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m16:47:46.844183 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:47:46.849850 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:47:46.851137 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:47:46.852846 [info ] [Thread-2 (]: 23 of 25 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.14s]
[0m16:47:46.853325 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:47:46.853862 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m16:47:46.855379 [info ] [Thread-3 (]: 24 of 25 PASS unique_dim_store_store_key ....................................... [[32mPASS[0m in 0.14s]
[0m16:47:46.855747 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:47:46.855976 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:47:46.858037 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:47:46.858794 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:47:46.859043 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
[0m16:47:46.875957 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m16:47:46.877530 [info ] [Thread-4 (]: 21 of 25 PASS unique_dim_customer_customer_key ................................. [[32mPASS[0m in 0.19s]
[0m16:47:46.877955 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:47:47.070343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m16:47:47.076168 [info ] [Thread-1 (]: 25 of 25 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.23s]
[0m16:47:47.077299 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:47:47.078738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:47.079029 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was left open.
[0m16:47:47.079287 [debug] [MainThread]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m16:47:47.265538 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_product_product_key.1753236bd0' was left open.
[0m16:47:47.266196 [debug] [MainThread]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: Close
[0m16:47:47.459175 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_store_store_key.9baa94554a' was left open.
[0m16:47:47.459907 [debug] [MainThread]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: Close
[0m16:47:47.652257 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e' was left open.
[0m16:47:47.652945 [debug] [MainThread]: On test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e: Close
[0m16:47:47.843953 [info ] [MainThread]: 
[0m16:47:47.845067 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m16:47:47.848056 [debug] [MainThread]: Command end result
[0m16:47:47.947992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:47:47.949264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:47:47.955025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:47:47.955275 [info ] [MainThread]: 
[0m16:47:47.955529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:47.955737 [info ] [MainThread]: 
[0m16:47:47.955943 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m16:47:47.959515 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6367927, "process_in_blocks": "0", "process_kernel_time": 0.840913, "process_mem_max_rss": "236388352", "process_out_blocks": "0", "process_user_time": 4.379243}
[0m16:47:47.959861 [debug] [MainThread]: Command `dbt test` succeeded at 16:47:47.959793 after 4.64 seconds
[0m16:47:47.960115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eae960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595a7b0>]}
[0m16:47:47.960357 [debug] [MainThread]: Flushing usage events
[0m16:47:48.312224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:32.102261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c59190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983a5d0>]}


============================== 16:53:32.105525 | 38e04c9f-089d-40a7-ae21-faceee1a190c ==============================
[0m16:53:32.105525 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:53:32.105984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'None', 'invocation_command': 'dbt docs generate', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt'}
[0m16:53:32.735418 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:53:32.735809 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:53:32.736060 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:53:32.983203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a104d10>]}
[0m16:53:33.031075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f724fb0>]}
[0m16:53:33.031700 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m16:53:33.133075 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:53:33.335912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:33.336275 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:53:33.336485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:33.381195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125406ed0>]}
[0m16:53:33.396667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125657b30>]}
[0m16:53:33.397039 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m16:53:33.397405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253d8da0>]}
[0m16:53:33.399642 [info ] [MainThread]: 
[0m16:53:33.399897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:33.400092 [info ] [MainThread]: 
[0m16:53:33.400412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:33.404140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m16:53:33.413145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m16:53:33.427607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m16:53:33.504047 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m16:53:33.504516 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m16:53:33.504792 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m16:53:33.505103 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m16:53:33.505343 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m16:53:33.505568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:33.505782 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m16:53:33.505975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:33.506253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:34.283911 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.778 seconds
[0m16:53:34.285320 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.779 seconds
[0m16:53:34.290090 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.784 seconds
[0m16:53:34.295327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e04c9f-089d-40a7-ae21-faceee1a190c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247f2540>]}
[0m16:53:34.298500 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m16:53:34.298817 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m16:53:34.299082 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m16:53:34.299375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m16:53:34.299617 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m16:53:34.299865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m16:53:34.300098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m16:53:34.300340 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m16:53:34.300641 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m16:53:34.300864 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m16:53:34.301079 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m16:53:34.308534 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m16:53:34.308804 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m16:53:34.311362 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m16:53:34.313445 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m16:53:34.315734 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m16:53:34.316431 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m16:53:34.316921 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m16:53:34.317174 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m16:53:34.317404 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m16:53:34.317671 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m16:53:34.318251 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m16:53:34.318519 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m16:53:34.319090 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m16:53:34.319350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m16:53:34.319615 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m16:53:34.320042 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m16:53:34.320325 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_stores
[0m16:53:34.320591 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m16:53:34.320864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m16:53:34.321118 [debug] [Thread-4 (]: Began running node snapshot.retail_dbt.snap_customers
[0m16:53:34.321365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_stores)
[0m16:53:34.323452 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m16:53:34.323702 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m16:53:34.323953 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now snapshot.retail_dbt.snap_customers)
[0m16:53:34.324182 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_stores
[0m16:53:34.326281 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m16:53:34.326534 [debug] [Thread-4 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m16:53:34.328625 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m16:53:34.328869 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m16:53:34.331455 [debug] [Thread-4 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m16:53:34.331966 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m16:53:34.332204 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m16:53:34.332578 [debug] [Thread-4 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m16:53:34.332862 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m16:53:34.333261 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m16:53:34.333501 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_stores
[0m16:53:34.333748 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:53:34.334024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m16:53:34.334305 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:53:34.334701 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_stores
[0m16:53:34.334952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now test.retail_dbt.not_null_dim_date_date_key.881d0a31b6)
[0m16:53:34.335180 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m16:53:34.335397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now test.retail_dbt.unique_dim_date_date_key.0869fd48f9)
[0m16:53:34.335635 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m16:53:34.335877 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:53:34.347123 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m16:53:34.347394 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:53:34.347668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_customer)
[0m16:53:34.357829 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m16:53:34.362437 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m16:53:34.362723 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m16:53:34.366713 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m16:53:34.367159 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:53:34.367409 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:53:34.367626 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m16:53:34.368041 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m16:53:34.368491 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m16:53:34.368734 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m16:53:34.369127 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m16:53:34.369379 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m16:53:34.369637 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m16:53:34.370055 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m16:53:34.370413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_date_date_key.0869fd48f9, now model.retail_dbt.dim_product)
[0m16:53:34.370663 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:53:34.370885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_date_date_key.881d0a31b6, now model.retail_dbt.dim_store)
[0m16:53:34.371130 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:53:34.371378 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m16:53:34.371648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m16:53:34.371868 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m16:53:34.372095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m16:53:34.374862 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m16:53:34.375136 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:53:34.377812 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m16:53:34.378063 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:53:34.381173 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m16:53:34.384259 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m16:53:34.384658 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m16:53:34.384872 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m16:53:34.385333 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m16:53:34.385764 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m16:53:34.385998 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:53:34.386252 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:53:34.386481 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:53:34.386744 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:53:34.387199 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m16:53:34.387486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m16:53:34.387879 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m16:53:34.388109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m16:53:34.388362 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m16:53:34.388604 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:53:34.388838 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:53:34.389072 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:53:34.389298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now model.retail_dbt.fact_sales)
[0m16:53:34.393766 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m16:53:34.394049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc)
[0m16:53:34.400164 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m16:53:34.400460 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m16:53:34.400751 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:53:34.405568 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m16:53:34.408675 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m16:53:34.408966 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:53:34.409193 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:53:34.409721 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m16:53:34.410156 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m16:53:34.410491 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:53:34.410706 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m16:53:34.410910 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:53:34.411176 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:53:34.411442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f)
[0m16:53:34.411842 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m16:53:34.412216 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m16:53:34.412450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e)
[0m16:53:34.412680 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:53:34.412927 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:53:34.413226 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:53:34.413693 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:53:34.416740 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m16:53:34.417039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_dim_store_store_key.507238c054)
[0m16:53:34.417311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m16:53:34.420258 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m16:53:34.420562 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:53:34.420793 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:53:34.423973 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m16:53:34.424265 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:53:34.428534 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m16:53:34.429055 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m16:53:34.429281 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:53:34.429610 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:53:34.429835 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:53:34.430310 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m16:53:34.430591 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f, now test.retail_dbt.unique_dim_store_store_key.9baa94554a)
[0m16:53:34.430844 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:53:34.431227 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m16:53:34.431483 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:53:34.431741 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:53:34.432139 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m16:53:34.432390 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:53:34.432656 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e, now test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3)
[0m16:53:34.435679 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m16:53:34.435968 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:53:34.436248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_store_store_key.507238c054, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m16:53:34.438102 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:53:34.438404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_dim_product_product_key.1753236bd0)
[0m16:53:34.438649 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:53:34.441656 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m16:53:34.441952 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:53:34.442179 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:53:34.446287 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m16:53:34.449505 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m16:53:34.449995 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m16:53:34.450345 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:53:34.450613 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:53:34.451154 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m16:53:34.451381 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:53:34.451606 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:53:34.451838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_store_store_key.9baa94554a, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m16:53:34.452088 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:53:34.452485 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m16:53:34.452867 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m16:53:34.453084 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:53:34.453332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m16:53:34.453586 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:53:34.453840 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:53:34.456839 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m16:53:34.457110 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:53:34.457364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_product_product_key.1753236bd0, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m16:53:34.457625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m16:53:34.460641 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m16:53:34.460902 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:53:34.461147 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:53:34.461366 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:53:34.464392 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m16:53:34.467305 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m16:53:34.467766 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m16:53:34.468003 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:53:34.468340 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:53:34.468810 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m16:53:34.469026 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:53:34.469241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m16:53:34.469459 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:53:34.469701 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:53:34.470109 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m16:53:34.470324 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:53:34.470729 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m16:53:34.470981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m16:53:34.471236 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:53:34.474354 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m16:53:34.474643 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:53:34.474895 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:53:34.475142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m16:53:34.475418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m16:53:34.481189 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m16:53:34.481485 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:53:34.481721 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:53:34.481948 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:53:34.485562 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m16:53:34.486022 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m16:53:34.489869 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m16:53:34.490146 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:53:34.490435 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:53:34.490933 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m16:53:34.491218 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:53:34.491465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m16:53:34.491742 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:53:34.491959 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:53:34.492340 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m16:53:34.492575 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:53:34.492833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m16:53:34.493223 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m16:53:34.496838 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m16:53:34.497107 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:53:34.500203 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m16:53:34.500567 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:53:34.500996 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m16:53:34.501319 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:53:34.501752 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m16:53:34.502524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:34.502724 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was left open.
[0m16:53:34.502913 [debug] [MainThread]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m16:53:34.725774 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was left open.
[0m16:53:34.726388 [debug] [MainThread]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m16:53:34.920459 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was left open.
[0m16:53:34.921492 [debug] [MainThread]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m16:53:35.116175 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m16:53:35.124424 [debug] [MainThread]: Command end result
[0m16:53:35.215571 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:53:35.216913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:53:35.222656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m16:53:35.225170 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m16:53:35.225418 [info ] [MainThread]: Building catalog
[0m16:53:35.233965 [debug] [ThreadPool]: Acquiring new snowflake connection 'RETAIL_DW.information_schema'
[0m16:53:35.249116 [debug] [ThreadPool]: Using snowflake connection "RETAIL_DW.information_schema"
[0m16:53:35.249849 [debug] [ThreadPool]: On RETAIL_DW.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from RETAIL_DW.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from RETAIL_DW.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "RETAIL_DW.information_schema"} */
[0m16:53:35.250530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:43.089970 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 7.839 seconds
[0m16:53:43.144675 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/catalog.json
[0m16:53:43.172864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m16:53:43.174049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m16:53:43.174271 [info ] [MainThread]: Catalog written to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/catalog.json
[0m16:53:43.176196 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.126555, "process_in_blocks": "0", "process_kernel_time": 0.995082, "process_mem_max_rss": "233619456", "process_out_blocks": "0", "process_user_time": 3.965159}
[0m16:53:43.176560 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:53:43.176493 after 11.13 seconds
[0m16:53:43.176778 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:53:43.176952 [debug] [MainThread]: Connection 'RETAIL_DW.information_schema' was left open.
[0m16:53:43.177129 [debug] [MainThread]: On RETAIL_DW.information_schema: Close
[0m16:53:43.360717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248d6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252c5910>]}
[0m16:53:43.361645 [debug] [MainThread]: Flushing usage events
[0m16:53:43.721604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:45.186004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b46660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b46330>]}


============================== 16:53:45.189305 | 1c7ae5a3-6dc9-46ba-911c-ebf8881255ab ==============================
[0m16:53:45.189305 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:53:45.189754 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'empty': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs serve', 'log_format': 'default'}
[0m16:53:45.718814 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:53:45.719198 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:53:45.719442 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:53:45.885803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c7ae5a3-6dc9-46ba-911c-ebf8881255ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705eb40>]}
[0m16:53:45.932740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c7ae5a3-6dc9-46ba-911c-ebf8881255ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127449ca0>]}
[0m17:04:20.552142 [error] [MainThread]: Encountered an error:

[0m17:04:20.560772 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:04:20.566382 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 635.43494, "process_in_blocks": "0", "process_kernel_time": 1.697077, "process_mem_max_rss": "207896576", "process_out_blocks": "0", "process_user_time": 2.302283}
[0m17:04:20.568024 [debug] [MainThread]: Command `dbt docs serve` failed at 17:04:20.567866 after 635.44 seconds
[0m17:04:20.568632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b46630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130485fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245061b0>]}
[0m17:04:20.569197 [debug] [MainThread]: Flushing usage events
[0m17:04:20.969347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:26.171564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076712b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4a3f0>]}


============================== 17:04:26.175265 | b219072b-f325-4a64-8429-01c84d0ab682 ==============================
[0m17:04:26.175265 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:04:26.175755 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/Users/lakshminishevitha/.dbt', 'log_cache_events': 'False', 'empty': 'None', 'log_path': '/Users/lakshminishevitha/retail-dw/dbt/retail_dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80'}
[0m17:04:26.911538 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:04:26.912003 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:04:26.912252 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:04:27.173590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e121e0>]}
[0m17:04:27.221151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158fd8470>]}
[0m17:04:27.221921 [info ] [MainThread]: Registered adapter: snowflake=1.11.0
[0m17:04:27.324580 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:04:27.555676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:27.556521 [debug] [MainThread]: Partial parsing: updated file: retail_dbt://models/marts/schema.yml
[0m17:04:27.957152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1596d9b80>]}
[0m17:04:28.041085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m17:04:28.043779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m17:04:28.068634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1599b0aa0>]}
[0m17:04:28.068994 [info ] [MainThread]: Found 12 models, 1 snapshot, 25 data tests, 6 sources, 634 macros
[0m17:04:28.069255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159a77680>]}
[0m17:04:28.071384 [info ] [MainThread]: 
[0m17:04:28.071654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:04:28.071855 [info ] [MainThread]: 
[0m17:04:28.072167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:28.075992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m17:04:28.082656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m17:04:28.096689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m17:04:28.171442 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m17:04:28.171829 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m17:04:28.172157 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m17:04:28.172377 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: show objects in RETAIL_DW.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */;
[0m17:04:28.172627 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: show objects in RETAIL_DW.STAGING_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */;
[0m17:04:28.172842 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: show objects in RETAIL_DW.STAGING_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */;
[0m17:04:28.173046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:28.173233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:28.173410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:29.385979 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.212 seconds
[0m17:04:29.387372 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.214 seconds
[0m17:04:29.393629 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.220 seconds
[0m17:04:29.399529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b219072b-f325-4a64-8429-01c84d0ab682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15996c590>]}
[0m17:04:29.402846 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m17:04:29.403268 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m17:04:29.403938 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m17:04:29.404272 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m17:04:29.403647 [info ] [Thread-1 (]: 1 of 25 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:04:29.404659 [info ] [Thread-2 (]: 2 of 25 START test not_null_dim_customer_customer_key .......................... [RUN]
[0m17:04:29.405473 [info ] [Thread-3 (]: 3 of 25 START test not_null_dim_date_date_key .................................. [RUN]
[0m17:04:29.405934 [info ] [Thread-4 (]: 4 of 25 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:04:29.406393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc)
[0m17:04:29.406728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f)
[0m17:04:29.407040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_dim_date_date_key.881d0a31b6)
[0m17:04:29.407395 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3'
[0m17:04:29.407668 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m17:04:29.407932 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m17:04:29.408179 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m17:04:29.408420 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m17:04:29.419934 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m17:04:29.422944 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m17:04:29.425849 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m17:04:29.429829 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m17:04:29.430726 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m17:04:29.436976 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m17:04:29.443303 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m17:04:29.459718 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m17:04:29.459998 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m17:04:29.460588 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m17:04:29.461874 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m17:04:29.463900 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m17:04:29.464614 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"
[0m17:04:29.465010 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc"} */
[0m17:04:29.465540 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"
[0m17:04:29.466120 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"
[0m17:04:29.466499 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f"} */
[0m17:04:29.467032 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"
[0m17:04:29.467339 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_date_date_key.881d0a31b6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_date_date_key.881d0a31b6"} */
[0m17:04:29.468237 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3"} */
[0m17:04:29.469223 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:04:29.607551 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:04:29.614888 [info ] [Thread-3 (]: 3 of 25 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.21s]
[0m17:04:29.615450 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_date_date_key.881d0a31b6
[0m17:04:29.616009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m17:04:29.616499 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m17:04:29.616779 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m17:04:29.618271 [info ] [Thread-1 (]: 1 of 25 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.21s]
[0m17:04:29.619594 [info ] [Thread-2 (]: 2 of 25 PASS not_null_dim_customer_customer_key ................................ [[32mPASS[0m in 0.21s]
[0m17:04:29.619890 [info ] [Thread-3 (]: 5 of 25 START test not_null_dim_store_store_key ................................ [RUN]
[0m17:04:29.620255 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc
[0m17:04:29.620573 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f
[0m17:04:29.620826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_date_date_key.881d0a31b6, now test.retail_dbt.not_null_dim_store_store_key.507238c054)
[0m17:04:29.621083 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m17:04:29.621383 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m17:04:29.621672 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m17:04:29.621906 [info ] [Thread-1 (]: 6 of 25 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m17:04:29.622152 [info ] [Thread-2 (]: 7 of 25 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m17:04:29.625367 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m17:04:29.625654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_id.9775012dfc, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m17:04:29.625899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customer_customer_key.c289fe4d1f, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m17:04:29.626188 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m17:04:29.626465 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m17:04:29.629499 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m17:04:29.633991 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m17:04:29.634391 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m17:04:29.692218 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m17:04:29.692831 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m17:04:29.694968 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m17:04:29.695525 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_dim_store_store_key.507238c054"
[0m17:04:29.695815 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m17:04:29.696158 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_store_store_key.507238c054: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_store_store_key.507238c054"} */
[0m17:04:29.698208 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m17:04:29.698947 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m17:04:29.699517 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
[0m17:04:29.700606 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m17:04:29.700912 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
[0m17:04:29.860375 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m17:04:29.863074 [info ] [Thread-2 (]: 7 of 25 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.24s]
[0m17:04:29.864097 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m17:04:29.864917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m17:04:29.865449 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m17:04:29.867359 [info ] [Thread-3 (]: 5 of 25 PASS not_null_dim_store_store_key ...................................... [[32mPASS[0m in 0.25s]
[0m17:04:29.869153 [info ] [Thread-1 (]: 6 of 25 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.24s]
[0m17:04:29.869584 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m17:04:29.870112 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_store_store_key.507238c054
[0m17:04:29.870591 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m17:04:29.870944 [info ] [Thread-2 (]: 8 of 25 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m17:04:29.871281 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m17:04:29.871589 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m17:04:29.871930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m17:04:29.872212 [info ] [Thread-3 (]: 9 of 25 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m17:04:29.872489 [info ] [Thread-1 (]: 10 of 25 START test not_null_fact_sales_date_key ............................... [RUN]
[0m17:04:29.872763 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m17:04:29.873027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_store_store_key.507238c054, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m17:04:29.873303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m17:04:29.877356 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m17:04:29.877681 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m17:04:29.877982 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m17:04:29.881530 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m17:04:29.884494 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m17:04:29.885753 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m17:04:29.887860 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m17:04:29.888207 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m17:04:29.890292 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m17:04:29.890595 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m17:04:29.893659 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m17:04:29.894191 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m17:04:29.895814 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
[0m17:04:29.896328 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m17:04:29.896883 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
[0m17:04:29.897468 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m17:04:29.897787 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
[0m17:04:30.036698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:04:30.040306 [info ] [Thread-1 (]: 10 of 25 PASS not_null_fact_sales_date_key ..................................... [[32mPASS[0m in 0.17s]
[0m17:04:30.041077 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m17:04:30.041528 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m17:04:30.042416 [info ] [Thread-1 (]: 11 of 25 START test not_null_fact_sales_product_key ............................ [RUN]
[0m17:04:30.043232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m17:04:30.043715 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m17:04:30.044697 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m17:04:30.049572 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m17:04:30.050325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m17:04:30.052652 [info ] [Thread-4 (]: 4 of 25 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.65s]
[0m17:04:30.053364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m17:04:30.054878 [info ] [Thread-3 (]: 9 of 25 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.18s]
[0m17:04:30.055396 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3
[0m17:04:30.055706 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m17:04:30.057279 [info ] [Thread-2 (]: 8 of 25 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.19s]
[0m17:04:30.057743 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m17:04:30.058053 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m17:04:30.060571 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m17:04:30.060980 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m17:04:30.061272 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m17:04:30.061531 [info ] [Thread-4 (]: 12 of 25 START test not_null_fact_sales_sales_line_key ......................... [RUN]
[0m17:04:30.061896 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m17:04:30.062180 [info ] [Thread-3 (]: 13 of 25 START test not_null_fact_sales_store_key .............................. [RUN]
[0m17:04:30.062467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_product_product_key.f0e1d838d3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m17:04:30.062974 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m17:04:30.063238 [info ] [Thread-2 (]: 14 of 25 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m17:04:30.063519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m17:04:30.063756 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m17:04:30.064001 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
[0m17:04:30.064260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m17:04:30.064483 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m17:04:30.067629 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m17:04:30.068046 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m17:04:30.071084 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m17:04:30.075226 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m17:04:30.075987 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m17:04:30.076256 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m17:04:30.078334 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m17:04:30.080491 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m17:04:30.080751 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m17:04:30.084171 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m17:04:30.084749 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m17:04:30.085025 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
[0m17:04:30.085773 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m17:04:30.086048 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
[0m17:04:30.086749 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m17:04:30.087223 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
[0m17:04:30.215280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m17:04:30.218277 [info ] [Thread-1 (]: 11 of 25 PASS not_null_fact_sales_product_key .................................. [[32mPASS[0m in 0.17s]
[0m17:04:30.219012 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m17:04:30.219460 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m17:04:30.219949 [info ] [Thread-1 (]: 15 of 25 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m17:04:30.220515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m17:04:30.220930 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m17:04:30.227788 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m17:04:30.228631 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m17:04:30.229696 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m17:04:30.231565 [info ] [Thread-4 (]: 12 of 25 PASS not_null_fact_sales_sales_line_key ............................... [[32mPASS[0m in 0.17s]
[0m17:04:30.233276 [info ] [Thread-2 (]: 14 of 25 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.17s]
[0m17:04:30.233635 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m17:04:30.234225 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m17:04:30.234640 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m17:04:30.235032 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m17:04:30.237500 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m17:04:30.239097 [info ] [Thread-3 (]: 13 of 25 PASS not_null_fact_sales_store_key .................................... [[32mPASS[0m in 0.18s]
[0m17:04:30.239432 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m17:04:30.239758 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m17:04:30.240189 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m17:04:30.240446 [info ] [Thread-4 (]: 16 of 25 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m17:04:30.240739 [info ] [Thread-2 (]: 17 of 25 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m17:04:30.241042 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m17:04:30.241767 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m17:04:30.242032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m17:04:30.242270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m17:04:30.242511 [info ] [Thread-3 (]: 18 of 25 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m17:04:30.242791 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
[0m17:04:30.243044 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m17:04:30.243262 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m17:04:30.243504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m17:04:30.247719 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m17:04:30.251478 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m17:04:30.251926 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m17:04:30.256142 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m17:04:30.256593 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m17:04:30.258695 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m17:04:30.259041 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m17:04:30.261026 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m17:04:30.261394 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m17:04:30.264564 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m17:04:30.265303 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m17:04:30.265646 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
[0m17:04:30.266606 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m17:04:30.267392 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m17:04:30.267660 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
[0m17:04:30.268001 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
[0m17:04:30.395840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m17:04:30.399291 [info ] [Thread-1 (]: 15 of 25 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.18s]
[0m17:04:30.400355 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m17:04:30.400939 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m17:04:30.403255 [info ] [Thread-4 (]: 16 of 25 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.16s]
[0m17:04:30.403770 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m17:04:30.404397 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m17:04:30.404837 [info ] [Thread-1 (]: 19 of 25 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m17:04:30.405247 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m17:04:30.405635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m17:04:30.405977 [info ] [Thread-4 (]: 20 of 25 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m17:04:30.406330 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m17:04:30.406633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m17:04:30.411993 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m17:04:30.412944 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m17:04:30.413592 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m17:04:30.414211 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:04:30.418435 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m17:04:30.419899 [info ] [Thread-3 (]: 18 of 25 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.18s]
[0m17:04:30.421365 [info ] [Thread-2 (]: 17 of 25 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.18s]
[0m17:04:30.421832 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m17:04:30.422174 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m17:04:30.422456 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m17:04:30.422707 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m17:04:30.422953 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m17:04:30.423295 [info ] [Thread-3 (]: 21 of 25 START test unique_dim_customer_customer_key ........................... [RUN]
[0m17:04:30.423542 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m17:04:30.425626 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m17:04:30.425892 [info ] [Thread-2 (]: 22 of 25 START test unique_dim_date_date_key ................................... [RUN]
[0m17:04:30.426186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e)
[0m17:04:30.428197 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m17:04:30.428521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_dim_date_date_key.0869fd48f9)
[0m17:04:30.428785 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m17:04:30.429538 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m17:04:30.429768 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m17:04:30.434387 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m17:04:30.434696 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
[0m17:04:30.435426 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m17:04:30.438572 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m17:04:30.439093 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
[0m17:04:30.440005 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m17:04:30.441989 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m17:04:30.442279 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m17:04:30.445625 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m17:04:30.446864 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"
[0m17:04:30.447171 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_customer
where customer_key is not null
group by customer_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e"} */
[0m17:04:30.448064 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"
[0m17:04:30.448585 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_date_date_key.0869fd48f9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_date
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_date_date_key.0869fd48f9"} */
[0m17:04:30.623042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m17:04:30.627841 [info ] [Thread-1 (]: 19 of 25 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.22s]
[0m17:04:30.629079 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m17:04:30.630520 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m17:04:30.631566 [info ] [Thread-1 (]: 23 of 25 START test unique_dim_product_product_key ............................. [RUN]
[0m17:04:30.632425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_dim_product_product_key.1753236bd0)
[0m17:04:30.633640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m17:04:30.634070 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m17:04:30.635106 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m17:04:30.637814 [info ] [Thread-3 (]: 21 of 25 PASS unique_dim_customer_customer_key ................................. [[32mPASS[0m in 0.21s]
[0m17:04:30.638728 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m17:04:30.643857 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m17:04:30.645947 [info ] [Thread-2 (]: 22 of 25 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.22s]
[0m17:04:30.646517 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e
[0m17:04:30.648242 [info ] [Thread-4 (]: 20 of 25 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.24s]
[0m17:04:30.648760 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_date_date_key.0869fd48f9
[0m17:04:30.649102 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m17:04:30.649580 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m17:04:30.649944 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m17:04:30.650269 [info ] [Thread-3 (]: 24 of 25 START test unique_dim_store_store_key ................................. [RUN]
[0m17:04:30.650566 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m17:04:30.650897 [info ] [Thread-2 (]: 25 of 25 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m17:04:30.651218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_customer_customer_key.7b0683cc6e, now test.retail_dbt.unique_dim_store_store_key.9baa94554a)
[0m17:04:30.653746 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m17:04:30.654051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_date_date_key.0869fd48f9, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m17:04:30.654329 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m17:04:30.654651 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m17:04:30.657955 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m17:04:30.660882 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m17:04:30.661637 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_dim_product_product_key.1753236bd0"
[0m17:04:30.661916 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_product
where product_key is not null
group by product_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_product_product_key.1753236bd0"} */
[0m17:04:30.662393 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m17:04:30.662641 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m17:04:30.664851 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m17:04:30.666969 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m17:04:30.667998 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_dim_store_store_key.9baa94554a"
[0m17:04:30.668273 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.dim_store
where store_key is not null
group by store_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_store_store_key.9baa94554a"} */
[0m17:04:30.668876 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m17:04:30.669293 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
[0m17:04:30.820236 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m17:04:30.821615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m17:04:30.825897 [info ] [Thread-2 (]: 25 of 25 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.17s]
[0m17:04:30.830211 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m17:04:30.831175 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m17:04:30.829161 [info ] [Thread-1 (]: 23 of 25 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.20s]
[0m17:04:30.833850 [info ] [Thread-3 (]: 24 of 25 PASS unique_dim_store_store_key ....................................... [[32mPASS[0m in 0.18s]
[0m17:04:30.834538 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_product_product_key.1753236bd0
[0m17:04:30.835089 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_store_store_key.9baa94554a
[0m17:04:30.836702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:30.837026 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_product_product_key.1753236bd0' was left open.
[0m17:04:30.837334 [debug] [MainThread]: On test.retail_dbt.unique_dim_product_product_key.1753236bd0: Close
[0m17:04:31.055962 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was left open.
[0m17:04:31.056649 [debug] [MainThread]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m17:04:31.254403 [debug] [MainThread]: Connection 'test.retail_dbt.unique_dim_store_store_key.9baa94554a' was left open.
[0m17:04:31.255200 [debug] [MainThread]: On test.retail_dbt.unique_dim_store_store_key.9baa94554a: Close
[0m17:04:31.459688 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was left open.
[0m17:04:31.460401 [debug] [MainThread]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m17:04:31.662236 [info ] [MainThread]: 
[0m17:04:31.663033 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:04:31.668043 [debug] [MainThread]: Command end result
[0m17:04:31.702841 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/manifest.json
[0m17:04:31.703987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/semantic_manifest.json
[0m17:04:31.709675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/lakshminishevitha/retail-dw/dbt/retail_dbt/target/run_results.json
[0m17:04:31.709915 [info ] [MainThread]: 
[0m17:04:31.710151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:31.710351 [info ] [MainThread]: 
[0m17:04:31.710556 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m17:04:31.712275 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.595122, "process_in_blocks": "0", "process_kernel_time": 0.719558, "process_mem_max_rss": "240254976", "process_out_blocks": "0", "process_user_time": 4.847358}
[0m17:04:31.712577 [debug] [MainThread]: Command `dbt test` succeeded at 17:04:31.712515 after 5.60 seconds
[0m17:04:31.712816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113be2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc74d0>]}
[0m17:04:31.713046 [debug] [MainThread]: Flushing usage events
[0m17:04:32.009948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:41.341420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf4e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5d4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf7deb0>]}


============================== 00:50:41.362766 | d4127de7-609e-49c7-ba66-25aca6ef076b ==============================
[0m00:50:41.362766 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:50:41.363309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:41.392099 [info ] [MainThread]: dbt version: 1.8.2
[0m00:50:41.392479 [info ] [MainThread]: python version: 3.12.7
[0m00:50:41.392902 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m00:50:41.393248 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m00:50:41.398218 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m00:50:41.398706 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m00:50:41.398996 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m00:50:41.399320 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m00:50:41.464917 [info ] [MainThread]: Configuration:
[0m00:50:41.465278 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:50:41.465687 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:50:41.466032 [info ] [MainThread]: Required dependencies:
[0m00:50:41.466352 [debug] [MainThread]: Executing "git --help"
[0m00:50:41.468749 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:50:41.469154 [debug] [MainThread]: STDERR: "b''"
[0m00:50:41.469413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:50:41.469739 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:50:41.470077 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:50:41.470440 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "retail_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m00:50:41.471184 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.16600117, "process_user_time": 1.617154, "process_kernel_time": 0.072006, "process_mem_max_rss": "108168", "process_out_blocks": "714", "command_success": false, "process_in_blocks": "0"}
[0m00:50:41.471625 [debug] [MainThread]: Command `dbt debug` failed at 00:50:41.471552 after 0.17 seconds
[0m00:50:41.471937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d68c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d83f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca36180>]}
[0m00:50:41.472253 [debug] [MainThread]: Flushing usage events
[0m00:52:52.446061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb40c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f476420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f476270>]}


============================== 00:52:52.465719 | 73192f05-613f-4643-a8b9-1bc71d941686 ==============================
[0m00:52:52.465719 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:52:52.466377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:52:52.495673 [info ] [MainThread]: dbt version: 1.8.2
[0m00:52:52.496116 [info ] [MainThread]: python version: 3.12.7
[0m00:52:52.496515 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m00:52:52.496898 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m00:52:54.194976 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m00:52:54.195547 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m00:52:54.196070 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m00:52:54.196795 [info ] [MainThread]: adapter type: snowflake
[0m00:52:54.197126 [info ] [MainThread]: adapter version: 1.8.2
[0m00:52:54.267361 [info ] [MainThread]: Configuration:
[0m00:52:54.267877 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:52:54.268292 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:52:54.268639 [info ] [MainThread]: Required dependencies:
[0m00:52:54.269085 [debug] [MainThread]: Executing "git --help"
[0m00:52:54.271316 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:52:54.271742 [debug] [MainThread]: STDERR: "b''"
[0m00:52:54.272036 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:52:54.272339 [info ] [MainThread]: Connection:
[0m00:52:54.272719 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m00:52:54.273079 [info ] [MainThread]:   user: lamirtha
[0m00:52:54.273432 [info ] [MainThread]:   database: RETAIL_DW
[0m00:52:54.273744 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m00:52:54.274090 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:52:54.274418 [info ] [MainThread]:   schema: STAGING
[0m00:52:54.274834 [info ] [MainThread]:   authenticator: None
[0m00:52:54.275170 [info ] [MainThread]:   oauth_client_id: None
[0m00:52:54.275529 [info ] [MainThread]:   query_tag: None
[0m00:52:54.275861 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:52:54.276144 [info ] [MainThread]:   host: None
[0m00:52:54.276590 [info ] [MainThread]:   port: None
[0m00:52:54.276898 [info ] [MainThread]:   proxy_host: None
[0m00:52:54.277286 [info ] [MainThread]:   proxy_port: None
[0m00:52:54.277600 [info ] [MainThread]:   protocol: None
[0m00:52:54.277921 [info ] [MainThread]:   connect_retries: 1
[0m00:52:54.278242 [info ] [MainThread]:   connect_timeout: None
[0m00:52:54.278628 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:52:54.278962 [info ] [MainThread]:   retry_all: False
[0m00:52:54.279262 [info ] [MainThread]:   insecure_mode: False
[0m00:52:54.279595 [info ] [MainThread]:   reuse_connections: None
[0m00:52:54.280053 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:52:54.344409 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:52:54.345169 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:52:54.345565 [debug] [MainThread]: On debug: select 1 as id
[0m00:52:54.345888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:56.477494 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.132 seconds
[0m00:52:56.478501 [debug] [MainThread]: On debug: Close
[0m00:52:56.681218 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:52:56.681662 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:52:56.682520 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.2741966, "process_user_time": 4.246037, "process_kernel_time": 0.246757, "process_mem_max_rss": "205628", "process_in_blocks": "3264", "process_out_blocks": "28125"}
[0m00:52:56.682938 [debug] [MainThread]: Command `dbt debug` succeeded at 00:52:56.682865 after 4.27 seconds
[0m00:52:56.683216 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:52:56.683595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f56be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f918d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5de900>]}
[0m00:52:56.684009 [debug] [MainThread]: Flushing usage events
[0m00:53:32.374061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6b2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6e26c0>]}


============================== 00:53:32.380398 | ffb86800-4720-4340-a475-f4e993f53be8 ==============================
[0m00:53:32.380398 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:53:32.381020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m00:53:32.470705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffb86800-4720-4340-a475-f4e993f53be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae91f4a0>]}
[0m00:53:32.533403 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m00:53:32.534551 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.20053442, "process_user_time": 1.643226, "process_kernel_time": 0.105821, "process_mem_max_rss": "100876", "process_in_blocks": "72", "process_out_blocks": "4", "command_success": false}
[0m00:53:32.535173 [debug] [MainThread]: Command `dbt deps` failed at 00:53:32.535093 after 0.20 seconds
[0m00:53:32.535522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0070e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8350a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae834da0>]}
[0m00:53:32.535968 [debug] [MainThread]: Flushing usage events
[0m00:53:34.664611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce1ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71e960>]}


============================== 00:53:34.670281 | 88dbc306-1611-43fc-8274-1f6c67605e65 ==============================
[0m00:53:34.670281 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:53:34.670862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:35.315060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88dbc306-1611-43fc-8274-1f6c67605e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdc4a40>]}
[0m00:53:35.354432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88dbc306-1611-43fc-8274-1f6c67605e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab32de0>]}
[0m00:53:35.355068 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:53:35.421840 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:53:35.422779 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.795761, "process_user_time": 2.834284, "process_kernel_time": 0.132888, "process_mem_max_rss": "195152", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:53:35.423276 [debug] [MainThread]: Command `dbt compile` failed at 00:53:35.423186 after 0.80 seconds
[0m00:53:35.423673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae64830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff2a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab0fda0>]}
[0m00:53:35.424122 [debug] [MainThread]: Flushing usage events
[0m00:53:47.550872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a95d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae7eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d994740>]}


============================== 00:53:47.556781 | 0fe10856-84ca-467a-b523-88e7cc739949 ==============================
[0m00:53:47.556781 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:53:47.557407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select 1+', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:48.203600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fe10856-84ca-467a-b523-88e7cc739949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a40f200>]}
[0m00:53:48.243328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fe10856-84ca-467a-b523-88e7cc739949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4f4d10>]}
[0m00:53:48.243963 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:53:48.308769 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:53:48.309712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7936005, "process_user_time": 2.824285, "process_kernel_time": 0.176455, "process_mem_max_rss": "195208", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:53:48.310251 [debug] [MainThread]: Command `dbt run` failed at 00:53:48.310139 after 0.79 seconds
[0m00:53:48.310634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab09880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d19fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f22d3a0>]}
[0m00:53:48.311047 [debug] [MainThread]: Flushing usage events
[0m00:53:59.787765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e498d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4305c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28c1040>]}


============================== 00:53:59.793387 | 9e3d8d76-9fb7-412f-baf6-8a1eb1ee37c7 ==============================
[0m00:53:59.793387 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:53:59.793973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:00.400201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e3d8d76-9fb7-412f-baf6-8a1eb1ee37c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d3aff0>]}
[0m00:54:00.439685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e3d8d76-9fb7-412f-baf6-8a1eb1ee37c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea03fb0>]}
[0m00:54:00.440294 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:54:00.504519 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:54:00.505327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.75204885, "process_user_time": 2.773767, "process_kernel_time": 0.137037, "process_mem_max_rss": "195204", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:54:00.505833 [debug] [MainThread]: Command `dbt run` failed at 00:54:00.505752 after 0.75 seconds
[0m00:54:00.506198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e455580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98331a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838fe510>]}
[0m00:54:00.506595 [debug] [MainThread]: Flushing usage events
[0m00:54:07.966876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9844b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9844bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9844be90>]}


============================== 00:54:07.972416 | e35bf1dd-ca33-4e81-9990-f6a6a842bc0f ==============================
[0m00:54:07.972416 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:54:07.972964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:54:08.584371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35bf1dd-ca33-4e81-9990-f6a6a842bc0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2717c0>]}
[0m00:54:08.623567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35bf1dd-ca33-4e81-9990-f6a6a842bc0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7382f0>]}
[0m00:54:08.624184 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:54:08.688611 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:54:08.689606 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.7573001, "process_user_time": 2.764047, "process_kernel_time": 0.132529, "process_mem_max_rss": "195212", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:54:08.690111 [debug] [MainThread]: Command `dbt test` failed at 00:54:08.690018 after 0.76 seconds
[0m00:54:08.690545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aad4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c20bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5c0890>]}
[0m00:54:08.690980 [debug] [MainThread]: Flushing usage events
[0m00:54:43.314420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab27a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c37f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab266f0>]}


============================== 00:54:43.320094 | a4c3fa95-4483-4caa-a224-b2aa46f122aa ==============================
[0m00:54:43.320094 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:54:43.320664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:54:43.401328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4c3fa95-4483-4caa-a224-b2aa46f122aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8750f410>]}
[0m00:54:43.412777 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m00:54:43.413585 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.13379158, "process_user_time": 1.620378, "process_kernel_time": 0.079969, "process_mem_max_rss": "100840", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:54:43.414067 [debug] [MainThread]: Command `dbt deps` failed at 00:54:43.413970 after 0.13 seconds
[0m00:54:43.414410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8750fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87461430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87461400>]}
[0m00:54:43.414751 [debug] [MainThread]: Flushing usage events
[0m00:55:02.574215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8340e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832301a0>]}


============================== 00:55:02.583841 | cc528e5e-1d58-4846-9d66-1706188ecf81 ==============================
[0m00:55:02.583841 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:55:02.584779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:02.700097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc528e5e-1d58-4846-9d66-1706188ecf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8203bd10>]}
[0m00:55:02.716332 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m00:55:02.717578 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.20258462, "process_user_time": 2.278404, "process_kernel_time": 0.116275, "process_mem_max_rss": "100892", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:55:02.718246 [debug] [MainThread]: Command `dbt deps` failed at 00:55:02.718146 after 0.20 seconds
[0m00:55:02.718711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f8f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8203b140>]}
[0m00:55:02.719147 [debug] [MainThread]: Flushing usage events
[0m00:56:24.254436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ee00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93739b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8698bf0>]}


============================== 00:56:24.260395 | 96b7db9f-2896-4b2b-a352-da9610d29249 ==============================
[0m00:56:24.260395 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:56:24.260932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:24.345938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96b7db9f-2896-4b2b-a352-da9610d29249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9dbb140>]}
[0m00:56:24.357957 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m00:56:24.358972 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.1390688, "process_user_time": 1.614371, "process_kernel_time": 0.114096, "process_mem_max_rss": "100852", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:56:24.359476 [debug] [MainThread]: Command `dbt deps` failed at 00:56:24.359382 after 0.14 seconds
[0m00:56:24.359807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8657b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb836dac0>]}
[0m00:56:24.360132 [debug] [MainThread]: Flushing usage events
[0m00:59:06.297595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e741880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee6bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f444740>]}


============================== 00:59:06.304212 | df90175c-1b86-435a-89d8-a3bd707845d9 ==============================
[0m00:59:06.304212 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:06.304804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:06.390144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df90175c-1b86-435a-89d8-a3bd707845d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fef6630>]}
[0m00:59:06.398886 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ezbt3ggk'
[0m00:59:06.399402 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:59:06.702061 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:59:06.703938 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:59:06.745912 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:59:06.761559 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail_dbt/package-lock.yml
[0m00:59:06.764371 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6yv1g3th'
[0m00:59:06.767523 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:59:07.397105 [info ] [MainThread]: Installed from version 1.1.1
[0m00:59:07.397552 [info ] [MainThread]: Updated version available: 1.3.3
[0m00:59:07.398024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'df90175c-1b86-435a-89d8-a3bd707845d9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e379160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e378290>]}
[0m00:59:07.398422 [info ] [MainThread]: 
[0m00:59:07.398786 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:59:07.400264 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.14308, "process_user_time": 1.859402, "process_kernel_time": 0.122665, "process_mem_max_rss": "101428", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m00:59:07.400827 [debug] [MainThread]: Command `dbt deps` succeeded at 00:59:07.400721 after 1.14 seconds
[0m00:59:07.401234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7675c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e47fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e47d1c0>]}
[0m00:59:07.401711 [debug] [MainThread]: Flushing usage events
[0m00:59:42.435133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4de5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb520cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78281d0>]}


============================== 00:59:42.440999 | 0df52137-becb-4eaa-b4d6-0fb9c0a5b3f0 ==============================
[0m00:59:42.440999 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:42.441585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:43.168358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0df52137-becb-4eaa-b4d6-0fb9c0a5b3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b7e00>]}
[0m00:59:43.213566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0df52137-becb-4eaa-b4d6-0fb9c0a5b3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45cc3e0>]}
[0m00:59:43.214391 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:59:43.299393 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:43.398305 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:59:43.398885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0df52137-becb-4eaa-b4d6-0fb9c0a5b3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b5c3b0>]}
[0m00:59:44.677102 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:59:44.677693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0df52137-becb-4eaa-b4d6-0fb9c0a5b3f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bdee40>]}
[0m00:59:44.775843 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_fact_sales_ref_dim_date___date_key__date_key (models/marts/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m00:59:44.776807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3768992, "process_user_time": 4.237918, "process_kernel_time": 0.217071, "process_mem_max_rss": "203600", "process_in_blocks": "16", "process_out_blocks": "22", "command_success": false}
[0m00:59:44.777320 [debug] [MainThread]: Command `dbt run` failed at 00:59:44.777229 after 2.38 seconds
[0m00:59:44.777653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d87d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b7ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bf49e0>]}
[0m00:59:44.777965 [debug] [MainThread]: Flushing usage events
[0m00:59:53.466746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94cd160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9152ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8866f00>]}


============================== 00:59:53.472415 | 44187a0f-e82c-4149-92d7-07a95725ae70 ==============================
[0m00:59:53.472415 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:53.473001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:59:54.091081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44187a0f-e82c-4149-92d7-07a95725ae70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2b83e0>]}
[0m00:59:54.130593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44187a0f-e82c-4149-92d7-07a95725ae70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90d6c60>]}
[0m00:59:54.131229 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:59:54.204741 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:54.297183 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:59:54.297645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44187a0f-e82c-4149-92d7-07a95725ae70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca5bcb0>]}
[0m00:59:55.335076 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:59:55.335710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44187a0f-e82c-4149-92d7-07a95725ae70', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca0d160>]}
[0m00:59:55.432682 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_fact_sales_ref_dim_date___date_key__date_key (models/marts/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m00:59:55.433567 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.0016217, "process_user_time": 3.9452, "process_kernel_time": 0.154381, "process_mem_max_rss": "203576", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m00:59:55.434072 [debug] [MainThread]: Command `dbt test` failed at 00:59:55.433988 after 2.00 seconds
[0m00:59:55.434426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97876e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae8710>]}
[0m00:59:55.434773 [debug] [MainThread]: Flushing usage events
[0m01:01:17.280401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0639880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0085a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ae82f0>]}


============================== 01:01:17.286386 | b8c9f87c-b112-46f2-81ba-420d52123656 ==============================
[0m01:01:17.286386 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:01:17.286936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:17.371424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8c9f87c-b112-46f2-81ba-420d52123656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a53c20>]}
[0m01:01:17.380203 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4iowrnes'
[0m01:01:17.380660 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:01:17.488915 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:01:17.489541 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:01:17.518685 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:01:17.528123 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail_dbt/package-lock.yml
[0m01:01:17.530139 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w2pttifl'
[0m01:01:17.532750 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:01:18.096921 [info ] [MainThread]: Installed from version 1.3.0
[0m01:01:18.097409 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:01:18.098124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8c9f87c-b112-46f2-81ba-420d52123656', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf84cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf84d0d0>]}
[0m01:01:18.098631 [info ] [MainThread]: 
[0m01:01:18.099113 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:01:18.100198 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8545881, "process_user_time": 1.685432, "process_kernel_time": 0.098966, "process_mem_max_rss": "101456", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:01:18.100699 [debug] [MainThread]: Command `dbt deps` succeeded at 01:01:18.100621 after 0.86 seconds
[0m01:01:18.100988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0639880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafbba3f0>]}
[0m01:01:18.101264 [debug] [MainThread]: Flushing usage events
[0m01:01:29.970147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3a4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92dc050>]}


============================== 01:01:29.975721 | a0a25313-9c77-4f3c-9625-45693e6d5d8e ==============================
[0m01:01:29.975721 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:01:29.976339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:30.594690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a25313-9c77-4f3c-9625-45693e6d5d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9c3ef0>]}
[0m01:01:30.635922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a25313-9c77-4f3c-9625-45693e6d5d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d370530>]}
[0m01:01:30.636640 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:01:30.711931 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:01:30.803038 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:01:30.803512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0a25313-9c77-4f3c-9625-45693e6d5d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9beeb440>]}
[0m01:01:31.859556 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:01:31.860208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0a25313-9c77-4f3c-9625-45693e6d5d8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b73d550>]}
[0m01:01:31.957348 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_fact_sales_ref_dim_date___date_key__date_key (models/marts/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m01:01:31.958203 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.0227687, "process_user_time": 3.970319, "process_kernel_time": 0.146863, "process_mem_max_rss": "203436", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m01:01:31.958722 [debug] [MainThread]: Command `dbt test` failed at 01:01:31.958636 after 2.02 seconds
[0m01:01:31.959075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ea5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6626f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5b2810>]}
[0m01:01:31.959427 [debug] [MainThread]: Flushing usage events
[0m01:02:43.354682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9235dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dc74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94794230>]}


============================== 01:02:43.360350 | d15b9a57-f1ea-4230-974f-c78c375282bb ==============================
[0m01:02:43.360350 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:02:43.360857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:02:43.445884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd15b9a57-f1ea-4230-974f-c78c375282bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915d73e0>]}
[0m01:02:43.455244 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wju9c80q'
[0m01:02:43.455743 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:02:43.621715 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:02:43.623386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:02:43.690882 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:02:43.702572 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/retail_dbt/package-lock.yml
[0m01:02:43.705087 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-glyy5ig0'
[0m01:02:43.707810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:02:44.297484 [info ] [MainThread]: Installed from version 1.3.0
[0m01:02:44.298044 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:02:44.298794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd15b9a57-f1ea-4230-974f-c78c375282bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91508920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91508c50>]}
[0m01:02:44.299351 [info ] [MainThread]: 
[0m01:02:44.300170 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:02:44.301561 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9855213, "process_user_time": 1.734665, "process_kernel_time": 0.121466, "process_mem_max_rss": "101552", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:02:44.302167 [debug] [MainThread]: Command `dbt deps` succeeded at 01:02:44.301979 after 0.99 seconds
[0m01:02:44.302582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d47d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91759880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91561d90>]}
[0m01:02:44.302992 [debug] [MainThread]: Flushing usage events
[0m01:07:49.187398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed38770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e512b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0e8950>]}


============================== 01:07:49.193223 | 8a181a0e-55ba-4850-a208-b1fe0e0bba8a ==============================
[0m01:07:49.193223 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:07:49.193784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:07:49.879522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72732930>]}
[0m01:07:49.919564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727312e0>]}
[0m01:07:49.920243 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:07:49.994807 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:07:50.087303 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:07:50.087776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff722d0c20>]}
[0m01:07:51.141990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:07:51.142509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7255e690>]}
[0m01:07:51.331713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff721d51c0>]}
[0m01:07:51.440278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7276d580>]}
[0m01:07:51.440704 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:07:51.441000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72731fa0>]}
[0m01:07:51.443155 [info ] [MainThread]: 
[0m01:07:51.443796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:07:51.447955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:07:51.454037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:07:51.465374 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:07:51.465857 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:07:51.466283 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:07:51.466690 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m01:07:51.467064 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:07:51.467435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:51.470210 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:07:51.470554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:51.472989 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:07:51.474849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:52.562689 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.088 seconds
[0m01:07:52.563767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.093 seconds
[0m01:07:52.564475 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.097 seconds
[0m01:07:52.566838 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:07:52.568586 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:07:52.570392 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:07:52.777324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a181a0e-55ba-4850-a208-b1fe0e0bba8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71575bb0>]}
[0m01:07:52.777902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:07:52.778295 [info ] [MainThread]: 
[0m01:07:52.787024 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:07:52.787392 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:07:52.787747 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:07:52.788069 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m01:07:52.788453 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:07:52.788760 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m01:07:52.789293 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m01:07:52.789809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m01:07:52.790194 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m01:07:52.790646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m01:07:52.790997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m01:07:52.791326 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:07:52.791731 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m01:07:52.792050 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:07:52.792389 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:07:52.802760 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:07:52.803046 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:07:52.806067 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:07:52.809013 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:07:52.812217 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:07:52.814364 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:07:52.814697 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:07:52.838503 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:07:52.839073 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:07:52.839389 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:07:52.839813 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:07:52.842123 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:07:52.845165 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:07:52.845889 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:07:52.846797 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:07:52.847412 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m01:07:52.848064 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:07:52.848363 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m01:07:52.848929 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:07:52.849219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:52.849543 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m01:07:52.849884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:52.850203 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m01:07:52.851984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:07:52.853615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:07:54.353369 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.501 seconds
[0m01:07:54.355038 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.506 seconds
[0m01:07:54.356186 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m01:07:54.369563 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m01:07:54.370614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.521 seconds
[0m01:07:54.372764 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m01:07:54.374488 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m01:07:54.378332 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m01:07:54.589883 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.80s]
[0m01:07:54.591370 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:07:54.592276 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:07:54.593122 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m01:07:54.594008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m01:07:54.594740 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:07:54.602762 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:07:54.605789 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.82s]
[0m01:07:54.606317 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:07:54.606989 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:07:54.610427 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:07:54.611683 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:07:54.612356 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m01:07:54.613269 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.82s]
[0m01:07:54.613864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m01:07:54.614448 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:07:54.615417 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:07:54.616156 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:07:54.616572 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:07:54.617360 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.83s]
[0m01:07:54.621363 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:07:54.621764 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m01:07:54.622120 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m01:07:54.622726 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:07:54.623273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:54.623648 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m01:07:54.624071 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:07:54.624331 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:07:54.625913 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:07:54.626355 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m01:07:54.628587 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:07:54.631798 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:07:54.632220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m01:07:54.633311 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:07:54.636582 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:07:54.637159 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:07:54.637553 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:07:54.637908 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m01:07:54.639944 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:07:54.640343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:54.640611 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:07:54.645583 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:07:54.646643 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:07:54.647022 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m01:07:54.647402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:07:54.647918 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:07:54.649336 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m01:07:54.649706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:07:55.305130 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m01:07:55.307480 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m01:07:55.341972 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m01:07:55.343954 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m01:07:55.345776 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m01:07:55.347534 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m01:07:55.349317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m01:07:55.351556 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m01:07:55.519362 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.89s]
[0m01:07:55.520801 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:07:55.521556 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:07:55.522199 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m01:07:55.523429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m01:07:55.524366 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:07:55.532137 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:07:55.533664 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:07:55.536496 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:07:55.538149 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:07:55.538570 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:55.539001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:07:55.580182 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.99s]
[0m01:07:55.581974 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.95s]
[0m01:07:55.582804 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:07:55.583572 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:07:55.584555 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.97s]
[0m01:07:55.585207 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:07:55.585817 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:07:55.586352 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:07:55.586786 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m01:07:55.587283 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m01:07:55.587850 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:07:55.588296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m01:07:55.588778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m01:07:55.589199 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m01:07:55.589688 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:07:55.590072 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:07:55.590485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m01:07:55.595309 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:07:55.599333 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:07:55.599724 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:07:55.604489 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:07:55.605294 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:07:55.605594 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:07:55.607553 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:07:55.607939 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:07:55.609800 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:07:55.611940 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:07:55.613465 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:07:55.613934 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:55.614754 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:07:55.615024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:07:55.615423 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:55.617033 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:07:55.618115 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:55.618573 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:55.620187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:56.793847 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.254 seconds
[0m01:07:56.798085 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m01:07:56.883982 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.266 seconds
[0m01:07:56.887682 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m01:07:56.922596 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.307 seconds
[0m01:07:56.926481 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m01:07:57.031236 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.51s]
[0m01:07:57.033335 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:07:57.034446 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:07:57.035189 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m01:07:57.036214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m01:07:57.036896 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:07:57.044988 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:07:57.046579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m01:07:57.048737 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m01:07:57.051687 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:07:57.054254 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:07:57.055747 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:07:57.056139 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:57.056492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:07:57.103607 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.51s]
[0m01:07:57.104540 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:07:57.105133 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:07:57.105657 [info ] [Thread-2 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m01:07:57.106191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m01:07:57.106649 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:07:57.111842 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:07:57.112872 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:07:57.115067 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:07:57.116305 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:07:57.116676 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:57.117055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:57.148203 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.56s]
[0m01:07:57.150943 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:07:57.151610 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:07:57.152007 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m01:07:57.152444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m01:07:57.152806 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:07:57.156816 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:07:57.157614 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:07:57.159583 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:07:57.160666 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:07:57.160980 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:07:57.161256 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:07:57.252877 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.66s]
[0m01:07:57.256022 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:07:57.256420 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:07:57.256769 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m01:07:57.257212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m01:07:57.257640 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:07:57.262752 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:07:57.263645 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:07:57.265665 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:07:57.266692 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:07:57.266995 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:07:57.267270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:57.728267 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m01:07:57.732907 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m01:07:57.835961 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m01:07:57.838827 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m01:07:57.870251 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m01:07:57.873099 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m01:07:57.919603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m01:07:57.922691 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m01:07:57.938962 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.90s]
[0m01:07:57.940070 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:07:58.058977 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.91s]
[0m01:07:58.059983 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:07:58.084164 [info ] [Thread-2 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.98s]
[0m01:07:58.085385 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:07:58.129862 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.87s]
[0m01:07:58.131326 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:07:58.134460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:58.135072 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m01:07:58.135495 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m01:07:58.135912 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m01:07:58.136311 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m01:07:58.137025 [info ] [MainThread]: 
[0m01:07:58.137539 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m01:07:58.140854 [debug] [MainThread]: Command end result
[0m01:07:58.184210 [info ] [MainThread]: 
[0m01:07:58.184641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:07:58.185018 [info ] [MainThread]: 
[0m01:07:58.185390 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m01:07:58.186202 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.033291, "process_user_time": 5.165783, "process_kernel_time": 0.306571, "process_mem_max_rss": "222112", "process_in_blocks": "40", "process_out_blocks": "4050"}
[0m01:07:58.186649 [debug] [MainThread]: Command `dbt test` succeeded at 01:07:58.186545 after 9.03 seconds
[0m01:07:58.186954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df2af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7263e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7116b980>]}
[0m01:07:58.187236 [debug] [MainThread]: Flushing usage events
[0m01:13:46.059443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8972e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89778ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898a79b0>]}


============================== 01:13:46.065912 | 8e25f564-ba80-403f-8618-c75a6aacaf60 ==============================
[0m01:13:46.065912 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:13:46.066677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:13:46.152547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e25f564-ba80-403f-8618-c75a6aacaf60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89098920>]}
[0m01:13:46.223412 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iwciqiwz'
[0m01:13:46.223862 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:13:46.380183 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:13:46.381093 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:13:46.485251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:13:46.492667 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:13:47.177663 [info ] [MainThread]: Installed from version 1.3.0
[0m01:13:47.178374 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:13:47.178816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8e25f564-ba80-403f-8618-c75a6aacaf60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b80230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b83770>]}
[0m01:13:47.179308 [info ] [MainThread]: 
[0m01:13:47.179700 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:13:47.180686 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1576612, "process_user_time": 1.758322, "process_kernel_time": 0.18886, "process_mem_max_rss": "164644", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:13:47.181172 [debug] [MainThread]: Command `dbt deps` succeeded at 01:13:47.181081 after 1.16 seconds
[0m01:13:47.181532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89216240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d05940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d56cc0>]}
[0m01:13:47.181877 [debug] [MainThread]: Flushing usage events
[0m01:13:49.792339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874d87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8785aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874d8ef0>]}


============================== 01:13:49.798070 | e1aca0ac-eede-4098-9f68-82f0d5f8e0a6 ==============================
[0m01:13:49.798070 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:13:49.798819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m01:13:50.511949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8862eae0>]}
[0m01:13:50.553335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b746660>]}
[0m01:13:50.554132 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:13:50.634804 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:13:50.782805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:13:50.783257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:13:50.823262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b53e1e0>]}
[0m01:13:50.944940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b53d0a0>]}
[0m01:13:50.945750 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:13:50.946710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b16e6c0>]}
[0m01:13:50.949777 [info ] [MainThread]: 
[0m01:13:50.951039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:13:50.952822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:13:50.972014 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:13:50.972663 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:13:50.973182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:51.892966 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.919 seconds
[0m01:13:51.897490 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:13:52.110638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m01:13:52.117610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:13:52.123190 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:13:52.126645 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:13:52.127168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m01:13:52.127602 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:13:52.128035 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:13:52.130083 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:13:52.130526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:52.130915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:52.131307 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:13:52.134562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:52.710294 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.579 seconds
[0m01:13:52.715246 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:13:52.718456 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.584 seconds
[0m01:13:52.721375 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:13:52.732920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.602 seconds
[0m01:13:52.734973 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:13:52.928737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5eaed0>]}
[0m01:13:52.929490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:13:52.930431 [info ] [MainThread]: 
[0m01:13:52.939169 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m01:13:52.939732 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m01:13:52.940346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m01:13:52.940740 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m01:13:52.947877 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m01:13:52.989287 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:52.989696 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:13:52.990037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:53.546410 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.556 seconds
[0m01:13:53.593863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:53.594485 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:13:57.885644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.290 seconds
[0m01:13:57.890783 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:57.891376 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:13:58.036977 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.145 seconds
[0m01:13:58.045335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:58.046217 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:13:58.173464 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m01:13:58.177667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:58.178169 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:13:58.305232 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.126 seconds
[0m01:13:58.313332 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:58.314111 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:13:58.449543 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.135 seconds
[0m01:13:58.463078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:58.463792 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:13:58.588740 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.124 seconds
[0m01:13:58.619456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:58.620116 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:13:59.008571 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.388 seconds
[0m01:13:59.018223 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:59.018992 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:13:59.195778 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.176 seconds
[0m01:13:59.196932 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m01:13:59.200854 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:59.201420 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m01:13:59.378648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m01:13:59.379669 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:13:59.380372 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:14:00.027532 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.646 seconds
[0m01:14:00.028309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:00.028788 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m01:14:00.445810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m01:14:00.474998 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m01:14:00.699973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1aca0ac-eede-4098-9f68-82f0d5f8e0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b6e2ab0>]}
[0m01:14:00.702316 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 7.76s]
[0m01:14:00.704478 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m01:14:00.707322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:00.707968 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m01:14:00.708649 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m01:14:00.709174 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m01:14:00.709846 [info ] [MainThread]: 
[0m01:14:00.710764 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m01:14:00.711676 [debug] [MainThread]: Command end result
[0m01:14:00.755894 [info ] [MainThread]: 
[0m01:14:00.756490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:00.756878 [info ] [MainThread]: 
[0m01:14:00.757264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:14:00.758268 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.001256, "process_user_time": 3.708975, "process_kernel_time": 0.262555, "process_mem_max_rss": "211572", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m01:14:00.758810 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:14:00.758703 after 11.00 seconds
[0m01:14:00.759211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cbb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ac5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d2e1b0>]}
[0m01:14:00.759561 [debug] [MainThread]: Flushing usage events
[0m01:14:04.569330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43d18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60c81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa386db20>]}


============================== 01:14:04.575219 | 1dc07879-26ff-4108-8a8f-8e450d1dcd65 ==============================
[0m01:14:04.575219 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:14:04.576087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:05.455959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e5baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f24770>]}


============================== 01:14:05.463779 | 45545214-5095-492d-98b2-a2e5c1d76a17 ==============================
[0m01:14:05.463779 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:14:05.464516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:05.485651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc07879-26ff-4108-8a8f-8e450d1dcd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b50c50>]}
[0m01:14:05.537497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc07879-26ff-4108-8a8f-8e450d1dcd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d129a00>]}
[0m01:14:05.538417 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:14:05.569167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45545214-5095-492d-98b2-a2e5c1d76a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e7bfe0>]}
[0m01:14:05.633105 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /opt/airflow/dbt/retail_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /opt/airflow/dbt/retail_dbt/dbt_packages/dbt_utils
[0m01:14:05.635139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1018718, "process_user_time": 3.477872, "process_kernel_time": 0.2654, "process_mem_max_rss": "195304", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m01:14:05.635911 [debug] [MainThread]: Command `dbt run` failed at 01:14:05.635796 after 1.10 seconds
[0m01:14:05.636564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38da3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8792e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8792d250>]}
[0m01:14:05.637264 [debug] [MainThread]: Flushing usage events
[0m01:14:05.705502 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nrxoq7a_'
[0m01:14:05.706717 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:14:05.819198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:14:05.819980 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:14:05.899665 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:14:05.903356 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:14:06.486424 [info ] [MainThread]: Installed from version 1.3.0
[0m01:14:06.486944 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:14:06.488084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45545214-5095-492d-98b2-a2e5c1d76a17', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d7b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d7b320>]}
[0m01:14:06.488508 [info ] [MainThread]: 
[0m01:14:06.488998 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:14:06.490202 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0784231, "process_user_time": 2.015078, "process_kernel_time": 0.170434, "process_mem_max_rss": "164072", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:14:06.490616 [debug] [MainThread]: Command `dbt deps` succeeded at 01:14:06.490547 after 1.08 seconds
[0m01:14:06.490914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a220c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9661aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f24770>]}
[0m01:14:06.491242 [debug] [MainThread]: Flushing usage events
[0m01:14:09.032638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb411d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f22fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4764470>]}


============================== 01:14:09.038382 | 53b01d66-ac73-471a-b33e-d631eeff4f82 ==============================
[0m01:14:09.038382 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:14:09.039133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:14:09.654886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b7f9e0>]}
[0m01:14:09.694556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4117d10>]}
[0m01:14:09.695263 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:14:09.768619 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:14:09.908769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:09.909180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:09.949802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37d9ca0>]}
[0m01:14:10.051710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983d2cc0>]}
[0m01:14:10.052205 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:14:10.052818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b0f020>]}
[0m01:14:10.054662 [info ] [MainThread]: 
[0m01:14:10.055276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:10.056044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:14:10.067471 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:14:10.067829 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:14:10.068124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:11.139580 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.071 seconds
[0m01:14:11.143944 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:14:11.393357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m01:14:11.400592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:14:11.404330 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:14:11.407769 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:14:11.408200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:14:11.408623 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:14:11.409002 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:14:11.410791 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:14:11.411149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:11.411492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:11.411815 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:14:11.414939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:12.050685 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.639 seconds
[0m01:14:12.054445 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:14:12.079196 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.668 seconds
[0m01:14:12.080288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.665 seconds
[0m01:14:12.082636 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:14:12.084349 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:14:12.328852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979627e0>]}
[0m01:14:12.329520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:12.330100 [info ] [MainThread]: 
[0m01:14:12.338152 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m01:14:12.338672 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m01:14:12.339225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m01:14:12.339633 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m01:14:12.346394 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m01:14:12.387455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:12.387854 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:14:12.388199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:12.982391 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.594 seconds
[0m01:14:13.016361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:13.016974 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:14:13.880830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m01:14:13.885750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:13.886459 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:14:14.086532 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.199 seconds
[0m01:14:14.095919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:14.096742 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:14:14.257723 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.160 seconds
[0m01:14:14.265975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:14.266854 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:14:14.407294 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.140 seconds
[0m01:14:14.413542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:14.414325 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:14:14.568215 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.153 seconds
[0m01:14:14.580548 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:14.581309 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:14:14.741857 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.160 seconds
[0m01:14:14.765569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:14.766112 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:14:15.032568 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.266 seconds
[0m01:14:15.042036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:15.042755 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:14:15.173320 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.130 seconds
[0m01:14:15.175361 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m01:14:15.180483 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:15.181330 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m01:14:15.406461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m01:14:15.407733 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:15.408601 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:14:16.111928 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.702 seconds
[0m01:14:16.113056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:14:16.113626 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m01:14:16.520956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m01:14:16.549824 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m01:14:16.751312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b01d66-ac73-471a-b33e-d631eeff4f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9893ac30>]}
[0m01:14:16.753632 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 4.41s]
[0m01:14:16.754889 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m01:14:16.758056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:16.758795 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m01:14:16.759393 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m01:14:16.759876 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m01:14:16.760478 [info ] [MainThread]: 
[0m01:14:16.761621 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m01:14:16.762651 [debug] [MainThread]: Command end result
[0m01:14:16.806190 [info ] [MainThread]: 
[0m01:14:16.806841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:16.807188 [info ] [MainThread]: 
[0m01:14:16.807580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:14:16.808403 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.810922, "process_user_time": 3.607061, "process_kernel_time": 0.206806, "process_mem_max_rss": "211780", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m01:14:16.808913 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:14:16.808838 after 7.81 seconds
[0m01:14:16.809287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb411d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4784ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4785460>]}
[0m01:14:16.809650 [debug] [MainThread]: Flushing usage events
[0m01:14:20.172843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958ba9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9540f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958b8440>]}


============================== 01:14:20.178443 | 452f5200-ebd2-4f35-a65f-831ee6e76f3f ==============================
[0m01:14:20.178443 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:14:20.179152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:14:20.819529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb76630>]}
[0m01:14:20.858811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b75a90>]}
[0m01:14:20.859466 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:14:20.932454 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:14:21.065691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:21.066088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:21.105557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799449b0>]}
[0m01:14:21.205365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff794be090>]}
[0m01:14:21.205823 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:14:21.206412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957902c0>]}
[0m01:14:21.208434 [info ] [MainThread]: 
[0m01:14:21.209053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:21.212713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:14:21.220704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:14:21.224827 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:14:21.227093 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:14:21.227481 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:14:21.227856 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:14:21.228192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:21.228536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:21.938070 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.709 seconds
[0m01:14:21.943172 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:14:21.944830 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.717 seconds
[0m01:14:21.949328 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:14:22.151172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m01:14:22.152383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m01:14:22.167545 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:14:22.168207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m01:14:22.168589 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:14:22.169158 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:14:22.171504 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:14:22.171957 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:14:22.172392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:22.172828 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:14:22.173220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:22.175035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:22.745451 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:14:22.750024 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:14:22.751418 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.579 seconds
[0m01:14:22.754789 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.580 seconds
[0m01:14:22.757329 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:14:22.760741 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:14:22.959449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792a89e0>]}
[0m01:14:22.960087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:22.960735 [info ] [MainThread]: 
[0m01:14:22.968771 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m01:14:22.969147 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m01:14:22.969508 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m01:14:22.969921 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m01:14:22.970314 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m01:14:22.970697 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m01:14:22.971189 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m01:14:22.972060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m01:14:22.972431 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m01:14:22.972880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m01:14:22.973295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m01:14:22.973665 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m01:14:22.974094 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m01:14:22.974440 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m01:14:22.974786 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m01:14:22.979977 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m01:14:22.980369 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m01:14:22.982593 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m01:14:22.984794 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:14:22.987096 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m01:14:22.990173 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m01:14:23.014503 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m01:14:23.014879 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m01:14:23.015213 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m01:14:23.015560 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m01:14:23.038086 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m01:14:23.038549 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m01:14:23.040917 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:14:23.043333 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m01:14:23.043730 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m01:14:23.044164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:23.045418 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m01:14:23.046103 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m01:14:23.047186 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m01:14:23.047789 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m01:14:23.048182 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m01:14:23.048635 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:14:23.049002 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m01:14:23.049351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:23.050688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:23.775354 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m01:14:23.806954 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m01:14:23.809161 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m01:14:23.811394 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m01:14:23.855186 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m01:14:23.857565 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m01:14:24.019014 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e02360>]}
[0m01:14:24.021009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c6f470>]}
[0m01:14:24.022387 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.04s]
[0m01:14:24.024332 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.05s]
[0m01:14:24.025531 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m01:14:24.026568 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m01:14:24.027377 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_orders
[0m01:14:24.028206 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m01:14:24.029330 [info ] [Thread-3 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m01:14:24.030385 [info ] [Thread-2 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m01:14:24.031350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m01:14:24.032030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_products)
[0m01:14:24.032699 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_orders
[0m01:14:24.033318 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m01:14:24.037067 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m01:14:24.039934 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m01:14:24.041598 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_orders
[0m01:14:24.041959 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m01:14:24.044585 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m01:14:24.048621 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m01:14:24.050518 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m01:14:24.051187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79330c50>]}
[0m01:14:24.051519 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m01:14:24.052071 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m01:14:24.052620 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.08s]
[0m01:14:24.053153 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:24.053596 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m01:14:24.054094 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m01:14:24.055614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:24.056057 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m01:14:24.057609 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m01:14:24.058141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m01:14:24.058497 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m01:14:24.060741 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m01:14:24.061774 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m01:14:24.064130 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m01:14:24.065279 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m01:14:24.065633 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m01:14:24.065978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:14:24.434336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m01:14:24.439668 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m01:14:24.653332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b15d60>]}
[0m01:14:24.655079 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.68s]
[0m01:14:24.656512 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m01:14:24.657310 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m01:14:24.658120 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m01:14:24.659002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m01:14:24.659626 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m01:14:24.675894 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:14:24.678405 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m01:14:24.680718 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:14:24.682363 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m01:14:24.682736 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m01:14:24.683110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:24.915694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m01:14:24.919927 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: Close
[0m01:14:24.938362 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m01:14:24.941128 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m01:14:24.976743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m01:14:24.980572 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: Close
[0m01:14:25.126248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7977b290>]}
[0m01:14:25.127709 [info ] [Thread-2 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.09s]
[0m01:14:25.129703 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m01:14:25.130770 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_customer
[0m01:14:25.131970 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m01:14:25.132993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m01:14:25.134194 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_customer
[0m01:14:25.141292 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m01:14:25.142735 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789604d0>]}
[0m01:14:25.143620 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.08s]
[0m01:14:25.144434 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m01:14:25.145060 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m01:14:25.145434 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_customer
[0m01:14:25.145997 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m01:14:25.148684 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m01:14:25.149182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m01:14:25.149956 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m01:14:25.154603 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m01:14:25.156282 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m01:14:25.156778 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m01:14:25.157290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:25.157600 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m01:14:25.160768 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m01:14:25.161851 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m01:14:25.162203 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m01:14:25.162674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:14:25.177179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78929880>]}
[0m01:14:25.177735 [info ] [Thread-3 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.15s]
[0m01:14:25.178402 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_orders
[0m01:14:25.178796 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m01:14:25.179288 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m01:14:25.179736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_store)
[0m01:14:25.180067 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m01:14:25.183072 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m01:14:25.183983 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m01:14:25.186049 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m01:14:25.187087 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m01:14:25.187445 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m01:14:25.187779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:26.336050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.652 seconds
[0m01:14:26.342641 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m01:14:26.544392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789b3830>]}
[0m01:14:26.547707 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.89s]
[0m01:14:26.548337 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m01:14:26.564755 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m01:14:26.567075 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: Close
[0m01:14:26.740771 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.578 seconds
[0m01:14:26.742782 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m01:14:26.756434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789b1d30>]}
[0m01:14:26.757074 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.62s]
[0m01:14:26.757621 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_customer
[0m01:14:26.758217 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m01:14:26.758669 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m01:14:26.759076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.fact_sales)
[0m01:14:26.759450 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m01:14:26.765212 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m01:14:26.766307 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m01:14:26.768540 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m01:14:26.770996 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m01:14:26.771480 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m01:14:26.771920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:26.932259 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m01:14:26.935238 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m01:14:26.941732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789c67e0>]}
[0m01:14:26.942424 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.79s]
[0m01:14:26.943262 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m01:14:27.138448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7892e690>]}
[0m01:14:27.139415 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.96s]
[0m01:14:27.140753 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m01:14:29.525519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.753 seconds
[0m01:14:29.531226 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m01:14:29.753069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f5200-ebd2-4f35-a65f-831ee6e76f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789b5010>]}
[0m01:14:29.755053 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.99s]
[0m01:14:29.757536 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m01:14:29.760928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:29.761686 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m01:14:29.762205 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m01:14:29.762721 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m01:14:29.763207 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m01:14:29.763975 [info ] [MainThread]: 
[0m01:14:29.764907 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m01:14:29.767566 [debug] [MainThread]: Command end result
[0m01:14:29.882821 [info ] [MainThread]: 
[0m01:14:29.883483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:29.883852 [info ] [MainThread]: 
[0m01:14:29.884176 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:14:29.884975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.747346, "process_user_time": 4.008763, "process_kernel_time": 0.22744, "process_mem_max_rss": "212788", "process_out_blocks": "2767", "process_in_blocks": "0"}
[0m01:14:29.885460 [debug] [MainThread]: Command `dbt run` succeeded at 01:14:29.885364 after 9.75 seconds
[0m01:14:29.885820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8894fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9706bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7890df10>]}
[0m01:14:29.886157 [debug] [MainThread]: Flushing usage events
[0m01:14:33.239630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf95c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09f3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa54bf0>]}


============================== 01:14:33.245350 | 3f571ff5-b2ab-44c6-b15d-7d98a520e36f ==============================
[0m01:14:33.245350 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:14:33.246162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:14:33.868802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b92c30>]}
[0m01:14:33.908962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fc44a0>]}
[0m01:14:33.909676 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:14:33.981604 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:14:34.114943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:34.115350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:34.155228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a6b530>]}
[0m01:14:34.264411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93588410>]}
[0m01:14:34.264867 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:14:34.265455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a96570>]}
[0m01:14:34.267691 [info ] [MainThread]: 
[0m01:14:34.268338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:34.272183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:14:34.272677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m01:14:34.285323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:14:34.290900 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:14:34.291357 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:14:34.293110 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:14:34.293486 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:14:34.293839 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:14:34.294182 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:14:34.294528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:34.294870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:34.295179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:35.068488 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.773 seconds
[0m01:14:35.073705 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:14:35.077170 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.782 seconds
[0m01:14:35.081050 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:14:35.095798 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.801 seconds
[0m01:14:35.098179 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:14:35.293122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f571ff5-b2ab-44c6-b15d-7d98a520e36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a50350>]}
[0m01:14:35.294129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:35.295187 [info ] [MainThread]: 
[0m01:14:35.307170 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:14:35.307629 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:14:35.308044 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:14:35.308449 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m01:14:35.308884 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:14:35.309253 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m01:14:35.309861 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m01:14:35.310488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m01:14:35.310933 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m01:14:35.311511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m01:14:35.312027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m01:14:35.312469 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:14:35.312957 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m01:14:35.313333 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:14:35.313699 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:14:35.325593 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:14:35.328563 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:14:35.332037 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:14:35.336224 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:14:35.339373 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:14:35.342374 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:14:35.348767 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:14:35.349116 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:14:35.349431 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:14:35.361959 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:14:35.362813 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:14:35.364879 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:14:35.366963 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:14:35.370257 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:14:35.370938 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:14:35.371295 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m01:14:35.371850 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:14:35.372498 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:14:35.372819 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m01:14:35.373250 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:35.373634 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m01:14:35.373999 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m01:14:35.374339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:35.375878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:35.376253 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:14:36.198747 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m01:14:36.201171 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m01:14:36.201986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.826 seconds
[0m01:14:36.202575 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m01:14:36.210251 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m01:14:36.211784 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m01:14:36.213261 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m01:14:36.214646 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m01:14:36.424092 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.11s]
[0m01:14:36.426236 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.11s]
[0m01:14:36.428737 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:14:36.427970 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.11s]
[0m01:14:36.429935 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.12s]
[0m01:14:36.431365 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:14:36.432154 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:14:36.433058 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:14:36.434005 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:14:36.434607 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:14:36.435115 [info ] [Thread-3 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m01:14:36.435800 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:14:36.436377 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:14:36.436873 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m01:14:36.437544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m01:14:36.438091 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m01:14:36.438639 [info ] [Thread-2 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m01:14:36.439218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m01:14:36.439683 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:14:36.440114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m01:14:36.440563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m01:14:36.440980 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:14:36.445788 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:14:36.446153 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:14:36.446589 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:14:36.451497 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:14:36.454978 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:14:36.458169 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:14:36.459184 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:14:36.462143 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:14:36.462957 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:14:36.463312 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:14:36.465394 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:14:36.465808 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:14:36.467935 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:14:36.468881 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:14:36.471468 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:14:36.472793 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m01:14:36.473829 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:14:36.474964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:36.476075 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:14:36.476491 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m01:14:36.479147 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:14:36.481074 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m01:14:36.481821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:36.482338 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m01:14:36.482726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:14:36.484259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:37.067384 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m01:14:37.072224 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m01:14:37.079430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m01:14:37.082026 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m01:14:37.092523 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m01:14:37.095089 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m01:14:37.099385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m01:14:37.101380 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m01:14:37.268599 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.83s]
[0m01:14:37.270873 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:14:37.271673 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:14:37.272332 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m01:14:37.273428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m01:14:37.274842 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:14:37.277481 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.84s]
[0m01:14:37.284982 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:14:37.287801 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:14:37.288719 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:14:37.289578 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m01:14:37.290461 [info ] [Thread-3 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.85s]
[0m01:14:37.290890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m01:14:37.291614 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:14:37.292170 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:14:37.292566 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:14:37.292992 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:14:37.297960 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:14:37.302188 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:14:37.302935 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.86s]
[0m01:14:37.303300 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m01:14:37.304198 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:14:37.304639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m01:14:37.305173 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:14:37.305479 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:14:37.306326 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:14:37.306610 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:14:37.306955 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m01:14:37.309107 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:14:37.309507 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:37.313734 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:14:37.314135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m01:14:37.314653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:14:37.315295 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:14:37.317353 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:14:37.321846 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:14:37.322517 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:37.322889 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:14:37.323434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:37.325537 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:14:37.326877 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:14:37.329445 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:14:37.330579 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:14:37.330970 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:37.331859 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:14:37.332195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:37.332653 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:37.334097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:37.947214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m01:14:37.952806 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m01:14:38.072033 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m01:14:38.073913 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m01:14:38.078333 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m01:14:38.081246 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m01:14:38.138081 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m01:14:38.142472 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m01:14:38.153600 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.84s]
[0m01:14:38.155047 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:14:38.155863 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:14:38.156565 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m01:14:38.157482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m01:14:38.158153 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:14:38.164426 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:14:38.166088 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:14:38.168631 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:14:38.170249 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:14:38.170733 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:38.171155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:38.275336 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.97s]
[0m01:14:38.276517 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:14:38.277524 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.99s]
[0m01:14:38.278101 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:14:38.278847 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:14:38.279376 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m01:14:38.279932 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:14:38.280442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m01:14:38.280891 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m01:14:38.281377 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:14:38.281803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m01:14:38.288692 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:14:38.289013 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:14:38.363512 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:14:38.365960 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:14:38.366666 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:14:38.370686 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.10s]
[0m01:14:38.372782 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:14:38.376599 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:14:38.377197 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:14:38.378072 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:14:38.378528 [info ] [Thread-4 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m01:14:38.379177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m01:14:38.379935 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:14:38.380299 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:14:38.381022 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:14:38.381358 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:38.386446 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:14:38.386869 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:14:38.387251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:14:38.388222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:38.390885 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:14:38.393003 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:14:38.394318 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:14:38.394709 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:14:38.395144 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:14:38.789987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m01:14:38.795155 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m01:14:38.985113 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m01:14:38.990803 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m01:14:38.993314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m01:14:38.999983 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m01:14:39.003430 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.85s]
[0m01:14:39.004470 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:14:39.006025 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:14:39.008183 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m01:14:39.201730 [info ] [Thread-4 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.82s]
[0m01:14:39.204054 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:14:39.208932 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.93s]
[0m01:14:39.209755 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.93s]
[0m01:14:39.211074 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:14:39.212074 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:14:39.214787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:39.215347 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m01:14:39.215816 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m01:14:39.216304 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m01:14:39.216732 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m01:14:39.217213 [info ] [MainThread]: 
[0m01:14:39.217979 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m01:14:39.220698 [debug] [MainThread]: Command end result
[0m01:14:39.264316 [info ] [MainThread]: 
[0m01:14:39.264806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:39.265125 [info ] [MainThread]: 
[0m01:14:39.265502 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m01:14:39.266207 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.0622244, "process_user_time": 4.08731, "process_kernel_time": 0.242091, "process_mem_max_rss": "213784", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m01:14:39.266688 [debug] [MainThread]: Command `dbt test` succeeded at 01:14:39.266593 after 6.06 seconds
[0m01:14:39.267065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa36090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2254440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff2a9f0>]}
[0m01:14:39.267422 [debug] [MainThread]: Flushing usage events
[0m01:19:08.231040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcb40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6688c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90623fb0>]}


============================== 01:19:08.237234 | ff208fda-69b3-45b2-9001-8c421917d1ec ==============================
[0m01:19:08.237234 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:19:08.237974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:08.913906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f453f50>]}
[0m01:19:08.953460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f125a0>]}
[0m01:19:08.954104 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:19:09.030203 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:19:09.169671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:09.170100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:09.209855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73cfe120>]}
[0m01:19:09.314222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff738ddf10>]}
[0m01:19:09.314710 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:19:09.315349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74fd7cb0>]}
[0m01:19:09.317329 [info ] [MainThread]: 
[0m01:19:09.317975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:09.321721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:19:09.330072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:19:09.333989 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:19:09.336295 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:19:09.336681 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:19:09.337026 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:19:09.337374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:09.337685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:10.206865 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.869 seconds
[0m01:19:10.208237 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.870 seconds
[0m01:19:10.210212 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:19:10.211957 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:19:10.424745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m01:19:10.432950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m01:19:10.446281 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:19:10.445643 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:19:10.447207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:19:10.447577 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:19:10.448093 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:19:10.450251 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:19:10.450659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:10.451026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:10.451389 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:19:10.454726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:11.109367 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.654 seconds
[0m01:19:11.111207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.660 seconds
[0m01:19:11.115612 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:19:11.117079 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.666 seconds
[0m01:19:11.119259 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:19:11.123410 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:19:11.333710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d7ddc0>]}
[0m01:19:11.335071 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:19:11.335742 [info ] [MainThread]: 
[0m01:19:11.349778 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m01:19:11.350384 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m01:19:11.350818 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m01:19:11.351345 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m01:19:11.351814 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m01:19:11.352272 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m01:19:11.352831 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m01:19:11.354010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m01:19:11.354444 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m01:19:11.355060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m01:19:11.355550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m01:19:11.356012 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m01:19:11.356519 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m01:19:11.356950 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m01:19:11.357351 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m01:19:11.363070 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m01:19:11.363456 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m01:19:11.365859 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m01:19:11.368086 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:19:11.370431 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m01:19:11.371366 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m01:19:11.386783 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m01:19:11.408210 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m01:19:11.412525 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m01:19:11.412912 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m01:19:11.413306 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m01:19:11.415824 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:19:11.418062 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m01:19:11.418974 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m01:19:11.419876 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m01:19:11.420308 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m01:19:11.420741 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m01:19:11.421304 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m01:19:11.421997 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m01:19:11.422315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:11.422659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:11.422995 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m01:19:11.423336 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m01:19:11.426019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:11.426469 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:19:12.059238 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m01:19:12.074752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m01:19:12.090372 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m01:19:12.094683 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m01:19:12.095947 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m01:19:12.097697 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m01:19:12.294941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900981a0>]}
[0m01:19:12.296895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7374bb60>]}
[0m01:19:12.298401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e732c0>]}
[0m01:19:12.299513 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.94s]
[0m01:19:12.301360 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.94s]
[0m01:19:12.302503 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.94s]
[0m01:19:12.303656 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m01:19:12.304506 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m01:19:12.305297 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m01:19:12.306121 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m01:19:12.306950 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m01:19:12.307934 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m01:19:12.308689 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m01:19:12.309402 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m01:19:12.310003 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m01:19:12.310673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m01:19:12.311255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m01:19:12.311777 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m01:19:12.312266 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m01:19:12.312722 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m01:19:12.313175 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m01:19:12.316628 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m01:19:12.319229 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m01:19:12.323148 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m01:19:12.324854 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m01:19:12.325181 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m01:19:12.327467 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m01:19:12.327797 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m01:19:12.329983 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m01:19:12.332263 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m01:19:12.333280 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m01:19:12.333668 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m01:19:12.334029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:12.335230 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m01:19:12.336233 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m01:19:12.336807 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m01:19:12.337238 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m01:19:12.337660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:19:12.338052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:12.885012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.463 seconds
[0m01:19:12.887250 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m01:19:12.980402 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m01:19:12.982424 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m01:19:12.993036 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m01:19:12.995222 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m01:19:12.998139 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m01:19:12.999910 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m01:19:13.074921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7370e7b0>]}
[0m01:19:13.075543 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.72s]
[0m01:19:13.076346 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m01:19:13.076799 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m01:19:13.077260 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m01:19:13.077760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m01:19:13.078119 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m01:19:13.090635 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m01:19:13.093847 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m01:19:13.096117 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m01:19:13.097817 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m01:19:13.098391 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m01:19:13.099748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:13.172560 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d2caa0>]}
[0m01:19:13.173401 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.86s]
[0m01:19:13.174049 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m01:19:13.174527 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m01:19:13.175112 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m01:19:13.175693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m01:19:13.176867 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m01:19:13.182778 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:19:13.183993 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m01:19:13.187811 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:19:13.189225 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m01:19:13.189640 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m01:19:13.190044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:19:13.194343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbeff0>]}
[0m01:19:13.195543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbe330>]}
[0m01:19:13.196310 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.88s]
[0m01:19:13.197828 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.88s]
[0m01:19:13.198749 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m01:19:13.199204 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m01:19:13.199607 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m01:19:13.200441 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m01:19:13.200919 [info ] [Thread-3 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m01:19:13.201620 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m01:19:13.202082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_store)
[0m01:19:13.202496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_product)
[0m01:19:13.202911 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m01:19:13.203302 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m01:19:13.206872 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m01:19:13.210057 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m01:19:13.211334 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m01:19:13.213667 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m01:19:13.214165 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m01:19:13.216383 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m01:19:13.217504 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m01:19:13.217878 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m01:19:13.218246 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:13.219496 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m01:19:13.220272 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m01:19:13.220752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:14.555808 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.335 seconds
[0m01:19:14.562463 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m01:19:14.569085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.469 seconds
[0m01:19:14.570498 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.380 seconds
[0m01:19:14.573671 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m01:19:14.574640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.356 seconds
[0m01:19:14.576818 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m01:19:14.580679 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m01:19:14.765832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d97380>]}
[0m01:19:14.767666 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.56s]
[0m01:19:14.769739 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m01:19:14.791326 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbea20>]}
[0m01:19:14.792977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbe720>]}
[0m01:19:14.794503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbefc0>]}
[0m01:19:14.795823 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.61s]
[0m01:19:14.797178 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.71s]
[0m01:19:14.798299 [info ] [Thread-3 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.59s]
[0m01:19:14.799313 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m01:19:14.800289 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m01:19:14.801078 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m01:19:14.802362 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m01:19:14.803290 [info ] [Thread-2 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m01:19:14.804001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now model.retail_dbt.fact_sales)
[0m01:19:14.804476 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m01:19:14.811983 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m01:19:14.813416 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m01:19:14.816001 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m01:19:14.818608 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m01:19:14.819083 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m01:19:14.819632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:17.011491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.192 seconds
[0m01:19:17.015101 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: Close
[0m01:19:17.207735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff208fda-69b3-45b2-9001-8c421917d1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dd8710>]}
[0m01:19:17.208571 [info ] [Thread-2 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.40s]
[0m01:19:17.209579 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m01:19:17.211417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:17.211781 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m01:19:17.212097 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m01:19:17.212474 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m01:19:17.212935 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m01:19:17.213525 [info ] [MainThread]: 
[0m01:19:17.214152 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m01:19:17.215767 [debug] [MainThread]: Command end result
[0m01:19:17.305401 [info ] [MainThread]: 
[0m01:19:17.306056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:17.306451 [info ] [MainThread]: 
[0m01:19:17.306862 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:19:17.307710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.112931, "process_user_time": 4.106582, "process_kernel_time": 0.313795, "process_mem_max_rss": "212712", "process_out_blocks": "2767", "process_in_blocks": "0"}
[0m01:19:17.308164 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:17.308080 after 9.11 seconds
[0m01:19:17.308527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92480800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6b6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d9a960>]}
[0m01:19:17.308859 [debug] [MainThread]: Flushing usage events
[0m01:19:19.789936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b3fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fa9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b6d820>]}


============================== 01:19:19.795598 | 2529fa8c-b46a-41f8-8707-09b9c8b81b49 ==============================
[0m01:19:19.795598 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:19:19.796357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:19:20.405996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901497c0>]}
[0m01:19:20.445352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7499c590>]}
[0m01:19:20.446051 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:19:20.519936 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:19:20.660055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:20.660480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:20.700347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74a11b50>]}
[0m01:19:20.808766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff742ac6e0>]}
[0m01:19:20.809216 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:19:20.809805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff747f2360>]}
[0m01:19:20.811945 [info ] [MainThread]: 
[0m01:19:20.812558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:20.816484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:19:20.816995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m01:19:20.831168 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:19:20.831579 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:19:20.832025 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:19:20.832441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:19:20.832812 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:19:20.833166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:20.834915 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:19:20.835248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:20.836484 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:19:20.838600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:21.465762 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.627 seconds
[0m01:19:21.469983 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:19:21.501458 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.666 seconds
[0m01:19:21.505114 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:19:21.506645 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.673 seconds
[0m01:19:21.510675 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:19:21.716622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2529fa8c-b46a-41f8-8707-09b9c8b81b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917602f0>]}
[0m01:19:21.717943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:19:21.719472 [info ] [MainThread]: 
[0m01:19:21.732384 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:19:21.733015 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:19:21.733510 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:19:21.733971 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m01:19:21.734439 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:19:21.734820 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m01:19:21.735365 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m01:19:21.735966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m01:19:21.736474 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m01:19:21.737034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m01:19:21.737511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m01:19:21.737944 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:19:21.738473 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m01:19:21.738879 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:19:21.739313 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:19:21.752783 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:19:21.753092 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:19:21.756380 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:19:21.760408 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:19:21.763523 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:19:21.765662 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:19:21.766044 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:19:21.781397 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:19:21.783362 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:19:21.783693 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:19:21.784001 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:19:21.786248 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:19:21.788426 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:19:21.789027 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m01:19:21.789825 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m01:19:21.790996 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m01:19:21.791545 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m01:19:21.792185 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m01:19:21.792714 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m01:19:21.793010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:21.793427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:21.793799 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m01:19:21.795178 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m01:19:21.797816 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:19:21.798207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:22.644204 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m01:19:22.646134 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m01:19:22.647466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m01:19:22.656447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m01:19:22.662595 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m01:19:22.665052 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m01:19:22.667086 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m01:19:22.668745 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m01:19:22.881601 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.15s]
[0m01:19:22.882593 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m01:19:22.884253 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:19:22.885131 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.15s]
[0m01:19:22.885616 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m01:19:22.887072 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.15s]
[0m01:19:22.887801 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m01:19:22.888536 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.15s]
[0m01:19:22.888910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m01:19:22.889459 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m01:19:22.889918 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:19:22.890430 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m01:19:22.890851 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:19:22.891328 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:19:22.891847 [info ] [Thread-4 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m01:19:22.892417 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:19:22.896700 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:19:22.897163 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m01:19:22.897880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m01:19:22.898371 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m01:19:22.899189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m01:19:22.900056 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:19:22.900628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m01:19:22.901029 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:19:22.904518 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:19:22.904893 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:19:22.905232 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:19:22.910119 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:19:22.912531 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:19:22.915783 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:19:22.917013 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:19:22.919546 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:19:22.920476 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m01:19:22.920956 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m01:19:22.921337 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:19:22.921761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:22.922196 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:19:22.924374 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:19:22.924911 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m01:19:22.928502 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:19:22.929357 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m01:19:22.930958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:19:22.934708 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m01:19:22.937325 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m01:19:22.938297 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m01:19:22.938699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:22.939183 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m01:19:22.940761 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:23.575045 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m01:19:23.580125 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m01:19:23.599202 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m01:19:23.603433 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m01:19:23.604795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m01:19:23.609830 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m01:19:23.613237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m01:19:23.616110 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m01:19:23.784645 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.88s]
[0m01:19:23.787314 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m01:19:23.788339 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:19:23.789206 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m01:19:23.790330 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m01:19:23.790932 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:19:23.803034 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:19:23.804730 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:19:23.807562 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:19:23.809762 [info ] [Thread-4 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.91s]
[0m01:19:23.810735 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m01:19:23.811254 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m01:19:23.811747 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:23.812319 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:19:23.813110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:23.814149 [info ] [Thread-4 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m01:19:23.816731 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.93s]
[0m01:19:23.817208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m01:19:23.818503 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.92s]
[0m01:19:23.819120 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m01:19:23.820497 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:19:23.821904 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m01:19:23.822784 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:19:23.829167 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:19:23.829695 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:19:23.830117 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m01:19:23.830866 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m01:19:23.831379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m01:19:23.831882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m01:19:23.832366 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:19:23.832692 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:19:23.833059 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:19:23.837772 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:19:23.839808 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:19:23.844132 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:19:23.845657 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:19:23.847705 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:19:23.848479 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m01:19:23.848773 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:19:23.849251 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:23.851350 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:19:23.851936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:19:23.852673 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m01:19:23.854282 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:23.854833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:23.855758 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m01:19:23.856522 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:23.857256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:24.488402 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m01:19:24.490357 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m01:19:24.555461 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m01:19:24.557534 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m01:19:24.600994 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m01:19:24.603501 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m01:19:24.641080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m01:19:24.643705 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m01:19:24.691331 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.86s]
[0m01:19:24.693417 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m01:19:24.694360 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:19:24.695039 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m01:19:24.696078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m01:19:24.696718 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:19:24.705039 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:19:24.706644 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:19:24.709124 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:19:24.710852 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m01:19:24.711393 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:24.711851 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:24.754315 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.96s]
[0m01:19:24.755379 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m01:19:24.755912 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:19:24.756438 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m01:19:24.757085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m01:19:24.757516 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:19:24.762548 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:19:24.763650 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:19:24.834870 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:19:24.836214 [info ] [Thread-4 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.02s]
[0m01:19:24.837207 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m01:19:24.837964 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m01:19:24.838380 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:19:24.838777 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:24.839166 [info ] [Thread-4 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m01:19:24.839627 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:19:24.840042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m01:19:24.841538 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:19:24.845775 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:19:24.847485 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.02s]
[0m01:19:24.848257 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m01:19:24.848793 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:19:24.849208 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m01:19:24.849852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m01:19:24.850160 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:19:24.850485 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:19:24.852695 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:19:24.857672 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:19:24.859526 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m01:19:24.859818 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:19:24.860145 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:19:24.862217 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:19:24.862732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:19:24.864802 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m01:19:24.865175 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:19:24.865475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:25.377739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m01:19:25.382744 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m01:19:25.462026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m01:19:25.467531 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m01:19:25.491720 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m01:19:25.494028 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m01:19:25.510159 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m01:19:25.511912 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m01:19:25.576519 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.88s]
[0m01:19:25.577409 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m01:19:25.659329 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.81s]
[0m01:19:25.660090 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m01:19:25.688640 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.93s]
[0m01:19:25.689437 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m01:19:25.710633 [info ] [Thread-4 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.87s]
[0m01:19:25.711553 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m01:19:25.713565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:25.714003 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m01:19:25.714501 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m01:19:25.714906 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m01:19:25.715281 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m01:19:25.715707 [info ] [MainThread]: 
[0m01:19:25.716310 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m01:19:25.718823 [debug] [MainThread]: Command end result
[0m01:19:25.761221 [info ] [MainThread]: 
[0m01:19:25.761727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:25.762059 [info ] [MainThread]: 
[0m01:19:25.762468 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m01:19:25.763196 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.0082154, "process_user_time": 3.98674, "process_kernel_time": 0.20683, "process_mem_max_rss": "214096", "process_out_blocks": "2791", "process_in_blocks": "0"}
[0m01:19:25.763672 [debug] [MainThread]: Command `dbt test` succeeded at 01:19:25.763583 after 6.01 seconds
[0m01:19:25.764030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b3fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902eb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90765280>]}
[0m01:19:25.764372 [debug] [MainThread]: Flushing usage events
[0m18:43:59.716380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96e6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96e4da0>]}


============================== 18:43:59.740153 | 980a9a9d-a2ce-4b1d-b7a9-b1add4f69eda ==============================
[0m18:43:59.740153 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:43:59.742098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:43:59.852796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '980a9a9d-a2ce-4b1d-b7a9-b1add4f69eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa140b90>]}
[0m18:43:59.948146 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vsk50p25'
[0m18:43:59.948836 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:44:00.055477 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:44:00.056343 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:44:00.108092 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:44:00.111589 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:44:00.684219 [info ] [MainThread]: Installed from version 1.3.0
[0m18:44:00.685185 [info ] [MainThread]: Updated version available: 1.3.3
[0m18:44:00.685775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '980a9a9d-a2ce-4b1d-b7a9-b1add4f69eda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94b7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9409bb0>]}
[0m18:44:00.686151 [info ] [MainThread]: 
[0m18:44:00.686627 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:44:00.687903 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0105984, "process_user_time": 1.993616, "process_kernel_time": 0.189868, "process_mem_max_rss": "171272", "process_in_blocks": "36000", "process_out_blocks": "5550"}
[0m18:44:00.688378 [debug] [MainThread]: Command `dbt deps` succeeded at 18:44:00.688295 after 1.01 seconds
[0m18:44:00.688699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96a0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96e4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa967fe90>]}
[0m18:44:00.689009 [debug] [MainThread]: Flushing usage events
[0m18:45:15.876111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1c3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0907d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8ea120>]}


============================== 18:45:15.881776 | 2206a7cb-7cb1-4eca-95a0-8c71c5c9df12 ==============================
[0m18:45:15.881776 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:15.882375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:15.962184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2206a7cb-7cb1-4eca-95a0-8c71c5c9df12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8e1df0>]}
[0m18:45:16.022883 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4am8prus'
[0m18:45:16.023340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:45:16.072702 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:45:16.073329 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:45:16.104775 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:45:16.108147 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:45:16.669724 [info ] [MainThread]: Installed from version 1.3.0
[0m18:45:16.670509 [info ] [MainThread]: Updated version available: 1.3.3
[0m18:45:16.671693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2206a7cb-7cb1-4eca-95a0-8c71c5c9df12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f933170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f933710>]}
[0m18:45:16.672196 [info ] [MainThread]: 
[0m18:45:16.672797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:45:16.674241 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8345213, "process_user_time": 1.693706, "process_kernel_time": 0.127807, "process_mem_max_rss": "170696", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m18:45:16.674924 [debug] [MainThread]: Command `dbt deps` succeeded at 18:45:16.674809 after 0.84 seconds
[0m18:45:16.675297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3bafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5fb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecae570>]}
[0m18:45:16.675692 [debug] [MainThread]: Flushing usage events
[0m18:45:19.255038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f26a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f287ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec65a30>]}


============================== 18:45:19.260692 | 332bbb8e-1202-4360-8eee-5feef8292edb ==============================
[0m18:45:19.260692 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:19.261427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:45:20.990084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4f5610>]}
[0m18:45:21.031252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdce3c0>]}
[0m18:45:21.032101 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:21.113438 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:21.277825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:21.278250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:21.320258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83457ef0>]}
[0m18:45:21.437583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e67bf0>]}
[0m18:45:21.438089 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:21.438765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84db59a0>]}
[0m18:45:21.440608 [info ] [MainThread]: 
[0m18:45:21.441227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:21.442078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:21.453923 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:21.454294 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:21.454625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:23.555275 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.101 seconds
[0m18:45:23.556890 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:23.786223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m18:45:23.793886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m18:45:23.794483 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:23.796513 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:23.797199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:23.798112 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:23.798790 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:23.800777 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:23.801227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:23.801624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:23.802001 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:23.805458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:24.097953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90c1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a6d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90c25d0>]}


============================== 18:45:24.104096 | 3cf311c3-80fd-4e02-91ac-126abe32dbe2 ==============================
[0m18:45:24.104096 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:24.104930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:45:24.191682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cf311c3-80fd-4e02-91ac-126abe32dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9600410>]}
[0m18:45:24.263686 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y1cttak9'
[0m18:45:24.264182 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:45:24.312241 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:45:24.312829 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:45:24.351311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:45:24.355217 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:45:24.473387 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.672 seconds
[0m18:45:24.475130 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:24.477183 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.676 seconds
[0m18:45:24.478933 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:24.481821 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.676 seconds
[0m18:45:24.483204 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:24.685267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82317560>]}
[0m18:45:24.686214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:24.687204 [info ] [MainThread]: 
[0m18:45:24.699001 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m18:45:24.699647 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m18:45:24.700336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m18:45:24.700793 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m18:45:24.708988 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m18:45:24.750921 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:24.751329 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:24.751678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:24.958692 [info ] [MainThread]: Installed from version 1.3.0
[0m18:45:24.959172 [info ] [MainThread]: Updated version available: 1.3.3
[0m18:45:24.959649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3cf311c3-80fd-4e02-91ac-126abe32dbe2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8324fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb82c8ce0>]}
[0m18:45:24.960052 [info ] [MainThread]: 
[0m18:45:24.960393 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:45:24.961316 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.901624, "process_user_time": 1.787076, "process_kernel_time": 0.150114, "process_mem_max_rss": "170696", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m18:45:24.961822 [debug] [MainThread]: Command `dbt deps` succeeded at 18:45:24.961727 after 0.90 seconds
[0m18:45:24.962171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a1e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9600410>]}
[0m18:45:24.962572 [debug] [MainThread]: Flushing usage events
[0m18:45:25.367263 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.615 seconds
[0m18:45:25.401610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:25.402245 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:45:27.873515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8836fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7941d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f63b00>]}


============================== 18:45:27.879241 | cc8f083f-1cf1-46ea-aec5-05bc0da4441b ==============================
[0m18:45:27.879241 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:27.879756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:28.517790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d988110>]}
[0m18:45:28.557288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723682f0>]}
[0m18:45:28.557919 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:28.632315 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:28.825206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:28.826876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:28.871985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bfb14f0>]}
[0m18:45:28.976611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bbf2b70>]}
[0m18:45:28.977092 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:28.977496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c042780>]}
[0m18:45:28.979351 [info ] [MainThread]: 
[0m18:45:28.979904 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:28.980676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:28.992057 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:28.992415 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:28.992726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:29.709994 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.716 seconds
[0m18:45:29.713340 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:29.968955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m18:45:29.975662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m18:45:29.979769 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:29.980374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:29.983698 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:29.984131 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:29.985855 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:29.986221 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:29.986559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:29.986887 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:29.987266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:29.988325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:30.181008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.777 seconds
[0m18:45:30.184144 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:30.184672 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:30.501334 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.316 seconds
[0m18:45:30.508555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:30.509291 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:30.683040 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.173 seconds
[0m18:45:30.690805 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:30.691473 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:30.778585 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.792 seconds
[0m18:45:30.782892 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:30.785763 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.797 seconds
[0m18:45:30.788441 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:30.789561 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.802 seconds
[0m18:45:30.792351 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:30.864673 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.173 seconds
[0m18:45:30.871928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:30.872500 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:31.028071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc1f560>]}
[0m18:45:31.029440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:31.030081 [info ] [MainThread]: 
[0m18:45:31.042559 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m18:45:31.043215 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m18:45:31.043755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m18:45:31.044210 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m18:45:31.046310 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.173 seconds
[0m18:45:31.051953 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m18:45:31.052723 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:31.053187 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:31.092421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:31.092817 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:31.093166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:31.263632 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.210 seconds
[0m18:45:31.282627 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:31.283143 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:31.919871 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.826 seconds
[0m18:45:31.962820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:31.963368 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:45:32.127895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.844 seconds
[0m18:45:32.137991 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:32.138761 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:32.562118 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.423 seconds
[0m18:45:32.563417 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m18:45:32.567962 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:32.568649 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m18:45:32.978579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m18:45:32.980260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:32.981057 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:33.789137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.825 seconds
[0m18:45:33.796122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:33.796983 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:34.024765 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.227 seconds
[0m18:45:34.032134 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.033231 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:34.228350 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.194 seconds
[0m18:45:34.233946 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.234483 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:34.314590 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.332 seconds
[0m18:45:34.316035 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.316733 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m18:45:34.459538 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.225 seconds
[0m18:45:34.463166 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.463552 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:45:34.688593 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.224 seconds
[0m18:45:34.701359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.702033 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:45:34.877740 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.175 seconds
[0m18:45:34.904387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:34.904943 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:34.944213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m18:45:34.963716 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m18:45:35.222070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332bbb8e-1202-4360-8eee-5feef8292edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f68c470>]}
[0m18:45:35.222975 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 10.52s]
[0m18:45:35.224005 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m18:45:35.225544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:35.225912 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m18:45:35.226223 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m18:45:35.226495 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m18:45:35.226829 [info ] [MainThread]: 
[0m18:45:35.227285 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.79 seconds (13.79s).
[0m18:45:35.227880 [debug] [MainThread]: Command end result
[0m18:45:35.264851 [info ] [MainThread]: 
[0m18:45:35.265378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:35.265727 [info ] [MainThread]: 
[0m18:45:35.266091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:45:35.266778 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.046322, "process_user_time": 4.753458, "process_kernel_time": 0.335727, "process_mem_max_rss": "217348", "process_in_blocks": "5848", "process_out_blocks": "25873"}
[0m18:45:35.267284 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:45:35.267211 after 16.05 seconds
[0m18:45:35.267616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef20290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8381b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83456090>]}
[0m18:45:35.267967 [debug] [MainThread]: Flushing usage events
[0m18:45:35.762838 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.857 seconds
[0m18:45:35.767917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:35.768383 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:36.008438 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.240 seconds
[0m18:45:36.009319 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m18:45:36.011223 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:36.011625 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m18:45:36.344096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m18:45:36.344602 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:36.345021 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:37.422188 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.077 seconds
[0m18:45:37.422869 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:45:37.423325 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m18:45:38.001666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m18:45:38.019382 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m18:45:38.047981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bfe1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d6fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb237f650>]}


============================== 18:45:38.053654 | 96954ea9-a5ed-4851-8b11-293738339347 ==============================
[0m18:45:38.053654 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:38.054165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:45:38.242959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc8f083f-1cf1-46ea-aec5-05bc0da4441b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c156c90>]}
[0m18:45:38.243782 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 7.20s]
[0m18:45:38.244451 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m18:45:38.245834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:38.246164 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m18:45:38.246470 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m18:45:38.246803 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m18:45:38.247237 [info ] [MainThread]: 
[0m18:45:38.247599 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m18:45:38.248396 [debug] [MainThread]: Command end result
[0m18:45:38.283170 [info ] [MainThread]: 
[0m18:45:38.283813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:38.284279 [info ] [MainThread]: 
[0m18:45:38.284711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:45:38.285565 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.447097, "process_user_time": 3.584125, "process_kernel_time": 0.176399, "process_mem_max_rss": "211756", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m18:45:38.285948 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:45:38.285887 after 10.45 seconds
[0m18:45:38.286247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8797b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8836fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8836f7d0>]}
[0m18:45:38.286528 [debug] [MainThread]: Flushing usage events
[0m18:45:38.673702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c50f80>]}
[0m18:45:38.714646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd45100>]}
[0m18:45:38.715466 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:38.800959 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:38.948008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:38.948436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:38.988977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a40ef0>]}
[0m18:45:39.089247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9659a090>]}
[0m18:45:39.089747 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:39.090087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965e0e00>]}
[0m18:45:39.092073 [info ] [MainThread]: 
[0m18:45:39.092747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:39.096503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:39.105605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:39.108731 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:39.110994 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:39.111385 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:39.111737 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:39.112072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:39.112413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:39.846742 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.735 seconds
[0m18:45:39.848219 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:39.853095 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.741 seconds
[0m18:45:39.854297 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:40.096891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m18:45:40.097455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m18:45:40.104098 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:40.105898 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:40.106292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:40.106597 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:40.106960 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:40.108738 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:40.109074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:40.109443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:40.109765 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:40.112199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:40.847906 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.739 seconds
[0m18:45:40.849419 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:40.943671 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.831 seconds
[0m18:45:40.944500 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.835 seconds
[0m18:45:40.945970 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:40.947304 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:40.985582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b4e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cb7b30>]}


============================== 18:45:40.991253 | 1cad6111-643a-407b-96c7-3ab42d24759f ==============================
[0m18:45:40.991253 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:40.991742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:45:41.229932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96599f40>]}
[0m18:45:41.230522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:41.230910 [info ] [MainThread]: 
[0m18:45:41.238767 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m18:45:41.239126 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m18:45:41.239466 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m18:45:41.239875 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m18:45:41.240257 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m18:45:41.240637 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m18:45:41.241097 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m18:45:41.241993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m18:45:41.242374 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m18:45:41.242847 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m18:45:41.243301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m18:45:41.243663 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m18:45:41.244084 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m18:45:41.244442 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m18:45:41.244787 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m18:45:41.249962 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m18:45:41.250373 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m18:45:41.252560 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m18:45:41.254746 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:41.257216 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m18:45:41.259817 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m18:45:41.260128 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m18:45:41.260471 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m18:45:41.268767 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m18:45:41.290410 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m18:45:41.300581 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:41.302833 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m18:45:41.305075 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m18:45:41.307294 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m18:45:41.307863 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m18:45:41.309686 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m18:45:41.308815 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m18:45:41.309428 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:41.308279 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m18:45:41.310906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:41.310280 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m18:45:41.310602 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m18:45:41.309972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:41.312435 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:41.312822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:41.646453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73fc4410>]}
[0m18:45:41.686122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7f8680>]}
[0m18:45:41.686756 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:41.758912 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:41.885771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:41.886182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:41.926257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dacc320>]}
[0m18:45:42.023030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d8bda90>]}
[0m18:45:42.023539 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:42.023919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d916cc0>]}
[0m18:45:42.025943 [info ] [MainThread]: 
[0m18:45:42.026446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:42.030056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:42.038031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:45:42.042162 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:42.044398 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:45:42.044756 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:42.045113 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:45:42.045466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:42.045787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:42.550276 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m18:45:42.570720 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m18:45:42.573706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m18:45:42.574360 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.262 seconds
[0m18:45:42.576080 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m18:45:42.577758 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m18:45:42.798745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d4f200>]}
[0m18:45:42.799647 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.55s]
[0m18:45:42.800494 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m18:45:42.801192 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m18:45:42.801895 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m18:45:42.802558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m18:45:42.803083 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m18:45:42.806051 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m18:45:42.807301 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m18:45:42.811389 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m18:45:42.812752 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m18:45:42.813140 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m18:45:42.813812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:42.815531 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9517cd10>]}
[0m18:45:42.816441 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.57s]
[0m18:45:42.817061 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m18:45:42.817590 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m18:45:42.818113 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m18:45:42.818583 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m18:45:42.818955 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m18:45:42.821684 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m18:45:42.822891 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m18:45:42.825192 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m18:45:42.826421 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m18:45:42.826780 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m18:45:42.827117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:42.857838 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b66c90>]}
[0m18:45:42.858483 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.61s]
[0m18:45:42.859036 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m18:45:42.859440 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m18:45:42.859995 [info ] [Thread-3 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m18:45:42.860528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m18:45:42.860891 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m18:45:42.863323 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m18:45:42.864435 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m18:45:42.867022 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m18:45:42.868311 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m18:45:42.868668 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m18:45:42.869016 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:42.882678 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.837 seconds
[0m18:45:42.884206 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:42.902566 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.857 seconds
[0m18:45:42.903854 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:45:43.129848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m18:45:43.137201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m18:45:43.140335 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:43.142657 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:43.143120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:43.143568 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:43.143994 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:43.145952 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:43.146303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:43.146603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:43.146905 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:43.149879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:43.491755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.181 seconds
[0m18:45:43.495456 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m18:45:43.745349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ba2210>]}
[0m18:45:43.747117 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.50s]
[0m18:45:43.748133 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m18:45:43.748807 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m18:45:43.749706 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m18:45:43.750673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m18:45:43.751282 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m18:45:43.766479 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m18:45:43.767710 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m18:45:43.769974 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m18:45:43.771657 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m18:45:43.772024 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m18:45:43.772358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:43.830014 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.016 seconds
[0m18:45:43.832216 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m18:45:43.881502 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.054 seconds
[0m18:45:43.883324 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m18:45:43.886885 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.737 seconds
[0m18:45:43.888574 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:43.891090 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.744 seconds
[0m18:45:43.892406 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:43.932463 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.786 seconds
[0m18:45:43.933926 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:44.003725 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.135 seconds
[0m18:45:44.006650 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m18:45:44.068530 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b3cc80>]}
[0m18:45:44.069504 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.27s]
[0m18:45:44.070253 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m18:45:44.070740 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m18:45:44.071251 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m18:45:44.071714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m18:45:44.072063 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m18:45:44.076035 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:44.077278 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m18:45:44.080984 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:44.082526 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:44.082897 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m18:45:44.083249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:44.096841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b710d0>]}
[0m18:45:44.097448 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.28s]
[0m18:45:44.098011 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m18:45:44.098596 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m18:45:44.099022 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m18:45:44.099581 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m18:45:44.099879 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m18:45:44.102983 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m18:45:44.105060 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m18:45:44.107292 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m18:45:44.108492 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m18:45:44.108833 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m18:45:44.109166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:44.188545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d8bdd00>]}
[0m18:45:44.189135 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:44.189499 [info ] [MainThread]: 
[0m18:45:44.198893 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m18:45:44.199362 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m18:45:44.199831 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m18:45:44.200156 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m18:45:44.200648 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m18:45:44.202418 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m18:45:44.203079 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m18:45:44.203827 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m18:45:44.205069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m18:45:44.205452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m18:45:44.205858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m18:45:44.206359 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m18:45:44.206771 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m18:45:44.207173 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m18:45:44.207532 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m18:45:44.207880 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m18:45:44.213247 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m18:45:44.215611 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m18:45:44.217837 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:44.219944 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m18:45:44.221512 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m18:45:44.225086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95105b20>]}
[0m18:45:44.225740 [info ] [Thread-3 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.36s]
[0m18:45:44.226454 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m18:45:44.226994 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m18:45:44.227499 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m18:45:44.228061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m18:45:44.228424 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m18:45:44.231715 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m18:45:44.233209 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m18:45:44.233520 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m18:45:44.235410 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m18:45:44.236763 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m18:45:44.237108 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m18:45:44.237474 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:44.252564 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m18:45:44.252985 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m18:45:44.264193 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m18:45:44.264752 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m18:45:44.267137 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m18:45:44.272443 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:44.273227 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m18:45:44.274199 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m18:45:44.274536 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m18:45:44.275028 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m18:45:44.275794 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m18:45:44.276125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:44.276731 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m18:45:44.278984 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m18:45:44.277488 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m18:45:44.277117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:44.279478 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:44.279859 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:45.279572 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.000 seconds
[0m18:45:45.281274 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.004 seconds
[0m18:45:45.312809 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m18:45:45.313581 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m18:45:45.341544 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.062 seconds
[0m18:45:45.343335 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m18:45:45.541614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e06f3e0>]}
[0m18:45:45.542850 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.33s]
[0m18:45:45.543987 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d70c980>]}
[0m18:45:45.544855 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m18:45:45.545766 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.34s]
[0m18:45:45.546616 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m18:45:45.547536 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m18:45:45.548311 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m18:45:45.549005 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m18:45:45.549578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m18:45:45.550207 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m18:45:45.550755 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m18:45:45.551429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m18:45:45.554257 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m18:45:45.554706 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m18:45:45.557225 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m18:45:45.558018 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m18:45:45.561686 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m18:45:45.562174 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m18:45:45.564367 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m18:45:45.565255 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m18:45:45.565614 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m18:45:45.565955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:45.566458 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m18:45:45.568091 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m18:45:45.568483 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:45.574252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d726840>]}
[0m18:45:45.574900 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.37s]
[0m18:45:45.575973 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m18:45:45.576378 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m18:45:45.576788 [info ] [Thread-3 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m18:45:45.577249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m18:45:45.577536 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m18:45:45.579882 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m18:45:45.580656 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m18:45:45.583174 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m18:45:45.584090 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m18:45:45.584415 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m18:45:45.584691 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:46.027973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.255 seconds
[0m18:45:46.031843 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m18:45:46.171819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.895 seconds
[0m18:45:46.176385 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m18:45:46.303022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95195970>]}
[0m18:45:46.305077 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 2.55s]
[0m18:45:46.306983 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m18:45:46.308507 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m18:45:46.309921 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m18:45:46.311279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m18:45:46.311935 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m18:45:46.320870 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m18:45:46.322718 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m18:45:46.325474 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m18:45:46.328345 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m18:45:46.328846 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m18:45:46.329387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:46.483017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d7454f0>]}
[0m18:45:46.483957 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.28s]
[0m18:45:46.484733 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m18:45:46.485242 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m18:45:46.485762 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m18:45:46.486437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m18:45:46.486770 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m18:45:46.500629 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m18:45:46.501930 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m18:45:46.504270 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m18:45:46.505844 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m18:45:46.506348 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m18:45:46.506715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:46.547343 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m18:45:46.549340 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m18:45:46.699555 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.616 seconds
[0m18:45:46.701719 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m18:45:46.708920 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.143 seconds
[0m18:45:46.710937 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m18:45:46.714362 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.130 seconds
[0m18:45:46.716228 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m18:45:46.726888 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.158 seconds
[0m18:45:46.728847 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m18:45:46.748728 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.511 seconds
[0m18:45:46.751979 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m18:45:46.761464 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bac650>]}
[0m18:45:46.762173 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 2.66s]
[0m18:45:46.763642 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m18:45:47.005793 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd58500>]}
[0m18:45:47.006077 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969d97c0>]}
[0m18:45:47.006796 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.46s]
[0m18:45:47.011118 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m18:45:47.011699 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m18:45:47.012255 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m18:45:47.012966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m18:45:47.013365 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m18:45:47.009736 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 2.93s]
[0m18:45:47.017395 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m18:45:47.020262 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:47.022065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd251c0>]}
[0m18:45:47.022744 [info ] [Thread-3 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.44s]
[0m18:45:47.023616 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m18:45:47.023921 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m18:45:47.024481 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m18:45:47.027289 [info ] [Thread-3 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m18:45:47.029192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m18:45:47.026824 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:47.029523 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m18:45:47.032856 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m18:45:47.034381 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m18:45:47.034791 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m18:45:47.035133 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m18:45:47.037311 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m18:45:47.037675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:47.039863 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m18:45:47.040400 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m18:45:47.040723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:47.108954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d750500>]}
[0m18:45:47.110302 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951b2b10>]}
[0m18:45:47.110904 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.56s]
[0m18:45:47.111001 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 2.88s]
[0m18:45:47.111666 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m18:45:47.111957 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m18:45:47.112513 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m18:45:47.112929 [info ] [Thread-4 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m18:45:47.113468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m18:45:47.113846 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m18:45:47.117162 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m18:45:47.118295 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m18:45:47.120400 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m18:45:47.121472 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m18:45:47.121783 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m18:45:47.122064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:48.858462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.352 seconds
[0m18:45:48.860602 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m18:45:49.099224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d750470>]}
[0m18:45:49.100370 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 2.61s]
[0m18:45:49.101360 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m18:45:49.102360 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m18:45:49.103107 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m18:45:49.104135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m18:45:49.104743 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m18:45:49.112482 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m18:45:49.113656 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m18:45:49.116103 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m18:45:49.118413 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m18:45:49.118828 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m18:45:49.119234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:49.248737 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.208 seconds
[0m18:45:49.253097 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m18:45:49.269066 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.231 seconds
[0m18:45:49.272880 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m18:45:49.342387 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.220 seconds
[0m18:45:49.344393 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m18:45:49.499824 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d7339b0>]}
[0m18:45:49.501003 [info ] [Thread-3 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 2.47s]
[0m18:45:49.502372 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m18:45:49.511568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d904a70>]}
[0m18:45:49.512497 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 2.50s]
[0m18:45:49.513521 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m18:45:49.565413 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d730440>]}
[0m18:45:49.566572 [info ] [Thread-4 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 2.45s]
[0m18:45:49.567956 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m18:45:50.710357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.381 seconds
[0m18:45:50.713911 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m18:45:50.941003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96954ea9-a5ed-4851-8b11-293738339347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95baeab0>]}
[0m18:45:50.942294 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 4.63s]
[0m18:45:50.943355 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m18:45:50.945557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:50.946135 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m18:45:50.946685 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m18:45:50.947132 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m18:45:50.947699 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m18:45:50.948256 [info ] [MainThread]: 
[0m18:45:50.948699 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 11.86 seconds (11.86s).
[0m18:45:50.951054 [debug] [MainThread]: Command end result
[0m18:45:51.040768 [info ] [MainThread]: 
[0m18:45:51.041253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:51.041660 [info ] [MainThread]: 
[0m18:45:51.042048 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:45:51.042858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.030266, "process_user_time": 3.866773, "process_kernel_time": 0.188574, "process_mem_max_rss": "212556", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m18:45:51.043351 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:51.043258 after 13.03 seconds
[0m18:45:51.043705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3186210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd1400>]}
[0m18:45:51.044041 [debug] [MainThread]: Flushing usage events
[0m18:45:51.958516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.839 seconds
[0m18:45:51.962132 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m18:45:52.186882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cad6111-643a-407b-96c7-3ab42d24759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cdfae40>]}
[0m18:45:52.188027 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 3.08s]
[0m18:45:52.189437 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m18:45:52.191602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:52.192178 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m18:45:52.192660 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m18:45:52.193079 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m18:45:52.193550 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m18:45:52.194128 [info ] [MainThread]: 
[0m18:45:52.194697 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 10.17 seconds (10.17s).
[0m18:45:52.197239 [debug] [MainThread]: Command end result
[0m18:45:52.283250 [info ] [MainThread]: 
[0m18:45:52.283946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:52.284442 [info ] [MainThread]: 
[0m18:45:52.284940 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:45:52.285971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.3374405, "process_user_time": 3.891006, "process_kernel_time": 0.219154, "process_mem_max_rss": "212828", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m18:45:52.286413 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:52.286342 after 11.34 seconds
[0m18:45:52.286719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f0f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8921b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e55be00>]}
[0m18:45:52.287014 [debug] [MainThread]: Flushing usage events
[0m18:45:54.303634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93093860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f30110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93093b60>]}


============================== 18:45:54.309469 | 75db9437-ad69-468f-8022-4aef3deb1258 ==============================
[0m18:45:54.309469 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:54.310021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:45:54.953071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d34410>]}
[0m18:45:54.993811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786c6720>]}
[0m18:45:54.994576 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:55.069315 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:55.170628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a61d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd2fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dbcc80>]}


============================== 18:45:55.176247 | 727849eb-2c4f-442c-9036-23bd2869bbcb ==============================
[0m18:45:55.176247 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:45:55.176971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:55.210651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:55.211082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:55.256600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ed96d0>]}
[0m18:45:55.413072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76850080>]}
[0m18:45:55.413584 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:55.413999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d376b0>]}
[0m18:45:55.416275 [info ] [MainThread]: 
[0m18:45:55.416844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:55.420798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m18:45:55.428616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:55.434171 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:55.435924 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:55.436505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m18:45:55.436864 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:55.437230 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:55.438972 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:55.439328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.439660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.439991 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:55.443801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.807495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8879de80>]}
[0m18:45:55.847172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ead8a40>]}
[0m18:45:55.847883 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:45:55.923406 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:45:56.060372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:56.060806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:56.101017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e311fd0>]}
[0m18:45:56.209952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e310710>]}
[0m18:45:56.210466 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:45:56.211036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dec8d40>]}
[0m18:45:56.213168 [info ] [MainThread]: 
[0m18:45:56.213811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:56.217694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:45:56.225486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m18:45:56.227017 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.788 seconds
[0m18:45:56.228815 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:56.231913 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.792 seconds
[0m18:45:56.231014 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:45:56.233753 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:56.231669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m18:45:56.234476 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.791 seconds
[0m18:45:56.233503 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:45:56.233900 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:45:56.235775 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:45:56.236621 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:56.236173 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:45:56.236535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:56.236875 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:45:56.237223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:56.238742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:56.459744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75db9437-ad69-468f-8022-4aef3deb1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76de4890>]}
[0m18:45:56.460387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:56.460730 [info ] [MainThread]: 
[0m18:45:56.468632 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:56.469414 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:56.469776 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:56.470115 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m18:45:56.470508 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:56.470813 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m18:45:56.471238 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m18:45:56.471700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m18:45:56.472089 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m18:45:56.472545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m18:45:56.472958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m18:45:56.473322 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:56.473754 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m18:45:56.474094 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:56.474526 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:56.487509 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:56.487810 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:56.491010 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:56.495113 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:56.498251 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:56.501716 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:56.517641 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:56.518065 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:56.518414 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:56.518705 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:56.520907 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:56.523009 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:56.525028 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:56.526042 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:56.527249 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m18:45:56.527803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:56.528588 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:56.529118 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:56.530990 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:56.531731 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m18:45:56.532220 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m18:45:56.532644 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m18:45:56.533047 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:56.533459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:56.533799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:57.112207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.875 seconds
[0m18:45:57.115040 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:45:57.120492 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.882 seconds
[0m18:45:57.122747 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:45:57.123855 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.887 seconds
[0m18:45:57.126917 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:45:57.378686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '727849eb-2c4f-442c-9036-23bd2869bbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4a66c0>]}
[0m18:45:57.379717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:57.380690 [info ] [MainThread]: 
[0m18:45:57.390511 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:57.390984 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:57.391393 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:57.391766 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m18:45:57.392181 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:57.392506 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m18:45:57.392930 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m18:45:57.393433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m18:45:57.393823 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m18:45:57.394275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m18:45:57.394667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m18:45:57.395038 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:57.395490 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m18:45:57.395846 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:57.396216 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:57.409420 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:57.409779 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:57.412930 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:57.417137 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:57.420450 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:57.421455 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:57.437335 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:57.438007 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:57.438399 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:57.438731 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:57.440676 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:57.442703 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:57.443306 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:45:57.445251 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:57.446015 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m18:45:57.446953 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:45:57.447363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:57.447896 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m18:45:57.448537 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:45:57.449141 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:45:57.450121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:57.450909 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m18:45:57.451548 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m18:45:57.453073 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:57.453763 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:57.510511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.983 seconds
[0m18:45:57.517487 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m18:45:57.519404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m18:45:57.521451 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m18:45:57.524678 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m18:45:57.526127 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m18:45:57.529826 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m18:45:57.531217 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m18:45:57.747497 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.27s]
[0m18:45:57.748217 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:57.748639 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:57.748994 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m18:45:57.749447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m18:45:57.749843 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:57.753451 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:57.755199 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.28s]
[0m18:45:57.755862 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:57.756164 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:57.756509 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:57.759914 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:57.760289 [info ] [Thread-4 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m18:45:57.760875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m18:45:57.761232 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:57.764521 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:57.765056 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:57.765562 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m18:45:57.765900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:57.767482 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:57.769610 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:57.770745 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:57.771076 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m18:45:57.771387 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:57.804758 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.33s]
[0m18:45:57.805370 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:57.805782 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:57.806179 [info ] [Thread-1 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m18:45:57.806629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m18:45:57.807399 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:57.810870 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:57.811583 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.34s]
[0m18:45:57.812491 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:57.812882 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:57.813283 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m18:45:57.813770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m18:45:57.814073 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:57.814384 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:57.816412 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:57.819562 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:57.820991 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:57.821295 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:57.821597 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m18:45:57.823630 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:57.824168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:57.826478 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:57.826930 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m18:45:57.827293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:58.123558 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m18:45:58.130797 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m18:45:58.139812 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m18:45:58.141388 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m18:45:58.158403 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m18:45:58.159852 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m18:45:58.187964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m18:45:58.189368 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m18:45:58.377227 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.98s]
[0m18:45:58.378022 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:45:58.378492 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:58.378902 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m18:45:58.379369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m18:45:58.379728 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:58.383427 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:58.385126 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.99s]
[0m18:45:58.385510 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:58.385949 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:45:58.389375 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:58.390958 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.00s]
[0m18:45:58.391419 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:58.392041 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:45:58.392424 [info ] [Thread-4 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m18:45:58.392917 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:58.393519 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:45:58.393854 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m18:45:58.394252 [info ] [Thread-3 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m18:45:58.394701 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m18:45:58.395043 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:58.395406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m18:45:58.395732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:58.399128 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:58.399530 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:58.403944 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:58.404588 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:58.406646 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:58.407348 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:58.409351 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:58.410096 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:45:58.410439 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m18:45:58.410759 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:58.411849 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:45:58.412584 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m18:45:58.413058 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:58.430784 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.04s]
[0m18:45:58.431560 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:45:58.431979 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:58.432368 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m18:45:58.432913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m18:45:58.433251 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:58.436579 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:58.437551 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:58.439578 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:58.440659 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:45:58.440999 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m18:45:58.442769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:58.501656 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m18:45:58.503530 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m18:45:58.550293 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m18:45:58.551943 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m18:45:58.578450 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m18:45:58.580049 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m18:45:58.685606 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m18:45:58.687315 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m18:45:58.743795 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.99s]
[0m18:45:58.744427 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:58.744865 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:58.745294 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m18:45:58.745760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m18:45:58.746218 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:58.753098 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:58.754299 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:58.756369 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:58.757756 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:58.758164 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:58.758523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:58.802633 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.99s]
[0m18:45:58.803554 [info ] [Thread-4 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 1.04s]
[0m18:45:58.804113 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:58.804768 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:58.805276 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:58.805772 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:58.806203 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m18:45:58.807111 [info ] [Thread-4 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m18:45:58.808612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m18:45:58.809237 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m18:45:58.809688 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:58.810437 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:58.817408 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:58.821887 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:58.824132 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:58.824528 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:58.826632 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:58.828851 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:58.832777 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:58.833828 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:58.834318 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:58.834891 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:58.835559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:58.836062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:58.903980 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 1.10s]
[0m18:45:58.904622 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:58.905035 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:58.905430 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m18:45:58.905822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m18:45:58.906236 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:58.910886 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:58.912236 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:58.914301 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:58.915851 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:58.916242 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:58.916613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:59.097165 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m18:45:59.099459 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m18:45:59.102538 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m18:45:59.103387 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m18:45:59.104986 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m18:45:59.106500 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m18:45:59.180569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m18:45:59.182316 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m18:45:59.336859 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.96s]
[0m18:45:59.338369 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:45:59.338855 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:59.339653 [info ] [Thread-4 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.95s]
[0m18:45:59.340053 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m18:45:59.340772 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.95s]
[0m18:45:59.341230 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:45:59.341641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m18:45:59.342137 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:45:59.342542 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:59.342912 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:59.343349 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:59.343788 [info ] [Thread-4 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m18:45:59.351120 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:59.351529 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m18:45:59.352069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m18:45:59.352680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m18:45:59.353064 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:59.353492 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:59.353941 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:45:59.358224 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:59.363936 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:59.366186 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:59.367502 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:45:59.369528 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:59.369828 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:45:59.370545 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:45:59.372530 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:59.372931 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:59.373959 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:45:59.374263 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:45:59.374629 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:59.376011 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:45:59.376954 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:45:59.377436 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:59.379282 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:45:59.419307 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.99s]
[0m18:45:59.420109 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:45:59.420570 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:59.421002 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m18:45:59.421532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m18:45:59.421891 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:59.426524 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:59.427628 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:45:59.429605 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:59.430927 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:45:59.431312 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:59.431644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:59.822907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m18:45:59.826358 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m18:45:59.935264 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m18:45:59.938330 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m18:45:59.940104 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.181 seconds
[0m18:45:59.945224 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m18:45:59.946392 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m18:45:59.949675 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m18:46:00.086488 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m18:46:00.088354 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.18s]
[0m18:46:00.089698 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:46:00.090698 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.087926 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m18:46:00.091503 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m18:46:00.091289 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m18:46:00.094448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m18:46:00.095020 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.093835 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m18:46:00.100558 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.101873 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.104145 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.105607 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.106038 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.106411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:00.136142 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m18:46:00.137857 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m18:46:00.189472 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.38s]
[0m18:46:00.192367 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:46:00.193825 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.45s]
[0m18:46:00.194656 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.196563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m18:46:00.195618 [info ] [Thread-4 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.39s]
[0m18:46:00.196460 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:46:00.197182 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m18:46:00.198601 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m18:46:00.197918 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:46:00.198471 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.198973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m18:46:00.199429 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.199881 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m18:46:00.200462 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.200891 [info ] [Thread-4 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m18:46:00.201442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m18:46:00.205947 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.206391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m18:46:00.206782 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.207494 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.212919 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.269146 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.269872 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.272134 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.272821 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.274906 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.275240 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.277383 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.278141 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.278680 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.279124 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:46:00.279872 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.281747 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.282565 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.282868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:46:00.283322 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:46:00.284871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:46:00.304418 [info ] [Thread-4 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.95s]
[0m18:46:00.305286 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:46:00.305674 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.306102 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m18:46:00.306642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m18:46:00.306957 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.311427 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.313190 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.96s]
[0m18:46:00.313570 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:00.314030 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:46:00.316222 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.316646 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.317193 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m18:46:00.317704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m18:46:00.318063 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.322058 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.322796 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:46:00.323217 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.323663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:46:00.324695 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:00.380352 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.382157 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.04s]
[0m18:46:00.383105 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:46:00.383769 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.384586 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m18:46:00.385241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m18:46:00.385697 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.386479 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:46:00.390431 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.390861 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.391393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:46:00.393007 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:00.395311 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.396647 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:46:00.397157 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:00.397555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:46:00.441266 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.02s]
[0m18:46:00.444130 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:46:00.444565 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.444989 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m18:46:00.445556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m18:46:00.445898 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.451168 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.452285 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:00.454417 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.455577 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:46:00.455955 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:46:00.456326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:00.897835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m18:46:00.900942 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m18:46:01.065421 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m18:46:01.068687 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m18:46:01.122063 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 1.03s]
[0m18:46:01.123381 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:01.144363 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m18:46:01.147450 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m18:46:01.368325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.089 seconds
[0m18:46:01.372114 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m18:46:01.442547 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.051 seconds
[0m18:46:01.444412 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m18:46:01.457781 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.175 seconds
[0m18:46:01.459592 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m18:46:01.468747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m18:46:01.470382 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m18:46:01.494356 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 1.19s]
[0m18:46:01.495156 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:46:01.497457 [info ] [Thread-4 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 1.29s]
[0m18:46:01.498154 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:01.513225 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m18:46:01.514836 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m18:46:01.619054 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.42s]
[0m18:46:01.619687 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:01.705852 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.39s]
[0m18:46:01.707360 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:46:01.735077 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 1.35s]
[0m18:46:01.736296 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:01.754889 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 1.31s]
[0m18:46:01.755011 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 1.55s]
[0m18:46:01.756175 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:46:01.756575 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:46:01.758527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.759158 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m18:46:01.759146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.759696 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m18:46:01.759807 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m18:46:01.760249 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m18:46:01.760369 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m18:46:01.760761 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m18:46:01.760882 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m18:46:01.761393 [info ] [MainThread]: 
[0m18:46:01.761507 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m18:46:01.762171 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m18:46:01.762269 [info ] [MainThread]: 
[0m18:46:01.762944 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m18:46:01.765463 [debug] [MainThread]: Command end result
[0m18:46:01.766050 [debug] [MainThread]: Command end result
[0m18:46:01.808125 [info ] [MainThread]: 
[0m18:46:01.808611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:01.808555 [info ] [MainThread]: 
[0m18:46:01.809031 [info ] [MainThread]: 
[0m18:46:01.809242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:01.809459 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m18:46:01.809703 [info ] [MainThread]: 
[0m18:46:01.810172 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m18:46:01.810307 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.5432854, "process_user_time": 3.888758, "process_kernel_time": 0.205208, "process_mem_max_rss": "213828", "process_in_blocks": "1120", "process_out_blocks": "2791"}
[0m18:46:01.810798 [debug] [MainThread]: Command `dbt test` succeeded at 18:46:01.810722 after 7.54 seconds
[0m18:46:01.810950 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.676619, "process_user_time": 3.902446, "process_kernel_time": 0.202008, "process_mem_max_rss": "213700", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m18:46:01.811173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c4a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d088f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d09310>]}
[0m18:46:01.811415 [debug] [MainThread]: Command `dbt test` succeeded at 18:46:01.811335 after 6.68 seconds
[0m18:46:01.811528 [debug] [MainThread]: Flushing usage events
[0m18:46:01.811805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db83b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c9bffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6df467b0>]}
[0m18:46:01.812177 [debug] [MainThread]: Flushing usage events
[0m18:49:03.949202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ab1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb061ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb146d3a0>]}


============================== 18:49:03.954773 | 84854a71-de6d-4bd2-ac21-a3780818131c ==============================
[0m18:49:03.954773 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:49:03.955484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:49:04.562946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49baf90>]}
[0m18:49:04.602214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb995b0>]}
[0m18:49:04.602852 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:49:04.675384 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:49:04.808635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:04.809037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:04.848973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b75be0>]}
[0m18:49:04.949910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a1bc80>]}
[0m18:49:04.950365 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:49:04.950947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945aeb70>]}
[0m18:49:04.952745 [info ] [MainThread]: 
[0m18:49:04.953344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:04.954160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:49:04.965456 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:49:04.965825 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:49:04.966126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:05.963033 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.997 seconds
[0m18:49:05.964576 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:49:06.174873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m18:49:06.175675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:49:06.182102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m18:49:06.184975 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:49:06.187928 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:49:06.189648 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:49:06.190056 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:49:06.190394 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:49:06.190713 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:49:06.191035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:06.191317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:06.191616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:06.856663 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.665 seconds
[0m18:49:06.858445 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.667 seconds
[0m18:49:06.861933 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:49:06.864940 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:49:06.870056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.678 seconds
[0m18:49:06.872878 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:49:07.100147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b4ecf0>]}
[0m18:49:07.101390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:07.101973 [info ] [MainThread]: 
[0m18:49:07.114771 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m18:49:07.115525 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m18:49:07.116371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m18:49:07.116932 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m18:49:07.125560 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m18:49:07.166533 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:07.166942 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:49:07.167310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:07.703119 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.535 seconds
[0m18:49:07.750264 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:07.750824 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:49:09.448220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.696 seconds
[0m18:49:09.455750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:09.456732 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:49:09.605276 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.148 seconds
[0m18:49:09.610793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:09.611333 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:49:09.750858 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.139 seconds
[0m18:49:09.759024 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:09.759709 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:49:09.939464 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.179 seconds
[0m18:49:09.947213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:09.947875 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m18:49:10.111759 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.163 seconds
[0m18:49:10.125309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:10.125983 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m18:49:10.263774 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.137 seconds
[0m18:49:10.287057 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:10.287591 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:49:10.674637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.386 seconds
[0m18:49:10.685065 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:10.685725 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:49:10.815937 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m18:49:10.817393 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m18:49:10.821026 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:10.821837 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m18:49:11.121884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m18:49:11.123181 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:11.124092 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:49:11.827190 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.702 seconds
[0m18:49:11.828225 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m18:49:11.828880 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m18:49:12.311798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m18:49:12.331432 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m18:49:12.552256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84854a71-de6d-4bd2-ac21-a3780818131c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b16ab0>]}
[0m18:49:12.554365 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.43s]
[0m18:49:12.556081 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m18:49:12.558327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:12.558944 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m18:49:12.559413 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m18:49:12.559914 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m18:49:12.560541 [info ] [MainThread]: 
[0m18:49:12.561397 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m18:49:12.562286 [debug] [MainThread]: Command end result
[0m18:49:12.604602 [info ] [MainThread]: 
[0m18:49:12.605162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:12.605512 [info ] [MainThread]: 
[0m18:49:12.605839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:49:12.606549 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.692749, "process_user_time": 3.581437, "process_kernel_time": 0.184486, "process_mem_max_rss": "211624", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m18:49:12.607008 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:49:12.606916 after 8.69 seconds
[0m18:49:12.607364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945a2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17f4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9317a510>]}
[0m18:49:12.607718 [debug] [MainThread]: Flushing usage events
[0m18:49:15.914949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fab64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7feddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fab66c0>]}


============================== 18:49:15.920607 | 4595f295-e593-4cd3-89c3-49855d66d675 ==============================
[0m18:49:15.920607 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:49:15.921314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:49:16.530343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7feddc10>]}
[0m18:49:16.569903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cb6360>]}
[0m18:49:16.570606 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:49:16.643756 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:49:16.776974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:16.777368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:16.817146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64340500>]}
[0m18:49:16.917021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff636dfce0>]}
[0m18:49:16.917498 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:49:16.918036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64340500>]}
[0m18:49:16.920029 [info ] [MainThread]: 
[0m18:49:16.920669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:16.924526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:49:16.931748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m18:49:16.936600 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:49:16.938878 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m18:49:16.939268 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:49:16.939702 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m18:49:16.940073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:16.940409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:17.549783 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.609 seconds
[0m18:49:17.551338 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.611 seconds
[0m18:49:17.554672 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:49:17.557036 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m18:49:17.774210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m18:49:17.775678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m18:49:17.791048 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:49:17.788430 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:49:17.791825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:49:17.792248 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:49:17.792838 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:49:17.795050 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:49:17.795561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:17.796007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:17.796449 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:49:17.799996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:18.441823 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.646 seconds
[0m18:49:18.446963 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:49:18.450429 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.650 seconds
[0m18:49:18.454328 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:49:18.457712 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.662 seconds
[0m18:49:18.460574 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:49:18.670439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f274230>]}
[0m18:49:18.671470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:18.672506 [info ] [MainThread]: 
[0m18:49:18.683416 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m18:49:18.683884 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m18:49:18.684275 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m18:49:18.684815 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m18:49:18.685256 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m18:49:18.685695 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m18:49:18.686355 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m18:49:18.687330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m18:49:18.687722 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m18:49:18.688159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m18:49:18.688582 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m18:49:18.688958 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m18:49:18.689398 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m18:49:18.689761 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m18:49:18.690127 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m18:49:18.695727 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m18:49:18.696115 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m18:49:18.698441 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m18:49:18.700673 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:49:18.702982 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m18:49:18.703941 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m18:49:18.727730 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m18:49:18.728172 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m18:49:18.728521 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m18:49:18.729114 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m18:49:18.751810 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m18:49:18.752311 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m18:49:18.754525 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m18:49:18.755405 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m18:49:18.756142 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m18:49:18.756748 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m18:49:18.757108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:18.757796 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m18:49:18.758128 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m18:49:18.758703 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m18:49:18.760249 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m18:49:18.760662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:18.761130 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m18:49:18.761516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:18.762666 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:49:19.591281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m18:49:19.593707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m18:49:19.608719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m18:49:19.624758 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m18:49:19.626594 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m18:49:19.628371 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m18:49:19.830315 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b26690>]}
[0m18:49:19.832923 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.14s]
[0m18:49:19.834720 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m18:49:19.835537 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m18:49:19.836871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63545e50>]}
[0m18:49:19.838350 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63e6f9e0>]}
[0m18:49:19.839123 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m18:49:19.840158 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.15s]
[0m18:49:19.841168 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.15s]
[0m18:49:19.841932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m18:49:19.842685 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m18:49:19.843350 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m18:49:19.843866 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m18:49:19.844449 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m18:49:19.845047 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m18:49:19.848790 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m18:49:19.849444 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m18:49:19.850076 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m18:49:19.850886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m18:49:19.851410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m18:49:19.851845 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m18:49:19.852381 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m18:49:19.852749 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m18:49:19.855329 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m18:49:19.857918 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m18:49:19.861773 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m18:49:19.863295 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m18:49:19.865684 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m18:49:19.866013 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m18:49:19.866621 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m18:49:19.868758 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m18:49:19.869138 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m18:49:19.869784 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m18:49:19.870187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:19.870566 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m18:49:19.872119 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:19.872633 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m18:49:19.873940 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m18:49:19.874359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:20.159111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m18:49:20.163826 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m18:49:20.387811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b8bfe0>]}
[0m18:49:20.389686 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.70s]
[0m18:49:20.391656 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m18:49:20.392464 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m18:49:20.393293 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m18:49:20.394842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m18:49:20.395712 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m18:49:20.413530 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m18:49:20.414962 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m18:49:20.417318 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m18:49:20.419190 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m18:49:20.419626 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m18:49:20.420060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:20.652377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m18:49:20.653587 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m18:49:20.656850 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m18:49:20.659691 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m18:49:20.874891 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6358e2a0>]}
[0m18:49:20.876417 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff634a8e90>]}
[0m18:49:20.877190 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.03s]
[0m18:49:20.877839 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:49:20.878583 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m18:49:20.879158 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m18:49:20.879696 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m18:49:20.880401 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m18:49:20.880985 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m18:49:20.881610 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m18:49:20.882060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m18:49:20.882519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m18:49:20.882953 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m18:49:20.883369 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m18:49:20.887463 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:49:20.890508 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m18:49:20.891890 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m18:49:20.892196 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m18:49:20.895594 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m18:49:20.897757 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m18:49:20.899300 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m18:49:20.899878 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m18:49:20.900208 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m18:49:20.900604 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m18:49:20.900977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:20.901313 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:20.963754 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m18:49:20.965883 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m18:49:21.270644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63552f30>]}
[0m18:49:21.271835 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.42s]
[0m18:49:21.273138 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m18:49:21.274147 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m18:49:21.274962 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m18:49:21.275929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m18:49:21.276509 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m18:49:21.281211 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m18:49:21.282997 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m18:49:21.285810 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m18:49:21.292305 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m18:49:21.292708 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m18:49:21.293046 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:22.042791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.622 seconds
[0m18:49:22.048074 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m18:49:22.267015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63547e60>]}
[0m18:49:22.268742 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.87s]
[0m18:49:22.270705 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m18:49:22.272023 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m18:49:22.272981 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m18:49:22.274333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m18:49:22.274964 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m18:49:22.284089 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m18:49:22.285817 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m18:49:22.289134 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m18:49:22.292070 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m18:49:22.292599 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m18:49:22.293088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:22.452614 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.551 seconds
[0m18:49:22.456050 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m18:49:22.478396 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.577 seconds
[0m18:49:22.481271 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m18:49:22.687918 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62bbe4e0>]}
[0m18:49:22.689287 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.81s]
[0m18:49:22.691095 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m18:49:22.693133 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62bc7ce0>]}
[0m18:49:22.694140 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.81s]
[0m18:49:22.695267 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m18:49:23.093530 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m18:49:23.098069 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m18:49:23.308516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62bb7290>]}
[0m18:49:23.310126 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 2.03s]
[0m18:49:23.311454 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m18:49:24.705782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.412 seconds
[0m18:49:24.711206 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m18:49:24.928978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4595f295-e593-4cd3-89c3-49855d66d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62babd10>]}
[0m18:49:24.930564 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.65s]
[0m18:49:24.931943 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m18:49:24.934415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:24.935026 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m18:49:24.935601 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m18:49:24.936099 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m18:49:24.936491 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m18:49:24.937042 [info ] [MainThread]: 
[0m18:49:24.937675 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m18:49:24.939796 [debug] [MainThread]: Command end result
[0m18:49:25.047977 [info ] [MainThread]: 
[0m18:49:25.048559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:25.048877 [info ] [MainThread]: 
[0m18:49:25.049242 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:49:25.049964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.170104, "process_user_time": 4.046004, "process_kernel_time": 0.211581, "process_mem_max_rss": "212912", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m18:49:25.050436 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:25.050338 after 9.17 seconds
[0m18:49:25.050830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65698710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d49550>]}
[0m18:49:25.051213 [debug] [MainThread]: Flushing usage events
[0m18:49:28.129075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab489370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab41bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab48a540>]}


============================== 18:49:28.134817 | 21034fe6-6720-4100-8362-014e23d108e1 ==============================
[0m18:49:28.134817 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:49:28.135503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:28.742160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95749700>]}
[0m18:49:28.781576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9cf4a0>]}
[0m18:49:28.782197 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:49:28.855142 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:49:28.999855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:29.000268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:29.041241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957a90d0>]}
[0m18:49:29.150026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eff0110>]}
[0m18:49:29.150518 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m18:49:29.151087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efd2fc0>]}
[0m18:49:29.153192 [info ] [MainThread]: 
[0m18:49:29.153774 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:29.157616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m18:49:29.158089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m18:49:29.170668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m18:49:29.171300 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m18:49:29.173027 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m18:49:29.174893 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m18:49:29.175263 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m18:49:29.175630 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m18:49:29.176030 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m18:49:29.176359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:29.176675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:29.176977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:30.004588 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.827 seconds
[0m18:49:30.007084 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m18:49:30.010886 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.833 seconds
[0m18:49:30.012813 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m18:49:30.016086 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.839 seconds
[0m18:49:30.017676 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m18:49:30.233862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21034fe6-6720-4100-8362-014e23d108e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4842f0>]}
[0m18:49:30.235120 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:30.236489 [info ] [MainThread]: 
[0m18:49:30.249993 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:49:30.250495 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:49:30.250914 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:49:30.251340 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m18:49:30.251781 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:49:30.252146 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m18:49:30.252674 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m18:49:30.253279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m18:49:30.253731 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m18:49:30.254212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m18:49:30.254695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m18:49:30.255124 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:49:30.255675 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m18:49:30.256079 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:49:30.256506 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:49:30.270239 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:49:30.270577 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:49:30.273764 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:49:30.277935 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:49:30.281241 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:49:30.282257 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:49:30.297764 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:49:30.298173 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:49:30.298705 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:49:30.300670 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:49:30.301056 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:49:30.302985 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:49:30.303804 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m18:49:30.305774 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:49:30.306387 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m18:49:30.306954 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m18:49:30.307516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:30.308164 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m18:49:30.308480 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m18:49:30.309669 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m18:49:30.310412 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m18:49:30.310965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:30.311338 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m18:49:30.311771 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:49:30.313106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:31.065852 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m18:49:31.078864 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m18:49:31.091821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m18:49:31.093943 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m18:49:31.116166 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m18:49:31.118064 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m18:49:31.119314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.808 seconds
[0m18:49:31.122478 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m18:49:31.291580 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.04s]
[0m18:49:31.293730 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m18:49:31.294546 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:49:31.295299 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m18:49:31.296207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m18:49:31.297272 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:49:31.303755 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:49:31.305554 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:49:31.310246 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:49:31.312218 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m18:49:31.313465 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m18:49:31.313108 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.06s]
[0m18:49:31.313924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:31.314498 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m18:49:31.316379 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:49:31.317050 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m18:49:31.317818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m18:49:31.318258 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:49:31.320033 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.07s]
[0m18:49:31.323432 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:49:31.324028 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m18:49:31.324752 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.07s]
[0m18:49:31.325342 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:49:31.325842 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m18:49:31.326282 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m18:49:31.326895 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:49:31.327174 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:49:31.327604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m18:49:31.328006 [info ] [Thread-4 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m18:49:31.330016 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:49:31.330367 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:49:31.330715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m18:49:31.334149 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:49:31.334562 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:49:31.337897 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:49:31.338466 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m18:49:31.338968 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m18:49:31.339385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:31.339682 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:49:31.342744 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:49:31.343044 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:49:31.345270 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:49:31.346156 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m18:49:31.346692 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m18:49:31.347209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:31.347742 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m18:49:31.349052 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m18:49:31.349648 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:31.948964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m18:49:31.954047 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m18:49:31.955386 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m18:49:31.959441 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m18:49:31.990292 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m18:49:31.992808 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m18:49:31.995740 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m18:49:31.998585 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m18:49:32.189717 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.86s]
[0m18:49:32.191602 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m18:49:32.192348 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:49:32.192994 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m18:49:32.194081 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.90s]
[0m18:49:32.195178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m18:49:32.196561 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m18:49:32.197202 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:49:32.197846 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:49:32.198807 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.88s]
[0m18:49:32.208160 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:49:32.208632 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m18:49:32.209604 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m18:49:32.210391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m18:49:32.211218 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.88s]
[0m18:49:32.211687 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:49:32.212090 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:49:32.212475 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:49:32.212873 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m18:49:32.213255 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m18:49:32.217947 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:49:32.221492 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:49:32.221951 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:49:32.222368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m18:49:32.223238 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m18:49:32.223793 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:49:32.224140 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:49:32.224493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m18:49:32.225348 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m18:49:32.229604 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:49:32.231697 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:49:32.232065 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:49:32.232455 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:32.237285 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:49:32.237880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:32.238279 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:49:32.239204 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m18:49:32.242511 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:49:32.242980 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:32.243327 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:49:32.243835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:32.245979 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:49:32.248276 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m18:49:32.248699 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:32.249109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:32.250408 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m18:49:32.251147 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:32.251728 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:32.915675 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m18:49:32.920775 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m18:49:33.082463 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m18:49:33.086077 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m18:49:33.087751 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.839 seconds
[0m18:49:33.092365 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m18:49:33.127413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m18:49:33.130726 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m18:49:33.136071 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.91s]
[0m18:49:33.137298 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m18:49:33.137931 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:49:33.138559 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m18:49:33.139279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m18:49:33.139751 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:49:33.145469 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:49:33.146914 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:49:33.149350 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:49:33.150844 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m18:49:33.151245 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:33.151674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:33.422373 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.23s]
[0m18:49:33.425335 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.21s]
[0m18:49:33.426424 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m18:49:33.427371 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m18:49:33.428384 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:49:33.430180 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.21s]
[0m18:49:33.430926 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:49:33.431872 [info ] [Thread-2 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m18:49:33.432972 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m18:49:33.433673 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m18:49:33.434535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m18:49:33.435348 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:49:33.436011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m18:49:33.436601 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:49:33.437174 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m18:49:33.437819 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:49:33.445254 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:49:33.445807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m18:49:33.498054 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:49:33.498690 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:49:33.503893 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:49:33.504440 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:49:33.506784 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:49:33.507141 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:49:33.507657 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:49:33.509535 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:49:33.511618 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:49:33.512602 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m18:49:33.513112 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:33.513488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:33.514849 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m18:49:33.516092 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m18:49:33.516604 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:49:33.517023 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:49:33.517387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:33.517709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:33.933554 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m18:49:33.936765 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m18:49:34.143137 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 1.00s]
[0m18:49:34.145665 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m18:49:34.163642 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m18:49:34.168134 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m18:49:34.231946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m18:49:34.233669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m18:49:34.237381 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m18:49:34.240103 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m18:49:34.371355 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.92s]
[0m18:49:34.373560 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m18:49:34.446045 [info ] [Thread-2 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.01s]
[0m18:49:34.448134 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 1.01s]
[0m18:49:34.449551 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m18:49:34.450653 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m18:49:34.453762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:34.454323 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m18:49:34.455030 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m18:49:34.455579 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m18:49:34.456030 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m18:49:34.456595 [info ] [MainThread]: 
[0m18:49:34.457396 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m18:49:34.460505 [debug] [MainThread]: Command end result
[0m18:49:34.504702 [info ] [MainThread]: 
[0m18:49:34.505298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:34.505693 [info ] [MainThread]: 
[0m18:49:34.506079 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m18:49:34.506791 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.4122944, "process_user_time": 4.04019, "process_kernel_time": 0.193012, "process_mem_max_rss": "214080", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m18:49:34.507271 [debug] [MainThread]: Command `dbt test` succeeded at 18:49:34.507162 after 6.41 seconds
[0m18:49:34.507630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba57e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac75df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac76360>]}
[0m18:49:34.507969 [debug] [MainThread]: Flushing usage events
[0m21:15:59.687920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8725760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c0d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8098410>]}


============================== 21:15:59.693836 | 8c482bb8-853a-4a00-89c6-5ca2b79316b0 ==============================
[0m21:15:59.693836 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:15:59.694369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:15:59.795017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c482bb8-853a-4a00-89c6-5ca2b79316b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ffa600>]}
[0m21:15:59.951660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yz3a2dz0'
[0m21:15:59.952538 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:16:00.090942 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:16:00.092296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:16:00.164113 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:16:00.167717 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:16:00.891851 [info ] [MainThread]: Installed from version 1.3.0
[0m21:16:00.908565 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:16:00.911147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8c482bb8-853a-4a00-89c6-5ca2b79316b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82b6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b0f7d0>]}
[0m21:16:00.911641 [info ] [MainThread]: 
[0m21:16:00.919582 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:16:00.925194 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2738048, "process_user_time": 1.744054, "process_kernel_time": 0.169393, "process_mem_max_rss": "164140", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m21:16:00.925907 [debug] [MainThread]: Command `dbt deps` succeeded at 21:16:00.925801 after 1.27 seconds
[0m21:16:00.927588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8326180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbd8e0>]}
[0m21:16:00.928129 [debug] [MainThread]: Flushing usage events
[0m21:16:03.502420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abf1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c32ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a374e60>]}


============================== 21:16:03.508139 | 2958abe7-3c0e-4e5a-9bff-c17c4162dfe5 ==============================
[0m21:16:03.508139 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:16:03.508886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:04.142266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eaa4d10>]}
[0m21:16:04.181331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b390410>]}
[0m21:16:04.181953 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:16:04.254322 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:16:04.396426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:04.396829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:04.436526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ebdbda0>]}
[0m21:16:04.538203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4a6330>]}
[0m21:16:04.538656 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:16:04.539235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4a6ea0>]}
[0m21:16:04.541007 [info ] [MainThread]: 
[0m21:16:04.541644 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:04.542451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:16:04.553719 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:16:04.554091 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:16:04.554392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:05.822468 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.268 seconds
[0m21:16:05.825278 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:16:06.040362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m21:16:06.047562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:16:06.047309 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:16:06.050472 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:16:06.050887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:16:06.051314 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:16:06.051722 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:16:06.053528 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:16:06.053950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:06.054293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:06.054620 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:16:06.057592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:06.687748 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.633 seconds
[0m21:16:06.692451 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:16:06.697562 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.644 seconds
[0m21:16:06.700338 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:16:06.701603 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.644 seconds
[0m21:16:06.705343 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:16:06.915200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ea47020>]}
[0m21:16:06.915873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:06.916480 [info ] [MainThread]: 
[0m21:16:06.924500 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m21:16:06.924990 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m21:16:06.925547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m21:16:06.925933 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m21:16:06.932626 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m21:16:06.973031 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:06.973435 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:16:06.973781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:07.490457 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.516 seconds
[0m21:16:07.529580 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:07.530107 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m21:16:10.225630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.695 seconds
[0m21:16:10.233028 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:10.233795 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:16:10.376145 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.141 seconds
[0m21:16:10.384282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:10.385164 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:16:10.526298 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.140 seconds
[0m21:16:10.535563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:10.536746 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:16:10.671140 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.133 seconds
[0m21:16:10.679829 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:10.680895 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:16:10.837640 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.156 seconds
[0m21:16:10.846537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:10.847041 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:16:11.006864 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.159 seconds
[0m21:16:11.035734 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:11.036538 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m21:16:11.292397 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.255 seconds
[0m21:16:11.304109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:11.305000 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:16:11.498047 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.192 seconds
[0m21:16:11.500047 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m21:16:11.503802 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:11.504945 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m21:16:11.690614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m21:16:11.692742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:11.693752 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:16:12.479095 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.784 seconds
[0m21:16:12.481297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:16:12.482543 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m21:16:13.095749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m21:16:13.127274 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m21:16:13.333172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2958abe7-3c0e-4e5a-9bff-c17c4162dfe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ea0ad20>]}
[0m21:16:13.335168 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 6.40s]
[0m21:16:13.337157 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m21:16:13.339918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:13.340543 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m21:16:13.341146 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m21:16:13.341608 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m21:16:13.342203 [info ] [MainThread]: 
[0m21:16:13.343151 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m21:16:13.344171 [debug] [MainThread]: Command end result
[0m21:16:13.386416 [info ] [MainThread]: 
[0m21:16:13.387008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:13.387402 [info ] [MainThread]: 
[0m21:16:13.387729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:16:13.388445 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.921404, "process_user_time": 3.581662, "process_kernel_time": 0.220732, "process_mem_max_rss": "211836", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m21:16:13.388916 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:16:13.388823 after 9.92 seconds
[0m21:16:13.389296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac6f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ebdbda0>]}
[0m21:16:13.389642 [debug] [MainThread]: Flushing usage events
[0m21:16:16.953466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b2ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cf0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967efb90>]}


============================== 21:16:16.959178 | ee4ee681-1acb-42d3-b89c-c0e1d77696ce ==============================
[0m21:16:16.959178 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:16:16.959893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:17.579991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3f3350>]}
[0m21:16:17.619514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a527d40>]}
[0m21:16:17.620173 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:16:17.692848 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:16:17.826606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:17.827019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:17.867218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a221bb0>]}
[0m21:16:17.976757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a254800>]}
[0m21:16:17.977913 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:16:17.978685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79db4050>]}
[0m21:16:17.980938 [info ] [MainThread]: 
[0m21:16:17.981603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:17.985688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:16:17.986291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:16:18.005230 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:16:18.005690 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:16:18.006085 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:16:18.006480 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:16:18.006882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:18.007200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:18.756406 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.749 seconds
[0m21:16:18.757714 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.751 seconds
[0m21:16:18.760010 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:16:18.762005 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:16:19.077165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m21:16:19.078492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m21:16:19.091811 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:16:19.094627 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:16:19.095219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:16:19.095736 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:16:19.096234 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:16:19.098478 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:16:19.098885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:19.099298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:19.099681 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:16:19.102921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:19.852820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.750 seconds
[0m21:16:19.857363 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:16:19.859454 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.760 seconds
[0m21:16:19.862593 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.763 seconds
[0m21:16:19.866334 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:16:19.868870 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:16:20.070086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e329f0>]}
[0m21:16:20.070698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:20.071296 [info ] [MainThread]: 
[0m21:16:20.079193 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m21:16:20.079553 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m21:16:20.079895 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m21:16:20.080326 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m21:16:20.080701 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m21:16:20.081093 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m21:16:20.081555 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m21:16:20.082456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m21:16:20.082866 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m21:16:20.083326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m21:16:20.083735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m21:16:20.084124 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m21:16:20.084617 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m21:16:20.084966 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m21:16:20.085334 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m21:16:20.090518 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m21:16:20.090903 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m21:16:20.093165 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m21:16:20.095293 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:16:20.097608 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m21:16:20.098581 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m21:16:20.122264 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m21:16:20.122795 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m21:16:20.123206 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m21:16:20.129429 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m21:16:20.142847 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:16:20.143898 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m21:16:20.146185 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m21:16:20.147350 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m21:16:20.147927 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m21:16:20.148382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:20.149720 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m21:16:20.150917 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m21:16:20.151276 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m21:16:20.151950 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m21:16:20.152343 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m21:16:20.152690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:20.153021 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m21:16:20.153432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:16:20.154779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:20.940322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m21:16:20.941372 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m21:16:20.966807 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m21:16:20.968260 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m21:16:21.009970 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m21:16:21.012114 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m21:16:21.195660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a35ac90>]}
[0m21:16:21.196927 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d12e40>]}
[0m21:16:21.197778 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.11s]
[0m21:16:21.199006 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.11s]
[0m21:16:21.199859 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m21:16:21.200558 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m21:16:21.201176 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m21:16:21.201801 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m21:16:21.202755 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m21:16:21.203465 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m21:16:21.204118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m21:16:21.204584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m21:16:21.205008 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m21:16:21.205429 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m21:16:21.208836 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m21:16:21.210713 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7894f4a0>]}
[0m21:16:21.213082 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m21:16:21.213829 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.13s]
[0m21:16:21.214885 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m21:16:21.215378 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m21:16:21.215935 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m21:16:21.216614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m21:16:21.216973 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m21:16:21.217295 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m21:16:21.217584 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m21:16:21.220054 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m21:16:21.223592 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m21:16:21.225695 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m21:16:21.227466 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m21:16:21.227987 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m21:16:21.228300 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m21:16:21.228611 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m21:16:21.228964 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m21:16:21.231089 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m21:16:21.231443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:21.231759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:21.234938 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m21:16:21.235323 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m21:16:21.235591 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:21.511609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.363 seconds
[0m21:16:21.514986 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m21:16:21.751099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79387080>]}
[0m21:16:21.752761 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.67s]
[0m21:16:21.754806 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m21:16:21.755469 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m21:16:21.756173 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m21:16:21.757461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m21:16:21.758180 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m21:16:21.775172 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m21:16:21.776388 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m21:16:21.778615 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m21:16:21.780284 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m21:16:21.780652 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m21:16:21.780975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:22.008972 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m21:16:22.012261 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m21:16:22.015038 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m21:16:22.018183 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m21:16:22.018974 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m21:16:22.021867 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m21:16:22.219193 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793fe570>]}
[0m21:16:22.220851 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.01s]
[0m21:16:22.222818 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m21:16:22.223582 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m21:16:22.224388 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m21:16:22.225999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.fact_inventory_snapshot)
[0m21:16:22.226691 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m21:16:22.233615 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:16:22.235297 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m21:16:22.240085 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:16:22.242232 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m21:16:22.242706 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m21:16:22.243603 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789c7980>]}
[0m21:16:22.243966 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:22.244618 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.03s]
[0m21:16:22.246953 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m21:16:22.247443 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m21:16:22.248125 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m21:16:22.248679 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m21:16:22.249016 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m21:16:22.252209 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m21:16:22.254251 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793fc590>]}
[0m21:16:22.255027 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:16:22.256218 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m21:16:22.256713 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m21:16:22.257018 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m21:16:22.257468 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m21:16:22.259785 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m21:16:22.260176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_store)
[0m21:16:22.260662 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m21:16:22.263549 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m21:16:22.264392 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m21:16:22.264722 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m21:16:22.265049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:22.265452 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m21:16:22.268584 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m21:16:22.270010 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m21:16:22.270403 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m21:16:22.270809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:23.278780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.498 seconds
[0m21:16:23.282106 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m21:16:23.512275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78925190>]}
[0m21:16:23.514036 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.75s]
[0m21:16:23.516135 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m21:16:23.517312 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m21:16:23.518034 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m21:16:23.519039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m21:16:23.519586 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m21:16:23.529512 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m21:16:23.531277 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m21:16:23.534432 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m21:16:23.537442 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m21:16:23.537919 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m21:16:23.538401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:23.910233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m21:16:23.912488 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m21:16:23.916736 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m21:16:23.917932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.653 seconds
[0m21:16:23.920686 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m21:16:23.923630 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m21:16:24.126763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789d30e0>]}
[0m21:16:24.128567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793bb890>]}
[0m21:16:24.129880 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793a38f0>]}
[0m21:16:24.131078 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.90s]
[0m21:16:24.132774 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.87s]
[0m21:16:24.133607 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.88s]
[0m21:16:24.134543 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m21:16:24.135139 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m21:16:24.135637 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m21:16:26.094926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.556 seconds
[0m21:16:26.096887 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m21:16:26.305738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4ee681-1acb-42d3-b89c-c0e1d77696ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789fbe60>]}
[0m21:16:26.307897 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.79s]
[0m21:16:26.310026 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m21:16:26.312829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:26.313472 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m21:16:26.313913 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m21:16:26.314651 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m21:16:26.315308 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m21:16:26.316022 [info ] [MainThread]: 
[0m21:16:26.316947 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m21:16:26.319696 [debug] [MainThread]: Command end result
[0m21:16:26.429296 [info ] [MainThread]: 
[0m21:16:26.429930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:26.430333 [info ] [MainThread]: 
[0m21:16:26.430782 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:16:26.431579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.513138, "process_user_time": 4.268523, "process_kernel_time": 0.206003, "process_mem_max_rss": "212600", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m21:16:26.432033 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:26.431962 after 9.51 seconds
[0m21:16:26.432382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a023f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9898e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7937e1b0>]}
[0m21:16:26.432712 [debug] [MainThread]: Flushing usage events
[0m21:16:29.850776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4dd7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e4ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36c1580>]}


============================== 21:16:29.856523 | bfd517cf-738d-4182-81d8-f1d26ba16b2e ==============================
[0m21:16:29.856523 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:16:29.857271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:30.474353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8817a600>]}
[0m21:16:30.513593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87888b30>]}
[0m21:16:30.514236 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:16:30.587175 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:16:30.721129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:30.721588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:30.761006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7215df0>]}
[0m21:16:30.869507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f67bc0>]}
[0m21:16:30.870021 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:16:30.870616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8738fc80>]}
[0m21:16:30.872743 [info ] [MainThread]: 
[0m21:16:30.873378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:30.877244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:16:30.877782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:16:30.892279 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:16:30.890562 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:16:30.892737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:16:30.893025 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:16:30.893435 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:16:30.895225 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:16:30.895588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:30.895928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:30.896253 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:16:30.899803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:31.758981 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.859 seconds
[0m21:16:31.761057 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.865 seconds
[0m21:16:31.764558 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:16:31.767571 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:16:31.769119 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.873 seconds
[0m21:16:31.775942 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:16:32.005635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd517cf-738d-4182-81d8-f1d26ba16b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e35460>]}
[0m21:16:32.006829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:32.007455 [info ] [MainThread]: 
[0m21:16:32.018648 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:16:32.019511 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:16:32.019939 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:16:32.020318 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m21:16:32.020760 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:16:32.021190 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m21:16:32.021682 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m21:16:32.022297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m21:16:32.022837 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m21:16:32.023436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m21:16:32.023972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m21:16:32.024448 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:16:32.024983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m21:16:32.025617 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:16:32.026000 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:16:32.039686 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:16:32.040017 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:16:32.043167 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:16:32.047390 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:16:32.050717 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:16:32.051746 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:16:32.068053 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:16:32.068759 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:16:32.069093 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:16:32.069411 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:16:32.071348 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:16:32.073291 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:16:32.075364 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:16:32.076005 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:16:32.076894 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m21:16:32.077327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:32.078017 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:16:32.079149 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:16:32.080130 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:16:32.080708 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m21:16:32.081232 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m21:16:32.081746 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m21:16:32.082213 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:32.082647 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:16:32.082991 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:32.778296 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m21:16:32.793873 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m21:16:32.813402 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m21:16:32.816161 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m21:16:32.839493 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m21:16:32.841889 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m21:16:32.855690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m21:16:32.857721 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m21:16:32.998222 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.97s]
[0m21:16:32.999883 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:16:33.000891 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:16:33.001703 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m21:16:33.002497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m21:16:33.003070 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:16:33.010700 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:16:33.012725 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:16:33.017640 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:16:33.019826 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:16:33.020718 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.00s]
[0m21:16:33.021141 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m21:16:33.021851 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:16:33.022358 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:33.022852 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:16:33.024807 [info ] [Thread-2 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m21:16:33.025391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m21:16:33.025871 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:16:33.029595 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:16:33.030577 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:16:33.032654 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:16:33.033782 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:16:33.034135 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m21:16:33.034508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:33.046677 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.02s]
[0m21:16:33.047286 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:16:33.047723 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:16:33.048139 [info ] [Thread-3 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m21:16:33.048605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m21:16:33.048964 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:16:33.052321 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:16:33.053310 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:16:33.055288 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:16:33.056365 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:16:33.056727 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m21:16:33.057112 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:33.079094 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.06s]
[0m21:16:33.079630 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:16:33.080026 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:16:33.080403 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m21:16:33.080801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m21:16:33.081137 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:16:33.084408 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:16:33.085287 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:16:33.087315 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:16:33.088364 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:16:33.088656 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m21:16:33.088920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:33.568009 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m21:16:33.572975 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m21:16:33.599722 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:16:33.603687 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m21:16:33.645743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:16:33.649627 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m21:16:33.666730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m21:16:33.669311 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m21:16:33.802451 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.80s]
[0m21:16:33.803832 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:16:33.804672 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:16:33.805422 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m21:16:33.806370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m21:16:33.807729 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:16:33.811862 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.79s]
[0m21:16:33.820474 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:16:33.822428 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:16:33.822943 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:16:33.823673 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m21:16:33.824248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m21:16:33.824750 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:16:33.830117 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:16:33.830522 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:16:33.834656 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:16:33.835473 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:16:33.837675 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:16:33.838619 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:16:33.839007 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:33.839380 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:33.840194 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:16:33.840980 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:33.841693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:33.860319 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.81s]
[0m21:16:33.860862 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:16:33.861247 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:16:33.861602 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m21:16:33.861977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m21:16:33.862322 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:16:33.866831 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:16:33.867831 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:16:33.869440 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.79s]
[0m21:16:33.871524 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:16:33.872011 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:16:33.872559 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:16:33.872860 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m21:16:33.873210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m21:16:33.873502 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:16:33.878140 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:16:33.879105 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:16:33.879560 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:33.880002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:33.880336 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:16:33.883333 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:16:33.884656 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:16:33.885021 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:33.885355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:34.557563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m21:16:34.561383 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m21:16:34.599303 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m21:16:34.602035 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m21:16:34.608756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m21:16:34.611045 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m21:16:34.678504 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m21:16:34.682099 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m21:16:34.768100 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.89s]
[0m21:16:34.769456 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:16:34.770191 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:16:34.770792 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m21:16:34.771437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m21:16:34.772109 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:16:34.779574 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:16:34.782622 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:16:34.785532 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:16:34.787242 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:16:34.787843 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:34.788320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:34.812890 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.01s]
[0m21:16:34.813567 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:16:34.814715 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.99s]
[0m21:16:34.815163 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:16:34.815703 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:16:34.816102 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m21:16:34.816567 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:16:34.816972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m21:16:34.817349 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m21:16:34.817743 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:16:34.818133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m21:16:34.822365 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:16:34.822754 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:16:34.828333 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:16:34.829082 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:16:34.877914 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:16:34.878352 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:16:34.880509 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:16:34.881930 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:16:34.882417 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:34.884168 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.02s]
[0m21:16:34.884540 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:34.885296 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:16:34.885721 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:16:34.887243 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:16:34.887993 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:16:34.888437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:34.888946 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m21:16:34.890500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m21:16:34.891107 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:16:34.896664 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:16:34.897590 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:16:34.899695 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:16:34.900744 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:16:34.901067 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m21:16:34.901379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:35.416188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m21:16:35.421195 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m21:16:35.520536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m21:16:35.522131 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m21:16:35.526119 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m21:16:35.528676 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m21:16:35.534789 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m21:16:35.538368 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m21:16:35.624446 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.85s]
[0m21:16:35.625588 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:16:35.748519 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.93s]
[0m21:16:35.749950 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.93s]
[0m21:16:35.750820 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:16:35.751926 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.86s]
[0m21:16:35.752704 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:16:35.753576 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:16:35.755791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:35.756198 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m21:16:35.756584 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m21:16:35.756948 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m21:16:35.757305 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m21:16:35.757714 [info ] [MainThread]: 
[0m21:16:35.758131 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m21:16:35.760484 [debug] [MainThread]: Command end result
[0m21:16:35.803628 [info ] [MainThread]: 
[0m21:16:35.804036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:35.804400 [info ] [MainThread]: 
[0m21:16:35.804715 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m21:16:35.805473 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.9899054, "process_user_time": 4.059724, "process_kernel_time": 0.23568, "process_mem_max_rss": "214044", "process_out_blocks": "2789", "process_in_blocks": "0"}
[0m21:16:35.805913 [debug] [MainThread]: Command `dbt test` succeeded at 21:16:35.805842 after 5.99 seconds
[0m21:16:35.806278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4dd7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d56f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5af8230>]}
[0m21:16:35.806702 [debug] [MainThread]: Flushing usage events
[0m21:17:29.358187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22a5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b7eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ae1af0>]}


============================== 21:17:29.363775 | 2c866a1f-0ca5-4fc7-957a-386bb8829e15 ==============================
[0m21:17:29.363775 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:17:29.364304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:17:29.444158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c866a1f-0ca5-4fc7-957a-386bb8829e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3132fc0>]}
[0m21:17:29.508160 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hvyjbwxo'
[0m21:17:29.508593 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:17:29.594507 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:17:29.595122 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:17:29.648461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:17:29.651789 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:17:30.257230 [info ] [MainThread]: Installed from version 1.3.0
[0m21:17:30.257701 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:17:30.258159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c866a1f-0ca5-4fc7-957a-386bb8829e15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17b30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19cb410>]}
[0m21:17:30.258553 [info ] [MainThread]: 
[0m21:17:30.258934 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:17:30.259837 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9373928, "process_user_time": 1.686173, "process_kernel_time": 0.105259, "process_mem_max_rss": "164144", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m21:17:30.260294 [debug] [MainThread]: Command `dbt deps` succeeded at 21:17:30.260224 after 0.94 seconds
[0m21:17:30.260632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2017da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17f8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17f92e0>]}
[0m21:17:30.261057 [debug] [MainThread]: Flushing usage events
[0m21:17:33.063745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9869a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98663950>]}


============================== 21:17:33.069440 | b1ff475d-b8ee-4ca7-936f-e22c402f388a ==============================
[0m21:17:33.069440 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:17:33.070147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:33.736000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c326f90>]}
[0m21:17:33.777380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8256c6b0>]}
[0m21:17:33.778103 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:17:33.851992 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:17:33.995147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:33.995564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:34.035963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c37b3e0>]}
[0m21:17:34.137362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf16e40>]}
[0m21:17:34.137809 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:17:34.138480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf04a70>]}
[0m21:17:34.140292 [info ] [MainThread]: 
[0m21:17:34.140926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:34.141741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:17:34.153305 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:17:34.153664 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:17:34.153980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:35.002936 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.849 seconds
[0m21:17:35.007166 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:17:35.215812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m21:17:35.217073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:17:35.224474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:17:35.233196 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:17:35.236756 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:17:35.238531 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:17:35.238936 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:17:35.239331 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:17:35.239691 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:17:35.240044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:35.240363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:35.240690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:35.857826 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m21:17:35.862301 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:17:35.866920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.626 seconds
[0m21:17:35.869404 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:17:35.872749 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.632 seconds
[0m21:17:35.874840 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:17:36.075005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99284410>]}
[0m21:17:36.075730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:36.076142 [info ] [MainThread]: 
[0m21:17:36.084840 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m21:17:36.085429 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m21:17:36.086106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m21:17:36.086433 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m21:17:36.093113 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m21:17:36.135284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:36.135748 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:17:36.136171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:36.658776 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.522 seconds
[0m21:17:36.704871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:36.705556 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m21:17:38.293193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.586 seconds
[0m21:17:38.301113 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:38.301934 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:17:38.479940 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.177 seconds
[0m21:17:38.489376 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:38.490378 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:17:38.657133 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.166 seconds
[0m21:17:38.660490 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:38.660902 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:17:38.815381 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.154 seconds
[0m21:17:38.822948 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:38.823696 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:17:38.987064 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.162 seconds
[0m21:17:39.000574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:39.001222 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:17:39.171788 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.170 seconds
[0m21:17:39.201546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:39.202163 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m21:17:39.441907 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.239 seconds
[0m21:17:39.450807 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:39.451461 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:17:39.631530 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.179 seconds
[0m21:17:39.633031 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m21:17:39.636930 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:39.637712 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m21:17:39.867497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m21:17:39.868914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:39.869648 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:17:40.542758 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.672 seconds
[0m21:17:40.546194 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:17:40.546721 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m21:17:41.158125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m21:17:41.181636 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m21:17:41.399905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1ff475d-b8ee-4ca7-936f-e22c402f388a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c47af00>]}
[0m21:17:41.401044 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.31s]
[0m21:17:41.402322 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m21:17:41.404254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:41.404676 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m21:17:41.405072 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m21:17:41.405408 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m21:17:41.405815 [info ] [MainThread]: 
[0m21:17:41.406449 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m21:17:41.407170 [debug] [MainThread]: Command end result
[0m21:17:41.445757 [info ] [MainThread]: 
[0m21:17:41.446280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:41.446585 [info ] [MainThread]: 
[0m21:17:41.446975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:17:41.447757 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.419372, "process_user_time": 3.651991, "process_kernel_time": 0.190993, "process_mem_max_rss": "211560", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m21:17:41.448275 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:17:41.448204 after 8.42 seconds
[0m21:17:41.448608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cb1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0509b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982d4a40>]}
[0m21:17:41.448957 [debug] [MainThread]: Flushing usage events
[0m21:17:44.441489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5583f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47f7e60>]}


============================== 21:17:44.447309 | e6bd315d-566d-4de5-8bad-e08c176f2552 ==============================
[0m21:17:44.447309 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:17:44.448325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:45.099611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40838f0>]}
[0m21:17:45.139195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb1b6b0>]}
[0m21:17:45.139850 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:17:45.215932 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:17:45.357001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:45.357448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:45.397824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9915c860>]}
[0m21:17:45.500768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989e38c0>]}
[0m21:17:45.501276 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:17:45.501871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9857a420>]}
[0m21:17:45.504025 [info ] [MainThread]: 
[0m21:17:45.504649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:45.508420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:17:45.517518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:17:45.520689 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:17:45.523005 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:17:45.523463 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:17:45.523858 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:17:45.524221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:45.524544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:46.155355 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.631 seconds
[0m21:17:46.157202 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:17:46.161485 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.637 seconds
[0m21:17:46.162781 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:17:46.366480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m21:17:46.367636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m21:17:46.375105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:17:46.381767 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:17:46.384354 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:17:46.386791 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:17:46.387255 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:17:46.387662 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:17:46.388072 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:17:46.388454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:46.388819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:46.389187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:47.033177 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.644 seconds
[0m21:17:47.038265 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:17:47.039614 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.651 seconds
[0m21:17:47.043678 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:17:47.048948 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.660 seconds
[0m21:17:47.050625 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:17:47.291351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40c8200>]}
[0m21:17:47.292539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:47.293814 [info ] [MainThread]: 
[0m21:17:47.306169 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m21:17:47.306602 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m21:17:47.307036 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m21:17:47.307556 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m21:17:47.308013 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m21:17:47.308465 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m21:17:47.309080 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m21:17:47.310218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m21:17:47.310639 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m21:17:47.311149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m21:17:47.311592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m21:17:47.311985 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m21:17:47.312458 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m21:17:47.312805 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m21:17:47.313164 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m21:17:47.318745 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m21:17:47.319152 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m21:17:47.321435 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m21:17:47.323575 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:17:47.325939 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m21:17:47.326898 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m21:17:47.341994 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m21:17:47.351009 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m21:17:47.367560 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m21:17:47.367974 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m21:17:47.368300 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m21:17:47.370680 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m21:17:47.372948 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:17:47.373618 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m21:17:47.374458 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m21:17:47.375001 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m21:17:47.375441 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m21:17:47.376096 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m21:17:47.376378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:47.377000 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m21:17:47.377258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:47.377601 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m21:17:47.379044 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m21:17:47.380627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:17:47.381089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:48.226902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m21:17:48.228768 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m21:17:48.259895 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m21:17:48.258130 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m21:17:48.260583 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m21:17:48.265129 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m21:17:48.468166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983a4860>]}
[0m21:17:48.470454 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.15s]
[0m21:17:48.472369 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m21:17:48.473198 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m21:17:48.474757 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98341e80>]}
[0m21:17:48.476103 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ccf770>]}
[0m21:17:48.477039 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m21:17:48.478171 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.16s]
[0m21:17:48.479207 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.16s]
[0m21:17:48.480119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m21:17:48.481021 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m21:17:48.481769 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m21:17:48.482304 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m21:17:48.482854 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m21:17:48.483512 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m21:17:48.487107 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m21:17:48.487841 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m21:17:48.488605 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m21:17:48.489485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m21:17:48.489963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m21:17:48.490390 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m21:17:48.490960 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m21:17:48.491287 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m21:17:48.493841 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m21:17:48.496304 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m21:17:48.500024 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m21:17:48.501468 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m21:17:48.504032 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m21:17:48.504411 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m21:17:48.505031 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m21:17:48.507048 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m21:17:48.507447 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m21:17:48.508007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:48.508551 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m21:17:48.510086 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m21:17:48.510568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:48.511105 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m21:17:48.512939 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m21:17:48.513381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:48.783350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m21:17:48.785680 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m21:17:48.981254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985c70b0>]}
[0m21:17:48.983257 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.67s]
[0m21:17:48.985011 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m21:17:48.985837 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m21:17:48.986732 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m21:17:48.987723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m21:17:48.988373 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m21:17:49.005028 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m21:17:49.006410 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m21:17:49.008690 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m21:17:49.010525 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m21:17:49.010965 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m21:17:49.011346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:49.266582 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m21:17:49.271910 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m21:17:49.275704 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m21:17:49.279993 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m21:17:49.340467 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m21:17:49.345012 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m21:17:49.493833 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983dde80>]}
[0m21:17:49.495517 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.00s]
[0m21:17:49.498154 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m21:17:49.499033 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m21:17:49.500055 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m21:17:49.501152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.fact_inventory_snapshot)
[0m21:17:49.502512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9798f110>]}
[0m21:17:49.503110 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m21:17:49.504163 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.02s]
[0m21:17:49.510671 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:17:49.511463 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m21:17:49.512258 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m21:17:49.512835 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m21:17:49.513562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_product)
[0m21:17:49.514128 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m21:17:49.514526 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m21:17:49.518090 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m21:17:49.522326 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:17:49.523519 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m21:17:49.525925 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m21:17:49.526617 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m21:17:49.527118 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m21:17:49.527486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:49.529153 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m21:17:49.529631 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m21:17:49.529951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:49.543204 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983a4f20>]}
[0m21:17:49.543762 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:17:49.544474 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m21:17:49.545048 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m21:17:49.545448 [info ] [Thread-4 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m21:17:49.545990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m21:17:49.546336 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m21:17:49.549224 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m21:17:49.550027 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m21:17:49.552044 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m21:17:49.552962 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m21:17:49.553252 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m21:17:49.553520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:50.638416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.627 seconds
[0m21:17:50.641481 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m21:17:50.841297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979ac2c0>]}
[0m21:17:50.842376 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.85s]
[0m21:17:50.843776 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m21:17:50.844838 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m21:17:50.845637 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m21:17:50.846464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m21:17:50.846947 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m21:17:50.854703 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m21:17:50.856179 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m21:17:50.858710 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m21:17:50.861740 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m21:17:50.862222 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m21:17:50.862698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:51.098357 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.571 seconds
[0m21:17:51.103164 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m21:17:51.179502 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.626 seconds
[0m21:17:51.181980 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m21:17:51.291283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.761 seconds
[0m21:17:51.295536 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m21:17:51.326083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97932300>]}
[0m21:17:51.327218 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.82s]
[0m21:17:51.328644 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m21:17:51.434100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97933740>]}
[0m21:17:51.435120 [info ] [Thread-4 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.89s]
[0m21:17:51.436182 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m21:17:51.527056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985c7dd0>]}
[0m21:17:51.528395 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 2.01s]
[0m21:17:51.529622 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m21:17:52.937639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.074 seconds
[0m21:17:52.943111 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m21:17:53.150167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bd315d-566d-4de5-8bad-e08c176f2552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979d6c30>]}
[0m21:17:53.152289 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.30s]
[0m21:17:53.153471 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m21:17:53.156269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:53.156817 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m21:17:53.157573 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m21:17:53.158532 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m21:17:53.159214 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m21:17:53.160068 [info ] [MainThread]: 
[0m21:17:53.160990 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m21:17:53.163663 [debug] [MainThread]: Command end result
[0m21:17:53.274559 [info ] [MainThread]: 
[0m21:17:53.275236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:53.275622 [info ] [MainThread]: 
[0m21:17:53.275990 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:17:53.276716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.871563, "process_user_time": 4.146084, "process_kernel_time": 0.245775, "process_mem_max_rss": "212612", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m21:17:53.277195 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:53.277102 after 8.87 seconds
[0m21:17:53.277555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5583f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8760cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99193080>]}
[0m21:17:53.277901 [debug] [MainThread]: Flushing usage events
[0m21:17:56.593356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5ebfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4de7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfc7e60>]}


============================== 21:17:56.599114 | 6ebc74aa-9455-4cea-833f-e7a9ed916475 ==============================
[0m21:17:56.599114 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:17:56.599797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:17:57.216589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92557f50>]}
[0m21:17:57.256336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad898e00>]}
[0m21:17:57.256960 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:17:57.330974 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:17:57.464679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:57.465081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:57.504600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921830e0>]}
[0m21:17:57.622136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92183500>]}
[0m21:17:57.622630 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:17:57.623182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadab1070>]}
[0m21:17:57.625311 [info ] [MainThread]: 
[0m21:17:57.625960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:57.629859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:17:57.637707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:17:57.643180 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:17:57.645086 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:17:57.645538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:17:57.645861 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:17:57.646214 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:17:57.648006 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:17:57.648349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:57.648664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:57.648969 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:17:57.652809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:58.350439 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.702 seconds
[0m21:17:58.355712 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:17:58.359390 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.711 seconds
[0m21:17:58.361882 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.709 seconds
[0m21:17:58.363661 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:17:58.365630 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:17:58.572049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ebc74aa-9455-4cea-833f-e7a9ed916475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939e6930>]}
[0m21:17:58.573085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:58.573729 [info ] [MainThread]: 
[0m21:17:58.586431 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:17:58.586857 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:17:58.587286 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:17:58.587682 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m21:17:58.588124 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:17:58.588528 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m21:17:58.589056 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m21:17:58.589623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m21:17:58.590076 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m21:17:58.590685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m21:17:58.591174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m21:17:58.592518 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:17:58.593811 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m21:17:58.594841 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:17:58.595581 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:17:58.608849 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:17:58.611811 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:17:58.615235 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:17:58.619647 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:17:58.622986 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:17:58.624729 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:17:58.625144 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:17:58.638751 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:17:58.639131 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:17:58.651102 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:17:58.651731 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:17:58.653848 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:17:58.655796 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:17:58.657515 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:17:58.658024 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m21:17:58.658635 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:17:58.659032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:58.659593 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:17:58.660122 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:17:58.660436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m21:17:58.662062 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m21:17:58.662509 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m21:17:58.662890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:58.663228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:58.663579 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:17:59.492746 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m21:17:59.501197 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m21:17:59.511926 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m21:17:59.513029 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m21:17:59.513876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m21:17:59.515679 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m21:17:59.517375 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m21:17:59.519847 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m21:17:59.720280 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.13s]
[0m21:17:59.721601 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:17:59.722630 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:17:59.723592 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m21:17:59.724395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m21:17:59.725003 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:17:59.731041 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:17:59.732769 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:17:59.737236 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:17:59.739987 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.15s]
[0m21:17:59.740951 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.15s]
[0m21:17:59.741540 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:17:59.742447 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.15s]
[0m21:17:59.743175 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:17:59.743806 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:17:59.744251 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:17:59.744805 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:17:59.745306 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:17:59.745694 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m21:17:59.746058 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m21:17:59.746510 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:17:59.746882 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m21:17:59.747236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:59.747635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m21:17:59.747993 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m21:17:59.748387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m21:17:59.749896 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:17:59.750335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m21:17:59.750679 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:17:59.753999 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:17:59.754426 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:17:59.757607 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:17:59.760801 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:17:59.761684 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:17:59.763803 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:17:59.764291 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:17:59.766242 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:17:59.766547 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:17:59.767219 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:17:59.769062 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:17:59.769460 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m21:17:59.770031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:59.770565 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:17:59.772046 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m21:17:59.772666 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:59.773693 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:17:59.774430 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m21:17:59.774944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:00.311007 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m21:18:00.315955 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m21:18:00.377767 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m21:18:00.381850 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m21:18:00.428357 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m21:18:00.431197 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m21:18:00.438397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m21:18:00.440501 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m21:18:00.519732 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.79s]
[0m21:18:00.523028 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:18:00.523934 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:18:00.524636 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m21:18:00.525421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m21:18:00.526103 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:18:00.536942 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:18:00.539817 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:18:00.544234 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:18:00.545854 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:18:00.546323 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:00.546733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:00.628176 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.88s]
[0m21:18:00.630713 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:18:00.631600 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.88s]
[0m21:18:00.632202 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:18:00.632860 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:18:00.633769 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.89s]
[0m21:18:00.634249 [info ] [Thread-4 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m21:18:00.634926 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:18:00.635585 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:18:00.636101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m21:18:00.636604 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m21:18:00.637172 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:18:00.637648 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:18:00.638096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m21:18:00.638631 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m21:18:00.645113 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:18:00.645458 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:18:00.645924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m21:18:00.650840 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:18:00.651330 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:18:00.656620 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:18:00.657045 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:18:00.659588 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:18:00.659957 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:18:00.662281 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:18:00.662615 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:18:00.664717 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:18:00.665659 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:18:00.666846 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:18:00.667307 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:00.667763 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:00.668498 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:18:00.668933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:00.669370 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:00.669918 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:00.672681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:01.544250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m21:18:01.546058 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m21:18:01.550439 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m21:18:01.553466 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m21:18:01.613928 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m21:18:01.615528 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m21:18:01.619510 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m21:18:01.622324 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m21:18:01.787758 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.14s]
[0m21:18:01.788638 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:18:01.789182 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:18:01.789711 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m21:18:01.790304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m21:18:01.790752 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:18:01.796403 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:18:01.797686 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:18:01.799844 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:18:01.801279 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:18:01.801688 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:01.802090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:01.810607 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.29s]
[0m21:18:01.811185 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:18:01.811851 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:18:01.812275 [info ] [Thread-2 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m21:18:01.812694 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m21:18:01.813043 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:18:01.871835 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:18:01.873709 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.24s]
[0m21:18:01.874568 [info ] [Thread-4 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.24s]
[0m21:18:01.875096 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:18:01.875413 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:18:01.875914 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:18:01.876354 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:18:01.878539 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:18:01.879015 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:18:01.879396 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m21:18:01.880098 [info ] [Thread-4 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m21:18:01.880599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m21:18:01.881032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m21:18:01.881897 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:18:01.882202 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:18:01.882589 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:18:01.882982 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:01.886938 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:18:01.891946 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:18:01.892364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:01.894943 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:18:01.895388 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:18:01.897486 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:18:01.899475 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:18:01.901243 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:18:01.901714 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:18:01.902343 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:18:01.902625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:01.902997 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m21:18:01.904562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:02.420528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m21:18:02.425323 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m21:18:02.497842 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m21:18:02.501541 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m21:18:02.511688 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m21:18:02.514001 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m21:18:02.520055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m21:18:02.522055 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m21:18:02.620877 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.83s]
[0m21:18:02.622231 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:18:02.705166 [info ] [Thread-4 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.82s]
[0m21:18:02.706734 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:18:02.725807 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.84s]
[0m21:18:02.727460 [info ] [Thread-2 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.91s]
[0m21:18:02.728849 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:18:02.729842 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:18:02.732918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:02.733517 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m21:18:02.734101 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m21:18:02.734632 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m21:18:02.735074 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m21:18:02.735661 [info ] [MainThread]: 
[0m21:18:02.736292 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m21:18:02.739424 [debug] [MainThread]: Command end result
[0m21:18:02.784525 [info ] [MainThread]: 
[0m21:18:02.785012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:02.785393 [info ] [MainThread]: 
[0m21:18:02.785744 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m21:18:02.786575 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.2285204, "process_user_time": 4.012872, "process_kernel_time": 0.23929, "process_mem_max_rss": "214204", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m21:18:02.787043 [debug] [MainThread]: Command `dbt test` succeeded at 21:18:02.786963 after 6.23 seconds
[0m21:18:02.787397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec1ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadba60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b877d0>]}
[0m21:18:02.787747 [debug] [MainThread]: Flushing usage events
[0m21:19:10.308111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a6d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6426360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a6d880>]}


============================== 21:19:10.313861 | fef10748-ed4e-4dfe-b5e0-9c616d1f5645 ==============================
[0m21:19:10.313861 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:19:10.314662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:19:10.395370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fef10748-ed4e-4dfe-b5e0-9c616d1f5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71d3080>]}
[0m21:19:10.461542 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9q2xqq3k'
[0m21:19:10.461996 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:19:10.574323 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:19:10.574979 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:19:10.613893 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:19:10.617601 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:19:11.231475 [info ] [MainThread]: Installed from version 1.3.0
[0m21:19:11.232202 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:19:11.232766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fef10748-ed4e-4dfe-b5e0-9c616d1f5645', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb608ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bd3500>]}
[0m21:19:11.233203 [info ] [MainThread]: 
[0m21:19:11.233640 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:19:11.234555 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.96221834, "process_user_time": 1.686335, "process_kernel_time": 0.117651, "process_mem_max_rss": "164144", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m21:19:11.235116 [debug] [MainThread]: Command `dbt deps` succeeded at 21:19:11.235033 after 0.96 seconds
[0m21:19:11.235462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6426360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71d3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb58745f0>]}
[0m21:19:11.235830 [debug] [MainThread]: Flushing usage events
[0m21:19:14.260888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb257e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3c4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5886b0>]}


============================== 21:19:14.266496 | 93d0d123-0926-4ef5-94de-aa34ac38806b ==============================
[0m21:19:14.266496 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:19:14.267215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:14.940597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba53db50>]}
[0m21:19:14.980338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e371790>]}
[0m21:19:14.981098 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:19:15.054408 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:19:15.192561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:15.192983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:15.233205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63496a0>]}
[0m21:19:15.333886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddcee10>]}
[0m21:19:15.334370 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:19:15.334973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd87ce0>]}
[0m21:19:15.336818 [info ] [MainThread]: 
[0m21:19:15.337407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:15.338223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:19:15.349654 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:19:15.350029 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:19:15.350328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:16.238288 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.888 seconds
[0m21:19:16.240143 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:19:16.476979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m21:19:16.485891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:19:16.493300 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:19:16.493880 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:19:16.494300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:19:16.494582 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:19:16.495012 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:19:16.496772 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:19:16.497135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:16.497456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:16.497817 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:19:16.500836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:17.043898 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.543 seconds
[0m21:19:17.045725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:19:17.049734 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:19:17.052083 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:19:17.060573 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.563 seconds
[0m21:19:17.063030 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:19:17.290733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7f21e0>]}
[0m21:19:17.292464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:17.293261 [info ] [MainThread]: 
[0m21:19:17.307824 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m21:19:17.308628 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m21:19:17.309588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m21:19:17.310198 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m21:19:17.318957 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m21:19:17.360503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:17.360898 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:19:17.361300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:18.475665 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.114 seconds
[0m21:19:18.514731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:18.515341 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m21:19:19.716293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m21:19:19.721221 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:19.721907 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:19:19.865158 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.142 seconds
[0m21:19:19.871741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:19.872364 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:19:20.012937 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.140 seconds
[0m21:19:20.019418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.020113 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:19:20.141177 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.120 seconds
[0m21:19:20.147698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.148383 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:19:20.273687 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m21:19:20.284414 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.285134 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:19:20.413881 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.128 seconds
[0m21:19:20.437467 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.438037 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:20.673642 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.235 seconds
[0m21:19:20.682554 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.683831 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:20.801453 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.116 seconds
[0m21:19:20.803054 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m21:19:20.806686 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:20.807311 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m21:19:21.001011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m21:19:21.002512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:21.003248 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:19:21.615422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.611 seconds
[0m21:19:21.617150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:19:21.617860 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m21:19:22.227231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m21:19:22.244576 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m21:19:22.444770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d0d123-0926-4ef5-94de-aa34ac38806b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e336de0>]}
[0m21:19:22.447002 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.13s]
[0m21:19:22.449202 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m21:19:22.451869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:22.452499 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m21:19:22.453066 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m21:19:22.453545 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m21:19:22.454269 [info ] [MainThread]: 
[0m21:19:22.454986 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m21:19:22.456161 [debug] [MainThread]: Command end result
[0m21:19:22.496459 [info ] [MainThread]: 
[0m21:19:22.497061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:22.497405 [info ] [MainThread]: 
[0m21:19:22.497773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:19:22.498583 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.274411, "process_user_time": 3.765442, "process_kernel_time": 0.195661, "process_mem_max_rss": "211604", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m21:19:22.499052 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:19:22.498971 after 8.27 seconds
[0m21:19:22.499399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ccab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba184b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba185370>]}
[0m21:19:22.499748 [debug] [MainThread]: Flushing usage events
[0m21:20:47.237579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4441dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c54740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35a9a00>]}


============================== 21:20:47.243441 | 17cb9237-2bb1-4c80-bc33-3e50c6428964 ==============================
[0m21:20:47.243441 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:20:47.244163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:47.326616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17cb9237-2bb1-4c80-bc33-3e50c6428964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3684290>]}
[0m21:20:47.397062 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4sngsjls'
[0m21:20:47.397548 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:20:47.468359 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:20:47.469095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:20:47.525479 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:20:47.528899 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:20:48.245312 [info ] [MainThread]: Installed from version 1.3.0
[0m21:20:48.246075 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:20:48.246616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '17cb9237-2bb1-4c80-bc33-3e50c6428964', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e1b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e1b4a0>]}
[0m21:20:48.247043 [info ] [MainThread]: 
[0m21:20:48.247424 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:20:48.248606 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0478913, "process_user_time": 1.761388, "process_kernel_time": 0.110463, "process_mem_max_rss": "164140", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m21:20:48.249109 [debug] [MainThread]: Command `dbt deps` succeeded at 21:20:48.249024 after 1.05 seconds
[0m21:20:48.249481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32589b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e0fb90>]}
[0m21:20:48.249834 [debug] [MainThread]: Flushing usage events
[0m21:20:51.245269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0d8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e08bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5ddee0>]}


============================== 21:20:51.251032 | 24b96c36-6425-4e3a-96bd-7cac7fea4c91 ==============================
[0m21:20:51.251032 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:20:51.251785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:51.909518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f232cc0>]}
[0m21:20:51.950493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829ab500>]}
[0m21:20:51.951292 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:20:52.027712 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:20:52.170525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:52.170978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:52.212756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b3620>]}
[0m21:20:52.317273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d6c800>]}
[0m21:20:52.317778 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:20:52.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa167ce00>]}
[0m21:20:52.320143 [info ] [MainThread]: 
[0m21:20:52.320844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:20:52.321680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:20:52.333361 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:20:52.333741 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:20:52.334048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:53.263914 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.930 seconds
[0m21:20:53.265618 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:20:53.463296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m21:20:53.469729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:20:53.472939 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:20:53.473408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:20:53.476859 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:20:53.477415 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:20:53.479241 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:20:53.479637 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:20:53.479991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:53.480348 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:20:53.480668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:53.482128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:54.048986 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.569 seconds
[0m21:20:54.050781 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:20:54.095005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.613 seconds
[0m21:20:54.096568 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:20:54.113250 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.632 seconds
[0m21:20:54.114798 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:20:54.311424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2fbfe0>]}
[0m21:20:54.312518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:54.313599 [info ] [MainThread]: 
[0m21:20:54.325266 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m21:20:54.325929 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m21:20:54.326659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m21:20:54.327099 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m21:20:54.334006 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m21:20:54.375362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:54.375940 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:20:54.376339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:54.866642 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.490 seconds
[0m21:20:54.906393 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:54.907038 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m21:20:56.254318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.347 seconds
[0m21:20:56.257140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:56.257705 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:20:56.397906 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.140 seconds
[0m21:20:56.404754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:56.405506 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:20:56.531665 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m21:20:56.535996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:56.536517 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:20:56.664100 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.127 seconds
[0m21:20:56.671245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:56.671953 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m21:20:56.849999 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.177 seconds
[0m21:20:56.860903 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:56.861638 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m21:20:57.014125 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.152 seconds
[0m21:20:57.037695 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:57.038355 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m21:20:57.272808 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m21:20:57.281477 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:57.282142 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:20:57.410135 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.127 seconds
[0m21:20:57.411355 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m21:20:57.414434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:57.415228 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m21:20:57.602669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m21:20:57.603513 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:57.622362 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:20:58.229618 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.606 seconds
[0m21:20:58.230360 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m21:20:58.230856 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m21:20:58.675697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m21:20:58.701943 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m21:20:58.920082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b96c36-6425-4e3a-96bd-7cac7fea4c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b6e030>]}
[0m21:20:58.921400 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 4.59s]
[0m21:20:58.922797 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m21:20:58.925053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:58.925642 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m21:20:58.926103 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m21:20:58.926546 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m21:20:58.927151 [info ] [MainThread]: 
[0m21:20:58.927842 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m21:20:58.928807 [debug] [MainThread]: Command end result
[0m21:20:58.967764 [info ] [MainThread]: 
[0m21:20:58.968439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:58.968845 [info ] [MainThread]: 
[0m21:20:58.969243 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:20:58.970018 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.760939, "process_user_time": 3.687611, "process_kernel_time": 0.212119, "process_mem_max_rss": "211900", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m21:20:58.970497 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:20:58.970407 after 7.76 seconds
[0m21:20:58.970881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6e97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f534140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f535940>]}
[0m21:20:58.971231 [debug] [MainThread]: Flushing usage events
[0m21:21:02.273877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4093c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3baf800>]}


============================== 21:21:02.279487 | edc4eaff-32f3-4e90-8440-7d1dc6737df4 ==============================
[0m21:21:02.279487 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:21:02.280219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:02.900202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88402e70>]}
[0m21:21:02.939703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8806cfe0>]}
[0m21:21:02.940417 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:21:03.012797 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:21:03.146858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:03.147294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:03.187431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36e5fa0>]}
[0m21:21:03.290399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8793d9a0>]}
[0m21:21:03.290960 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:21:03.291525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879385c0>]}
[0m21:21:03.293525 [info ] [MainThread]: 
[0m21:21:03.294212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:03.298024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:21:03.306089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:21:03.310159 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:21:03.312468 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:21:03.312866 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:21:03.313230 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:21:03.313569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:03.313895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:03.970744 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.657 seconds
[0m21:21:03.973432 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:21:03.978732 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.665 seconds
[0m21:21:03.980839 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:21:04.177336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m21:21:04.178277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m21:21:04.184296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:21:04.189043 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:21:04.191089 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:21:04.192984 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:21:04.193393 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:21:04.193837 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:21:04.194192 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:21:04.194522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:04.194884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:04.195206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:04.763109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.568 seconds
[0m21:21:04.766620 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:21:04.767833 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.573 seconds
[0m21:21:04.771450 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:21:04.775878 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.581 seconds
[0m21:21:04.777637 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:21:04.974986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87849310>]}
[0m21:21:04.976036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:21:04.976946 [info ] [MainThread]: 
[0m21:21:04.986812 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m21:21:04.987262 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m21:21:04.987644 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m21:21:04.988086 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m21:21:04.988479 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m21:21:04.988881 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m21:21:04.989365 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m21:21:04.990466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m21:21:04.990879 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m21:21:04.991359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m21:21:04.991772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m21:21:04.992147 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m21:21:04.992590 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m21:21:04.992961 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m21:21:04.993317 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m21:21:04.998568 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m21:21:04.998978 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m21:21:05.001223 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m21:21:05.003398 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:21:05.005720 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m21:21:05.006719 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m21:21:05.030731 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m21:21:05.031124 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m21:21:05.036968 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m21:21:05.037297 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m21:21:05.048237 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m21:21:05.050515 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:21:05.052691 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m21:21:05.053764 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m21:21:05.054464 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m21:21:05.055009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:05.055538 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m21:21:05.056093 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m21:21:05.057995 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m21:21:05.058302 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m21:21:05.058689 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m21:21:05.059047 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m21:21:05.059381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:05.059747 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:05.060136 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:21:05.734530 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m21:21:05.759574 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m21:21:05.761875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m21:21:05.762471 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m21:21:05.764800 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m21:21:05.766518 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m21:21:05.968691 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87897050>]}
[0m21:21:05.969971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877a7ef0>]}
[0m21:21:05.971070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87edaed0>]}
[0m21:21:05.972033 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.97s]
[0m21:21:05.973196 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.98s]
[0m21:21:05.974016 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.98s]
[0m21:21:05.974860 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m21:21:05.975548 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m21:21:05.976439 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m21:21:05.977050 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m21:21:05.977566 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m21:21:05.978103 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m21:21:05.978670 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m21:21:05.979341 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m21:21:05.979816 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m21:21:05.980284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m21:21:05.980747 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m21:21:05.981146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m21:21:05.981532 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m21:21:05.981908 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m21:21:05.982271 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m21:21:05.984869 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m21:21:05.987109 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m21:21:05.989244 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m21:21:05.990704 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m21:21:05.994355 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m21:21:05.994691 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m21:21:05.994982 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m21:21:05.997285 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m21:21:05.999372 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m21:21:06.000226 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m21:21:06.000709 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m21:21:06.001057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:21:06.002922 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m21:21:06.003682 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m21:21:06.004005 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m21:21:06.004406 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m21:21:06.004762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:06.005138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:06.245565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.190 seconds
[0m21:21:06.247547 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m21:21:06.476898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877699d0>]}
[0m21:21:06.478136 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.49s]
[0m21:21:06.479112 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m21:21:06.479851 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m21:21:06.480657 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m21:21:06.481481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m21:21:06.482102 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m21:21:06.496970 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:21:06.498340 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m21:21:06.500774 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:21:06.502092 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m21:21:06.502467 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m21:21:06.502838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:06.631104 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m21:21:06.631780 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m21:21:06.633656 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m21:21:06.634222 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m21:21:06.635915 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m21:21:06.638407 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m21:21:06.840957 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d92750>]}
[0m21:21:06.842432 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87787230>]}
[0m21:21:06.843587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87784530>]}
[0m21:21:06.844540 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.86s]
[0m21:21:06.845898 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.86s]
[0m21:21:06.847063 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.86s]
[0m21:21:06.847865 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m21:21:06.848643 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m21:21:06.849332 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m21:21:06.849931 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m21:21:06.850723 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m21:21:06.851476 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m21:21:06.852110 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m21:21:06.852816 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m21:21:06.853339 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m21:21:06.853840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m21:21:06.854269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m21:21:06.854678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m21:21:06.855052 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m21:21:06.855410 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m21:21:06.855766 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m21:21:06.860104 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m21:21:06.863080 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m21:21:06.868867 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m21:21:06.871818 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m21:21:06.872145 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m21:21:06.874221 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m21:21:06.874534 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m21:21:06.876520 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m21:21:06.878818 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m21:21:06.879954 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m21:21:06.880326 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m21:21:06.880908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:06.881977 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m21:21:06.883116 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m21:21:06.884217 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m21:21:06.884748 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m21:21:06.885188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:21:06.885513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:07.907260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.404 seconds
[0m21:21:07.910895 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m21:21:08.095959 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.215 seconds
[0m21:21:08.099747 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m21:21:08.103127 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.217 seconds
[0m21:21:08.106535 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m21:21:08.114776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d6dc40>]}
[0m21:21:08.115498 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.63s]
[0m21:21:08.116296 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m21:21:08.144773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.259 seconds
[0m21:21:08.147682 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: Close
[0m21:21:08.306632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877ae540>]}
[0m21:21:08.307549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877ae0c0>]}
[0m21:21:08.308513 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.45s]
[0m21:21:08.309831 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.45s]
[0m21:21:08.310829 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m21:21:08.311754 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m21:21:08.354994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d982f0>]}
[0m21:21:08.356038 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.50s]
[0m21:21:08.357213 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m21:21:08.358280 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m21:21:08.359237 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m21:21:08.360089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.fact_sales)
[0m21:21:08.360711 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m21:21:08.368678 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m21:21:08.370035 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m21:21:08.372394 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m21:21:08.374951 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m21:21:08.375445 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m21:21:08.375902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:10.160952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.785 seconds
[0m21:21:10.164567 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m21:21:10.367312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc4eaff-32f3-4e90-8440-7d1dc6737df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d81d00>]}
[0m21:21:10.368498 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.01s]
[0m21:21:10.369903 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m21:21:10.372066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:10.372674 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m21:21:10.373174 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m21:21:10.373672 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m21:21:10.374144 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m21:21:10.374762 [info ] [MainThread]: 
[0m21:21:10.375425 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m21:21:10.377927 [debug] [MainThread]: Command end result
[0m21:21:10.468174 [info ] [MainThread]: 
[0m21:21:10.468870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:21:10.469293 [info ] [MainThread]: 
[0m21:21:10.469665 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:21:10.470389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.232774, "process_user_time": 3.953195, "process_kernel_time": 0.205693, "process_mem_max_rss": "212640", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m21:21:10.470885 [debug] [MainThread]: Command `dbt run` succeeded at 21:21:10.470776 after 8.23 seconds
[0m21:21:10.471264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa405dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47cc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882b0560>]}
[0m21:21:10.471632 [debug] [MainThread]: Flushing usage events
[0m21:21:12.998347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43824b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e72ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c63830>]}


============================== 21:21:13.004027 | 572331cc-83d6-4a50-815d-4b0a3975f5cb ==============================
[0m21:21:13.004027 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:21:13.004763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:13.642518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e56b70>]}
[0m21:21:13.682515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1da1b80>]}
[0m21:21:13.683316 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:21:13.756120 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:21:13.885406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:13.885839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:13.925751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c0ce30>]}
[0m21:21:14.035085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873ec170>]}
[0m21:21:14.035535 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:21:14.036163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87516690>]}
[0m21:21:14.038463 [info ] [MainThread]: 
[0m21:21:14.039236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:14.043544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:21:14.044164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:21:14.057079 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:21:14.057477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:21:14.059241 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:21:14.059686 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:21:14.061460 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:21:14.061819 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:21:14.062147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:14.062471 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:21:14.062795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:14.065009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:14.701739 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.639 seconds
[0m21:21:14.702638 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.638 seconds
[0m21:21:14.704150 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:21:14.705704 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:21:14.744845 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.683 seconds
[0m21:21:14.746995 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:21:14.946646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572331cc-83d6-4a50-815d-4b0a3975f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4880260>]}
[0m21:21:14.947795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:21:14.948835 [info ] [MainThread]: 
[0m21:21:14.960949 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:21:14.961405 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:21:14.961797 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:21:14.962165 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m21:21:14.962572 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:21:14.962889 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m21:21:14.963338 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m21:21:14.963890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m21:21:14.964322 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m21:21:14.964781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m21:21:14.965183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m21:21:14.965576 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:21:14.966043 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m21:21:14.966415 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:21:14.966787 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:21:14.978981 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:21:14.980416 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:21:14.983621 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:21:14.987837 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:21:14.990967 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:21:14.992742 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:21:15.000111 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:21:15.009985 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:21:15.010313 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:21:15.010626 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:21:15.011157 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:21:15.013963 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:21:15.016110 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:21:15.017103 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:21:15.017933 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m21:21:15.018572 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:21:15.018924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:15.019647 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:21:15.019951 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m21:21:15.020477 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:21:15.021923 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m21:21:15.022482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:15.022926 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m21:21:15.023443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:15.024989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:21:15.672448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m21:21:15.680503 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m21:21:15.687283 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:21:15.689164 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m21:21:15.691781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m21:21:15.693213 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m21:21:15.698796 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m21:21:15.700193 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m21:21:15.893914 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.93s]
[0m21:21:15.895066 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:21:15.895571 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:21:15.896046 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m21:21:15.897548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m21:21:15.899547 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:21:15.898777 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.93s]
[0m21:21:15.900413 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.93s]
[0m21:21:15.901192 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.94s]
[0m21:21:15.905026 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:21:15.905687 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:21:15.906392 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:21:15.907111 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:21:15.908069 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:21:15.908821 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:21:15.909347 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:21:15.909968 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m21:21:15.910358 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:21:15.910968 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m21:21:15.911597 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m21:21:15.912334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m21:21:15.915940 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:21:15.916480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m21:21:15.917250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m21:21:15.917986 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:21:15.918675 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:21:15.919096 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:21:15.922518 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:21:15.923262 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:21:15.926480 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:21:15.929728 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:21:15.930274 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m21:21:15.931135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:15.931473 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:21:15.934961 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:21:15.935309 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:21:15.935642 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:21:15.937687 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:21:15.939752 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:21:15.940635 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:21:15.941102 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m21:21:15.941459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:15.942639 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:21:15.943611 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m21:21:15.944158 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:21:15.944462 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:21:15.944860 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m21:21:15.946184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:16.479490 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m21:21:16.480722 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:21:16.483572 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m21:21:16.486160 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m21:21:16.488878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m21:21:16.492837 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m21:21:16.511276 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m21:21:16.512833 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m21:21:16.686031 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.77s]
[0m21:21:16.686973 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:21:16.687435 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:21:16.687896 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m21:21:16.688538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m21:21:16.688967 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:21:16.696453 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:21:16.698988 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.78s]
[0m21:21:16.699875 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.80s]
[0m21:21:16.700629 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:21:16.701256 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:21:16.701916 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:21:16.702537 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:21:16.702979 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:21:16.703417 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m21:21:16.704135 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m21:21:16.706907 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:21:16.708067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m21:21:16.709391 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.79s]
[0m21:21:16.709894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m21:21:16.710757 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:21:16.711444 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:21:16.712123 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:21:16.713175 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:21:16.720159 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:21:16.720804 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:21:16.725896 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:21:16.726497 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:16.727311 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m21:21:16.728301 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:16.729005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m21:21:16.729398 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:21:16.731366 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:21:16.731824 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:21:16.734937 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:21:16.737175 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:21:16.743285 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:21:16.745764 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:21:16.746479 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:16.747494 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:21:16.747829 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:21:16.748123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:16.748548 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:16.750947 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:21:16.753010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:16.756895 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:21:16.757366 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:16.758079 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:21:17.343655 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m21:21:17.346711 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m21:21:17.407621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m21:21:17.410394 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m21:21:17.482249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m21:21:17.486794 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m21:21:17.494330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m21:21:17.496743 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m21:21:17.551389 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.82s]
[0m21:21:17.552901 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:21:17.553670 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:21:17.554314 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m21:21:17.555198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m21:21:17.555858 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:21:17.562816 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:21:17.564147 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:21:17.566690 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:21:17.568214 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:21:17.568661 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:17.569043 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:21:17.618737 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.93s]
[0m21:21:17.619746 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:21:17.620165 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:21:17.620595 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m21:21:17.621239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m21:21:17.621663 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:21:17.626115 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:21:17.627186 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:21:17.683081 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:21:17.685793 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.98s]
[0m21:21:17.686712 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:21:17.687696 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:21:17.688217 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:17.689011 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.98s]
[0m21:21:17.689428 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:21:17.689816 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:21:17.690269 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:21:17.690635 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m21:21:17.692197 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:21:17.692861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m21:21:17.693413 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m21:21:17.694136 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:21:17.694531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m21:21:17.698804 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:21:17.699220 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:21:17.704702 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:21:17.705765 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:21:17.707847 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:21:17.708337 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:21:17.710350 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:21:17.711343 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:21:17.711905 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:21:17.712305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:17.713047 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:21:17.713913 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m21:21:17.714983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:18.198572 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m21:21:18.201871 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m21:21:18.270397 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m21:21:18.273306 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m21:21:18.282160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m21:21:18.284780 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m21:21:18.300795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:21:18.303520 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m21:21:18.396738 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.84s]
[0m21:21:18.398060 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:21:18.472028 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.85s]
[0m21:21:18.473276 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:21:18.476933 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.78s]
[0m21:21:18.477949 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:21:18.499482 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.81s]
[0m21:21:18.500675 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:21:18.502901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:18.503463 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m21:21:18.504063 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m21:21:18.504513 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m21:21:18.504990 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m21:21:18.505481 [info ] [MainThread]: 
[0m21:21:18.506243 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m21:21:18.509045 [debug] [MainThread]: Command end result
[0m21:21:18.550950 [info ] [MainThread]: 
[0m21:21:18.551698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:21:18.552133 [info ] [MainThread]: 
[0m21:21:18.552716 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m21:21:18.553850 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.591602, "process_user_time": 3.977811, "process_kernel_time": 0.239053, "process_mem_max_rss": "213624", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m21:21:18.554358 [debug] [MainThread]: Command `dbt test` succeeded at 21:21:18.554261 after 5.59 seconds
[0m21:21:18.554785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50b85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa421fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa421fbc0>]}
[0m21:21:18.555239 [debug] [MainThread]: Flushing usage events
[0m21:24:25.899144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abf2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885cd5b0>]}


============================== 21:24:25.904841 | 3f35a497-b160-40dd-a92e-8e52e571ad9b ==============================
[0m21:24:25.904841 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:24:25.905573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:24:26.516999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cc31700>]}
[0m21:24:26.556023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e61c6b0>]}
[0m21:24:26.556652 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:24:26.627992 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:24:26.761238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:24:26.761658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:24:26.801491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ccc6060>]}
[0m21:24:26.901177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c876ed0>]}
[0m21:24:26.901706 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:24:26.902296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ea41c40>]}
[0m21:24:26.904294 [info ] [MainThread]: 
[0m21:24:26.904930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:24:26.908713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:24:26.917865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m21:24:26.920817 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:24:26.923070 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m21:24:26.923455 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:24:26.923849 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m21:24:26.924182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:26.924512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:28.027271 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.103 seconds
[0m21:24:28.028816 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.104 seconds
[0m21:24:28.032025 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:24:28.034015 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m21:24:28.234505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m21:24:28.235499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m21:24:28.245798 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:24:28.246263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:24:28.248295 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:24:28.248802 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:24:28.250842 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:24:28.251256 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:24:28.251672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:28.252048 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:24:28.252423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:28.253446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:28.843821 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.591 seconds
[0m21:24:28.844637 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.591 seconds
[0m21:24:28.845293 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.594 seconds
[0m21:24:28.846868 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:24:28.848224 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:24:28.849571 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:24:29.053787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c876540>]}
[0m21:24:29.055143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:29.056528 [info ] [MainThread]: 
[0m21:24:29.069426 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m21:24:29.070034 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m21:24:29.070536 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m21:24:29.071120 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m21:24:29.071594 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m21:24:29.072045 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m21:24:29.072620 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m21:24:29.073821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m21:24:29.074253 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m21:24:29.074799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m21:24:29.075266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m21:24:29.075728 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m21:24:29.076244 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m21:24:29.076668 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m21:24:29.077034 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m21:24:29.082718 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m21:24:29.083106 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m21:24:29.085435 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m21:24:29.087620 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:24:29.089908 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m21:24:29.090887 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m21:24:29.114507 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m21:24:29.114951 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m21:24:29.115304 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m21:24:29.115590 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m21:24:29.131818 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m21:24:29.134018 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m21:24:29.136126 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m21:24:29.137048 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m21:24:29.137936 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m21:24:29.138352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:29.138938 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m21:24:29.140489 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m21:24:29.141218 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m21:24:29.141803 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m21:24:29.142090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:24:29.142484 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m21:24:29.142846 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m21:24:29.144171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:29.144566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:29.758789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m21:24:29.773557 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m21:24:29.800221 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m21:24:29.800766 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m21:24:29.802251 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m21:24:29.805482 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m21:24:29.995464 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cdd3350>]}
[0m21:24:29.996704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bda7ef0>]}
[0m21:24:29.997771 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.92s]
[0m21:24:29.998786 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c71c2c0>]}
[0m21:24:29.999450 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.92s]
[0m21:24:30.000435 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m21:24:30.001098 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.92s]
[0m21:24:30.001937 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m21:24:30.002549 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m21:24:30.003215 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m21:24:30.003778 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m21:24:30.004333 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m21:24:30.004877 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m21:24:30.005465 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m21:24:30.006086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m21:24:30.006629 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m21:24:30.007149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m21:24:30.007590 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m21:24:30.008032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m21:24:30.008428 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m21:24:30.011543 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m21:24:30.011973 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m21:24:30.014153 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m21:24:30.016499 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m21:24:30.017411 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m21:24:30.021248 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m21:24:30.021815 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m21:24:30.022119 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m21:24:30.024188 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m21:24:30.026354 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m21:24:30.027004 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m21:24:30.027712 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m21:24:30.028069 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:30.029832 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m21:24:30.030571 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m21:24:30.030896 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m21:24:30.031289 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m21:24:30.031720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:30.032033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:30.647866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m21:24:30.652701 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m21:24:30.688369 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m21:24:30.692013 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m21:24:30.727650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m21:24:30.731408 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m21:24:30.735728 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m21:24:30.738774 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m21:24:30.854706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8c3620>]}
[0m21:24:30.856248 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.78s]
[0m21:24:30.858264 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m21:24:30.859100 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m21:24:30.859889 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m21:24:30.860597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m21:24:30.861168 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m21:24:30.879948 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:24:30.881589 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m21:24:30.884265 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m21:24:30.886353 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m21:24:30.886852 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bd944a0>]}
[0m21:24:30.887219 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m21:24:30.887880 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.88s]
[0m21:24:30.888223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:30.888790 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m21:24:30.890509 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m21:24:30.891008 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m21:24:30.891786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m21:24:30.892192 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m21:24:30.896347 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m21:24:30.897378 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m21:24:30.900742 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m21:24:30.902367 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m21:24:30.902761 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m21:24:30.903142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:30.926538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3b8c80>]}
[0m21:24:30.927093 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.92s]
[0m21:24:30.927956 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m21:24:30.928549 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m21:24:30.929166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3b8770>]}
[0m21:24:30.929576 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m21:24:30.930194 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.92s]
[0m21:24:30.930641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m21:24:30.931107 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m21:24:30.931450 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m21:24:30.932013 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m21:24:30.934967 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m21:24:30.935436 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m21:24:30.935989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m21:24:30.936365 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m21:24:30.939093 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m21:24:30.939565 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m21:24:30.941582 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m21:24:30.942125 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m21:24:30.944157 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m21:24:30.944926 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m21:24:30.945246 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m21:24:30.945583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:30.946246 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m21:24:30.946955 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m21:24:30.947654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:32.180581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m21:24:32.186372 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m21:24:32.191467 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.243 seconds
[0m21:24:32.195671 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m21:24:32.201076 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.255 seconds
[0m21:24:32.203608 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m21:24:32.212404 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.309 seconds
[0m21:24:32.214978 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: Close
[0m21:24:32.416117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3920f0>]}
[0m21:24:32.417578 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bde0710>]}
[0m21:24:32.418666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bdac1d0>]}
[0m21:24:32.420080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3c8a70>]}
[0m21:24:32.421365 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.55s]
[0m21:24:32.422637 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.48s]
[0m21:24:32.423635 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.49s]
[0m21:24:32.424696 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.53s]
[0m21:24:32.425617 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m21:24:32.426487 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m21:24:32.427265 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m21:24:32.427926 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m21:24:32.429633 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m21:24:32.430316 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m21:24:32.431121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.fact_sales)
[0m21:24:32.431640 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m21:24:32.438464 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m21:24:32.439842 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m21:24:32.442287 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m21:24:32.444803 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m21:24:32.445230 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m21:24:32.445713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:34.147939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.702 seconds
[0m21:24:34.152270 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m21:24:34.351678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f35a497-b160-40dd-a92e-8e52e571ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bdac1d0>]}
[0m21:24:34.352770 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 1.92s]
[0m21:24:34.353684 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m21:24:34.355992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:34.357346 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m21:24:34.357732 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m21:24:34.358111 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m21:24:34.358639 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m21:24:34.359156 [info ] [MainThread]: 
[0m21:24:34.359805 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m21:24:34.361723 [debug] [MainThread]: Command end result
[0m21:24:34.449218 [info ] [MainThread]: 
[0m21:24:34.449841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:34.450166 [info ] [MainThread]: 
[0m21:24:34.450649 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:24:34.451405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.58727, "process_user_time": 3.92906, "process_kernel_time": 0.244941, "process_mem_max_rss": "212828", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m21:24:34.451888 [debug] [MainThread]: Command `dbt run` succeeded at 21:24:34.451804 after 8.59 seconds
[0m21:24:34.452234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b34b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b34b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b34be60>]}
[0m21:24:34.452604 [debug] [MainThread]: Flushing usage events
[0m21:24:36.966373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802b01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8cb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f964410>]}


============================== 21:24:36.971955 | f30c485e-2d8a-47dc-88db-a3a84e35fa4e ==============================
[0m21:24:36.971955 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:24:36.972682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:24:37.584306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0ffef0>]}
[0m21:24:37.623717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63ad3b60>]}
[0m21:24:37.624362 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m21:24:37.696512 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:24:37.828887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:24:37.829304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:24:37.868785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a21d00>]}
[0m21:24:37.976231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63492d50>]}
[0m21:24:37.976707 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m21:24:37.977296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a77920>]}
[0m21:24:37.979443 [info ] [MainThread]: 
[0m21:24:37.980069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:24:37.983957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m21:24:37.991679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m21:24:37.997159 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m21:24:37.997684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m21:24:37.999401 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m21:24:37.999810 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m21:24:38.001585 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m21:24:38.001938 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m21:24:38.002264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:38.002609 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m21:24:38.002919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:38.004162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:38.592087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:24:38.596638 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m21:24:38.600250 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.598 seconds
[0m21:24:38.603618 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m21:24:38.607174 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.604 seconds
[0m21:24:38.609137 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m21:24:38.820473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30c485e-2d8a-47dc-88db-a3a84e35fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a77920>]}
[0m21:24:38.821088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:38.821742 [info ] [MainThread]: 
[0m21:24:38.830253 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:24:38.830670 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:24:38.831050 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:24:38.831447 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m21:24:38.831894 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:24:38.832237 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m21:24:38.832715 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m21:24:38.833223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m21:24:38.833653 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m21:24:38.834100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m21:24:38.834542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m21:24:38.834930 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:24:38.835396 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m21:24:38.835761 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:24:38.836116 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:24:38.849507 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:24:38.849870 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:24:38.853081 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:24:38.857313 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:24:38.860740 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:24:38.861600 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:24:38.874573 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:24:38.885750 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:24:38.886420 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:24:38.886758 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:24:38.887267 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:24:38.889673 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:24:38.891713 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:24:38.892504 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m21:24:38.893131 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m21:24:38.893688 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m21:24:38.894321 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m21:24:38.894625 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m21:24:38.895111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:38.895672 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m21:24:38.895965 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m21:24:38.896365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:38.897741 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m21:24:38.898322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:38.899761 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:24:39.584522 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m21:24:39.596741 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m21:24:39.598897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m21:24:39.600894 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m21:24:39.605690 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m21:24:39.607284 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m21:24:39.612767 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m21:24:39.614202 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m21:24:39.797243 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.96s]
[0m21:24:39.799120 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.97s]
[0m21:24:39.801037 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m21:24:39.802950 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m21:24:39.803943 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:24:39.804727 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:24:39.805892 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.97s]
[0m21:24:39.806429 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m21:24:39.807661 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m21:24:39.808558 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m21:24:39.809413 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.98s]
[0m21:24:39.809877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m21:24:39.810349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m21:24:39.810851 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:24:39.811377 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m21:24:39.811768 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:24:39.812307 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:24:39.812903 [info ] [Thread-3 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m21:24:39.813540 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:24:39.819046 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:24:39.824474 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:24:39.825036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m21:24:39.825630 [info ] [Thread-2 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m21:24:39.826769 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:24:39.827262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m21:24:39.830933 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:24:39.831253 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:24:39.831702 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:24:39.831979 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:24:39.834225 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:24:39.837495 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:24:39.839498 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:24:39.839924 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:24:39.842431 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:24:39.843258 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m21:24:39.843630 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:24:39.843968 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m21:24:39.844511 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m21:24:39.846417 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:24:39.847003 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m21:24:39.847312 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:39.847689 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m21:24:39.848206 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m21:24:39.849297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:39.850520 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m21:24:39.850822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:39.852236 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m21:24:39.853888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:40.389478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m21:24:40.391973 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m21:24:40.412571 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m21:24:40.414585 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m21:24:40.427825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:24:40.429677 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m21:24:40.439545 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m21:24:40.441160 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m21:24:40.600790 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.79s]
[0m21:24:40.602317 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m21:24:40.602976 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:24:40.603845 [info ] [Thread-1 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m21:24:40.605556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m21:24:40.606162 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:24:40.615223 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:24:40.616654 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:24:40.619238 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:24:40.621241 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m21:24:40.622140 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.80s]
[0m21:24:40.622640 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:40.623302 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m21:24:40.623736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:40.624181 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:24:40.625699 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m21:24:40.626227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m21:24:40.626605 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:24:40.632928 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:24:40.634006 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:24:40.636079 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:24:40.637792 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.81s]
[0m21:24:40.638647 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m21:24:40.639458 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m21:24:40.640088 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:40.640851 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.83s]
[0m21:24:40.641244 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:24:40.641623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:40.642066 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m21:24:40.642434 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m21:24:40.644005 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:24:40.644533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m21:24:40.644914 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m21:24:40.645370 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:24:40.645810 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m21:24:40.650396 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:24:40.650856 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:24:40.655182 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:24:40.655963 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:24:40.658007 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:24:40.658461 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:24:40.660305 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:24:40.661389 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m21:24:40.661828 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:40.662209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:40.663085 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m21:24:40.663813 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:40.664524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:41.234528 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m21:24:41.239710 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m21:24:41.334334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m21:24:41.335779 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m21:24:41.338682 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m21:24:41.340791 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m21:24:41.387890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m21:24:41.390686 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m21:24:41.435018 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.79s]
[0m21:24:41.436434 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m21:24:41.437174 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:24:41.437834 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m21:24:41.438669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m21:24:41.439296 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:24:41.445747 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:24:41.447321 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:24:41.449899 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:24:41.451552 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m21:24:41.451997 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:41.452402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:41.530867 [info ] [Thread-1 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.92s]
[0m21:24:41.532438 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m21:24:41.533164 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:24:41.533798 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m21:24:41.535036 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.91s]
[0m21:24:41.535696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m21:24:41.536500 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m21:24:41.537068 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:24:41.537645 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:24:41.543588 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:24:41.544149 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m21:24:41.545160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m21:24:41.545651 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:24:41.551689 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:24:41.552310 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:24:41.603807 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:24:41.604839 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:24:41.606988 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:24:41.608356 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m21:24:41.609094 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.96s]
[0m21:24:41.609510 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:41.610141 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m21:24:41.610879 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m21:24:41.611179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:41.611618 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:24:41.612006 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:24:41.613514 [info ] [Thread-2 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m21:24:41.614059 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:41.614638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m21:24:41.616088 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:24:41.621461 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:24:41.622545 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:24:41.624691 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:24:41.625871 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m21:24:41.626259 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m21:24:41.626648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:42.030270 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m21:24:42.034933 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m21:24:42.196328 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m21:24:42.199526 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m21:24:42.209369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m21:24:42.211643 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m21:24:42.222194 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m21:24:42.224389 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m21:24:42.227853 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.79s]
[0m21:24:42.228930 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m21:24:42.391543 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.85s]
[0m21:24:42.393342 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m21:24:42.405118 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.87s]
[0m21:24:42.406475 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m21:24:42.421651 [info ] [Thread-2 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.81s]
[0m21:24:42.422859 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m21:24:42.425615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:42.426394 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m21:24:42.426999 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m21:24:42.427538 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m21:24:42.427964 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m21:24:42.428535 [info ] [MainThread]: 
[0m21:24:42.429353 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m21:24:42.432491 [debug] [MainThread]: Command end result
[0m21:24:42.477040 [info ] [MainThread]: 
[0m21:24:42.477576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:42.477957 [info ] [MainThread]: 
[0m21:24:42.478360 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m21:24:42.479158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.5481057, "process_user_time": 4.00326, "process_kernel_time": 0.223409, "process_mem_max_rss": "213956", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m21:24:42.479673 [debug] [MainThread]: Command `dbt test` succeeded at 21:24:42.479574 after 5.55 seconds
[0m21:24:42.480042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802b01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6414cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb48aa0>]}
[0m21:24:42.480397 [debug] [MainThread]: Flushing usage events
[0m02:11:45.478889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccd4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d919040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6718b0>]}


============================== 02:11:45.485194 | e266d175-535d-417a-af73-0597f155505f ==============================
[0m02:11:45.485194 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:11:45.485772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:11:45.568987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e266d175-535d-417a-af73-0597f155505f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99aabf80>]}
[0m02:11:45.633333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5kn3m87r'
[0m02:11:45.633790 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:11:45.779252 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:11:45.779990 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:11:45.866020 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:11:45.872935 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:11:46.529023 [info ] [MainThread]: Installed from version 1.3.0
[0m02:11:46.529496 [info ] [MainThread]: Updated version available: 1.3.3
[0m02:11:46.529991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e266d175-535d-417a-af73-0597f155505f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b03b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fd9940>]}
[0m02:11:46.530343 [info ] [MainThread]: 
[0m02:11:46.530663 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:11:46.531694 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0900135, "process_user_time": 1.658702, "process_kernel_time": 0.134137, "process_mem_max_rss": "101448", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m02:11:46.532410 [debug] [MainThread]: Command `dbt deps` succeeded at 02:11:46.532164 after 1.09 seconds
[0m02:11:46.532846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b03b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e40cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1370e0>]}
[0m02:11:46.533192 [debug] [MainThread]: Flushing usage events
[0m02:18:03.861308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906aaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f59d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f59d8e0>]}


============================== 02:18:03.866878 | cd3df697-9624-43f2-9cf6-c199af811057 ==============================
[0m02:18:03.866878 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:03.867587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:18:03.947173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd3df697-9624-43f2-9cf6-c199af811057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f24bb90>]}
[0m02:18:04.014884 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mowtkpmw'
[0m02:18:04.015273 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:18:04.103398 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:18:04.103982 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:18:04.257425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:18:04.272140 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:18:04.984889 [info ] [MainThread]: Installed from version 1.3.0
[0m02:18:04.985669 [info ] [MainThread]: Updated version available: 1.3.3
[0m02:18:04.986133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd3df697-9624-43f2-9cf6-c199af811057', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f134170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f172a20>]}
[0m02:18:04.986559 [info ] [MainThread]: 
[0m02:18:04.987058 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:18:04.988015 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.16223, "process_user_time": 1.670681, "process_kernel_time": 0.121504, "process_mem_max_rss": "164044", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m02:18:04.988445 [debug] [MainThread]: Command `dbt deps` succeeded at 02:18:04.988364 after 1.16 seconds
[0m02:18:04.988765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fde0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90507e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9ed370>]}
[0m02:18:04.989098 [debug] [MainThread]: Flushing usage events
[0m02:18:08.134074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90d8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8089460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafe7a40>]}


============================== 02:18:08.139711 | a407e91d-d1b6-4baf-b79a-c38257824e75 ==============================
[0m02:18:08.139711 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:08.140491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m02:18:08.771096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9101250>]}
[0m02:18:08.810205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cea1dc0>]}
[0m02:18:08.810818 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:08.885986 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:09.029964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:09.030350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:09.070536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7c9ee0>]}
[0m02:18:09.146005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca0b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8271a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8fb890>]}


============================== 02:18:09.151628 | 1adae053-dbb6-475a-a39a-5d17a2246ba2 ==============================
[0m02:18:09.151628 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:09.152075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:18:09.174988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c22ecc0>]}
[0m02:18:09.175430 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:09.175995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c301f70>]}
[0m02:18:09.177744 [info ] [MainThread]: 
[0m02:18:09.178292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:09.179045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:09.190564 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:09.190893 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:09.191170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:09.233431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1adae053-dbb6-475a-a39a-5d17a2246ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6bbdd0>]}
[0m02:18:09.301070 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9qbrg38k'
[0m02:18:09.301456 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:18:09.344197 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:18:09.344731 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:18:09.383183 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:18:09.386444 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:18:10.014910 [info ] [MainThread]: Installed from version 1.3.0
[0m02:18:10.015419 [info ] [MainThread]: Updated version available: 1.3.3
[0m02:18:10.015843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1adae053-dbb6-475a-a39a-5d17a2246ba2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8b54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5b7110>]}
[0m02:18:10.016261 [info ] [MainThread]: 
[0m02:18:10.016547 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:18:10.017399 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9062748, "process_user_time": 1.762945, "process_kernel_time": 0.117663, "process_mem_max_rss": "164048", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m02:18:10.017836 [debug] [MainThread]: Command `dbt deps` succeeded at 02:18:10.017757 after 0.91 seconds
[0m02:18:10.018128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce542c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6e93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dfe63f0>]}
[0m02:18:10.018421 [debug] [MainThread]: Flushing usage events
[0m02:18:10.500421 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.309 seconds
[0m02:18:10.501920 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:10.702585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m02:18:10.710124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m02:18:10.710779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m02:18:10.718679 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:10.719141 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:10.720806 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m02:18:10.721146 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:10.721513 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:10.721817 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:10.722116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:10.722386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:10.722668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:11.286030 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.564 seconds
[0m02:18:11.287751 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:11.334237 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.612 seconds
[0m02:18:11.335019 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.612 seconds
[0m02:18:11.336451 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:11.337864 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:11.530912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97bfad0>]}
[0m02:18:11.531520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:11.532070 [info ] [MainThread]: 
[0m02:18:11.539859 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m02:18:11.540442 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m02:18:11.540976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m02:18:11.541270 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m02:18:11.547845 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m02:18:11.587786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:11.588166 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:11.588457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:12.065417 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.477 seconds
[0m02:18:12.098433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:12.098934 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m02:18:12.936134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818da180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83367830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813c7b30>]}


============================== 02:18:12.941774 | 7a3b02cb-06d4-467f-a6ee-30063aff99d1 ==============================
[0m02:18:12.941774 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:12.942331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:18:13.571389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bd938f0>]}
[0m02:18:13.610701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a42780>]}
[0m02:18:13.611278 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:13.685418 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:13.822755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:13.823118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:13.863307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65b45f10>]}
[0m02:18:13.963392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65675490>]}
[0m02:18:13.963821 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:13.964172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65b005c0>]}
[0m02:18:13.965983 [info ] [MainThread]: 
[0m02:18:13.966480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:13.967223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:13.978374 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:13.978719 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:13.979046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:14.576828 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.598 seconds
[0m02:18:14.580257 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:14.777709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m02:18:14.783850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m02:18:14.785866 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:14.786371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m02:18:14.789166 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m02:18:14.789640 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:14.791271 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:14.791772 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:14.792651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:14.793072 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:14.793400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:14.795141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:14.898322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.799 seconds
[0m02:18:14.900804 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:14.901135 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:15.028084 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.127 seconds
[0m02:18:15.031382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.031833 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:15.152306 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.120 seconds
[0m02:18:15.155836 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.156224 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:15.278446 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.122 seconds
[0m02:18:15.284577 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.285212 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:15.299089 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.504 seconds
[0m02:18:15.301317 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:15.303812 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.511 seconds
[0m02:18:15.306280 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:15.317951 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.525 seconds
[0m02:18:15.319714 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:15.398732 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.113 seconds
[0m02:18:15.408137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.408620 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:15.505950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82be77d0>]}
[0m02:18:15.507397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:15.507980 [info ] [MainThread]: 
[0m02:18:15.519757 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m02:18:15.520341 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m02:18:15.520853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m02:18:15.521207 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m02:18:15.527561 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.119 seconds
[0m02:18:15.528894 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m02:18:15.544507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.544938 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m02:18:15.569213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.569586 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:15.569966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:15.763294 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.218 seconds
[0m02:18:15.769702 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.770223 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:18:15.916230 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.145 seconds
[0m02:18:15.918134 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m02:18:15.925037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:15.925885 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m02:18:16.052624 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.482 seconds
[0m02:18:16.088795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m02:18:16.089183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:16.089529 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:18:16.097605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:16.098075 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m02:18:16.764368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m02:18:16.764405 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.674 seconds
[0m02:18:16.766112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:16.766718 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m02:18:16.771124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:16.771912 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:17.028834 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.256 seconds
[0m02:18:17.034555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.035167 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:17.163755 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.128 seconds
[0m02:18:17.171265 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.171899 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:17.209609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m02:18:17.234945 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m02:18:17.290513 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.118 seconds
[0m02:18:17.294553 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.294949 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m02:18:17.416014 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.120 seconds
[0m02:18:17.426566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a407e91d-d1b6-4baf-b79a-c38257824e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7ca030>]}
[0m02:18:17.427985 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.88s]
[0m02:18:17.428348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.429145 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m02:18:17.429289 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m02:18:17.431262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:17.431744 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m02:18:17.432154 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m02:18:17.432507 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m02:18:17.432925 [info ] [MainThread]: 
[0m02:18:17.433609 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m02:18:17.434428 [debug] [MainThread]: Command end result
[0m02:18:17.474938 [info ] [MainThread]: 
[0m02:18:17.475419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:17.475688 [info ] [MainThread]: 
[0m02:18:17.476013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:18:17.476678 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.380053, "process_user_time": 3.647285, "process_kernel_time": 0.214605, "process_mem_max_rss": "211516", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m02:18:17.477091 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:18:17.476995 after 9.38 seconds
[0m02:18:17.477408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f9ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c42c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa814d7c0>]}
[0m02:18:17.477718 [debug] [MainThread]: Flushing usage events
[0m02:18:17.555296 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.126 seconds
[0m02:18:17.574114 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.574698 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m02:18:17.908526 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.333 seconds
[0m02:18:17.913497 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:17.913890 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:18:18.057509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.143 seconds
[0m02:18:18.058083 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m02:18:18.059655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:18.059939 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m02:18:18.231451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m02:18:18.231885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:18.232725 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:18:18.805152 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.571 seconds
[0m02:18:18.805631 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m02:18:18.806012 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m02:18:19.282595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m02:18:19.299690 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m02:18:19.485004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3b02cb-06d4-467f-a6ee-30063aff99d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65b45d30>]}
[0m02:18:19.485751 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 3.96s]
[0m02:18:19.486338 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m02:18:19.487566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:19.487843 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m02:18:19.488102 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m02:18:19.488324 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m02:18:19.488593 [info ] [MainThread]: 
[0m02:18:19.488872 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m02:18:19.489486 [debug] [MainThread]: Command end result
[0m02:18:19.524184 [info ] [MainThread]: 
[0m02:18:19.524546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:19.524774 [info ] [MainThread]: 
[0m02:18:19.525004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:18:19.525951 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.625229, "process_user_time": 3.510867, "process_kernel_time": 0.180198, "process_mem_max_rss": "211432", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m02:18:19.526286 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:18:19.526222 after 6.63 seconds
[0m02:18:19.526531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83367830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a1bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813c82c0>]}
[0m02:18:19.526770 [debug] [MainThread]: Flushing usage events
[0m02:18:19.911730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c58f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b257e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc53d10>]}


============================== 02:18:19.917593 | 812beb65-ef1c-4e39-8c25-27ff5cae306a ==============================
[0m02:18:19.917593 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:19.918077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --fail-fast', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:18:20.557014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5ae9f0>]}
[0m02:18:20.597051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7f11c0>]}
[0m02:18:20.597744 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:20.670945 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:20.797237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:20.797593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:20.837592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70bb7530>]}
[0m02:18:20.935829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee85d90>]}
[0m02:18:20.936322 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:20.936657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee57b90>]}
[0m02:18:20.938668 [info ] [MainThread]: 
[0m02:18:20.939164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:20.942870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:20.950221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:20.954760 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:20.957018 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:20.957358 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:20.957678 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:20.957981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:20.958253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:21.522220 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.564 seconds
[0m02:18:21.523244 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.565 seconds
[0m02:18:21.524542 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:21.525729 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:21.712794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m02:18:21.713303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m02:18:21.719856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m02:18:21.720298 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m02:18:21.722037 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:21.723746 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:21.724097 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:21.724405 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:21.724705 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:21.724993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:21.725324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:21.725580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:22.041349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28bbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e9d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32ddf70>]}


============================== 02:18:22.047237 | 00fd9b47-53f2-4497-96a5-018ad54f0215 ==============================
[0m02:18:22.047237 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:22.048016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --fail-fast', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:22.218918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.494 seconds
[0m02:18:22.220626 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:22.244359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.519 seconds
[0m02:18:22.245991 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:22.296163 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m02:18:22.297612 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:22.494157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f303320>]}
[0m02:18:22.494730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:22.495130 [info ] [MainThread]: 
[0m02:18:22.503625 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m02:18:22.504015 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m02:18:22.504329 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m02:18:22.504720 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m02:18:22.505105 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m02:18:22.505491 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m02:18:22.505979 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m02:18:22.506936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m02:18:22.507278 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m02:18:22.507677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m02:18:22.508070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m02:18:22.508398 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m02:18:22.508795 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m02:18:22.509112 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m02:18:22.509497 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m02:18:22.514724 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m02:18:22.515088 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m02:18:22.517379 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m02:18:22.519527 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:22.521751 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m02:18:22.524253 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m02:18:22.531042 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m02:18:22.531314 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m02:18:22.550566 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m02:18:22.556165 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m02:18:22.567728 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:22.565731 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m02:18:22.569795 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m02:18:22.571949 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:22.572649 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m02:18:22.572937 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m02:18:22.573369 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m02:18:22.573856 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m02:18:22.574421 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m02:18:22.575586 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m02:18:22.575022 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:18:22.575307 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m02:18:22.574716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:22.575831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:22.577385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:22.669637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988cf890>]}
[0m02:18:22.714340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb402e750>]}
[0m02:18:22.715079 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:22.787964 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:22.921312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:22.921681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:22.961620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f76180>]}
[0m02:18:23.062659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eda9f0>]}
[0m02:18:23.063132 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:23.063675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fd5f70>]}
[0m02:18:23.065640 [info ] [MainThread]: 
[0m02:18:23.066212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:23.069854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:23.077953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m02:18:23.081937 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:23.084125 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m02:18:23.084466 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:23.084818 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m02:18:23.085116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:23.085385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:23.297148 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m02:18:23.316485 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m02:18:23.317082 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m02:18:23.320162 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m02:18:23.333311 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m02:18:23.334875 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m02:18:23.501616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ecdecf0>]}
[0m02:18:23.502215 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.99s]
[0m02:18:23.502815 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m02:18:23.503208 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_orders
[0m02:18:23.503710 [info ] [Thread-3 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m02:18:23.504107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m02:18:23.504425 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_orders
[0m02:18:23.506862 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m02:18:23.508421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f0c49e0>]}
[0m02:18:23.509062 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.00s]
[0m02:18:23.509391 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_orders
[0m02:18:23.509765 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m02:18:23.511923 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m02:18:23.512303 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m02:18:23.512873 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m02:18:23.513270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m02:18:23.513921 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m02:18:23.514157 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m02:18:23.514469 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m02:18:23.516877 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m02:18:23.517443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:23.518160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e31dd00>]}
[0m02:18:23.520006 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.01s]
[0m02:18:23.520697 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m02:18:23.521013 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m02:18:23.521352 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m02:18:23.524841 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m02:18:23.525258 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m02:18:23.525922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m02:18:23.526367 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m02:18:23.528694 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m02:18:23.529292 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m02:18:23.529737 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m02:18:23.530054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:23.531460 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m02:18:23.533663 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m02:18:23.534721 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m02:18:23.535045 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m02:18:23.535352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:23.674358 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.589 seconds
[0m02:18:23.674976 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.590 seconds
[0m02:18:23.676370 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:23.677598 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m02:18:23.828116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m02:18:23.831180 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m02:18:23.878461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m02:18:23.879139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m02:18:23.888531 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m02:18:23.888948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m02:18:23.890886 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:23.891367 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:23.893243 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:23.893587 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:23.893968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:23.894281 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:23.894580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:23.896003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:24.032123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eca4f50>]}
[0m02:18:24.033192 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.53s]
[0m02:18:24.034412 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m02:18:24.034952 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m02:18:24.035597 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m02:18:24.036558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m02:18:24.037117 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m02:18:24.051510 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:24.052611 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m02:18:24.054666 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:24.056212 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:24.056521 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m02:18:24.056834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:24.123726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m02:18:24.125405 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: Close
[0m02:18:24.163282 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m02:18:24.164812 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m02:18:24.183123 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m02:18:24.184822 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m02:18:24.310245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2d70b0>]}
[0m02:18:24.311086 [info ] [Thread-3 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.81s]
[0m02:18:24.312106 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_orders
[0m02:18:24.312480 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_customer
[0m02:18:24.312961 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m02:18:24.313898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m02:18:24.314216 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_customer
[0m02:18:24.318513 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m02:18:24.319617 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_customer
[0m02:18:24.321628 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m02:18:24.323202 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m02:18:24.323545 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m02:18:24.323898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:24.356750 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3bbec0>]}
[0m02:18:24.357328 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.84s]
[0m02:18:24.358011 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m02:18:24.358545 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m02:18:24.358960 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m02:18:24.359455 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m02:18:24.359754 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m02:18:24.362553 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m02:18:24.363556 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m02:18:24.365463 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m02:18:24.366589 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m02:18:24.366891 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m02:18:24.367168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:24.394798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2d6d20>]}
[0m02:18:24.395308 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.87s]
[0m02:18:24.395936 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m02:18:24.396449 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m02:18:24.396830 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m02:18:24.397327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m02:18:24.397601 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m02:18:24.400546 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m02:18:24.401487 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m02:18:24.403374 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m02:18:24.404451 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m02:18:24.404775 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m02:18:24.405114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:24.457440 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.563 seconds
[0m02:18:24.459077 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:24.468803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.574 seconds
[0m02:18:24.469455 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.573 seconds
[0m02:18:24.470678 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:24.471983 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:24.664629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b27860>]}
[0m02:18:24.665522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:24.666514 [info ] [MainThread]: 
[0m02:18:24.677645 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m02:18:24.678047 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m02:18:24.678396 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m02:18:24.678847 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m02:18:24.679238 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m02:18:24.679649 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m02:18:24.680165 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m02:18:24.681243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m02:18:24.681605 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m02:18:24.682062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m02:18:24.682445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m02:18:24.682802 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m02:18:24.683188 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m02:18:24.683493 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m02:18:24.683809 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m02:18:24.689133 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m02:18:24.689475 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m02:18:24.691631 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m02:18:24.693766 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:24.696331 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m02:18:24.697208 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m02:18:24.718229 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m02:18:24.721129 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m02:18:24.721505 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m02:18:24.737563 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m02:18:24.738016 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m02:18:24.740137 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:24.742527 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m02:18:24.743254 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m02:18:24.743999 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m02:18:24.744424 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m02:18:24.744798 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m02:18:24.745211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:24.745689 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m02:18:24.746171 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m02:18:24.746398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:24.747982 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m02:18:24.748364 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m02:18:24.749825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:24.750188 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:18:25.419531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m02:18:25.420420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m02:18:25.439935 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m02:18:25.441749 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m02:18:25.442304 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m02:18:25.446648 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m02:18:25.616957 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.293 seconds
[0m02:18:25.621933 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: Close
[0m02:18:25.633981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f07a40>]}
[0m02:18:25.634978 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.95s]
[0m02:18:25.636266 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m02:18:25.636954 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m02:18:25.637821 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m02:18:25.638533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m02:18:25.638938 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m02:18:25.642377 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m02:18:25.645191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96989700>]}
[0m02:18:25.645962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9698bf20>]}
[0m02:18:25.646491 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.96s]
[0m02:18:25.647154 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m02:18:25.647571 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.96s]
[0m02:18:25.648225 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m02:18:25.650861 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m02:18:25.651371 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m02:18:25.651803 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m02:18:25.652542 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m02:18:25.653064 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m02:18:25.653705 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m02:18:25.654248 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m02:18:25.654607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m02:18:25.654948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m02:18:25.655298 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m02:18:25.655615 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m02:18:25.655916 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m02:18:25.656360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:25.658653 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m02:18:25.661989 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m02:18:25.664438 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m02:18:25.666715 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m02:18:25.666998 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m02:18:25.669070 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m02:18:25.670143 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m02:18:25.670505 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m02:18:25.670932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:25.671393 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m02:18:25.672801 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m02:18:25.673109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:25.702914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.646 seconds
[0m02:18:25.704561 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m02:18:25.832501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3bba40>]}
[0m02:18:25.833441 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.52s]
[0m02:18:25.834647 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_customer
[0m02:18:25.835524 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_sales
[0m02:18:25.836259 [info ] [Thread-3 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m02:18:25.837248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m02:18:25.837671 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_sales
[0m02:18:25.844792 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m02:18:25.845880 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_sales
[0m02:18:25.848271 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m02:18:25.851287 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m02:18:25.851674 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m02:18:25.852046 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:25.904115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3ad610>]}
[0m02:18:25.904754 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.87s]
[0m02:18:25.905582 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m02:18:26.003514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m02:18:26.005610 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.638 seconds
[0m02:18:26.007215 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m02:18:26.008438 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m02:18:26.056100 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.651 seconds
[0m02:18:26.058224 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m02:18:26.200452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e369c10>]}
[0m02:18:26.200520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9698bcb0>]}
[0m02:18:26.202069 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.84s]
[0m02:18:26.202233 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.52s]
[0m02:18:26.203768 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m02:18:26.204275 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m02:18:26.205032 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m02:18:26.205961 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m02:18:26.207358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m02:18:26.208044 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m02:18:26.225138 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m02:18:26.226629 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m02:18:26.229158 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m02:18:26.230926 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m02:18:26.231376 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m02:18:26.231746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:26.273419 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ecccf50>]}
[0m02:18:26.274182 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.88s]
[0m02:18:26.275228 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m02:18:26.407430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m02:18:26.410199 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m02:18:26.466934 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m02:18:26.469505 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m02:18:26.475695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m02:18:26.477841 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m02:18:26.614758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f97a40>]}
[0m02:18:26.616495 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.98s]
[0m02:18:26.618488 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m02:18:26.619284 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m02:18:26.620058 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m02:18:26.620958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m02:18:26.621450 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m02:18:26.627915 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:26.629736 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m02:18:26.632724 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:26.638844 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m02:18:26.639261 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m02:18:26.639637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:26.677211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc19a0>]}
[0m02:18:26.677999 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.02s]
[0m02:18:26.679069 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m02:18:26.679867 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m02:18:26.680365 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m02:18:26.680961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m02:18:26.681344 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m02:18:26.684857 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m02:18:26.686014 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m02:18:26.688051 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m02:18:26.689638 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m02:18:26.690286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969f33e0>]}
[0m02:18:26.690572 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m02:18:26.691072 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.04s]
[0m02:18:26.691334 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:26.691753 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m02:18:26.693328 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m02:18:26.693735 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m02:18:26.694206 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m02:18:26.694467 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m02:18:26.697266 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m02:18:26.698107 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m02:18:26.700120 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m02:18:26.701211 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m02:18:26.701506 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m02:18:26.701796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:27.614739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.383 seconds
[0m02:18:27.616525 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m02:18:27.822180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969f3bc0>]}
[0m02:18:27.824222 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.61s]
[0m02:18:27.826303 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m02:18:27.827441 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m02:18:27.828166 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m02:18:27.829093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m02:18:27.829576 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m02:18:27.838348 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m02:18:27.840040 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m02:18:27.842977 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m02:18:27.846106 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m02:18:27.846663 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m02:18:27.847227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:27.945412 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.254 seconds
[0m02:18:27.948185 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m02:18:27.978850 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.277 seconds
[0m02:18:27.980582 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m02:18:28.029736 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m02:18:28.031792 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m02:18:28.141364 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc1b20>]}
[0m02:18:28.142919 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.46s]
[0m02:18:28.144971 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m02:18:28.177678 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc2450>]}
[0m02:18:28.179128 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.48s]
[0m02:18:28.180940 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m02:18:28.233383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65aef30>]}
[0m02:18:28.234038 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.61s]
[0m02:18:28.234919 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m02:18:28.322758 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.471 seconds
[0m02:18:28.324490 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: Close
[0m02:18:28.515651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812beb65-ef1c-4e39-8c25-27ff5cae306a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2d6d20>]}
[0m02:18:28.517604 [info ] [Thread-3 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.68s]
[0m02:18:28.519738 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_sales
[0m02:18:28.522615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:28.523267 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m02:18:28.523697 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m02:18:28.524100 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m02:18:28.524455 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m02:18:28.525047 [info ] [MainThread]: 
[0m02:18:28.525871 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m02:18:28.528557 [debug] [MainThread]: Command end result
[0m02:18:28.639341 [info ] [MainThread]: 
[0m02:18:28.639930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:28.640199 [info ] [MainThread]: 
[0m02:18:28.640543 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m02:18:28.641211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.779263, "process_user_time": 3.742253, "process_kernel_time": 0.202013, "process_mem_max_rss": "212924", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m02:18:28.641622 [debug] [MainThread]: Command `dbt run` succeeded at 02:18:28.641526 after 8.78 seconds
[0m02:18:28.641932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad48a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6bf950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5af680>]}
[0m02:18:28.642213 [debug] [MainThread]: Flushing usage events
[0m02:18:29.665168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m02:18:29.670168 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m02:18:29.871860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fd9b47-53f2-4497-96a5-018ad54f0215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc06e0>]}
[0m02:18:29.874007 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.04s]
[0m02:18:29.876093 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m02:18:29.878759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:29.879283 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m02:18:29.879626 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m02:18:29.880405 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m02:18:29.880902 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m02:18:29.881509 [info ] [MainThread]: 
[0m02:18:29.882485 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m02:18:29.885341 [debug] [MainThread]: Command end result
[0m02:18:29.992085 [info ] [MainThread]: 
[0m02:18:29.992745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:29.993147 [info ] [MainThread]: 
[0m02:18:29.993505 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m02:18:29.994297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.988454, "process_user_time": 3.941172, "process_kernel_time": 0.177367, "process_mem_max_rss": "212668", "process_out_blocks": "2765", "process_in_blocks": "0"}
[0m02:18:29.994624 [debug] [MainThread]: Command `dbt run` succeeded at 02:18:29.994561 after 7.99 seconds
[0m02:18:29.994926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29fa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d157020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f53710>]}
[0m02:18:29.995155 [debug] [MainThread]: Flushing usage events
[0m02:18:32.143403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4927e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9b6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffe8440>]}


============================== 02:18:32.149306 | e5753a23-be91-4225-a45b-44aa05279948 ==============================
[0m02:18:32.149306 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:32.150025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --fail-fast', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:32.763440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff720cc260>]}
[0m02:18:32.802755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de1a900>]}
[0m02:18:32.803389 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:32.876840 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:33.011171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:33.011545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:33.051770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716ded20>]}
[0m02:18:33.162454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71252600>]}
[0m02:18:33.162931 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:33.163304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712f9520>]}
[0m02:18:33.165411 [info ] [MainThread]: 
[0m02:18:33.165933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:33.169775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m02:18:33.177288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m02:18:33.182649 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:33.179548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b1dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b1f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b1e000>]}
[0m02:18:33.184481 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"


============================== 02:18:33.185093 | 38942ef9-5d95-48dd-8c8e-a97a2694bcd1 ==============================
[0m02:18:33.185093 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:18:33.184849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m02:18:33.185840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --fail-fast', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:33.185124 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:33.185646 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:33.187376 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:33.187672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:33.187984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:33.188265 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:33.191989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:33.794247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94891f0>]}
[0m02:18:33.806332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.614 seconds
[0m02:18:33.807882 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:33.818139 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.630 seconds
[0m02:18:33.819527 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:33.822608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.635 seconds
[0m02:18:33.823930 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:33.834045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980a6930>]}
[0m02:18:33.834619 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:18:33.908529 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:18:34.027735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5753a23-be91-4225-a45b-44aa05279948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7bfa40>]}
[0m02:18:34.028401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:34.028751 [info ] [MainThread]: 
[0m02:18:34.037141 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:34.037470 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:34.037831 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:34.038164 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m02:18:34.038550 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:34.038875 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m02:18:34.039293 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m02:18:34.039706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m02:18:34.040068 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m02:18:34.040447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m02:18:34.040818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m02:18:34.041194 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:34.043824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:34.044156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:34.041643 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m02:18:34.042010 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:34.042345 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:34.055156 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:34.055473 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:34.058631 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:34.062587 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:34.065576 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:34.067960 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:34.068235 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:34.084853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967c9c40>]}
[0m02:18:34.080911 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:34.091896 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:34.092447 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:34.092738 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:34.094623 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:34.096985 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:34.098121 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:34.098608 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:34.098972 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m02:18:34.099405 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m02:18:34.099882 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:34.100453 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:34.100692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:34.100994 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:34.101280 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m02:18:34.101588 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m02:18:34.104049 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:18:34.104391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:34.194351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96293a40>]}
[0m02:18:34.194831 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m02:18:34.195599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963de210>]}
[0m02:18:34.198519 [info ] [MainThread]: 
[0m02:18:34.199209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:34.203227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m02:18:34.211737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m02:18:34.216470 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m02:18:34.218153 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m02:18:34.218523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m02:18:34.218824 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m02:18:34.219104 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m02:18:34.220727 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m02:18:34.221031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:34.221313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:34.221624 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m02:18:34.225054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:34.740350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m02:18:34.747899 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m02:18:34.748559 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m02:18:34.750927 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m02:18:34.754880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m02:18:34.756212 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m02:18:34.813644 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m02:18:34.815427 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m02:18:34.817081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.592 seconds
[0m02:18:34.818898 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m02:18:34.826945 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.606 seconds
[0m02:18:34.827710 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.606 seconds
[0m02:18:34.829275 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m02:18:34.830911 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m02:18:34.969706 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.93s]
[0m02:18:34.971338 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:34.973191 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:34.974338 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m02:18:34.975835 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.93s]
[0m02:18:34.976605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m02:18:34.978029 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:34.979056 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.94s]
[0m02:18:34.979519 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:34.980190 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:34.981331 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:34.987543 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:34.988091 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m02:18:34.988739 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:34.989965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m02:18:34.990538 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m02:18:34.991162 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:34.991739 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m02:18:34.992123 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:34.996709 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:34.997155 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:34.999094 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:35.002884 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.005173 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.96s]
[0m02:18:35.005846 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:35.006530 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:35.008605 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:35.009446 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:35.009821 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.010079 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:35.010702 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m02:18:35.011107 [info ] [Thread-4 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m02:18:35.013245 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.013910 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:35.014177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:35.014937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m02:18:35.015443 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m02:18:35.017419 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.017956 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.018350 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:35.021848 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.022967 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m02:18:35.025217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:35.026981 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.029372 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.033872 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.034243 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m02:18:35.034602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:35.034943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38942ef9-5d95-48dd-8c8e-a97a2694bcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff962fddc0>]}
[0m02:18:35.035526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:35.035867 [info ] [MainThread]: 
[0m02:18:35.046912 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:35.047418 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:35.047960 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:35.048547 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m02:18:35.048985 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:35.049412 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m02:18:35.049846 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m02:18:35.050535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m02:18:35.050891 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m02:18:35.051357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m02:18:35.051722 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m02:18:35.052094 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:35.052497 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m02:18:35.052832 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:35.053122 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:35.066196 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:35.066507 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:35.069601 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:35.073570 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:35.076894 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:35.077827 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:35.090901 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:35.097147 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:35.100215 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:35.102986 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:35.104798 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:35.105057 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:35.107472 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:35.108393 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m02:18:35.108898 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m02:18:35.109324 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m02:18:35.109954 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m02:18:35.110245 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m02:18:35.110850 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m02:18:35.111083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:35.111404 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m02:18:35.111705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:35.112172 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m02:18:35.113109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:35.115457 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:18:35.542171 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m02:18:35.544093 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m02:18:35.548377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m02:18:35.549938 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m02:18:35.563526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m02:18:35.565012 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m02:18:35.571708 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m02:18:35.573217 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m02:18:35.613794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m02:18:35.624862 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m02:18:35.626636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m02:18:35.627715 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m02:18:35.628583 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m02:18:35.630041 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m02:18:35.631506 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m02:18:35.632864 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m02:18:35.737424 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.75s]
[0m02:18:35.739062 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:35.739739 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:35.740407 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m02:18:35.741713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m02:18:35.742286 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:35.752499 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:35.753305 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.76s]
[0m02:18:35.754484 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:35.755263 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.78s]
[0m02:18:35.755715 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:35.756290 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:35.756643 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:35.756997 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m02:18:35.757598 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:35.759799 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:35.760174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m02:18:35.760524 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m02:18:35.761108 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:35.761468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m02:18:35.767331 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:35.768117 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:35.768834 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:35.773556 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:35.774264 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.76s]
[0m02:18:35.774585 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:35.775311 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.775710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:35.775967 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:35.776349 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:35.776705 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:35.779452 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:35.780272 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m02:18:35.782369 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:35.782853 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m02:18:35.783393 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:35.788018 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:35.788750 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:35.789591 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:35.790007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:35.790659 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:35.792114 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:35.792397 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:35.794364 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:35.794725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:35.797004 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:35.797335 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:35.797656 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:35.813592 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.76s]
[0m02:18:35.814579 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m02:18:35.814993 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:35.815724 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.76s]
[0m02:18:35.816052 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m02:18:35.816588 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m02:18:35.816945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m02:18:35.817323 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:35.817693 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:35.818074 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m02:18:35.821841 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:35.822153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m02:18:35.823813 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.77s]
[0m02:18:35.824598 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.77s]
[0m02:18:35.824894 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:35.825379 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m02:18:35.825887 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m02:18:35.826114 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:35.830420 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:35.830834 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:35.831222 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.833166 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:35.833630 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m02:18:35.834096 [info ] [Thread-2 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m02:18:35.834655 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:35.834934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m02:18:35.835293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m02:18:35.837141 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:35.837722 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m02:18:35.837975 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:35.838260 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.838701 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m02:18:35.841840 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.844768 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.845386 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m02:18:35.845629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:35.846187 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m02:18:35.847950 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:35.848198 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:35.848452 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:35.850418 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.853540 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.854912 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m02:18:35.855448 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m02:18:35.855748 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m02:18:35.856219 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m02:18:35.856558 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:35.856866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:36.334546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m02:18:36.339442 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m02:18:36.359344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m02:18:36.363504 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m02:18:36.398007 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m02:18:36.400064 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m02:18:36.433241 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m02:18:36.434976 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m02:18:36.437576 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m02:18:36.439180 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m02:18:36.464938 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m02:18:36.466670 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m02:18:36.488939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m02:18:36.490876 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m02:18:36.533972 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.72s]
[0m02:18:36.535160 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m02:18:36.536161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m02:18:36.536692 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:36.537236 [info ] [Thread-1 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m02:18:36.537828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m02:18:36.538183 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m02:18:36.538274 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:36.546394 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:36.549121 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:36.551176 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:36.552846 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.72s]
[0m02:18:36.553589 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m02:18:36.554039 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m02:18:36.554400 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.554798 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:36.555211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:36.555539 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m02:18:36.557165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m02:18:36.557488 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:36.563689 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:36.564698 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:36.566661 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:36.567975 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m02:18:36.568315 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.568643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:36.595183 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.81s]
[0m02:18:36.595940 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:36.596305 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:36.596619 [info ] [Thread-4 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m02:18:36.597143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m02:18:36.597501 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:36.601677 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:36.602656 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:36.604554 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:36.605829 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:36.606148 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.606461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:36.628142 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.81s]
[0m02:18:36.628961 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m02:18:36.629333 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:36.629801 [info ] [Thread-3 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m02:18:36.630556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m02:18:36.630944 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:36.635507 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:36.636190 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.80s]
[0m02:18:36.636795 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m02:18:36.637162 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:36.637535 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m02:18:36.638099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m02:18:36.638352 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:36.638586 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:36.640496 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:36.644842 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:36.646269 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m02:18:36.646679 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.646991 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:36.647277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:36.649163 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:36.651584 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.91s]
[0m02:18:36.652400 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:36.652835 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m02:18:36.652852 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:36.653226 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.653364 [info ] [Thread-3 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m02:18:36.653589 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:36.653898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m02:18:36.654237 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:36.660229 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:36.661182 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:36.712375 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:36.714724 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:36.715487 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.95s]
[0m02:18:36.715842 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.716328 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:36.716621 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:36.717025 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:36.718507 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m02:18:36.719238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m02:18:36.719547 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:36.723387 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:36.724865 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:36.726835 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:36.728123 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:36.728460 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:36.728814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:36.730420 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.97s]
[0m02:18:36.731745 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:36.732260 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:36.732598 [info ] [Thread-2 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m02:18:36.733035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m02:18:36.733310 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:36.739323 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:36.740515 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:36.742376 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:36.743524 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:36.743847 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:18:36.744166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:37.255116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m02:18:37.259861 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m02:18:37.263089 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m02:18:37.266183 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m02:18:37.302806 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m02:18:37.305574 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m02:18:37.313745 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m02:18:37.316034 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m02:18:37.368694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m02:18:37.371132 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m02:18:37.385027 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m02:18:37.386704 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m02:18:37.409862 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m02:18:37.412008 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m02:18:37.413154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m02:18:37.415455 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m02:18:37.479896 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.92s]
[0m02:18:37.480727 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m02:18:37.481434 [info ] [Thread-1 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.94s]
[0m02:18:37.481873 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:37.482425 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m02:18:37.482798 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m02:18:37.483306 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:37.483725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m02:18:37.484095 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m02:18:37.484510 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:37.484884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m02:18:37.489337 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:37.489625 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:37.493827 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:37.494611 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:37.496525 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:37.496965 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:37.500250 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:37.501311 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m02:18:37.502145 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:37.502542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:18:37.503869 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m02:18:37.555457 [info ] [Thread-3 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.92s]
[0m02:18:37.558829 [info ] [Thread-2 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.83s]
[0m02:18:37.555929 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:37.559582 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:37.558233 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.92s]
[0m02:18:37.559404 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m02:18:37.559768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:37.560336 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m02:18:37.560751 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:37.562623 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:37.564490 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m02:18:37.565501 [info ] [Thread-4 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m02:18:37.566186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m02:18:37.566699 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m02:18:37.567228 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:37.567645 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:37.574565 [info ] [Thread-3 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.92s]
[0m02:18:37.575484 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:37.572870 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:37.578076 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:37.579454 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:37.579762 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:37.581647 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:37.583530 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:37.585102 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m02:18:37.585572 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:18:37.586162 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m02:18:37.586424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:18:37.586849 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:18:37.588729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:18:37.616193 [info ] [Thread-4 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 1.02s]
[0m02:18:37.617956 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.90s]
[0m02:18:37.618476 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:37.618967 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:37.620526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:37.620828 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m02:18:37.621067 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m02:18:37.621294 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m02:18:37.621507 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m02:18:37.621770 [info ] [MainThread]: 
[0m02:18:37.622055 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m02:18:37.623772 [debug] [MainThread]: Command end result
[0m02:18:37.664400 [info ] [MainThread]: 
[0m02:18:37.664772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:37.665100 [info ] [MainThread]: 
[0m02:18:37.665393 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m02:18:37.666124 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.5595827, "process_user_time": 3.785442, "process_kernel_time": 0.184411, "process_mem_max_rss": "213788", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m02:18:37.666536 [debug] [MainThread]: Command `dbt test` succeeded at 02:18:37.666437 after 5.56 seconds
[0m02:18:37.666869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d84f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e155a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706d22d0>]}
[0m02:18:37.667162 [debug] [MainThread]: Flushing usage events
[0m02:18:38.062162 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m02:18:38.062953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m02:18:38.064594 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m02:18:38.066137 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m02:18:38.071209 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m02:18:38.072584 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m02:18:38.075726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m02:18:38.077092 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m02:18:38.265874 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.78s]
[0m02:18:38.266914 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m02:18:38.267603 [info ] [Thread-4 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.70s]
[0m02:18:38.268313 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m02:18:38.269027 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.79s]
[0m02:18:38.270038 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m02:18:38.271138 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.70s]
[0m02:18:38.271686 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m02:18:38.272964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:38.273229 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m02:18:38.273462 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m02:18:38.273686 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m02:18:38.273911 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m02:18:38.274162 [info ] [MainThread]: 
[0m02:18:38.274553 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m02:18:38.276250 [debug] [MainThread]: Command end result
[0m02:18:38.318039 [info ] [MainThread]: 
[0m02:18:38.318621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:38.319025 [info ] [MainThread]: 
[0m02:18:38.319653 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m02:18:38.320605 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.1758466, "process_user_time": 3.855744, "process_kernel_time": 0.186859, "process_mem_max_rss": "213860", "process_out_blocks": "2791", "process_in_blocks": "0"}
[0m02:18:38.321099 [debug] [MainThread]: Command `dbt test` succeeded at 02:18:38.321008 after 5.18 seconds
[0m02:18:38.321428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68bb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22dade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9455b6e0>]}
[0m02:18:38.321761 [debug] [MainThread]: Flushing usage events
[0m02:47:48.702924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40376e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39ec650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4037ef0>]}


============================== 02:47:48.709285 | 6b6b30f9-c71c-48a7-a754-aa9c42dfc174 ==============================
[0m02:47:48.709285 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:47:48.709843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --target test_wh', 'send_anonymous_usage_stats': 'True'}
[0m02:47:48.716041 [info ] [MainThread]: dbt version: 1.8.2
[0m02:47:48.716394 [info ] [MainThread]: python version: 3.12.7
[0m02:47:48.716771 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:47:48.717168 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:47:49.257169 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m02:47:49.257658 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m02:47:49.258119 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m02:47:49.258691 [info ] [MainThread]: adapter type: snowflake
[0m02:47:49.259046 [info ] [MainThread]: adapter version: 1.8.2
[0m02:47:49.326120 [info ] [MainThread]: Configuration:
[0m02:47:49.326549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:47:49.326939 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:47:49.327355 [info ] [MainThread]: Required dependencies:
[0m02:47:49.327774 [debug] [MainThread]: Executing "git --help"
[0m02:47:49.329445 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:47:49.329906 [debug] [MainThread]: STDERR: "b''"
[0m02:47:49.330180 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:47:49.330470 [info ] [MainThread]: Connection:
[0m02:47:49.330827 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m02:47:49.331128 [info ] [MainThread]:   user: lamirtha
[0m02:47:49.331417 [info ] [MainThread]:   database: RETAIL_DW
[0m02:47:49.331751 [info ] [MainThread]:   warehouse: RETAIL_WH_TEST
[0m02:47:49.332128 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:47:49.332517 [info ] [MainThread]:   schema: STAGING
[0m02:47:49.332852 [info ] [MainThread]:   authenticator: None
[0m02:47:49.333162 [info ] [MainThread]:   oauth_client_id: None
[0m02:47:49.333465 [info ] [MainThread]:   query_tag: None
[0m02:47:49.333791 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:47:49.334114 [info ] [MainThread]:   host: None
[0m02:47:49.334417 [info ] [MainThread]:   port: None
[0m02:47:49.334734 [info ] [MainThread]:   proxy_host: None
[0m02:47:49.335022 [info ] [MainThread]:   proxy_port: None
[0m02:47:49.335303 [info ] [MainThread]:   protocol: None
[0m02:47:49.335613 [info ] [MainThread]:   connect_retries: 1
[0m02:47:49.335906 [info ] [MainThread]:   connect_timeout: None
[0m02:47:49.336211 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:47:49.336514 [info ] [MainThread]:   retry_all: False
[0m02:47:49.336824 [info ] [MainThread]:   insecure_mode: False
[0m02:47:49.337129 [info ] [MainThread]:   reuse_connections: None
[0m02:47:49.337561 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:47:49.401405 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:47:49.402028 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:47:49.402358 [debug] [MainThread]: On debug: select 1 as id
[0m02:47:49.402664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:50.527618 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m02:47:50.528360 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m02:47:50.529014 [debug] [MainThread]: On debug: No close available on handle
[0m02:47:50.529571 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:47:50.530182 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:47:50.530837 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:47:50.532423 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.8639431, "process_user_time": 2.817898, "process_kernel_time": 0.170993, "process_mem_max_rss": "198760", "process_out_blocks": "22", "command_success": false, "process_in_blocks": "0"}
[0m02:47:50.533325 [debug] [MainThread]: Command `dbt debug` failed at 02:47:50.533132 after 1.86 seconds
[0m02:47:50.533877 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:47:50.534418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3efa0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9853f7d0>]}
[0m02:47:50.535033 [debug] [MainThread]: Flushing usage events
[0m02:48:18.832375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa2e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f44350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1532450>]}


============================== 02:48:18.837971 | c86c7940-6b4b-4dee-ad85-e3a8e285f223 ==============================
[0m02:48:18.837971 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:48:18.838601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:48:18.844050 [info ] [MainThread]: dbt version: 1.8.2
[0m02:48:18.844452 [info ] [MainThread]: python version: 3.12.7
[0m02:48:18.844873 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:48:18.845221 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:48:19.372967 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m02:48:19.373418 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m02:48:19.373910 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m02:48:19.374443 [info ] [MainThread]: adapter type: snowflake
[0m02:48:19.374797 [info ] [MainThread]: adapter version: 1.8.2
[0m02:48:19.440713 [info ] [MainThread]: Configuration:
[0m02:48:19.441172 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:48:19.441566 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:48:19.441981 [info ] [MainThread]: Required dependencies:
[0m02:48:19.442390 [debug] [MainThread]: Executing "git --help"
[0m02:48:19.443893 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:48:19.444316 [debug] [MainThread]: STDERR: "b''"
[0m02:48:19.444618 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:48:19.444967 [info ] [MainThread]: Connection:
[0m02:48:19.445302 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m02:48:19.445622 [info ] [MainThread]:   user: lamirtha
[0m02:48:19.445963 [info ] [MainThread]:   database: RETAIL_DW
[0m02:48:19.446309 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m02:48:19.446605 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:48:19.446979 [info ] [MainThread]:   schema: STAGING
[0m02:48:19.447343 [info ] [MainThread]:   authenticator: None
[0m02:48:19.447651 [info ] [MainThread]:   oauth_client_id: None
[0m02:48:19.447962 [info ] [MainThread]:   query_tag: None
[0m02:48:19.448254 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:48:19.448545 [info ] [MainThread]:   host: None
[0m02:48:19.448864 [info ] [MainThread]:   port: None
[0m02:48:19.449162 [info ] [MainThread]:   proxy_host: None
[0m02:48:19.449455 [info ] [MainThread]:   proxy_port: None
[0m02:48:19.449849 [info ] [MainThread]:   protocol: None
[0m02:48:19.450133 [info ] [MainThread]:   connect_retries: 1
[0m02:48:19.450422 [info ] [MainThread]:   connect_timeout: None
[0m02:48:19.450727 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:48:19.451010 [info ] [MainThread]:   retry_all: False
[0m02:48:19.451290 [info ] [MainThread]:   insecure_mode: False
[0m02:48:19.451568 [info ] [MainThread]:   reuse_connections: None
[0m02:48:19.452001 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:48:19.516084 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:48:19.516720 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:48:19.517056 [debug] [MainThread]: On debug: select 1 as id
[0m02:48:19.517368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:48:20.032160 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m02:48:20.033258 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m02:48:20.033984 [debug] [MainThread]: On debug: No close available on handle
[0m02:48:20.034638 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:48:20.035330 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:48:20.036133 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:48:20.038205 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.2400389, "process_user_time": 2.771383, "process_kernel_time": 0.123061, "process_mem_max_rss": "198668", "process_out_blocks": "22", "command_success": false, "process_in_blocks": "0"}
[0m02:48:20.039172 [debug] [MainThread]: Command `dbt debug` failed at 02:48:20.039041 after 1.24 seconds
[0m02:48:20.039711 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:48:20.040261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25b97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93873b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95775c70>]}
[0m02:48:20.040942 [debug] [MainThread]: Flushing usage events
[0m02:55:31.145442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4db5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ccb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cc82c0>]}


============================== 02:55:31.165355 | 39ab074c-f2ec-47aa-93e8-130d2de944e5 ==============================
[0m02:55:31.165355 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:55:31.165887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:55:31.194016 [info ] [MainThread]: dbt version: 1.8.2
[0m02:55:31.194389 [info ] [MainThread]: python version: 3.12.7
[0m02:55:31.194744 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:55:31.195063 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:55:32.780715 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m02:55:32.781217 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m02:55:32.781649 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m02:55:32.782180 [info ] [MainThread]: adapter type: snowflake
[0m02:55:32.782623 [info ] [MainThread]: adapter version: 1.8.2
[0m02:55:32.850791 [info ] [MainThread]: Configuration:
[0m02:55:32.851295 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:55:32.851710 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:55:32.852074 [info ] [MainThread]: Required dependencies:
[0m02:55:32.852498 [debug] [MainThread]: Executing "git --help"
[0m02:55:32.854149 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:55:32.854591 [debug] [MainThread]: STDERR: "b''"
[0m02:55:32.854867 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:55:32.855183 [info ] [MainThread]: Connection:
[0m02:55:32.855506 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m02:55:32.855801 [info ] [MainThread]:   user: lamirtha
[0m02:55:32.856136 [info ] [MainThread]:   database: RETAIL_DW
[0m02:55:32.856473 [info ] [MainThread]:   warehouse: RETAIL_WH
[0m02:55:32.856766 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:55:32.857074 [info ] [MainThread]:   schema: STAGING
[0m02:55:32.857509 [info ] [MainThread]:   authenticator: None
[0m02:55:32.857780 [info ] [MainThread]:   oauth_client_id: None
[0m02:55:32.858058 [info ] [MainThread]:   query_tag: None
[0m02:55:32.858401 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:55:32.858736 [info ] [MainThread]:   host: None
[0m02:55:32.859058 [info ] [MainThread]:   port: None
[0m02:55:32.859413 [info ] [MainThread]:   proxy_host: None
[0m02:55:32.859831 [info ] [MainThread]:   proxy_port: None
[0m02:55:32.860168 [info ] [MainThread]:   protocol: None
[0m02:55:32.860480 [info ] [MainThread]:   connect_retries: 1
[0m02:55:32.860786 [info ] [MainThread]:   connect_timeout: None
[0m02:55:32.861085 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:55:32.861459 [info ] [MainThread]:   retry_all: False
[0m02:55:32.861757 [info ] [MainThread]:   insecure_mode: False
[0m02:55:32.862050 [info ] [MainThread]:   reuse_connections: None
[0m02:55:32.862554 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:55:32.929010 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:55:32.929702 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:55:32.930044 [debug] [MainThread]: On debug: select 1 as id
[0m02:55:32.930355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:34.323958 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.393 seconds
[0m02:55:34.325554 [debug] [MainThread]: On debug: Close
[0m02:55:34.528488 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:55:34.529568 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:55:34.531584 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4211092, "process_user_time": 4.235746, "process_kernel_time": 0.213794, "process_mem_max_rss": "205736", "process_out_blocks": "28117", "process_in_blocks": "0"}
[0m02:55:34.532574 [debug] [MainThread]: Command `dbt debug` succeeded at 02:55:34.532439 after 3.42 seconds
[0m02:55:34.533138 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:55:34.533683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45e4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4840f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ded730>]}
[0m02:55:34.534421 [debug] [MainThread]: Flushing usage events
[0m02:55:43.940832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804aa660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804d1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fab97f0>]}


============================== 02:55:43.946358 | dd4288d1-998b-4ddc-ae94-bf9aa25b91db ==============================
[0m02:55:43.946358 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:55:43.947006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --target test_wh', 'send_anonymous_usage_stats': 'True'}
[0m02:55:43.952559 [info ] [MainThread]: dbt version: 1.8.2
[0m02:55:43.952980 [info ] [MainThread]: python version: 3.12.7
[0m02:55:43.953362 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:55:43.953757 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:55:44.483247 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m02:55:44.483754 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m02:55:44.484220 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/retail_dbt/dbt_project.yml
[0m02:55:44.484789 [info ] [MainThread]: adapter type: snowflake
[0m02:55:44.485142 [info ] [MainThread]: adapter version: 1.8.2
[0m02:55:44.551173 [info ] [MainThread]: Configuration:
[0m02:55:44.551567 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:55:44.551972 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:55:44.552357 [info ] [MainThread]: Required dependencies:
[0m02:55:44.552761 [debug] [MainThread]: Executing "git --help"
[0m02:55:44.554225 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:55:44.554641 [debug] [MainThread]: STDERR: "b''"
[0m02:55:44.554898 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:55:44.555266 [info ] [MainThread]: Connection:
[0m02:55:44.555617 [info ] [MainThread]:   account: PIITFVT-FW65290
[0m02:55:44.555932 [info ] [MainThread]:   user: lamirtha
[0m02:55:44.556298 [info ] [MainThread]:   database: RETAIL_DW
[0m02:55:44.556618 [info ] [MainThread]:   warehouse: RETAIL_WH_TEST
[0m02:55:44.556914 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:55:44.557236 [info ] [MainThread]:   schema: STAGING
[0m02:55:44.557590 [info ] [MainThread]:   authenticator: None
[0m02:55:44.557895 [info ] [MainThread]:   oauth_client_id: None
[0m02:55:44.558278 [info ] [MainThread]:   query_tag: None
[0m02:55:44.558610 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:55:44.558915 [info ] [MainThread]:   host: None
[0m02:55:44.559264 [info ] [MainThread]:   port: None
[0m02:55:44.559576 [info ] [MainThread]:   proxy_host: None
[0m02:55:44.559878 [info ] [MainThread]:   proxy_port: None
[0m02:55:44.560152 [info ] [MainThread]:   protocol: None
[0m02:55:44.560426 [info ] [MainThread]:   connect_retries: 1
[0m02:55:44.560729 [info ] [MainThread]:   connect_timeout: None
[0m02:55:44.561025 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:55:44.561344 [info ] [MainThread]:   retry_all: False
[0m02:55:44.561632 [info ] [MainThread]:   insecure_mode: False
[0m02:55:44.561919 [info ] [MainThread]:   reuse_connections: None
[0m02:55:44.562376 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m02:55:44.623890 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:55:44.624501 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:55:44.624803 [debug] [MainThread]: On debug: select 1 as id
[0m02:55:44.625094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:45.351978 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.726 seconds
[0m02:55:45.354681 [debug] [MainThread]: On debug: Close
[0m02:55:45.560273 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:55:45.561619 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:55:45.563762 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6571891, "process_user_time": 2.712856, "process_kernel_time": 0.153708, "process_mem_max_rss": "199120", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m02:55:45.564898 [debug] [MainThread]: Command `dbt debug` succeeded at 02:55:45.564730 after 1.66 seconds
[0m02:55:45.565587 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:55:45.566180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fab97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644d88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643b20c0>]}
[0m02:55:45.566851 [debug] [MainThread]: Flushing usage events
[0m03:00:02.231604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3befce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68c7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5907d70>]}


============================== 03:00:02.238129 | 81b05b71-f8c8-44a3-ade6-b1baaea1636f ==============================
[0m03:00:02.238129 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:00:02.238844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:00:02.322479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b05b71-f8c8-44a3-ade6-b1baaea1636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4719820>]}
[0m03:00:02.389906 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b2s6fi2b'
[0m03:00:02.390370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:00:02.983128 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:00:02.984510 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:00:03.320591 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:00:03.327983 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:00:03.994645 [info ] [MainThread]: Installed from version 1.3.0
[0m03:00:03.995560 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:00:03.996018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '81b05b71-f8c8-44a3-ade6-b1baaea1636f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3befce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4feeae0>]}
[0m03:00:03.996421 [info ] [MainThread]: 
[0m03:00:03.996962 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:00:03.998064 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8010501, "process_user_time": 1.684755, "process_kernel_time": 0.132137, "process_mem_max_rss": "164704", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:00:03.998561 [debug] [MainThread]: Command `dbt deps` succeeded at 03:00:03.998444 after 1.80 seconds
[0m03:00:03.998984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5907d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3884b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36e3620>]}
[0m03:00:03.999334 [debug] [MainThread]: Flushing usage events
[0m03:00:07.230501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807bfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d678c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d7f1a0>]}


============================== 03:00:07.236095 | 39a0916d-e84b-4aa3-8c49-fa144e9ee804 ==============================
[0m03:00:07.236095 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:00:07.236840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:00:07.867168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39a0916d-e84b-4aa3-8c49-fa144e9ee804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbfeb40>]}
[0m03:00:07.906286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39a0916d-e84b-4aa3-8c49-fa144e9ee804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c52d80>]}
[0m03:00:07.906880 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:00:07.987164 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:00:08.129644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:08.130030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:08.169383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a0916d-e84b-4aa3-8c49-fa144e9ee804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6446de20>]}
[0m03:00:08.271117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a0916d-e84b-4aa3-8c49-fa144e9ee804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640765d0>]}
[0m03:00:08.271517 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:00:08.272077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a0916d-e84b-4aa3-8c49-fa144e9ee804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe10800>]}
[0m03:00:08.273718 [info ] [MainThread]: 
[0m03:00:08.274349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:08.275121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:00:08.286313 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:00:08.286618 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:00:08.286870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:08.834963 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:00:08.835909 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:00:08.836494 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:00:08.836896 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:00:08.837295 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:00:08.838260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:08.838666 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:00:08.839066 [info ] [MainThread]: 
[0m03:00:08.839856 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m03:00:08.840492 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m03:00:08.841739 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6464939, "process_user_time": 3.021369, "process_kernel_time": 0.18092, "process_mem_max_rss": "205336", "process_in_blocks": "120", "process_out_blocks": "1384", "command_success": false}
[0m03:00:08.842435 [debug] [MainThread]: Command `dbt snapshot` failed at 03:00:08.842329 after 1.65 seconds
[0m03:00:08.842823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdcfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64435a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fb5580>]}
[0m03:00:08.843183 [debug] [MainThread]: Flushing usage events
[0m03:05:11.713719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1746ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1746c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1746a50>]}


============================== 03:05:11.720203 | 12bebb26-c3b2-4112-9352-bf53a2b8575a ==============================
[0m03:05:11.720203 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:05:11.721186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:05:12.404894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12bebb26-c3b2-4112-9352-bf53a2b8575a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866af080>]}
[0m03:05:12.444529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12bebb26-c3b2-4112-9352-bf53a2b8575a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3486e0>]}
[0m03:05:12.445112 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:05:12.523246 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:05:12.670606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:12.670969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:12.711102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12bebb26-c3b2-4112-9352-bf53a2b8575a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa195d220>]}
[0m03:05:12.817793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12bebb26-c3b2-4112-9352-bf53a2b8575a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dda3f0>]}
[0m03:05:12.818245 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:05:12.818900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12bebb26-c3b2-4112-9352-bf53a2b8575a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985176e0>]}
[0m03:05:12.820650 [info ] [MainThread]: 
[0m03:05:12.821224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:05:12.821978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:05:12.833493 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:05:12.833802 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:05:12.834118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:13.396796 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:05:13.397627 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:05:13.398306 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:05:13.398785 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:05:13.399364 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:05:13.400536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:13.401034 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:05:13.401537 [info ] [MainThread]: 
[0m03:05:13.402472 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m03:05:13.403449 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m03:05:13.405227 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.7281097, "process_user_time": 3.151618, "process_kernel_time": 0.258872, "process_mem_max_rss": "205212", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:05:13.405940 [debug] [MainThread]: Command `dbt snapshot` failed at 03:05:13.405810 after 1.73 seconds
[0m03:05:13.406463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1957e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bd6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87986240>]}
[0m03:05:13.407215 [debug] [MainThread]: Flushing usage events
[0m03:12:33.957698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad635c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a2a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc46b980>]}


============================== 03:12:33.963852 | 0a32a663-20eb-4ae5-8ab0-1d4dfe8b4190 ==============================
[0m03:12:33.963852 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:12:33.964599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:12:34.045824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a32a663-20eb-4ae5-8ab0-1d4dfe8b4190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb941d4f0>]}
[0m03:12:34.116869 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9e9sdqgu'
[0m03:12:34.117259 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:12:34.256836 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:12:34.257511 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:12:34.315097 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:12:34.318571 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:12:34.969884 [info ] [MainThread]: Installed from version 1.3.0
[0m03:12:34.970595 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:12:34.971136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a32a663-20eb-4ae5-8ab0-1d4dfe8b4190', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb91c2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba04e360>]}
[0m03:12:34.971585 [info ] [MainThread]: 
[0m03:12:34.971952 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:12:34.972927 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0503647, "process_user_time": 1.673447, "process_kernel_time": 0.120186, "process_mem_max_rss": "164064", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:12:34.973354 [debug] [MainThread]: Command `dbt deps` succeeded at 03:12:34.973272 after 1.05 seconds
[0m03:12:34.973659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb998ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb941d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb91df9e0>]}
[0m03:12:34.973962 [debug] [MainThread]: Flushing usage events
[0m03:12:37.916567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c668170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c40d310>]}


============================== 03:12:37.922138 | 0c298082-7c50-448b-9c32-52ddbbeeb62a ==============================
[0m03:12:37.922138 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:12:37.922609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:12:38.543058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c298082-7c50-448b-9c32-52ddbbeeb62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e7abd70>]}
[0m03:12:38.582804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c298082-7c50-448b-9c32-52ddbbeeb62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893c2db0>]}
[0m03:12:38.583389 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:12:38.658103 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:12:38.799749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:38.800126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:38.840042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c298082-7c50-448b-9c32-52ddbbeeb62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dcf1940>]}
[0m03:12:38.943706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c298082-7c50-448b-9c32-52ddbbeeb62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d889730>]}
[0m03:12:38.944152 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:12:38.944468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c298082-7c50-448b-9c32-52ddbbeeb62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dc7a780>]}
[0m03:12:38.946231 [info ] [MainThread]: 
[0m03:12:38.946722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:12:38.947425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:12:38.958847 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:12:38.959152 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:12:38.959403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:39.487582 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:12:39.488600 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:12:39.489175 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:12:39.489636 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:12:39.490669 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:12:39.491933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:39.492391 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:12:39.492877 [info ] [MainThread]: 
[0m03:12:39.493367 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m03:12:39.494082 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m03:12:39.495381 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6144431, "process_user_time": 3.042686, "process_kernel_time": 0.153782, "process_mem_max_rss": "205196", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:12:39.496086 [debug] [MainThread]: Command `dbt snapshot` failed at 03:12:39.495960 after 1.62 seconds
[0m03:12:39.496602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c2bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dcd3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d8b8980>]}
[0m03:12:39.497094 [debug] [MainThread]: Flushing usage events
[0m03:17:42.434439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c167d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899efbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3cda00>]}


============================== 03:17:42.441149 | 18c6a16e-6df6-4f0c-8808-23aad602eedb ==============================
[0m03:17:42.441149 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:17:42.441908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:17:43.168490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18c6a16e-6df6-4f0c-8808-23aad602eedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6debe0c0>]}
[0m03:17:43.208289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18c6a16e-6df6-4f0c-8808-23aad602eedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893cce90>]}
[0m03:17:43.208918 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:17:43.286122 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:17:43.432902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:17:43.433318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:17:43.474005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18c6a16e-6df6-4f0c-8808-23aad602eedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6da81eb0>]}
[0m03:17:43.581269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18c6a16e-6df6-4f0c-8808-23aad602eedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2a5f10>]}
[0m03:17:43.581724 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:17:43.582316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18c6a16e-6df6-4f0c-8808-23aad602eedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6da80800>]}
[0m03:17:43.584112 [info ] [MainThread]: 
[0m03:17:43.584708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:17:43.585529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:17:43.597155 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:17:43.597463 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:17:43.597714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:17:44.272864 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:17:44.273615 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:17:44.274209 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:17:44.274643 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:17:44.275244 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:17:44.276223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:17:44.276666 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:17:44.277108 [info ] [MainThread]: 
[0m03:17:44.277996 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m03:17:44.278634 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m03:17:44.279976 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.8823314, "process_user_time": 3.181016, "process_kernel_time": 0.263891, "process_mem_max_rss": "205516", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:17:44.280569 [debug] [MainThread]: Command `dbt snapshot` failed at 03:17:44.280463 after 1.88 seconds
[0m03:17:44.281050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b575ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d6769f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5b5670>]}
[0m03:17:44.281493 [debug] [MainThread]: Flushing usage events
[0m03:20:53.742146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9fb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917b9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e31d5b0>]}


============================== 03:20:53.749152 | 6406a0ca-33f5-4b93-8d6d-b4b91b4d3f15 ==============================
[0m03:20:53.749152 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:20:53.749696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m03:20:53.834401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6406a0ca-33f5-4b93-8d6d-b4b91b4d3f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce61820>]}
[0m03:20:53.908164 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y9gjqy4n'
[0m03:20:53.908653 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:20:54.089654 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:20:54.090647 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:20:54.193564 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:20:54.197312 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:20:54.838135 [info ] [MainThread]: Installed from version 1.3.0
[0m03:20:54.838740 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:20:54.839334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6406a0ca-33f5-4b93-8d6d-b4b91b4d3f15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce63350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce616a0>]}
[0m03:20:54.839794 [info ] [MainThread]: 
[0m03:20:54.840097 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:20:54.841047 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1343684, "process_user_time": 1.73309, "process_kernel_time": 0.130913, "process_mem_max_rss": "164108", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:20:54.841483 [debug] [MainThread]: Command `dbt deps` succeeded at 03:20:54.841388 after 1.13 seconds
[0m03:20:54.841796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fee5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900977d0>]}
[0m03:20:54.842095 [debug] [MainThread]: Flushing usage events
[0m03:20:57.669514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae11070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad721b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aca2ab0>]}


============================== 03:20:57.675207 | 7c99e002-280a-44dd-84cb-618e5bf213fb ==============================
[0m03:20:57.675207 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:20:57.675925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:20:58.309677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c99e002-280a-44dd-84cb-618e5bf213fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f73fdd0>]}
[0m03:20:58.351423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c99e002-280a-44dd-84cb-618e5bf213fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f48a150>]}
[0m03:20:58.352092 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:20:58.426340 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:20:58.566748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:20:58.567100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:20:58.607027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c99e002-280a-44dd-84cb-618e5bf213fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e1f800>]}
[0m03:20:58.713995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c99e002-280a-44dd-84cb-618e5bf213fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eeb5f70>]}
[0m03:20:58.714476 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:20:58.715010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c99e002-280a-44dd-84cb-618e5bf213fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c561e20>]}
[0m03:20:58.716738 [info ] [MainThread]: 
[0m03:20:58.717350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:20:58.718052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:20:58.729473 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:20:58.729790 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:20:58.730047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:59.288554 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:20:59.289236 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:20:59.289790 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:20:59.290138 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:20:59.290526 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:20:59.291308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:20:59.291607 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:20:59.291918 [info ] [MainThread]: 
[0m03:20:59.292679 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m03:20:59.293165 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:20:59.294204 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6604682, "process_user_time": 3.087119, "process_kernel_time": 0.174533, "process_mem_max_rss": "205424", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:20:59.294707 [debug] [MainThread]: Command `dbt snapshot` failed at 03:20:59.294599 after 1.66 seconds
[0m03:20:59.295103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b67dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa5dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eeebaa0>]}
[0m03:20:59.295473 [debug] [MainThread]: Flushing usage events
[0m03:23:56.967896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86767e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86767a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867657f0>]}


============================== 03:23:56.974619 | 7a95b252-9477-41c4-9b29-db674853ff0f ==============================
[0m03:23:56.974619 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:23:56.975806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:23:57.076008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a95b252-9477-41c4-9b29-db674853ff0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a97e60>]}
[0m03:23:57.165631 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v08m1kuh'
[0m03:23:57.166067 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:23:57.293283 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:23:57.293936 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:23:57.513967 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:23:57.521402 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:23:58.148884 [info ] [MainThread]: Installed from version 1.3.0
[0m03:23:58.149566 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:23:58.150192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a95b252-9477-41c4-9b29-db674853ff0f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866da9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866daf60>]}
[0m03:23:58.150559 [info ] [MainThread]: 
[0m03:23:58.150966 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:23:58.152060 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.224297, "process_user_time": 1.831593, "process_kernel_time": 0.131696, "process_mem_max_rss": "164144", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:23:58.152539 [debug] [MainThread]: Command `dbt deps` succeeded at 03:23:58.152408 after 1.22 seconds
[0m03:23:58.152873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f09550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866a4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867657f0>]}
[0m03:23:58.153189 [debug] [MainThread]: Flushing usage events
[0m03:24:00.829329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842b8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842bbb00>]}


============================== 03:24:00.834877 | 4d556212-944d-42a0-9932-7cf069b8046f ==============================
[0m03:24:00.834877 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:24:00.835361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:24:01.477324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d556212-944d-42a0-9932-7cf069b8046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68bbc4a0>]}
[0m03:24:01.516632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d556212-944d-42a0-9932-7cf069b8046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68bdc9e0>]}
[0m03:24:01.517229 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:24:01.591513 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:24:01.734524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:01.734906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:01.774971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d556212-944d-42a0-9932-7cf069b8046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854575f0>]}
[0m03:24:01.878835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d556212-944d-42a0-9932-7cf069b8046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68b1f260>]}
[0m03:24:01.879255 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:24:01.879608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d556212-944d-42a0-9932-7cf069b8046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68547bf0>]}
[0m03:24:01.881374 [info ] [MainThread]: 
[0m03:24:01.881846 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:24:01.882586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:24:01.893832 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:24:01.894155 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:24:01.894410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:02.418851 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:24:02.420009 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:24:02.420736 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:24:02.421164 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:24:02.422119 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:24:02.423590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:02.424135 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:24:02.424650 [info ] [MainThread]: 
[0m03:24:02.425202 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m03:24:02.425966 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:24:02.427489 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6337478, "process_user_time": 3.10473, "process_kernel_time": 0.17115, "process_mem_max_rss": "205280", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:24:02.428221 [debug] [MainThread]: Command `dbt snapshot` failed at 03:24:02.428068 after 1.63 seconds
[0m03:24:02.428717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851b9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68586510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff685bde50>]}
[0m03:24:02.429246 [debug] [MainThread]: Flushing usage events
[0m03:26:01.939915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a05100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a04fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39fca40>]}


============================== 03:26:01.946414 | d95e5cc1-011e-4811-938a-4f7c34a6a7b1 ==============================
[0m03:26:01.946414 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:26:01.947121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:26:02.588864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd95e5cc1-011e-4811-938a-4f7c34a6a7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa517e2d0>]}
[0m03:26:02.629116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd95e5cc1-011e-4811-938a-4f7c34a6a7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d931eb0>]}
[0m03:26:02.629774 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:26:02.706290 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:26:02.844171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:26:02.844586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:26:02.884569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd95e5cc1-011e-4811-938a-4f7c34a6a7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882e93a0>]}
[0m03:26:02.986871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd95e5cc1-011e-4811-938a-4f7c34a6a7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cb21b0>]}
[0m03:26:02.987337 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:26:02.987879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd95e5cc1-011e-4811-938a-4f7c34a6a7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c81b80>]}
[0m03:26:02.989601 [info ] [MainThread]: 
[0m03:26:02.990209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:26:02.990955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:26:03.002283 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:26:03.002606 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:26:03.002881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:03.351059 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:26:03.351781 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:26:03.352411 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:26:03.352876 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:26:03.353436 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:26:03.354419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:03.354828 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:26:03.355262 [info ] [MainThread]: 
[0m03:26:03.356057 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m03:26:03.356654 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:26:03.357838 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.4528779, "process_user_time": 3.090681, "process_kernel_time": 0.151783, "process_mem_max_rss": "205640", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:26:03.358415 [debug] [MainThread]: Command `dbt snapshot` failed at 03:26:03.358322 after 1.45 seconds
[0m03:26:03.358790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d1dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e4bce0>]}
[0m03:26:03.359157 [debug] [MainThread]: Flushing usage events
[0m03:29:05.100099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0632c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b063020>]}


============================== 03:29:05.106945 | fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1 ==============================
[0m03:29:05.106945 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:05.107726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:29:05.799408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f702180>]}
[0m03:29:05.838841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdfeb40>]}
[0m03:29:05.839424 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:29:05.915015 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:06.060459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:29:06.060834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:29:06.100814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a45b380>]}
[0m03:29:06.205909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e982090>]}
[0m03:29:06.206319 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:29:06.206907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe958713-d9bf-4e2b-8bf7-e25e6d85b4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efb66f0>]}
[0m03:29:06.208674 [info ] [MainThread]: 
[0m03:29:06.209277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:29:06.210028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:29:06.221370 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:29:06.221675 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:06.221940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:06.600555 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:06.601222 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:06.601784 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:29:06.602189 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:06.602655 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:29:06.603513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:06.603927 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:29:06.604272 [info ] [MainThread]: 
[0m03:29:06.605116 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m03:29:06.605652 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:29:06.606848 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.5425019, "process_user_time": 3.108146, "process_kernel_time": 0.264756, "process_mem_max_rss": "205680", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:29:06.607524 [debug] [MainThread]: Command `dbt snapshot` failed at 03:29:06.607414 after 1.54 seconds
[0m03:29:06.607955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b063020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed723c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e9b1df0>]}
[0m03:29:06.608366 [debug] [MainThread]: Flushing usage events
[0m03:29:29.799483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab19700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5d9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab19670>]}


============================== 03:29:29.805110 | 2f377707-fcde-46a8-99bd-f07d5a4d842c ==============================
[0m03:29:29.805110 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:29.805943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:29:29.886550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f377707-fcde-46a8-99bd-f07d5a4d842c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a922870>]}
[0m03:29:29.956214 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-doj59ekt'
[0m03:29:29.956683 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:29:30.135717 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:29:30.136762 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:29:30.213861 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:29:30.219533 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:29:30.842504 [info ] [MainThread]: Installed from version 1.3.0
[0m03:29:30.843211 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:29:30.843752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f377707-fcde-46a8-99bd-f07d5a4d842c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a980680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a983080>]}
[0m03:29:30.844228 [info ] [MainThread]: 
[0m03:29:30.844746 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:29:30.845808 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0815431, "process_user_time": 1.687886, "process_kernel_time": 0.111587, "process_mem_max_rss": "164140", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:29:30.846286 [debug] [MainThread]: Command `dbt deps` succeeded at 03:29:30.846194 after 1.08 seconds
[0m03:29:30.846703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac5a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9acda7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b02b5f0>]}
[0m03:29:30.847041 [debug] [MainThread]: Flushing usage events
[0m03:29:42.838517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8197530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8197e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8702ff0>]}


============================== 03:29:42.844546 | d697917e-7db8-4098-bcd7-bcdd19f733eb ==============================
[0m03:29:42.844546 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:42.845046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:29:43.487846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd697917e-7db8-4098-bcd7-bcdd19f733eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3cd760>]}
[0m03:29:43.530371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd697917e-7db8-4098-bcd7-bcdd19f733eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85a0980>]}
[0m03:29:43.531110 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:29:43.613617 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:43.752831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:29:43.753300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:29:43.795444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd697917e-7db8-4098-bcd7-bcdd19f733eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daa0410>]}
[0m03:29:43.944770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd697917e-7db8-4098-bcd7-bcdd19f733eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdceb70>]}
[0m03:29:43.957827 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:29:43.966175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd697917e-7db8-4098-bcd7-bcdd19f733eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6bdd30>]}
[0m03:29:43.970052 [info ] [MainThread]: 
[0m03:29:43.971344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:29:43.972526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:29:43.985674 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:29:43.986160 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:43.986617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:44.352252 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:44.352861 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:44.353299 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:29:44.353647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:44.354034 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:29:44.354816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:44.355110 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:29:44.355391 [info ] [MainThread]: 
[0m03:29:44.356058 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m03:29:44.356662 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:29:44.357942 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.5558678, "process_user_time": 2.988182, "process_kernel_time": 0.169613, "process_mem_max_rss": "205348", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:29:44.358585 [debug] [MainThread]: Command `dbt snapshot` failed at 03:29:44.358499 after 1.56 seconds
[0m03:29:44.358925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89a86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdcc6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdcf3e0>]}
[0m03:29:44.359245 [debug] [MainThread]: Flushing usage events
[0m03:29:46.079394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830c1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a46390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824a4050>]}


============================== 03:29:46.085054 | 19c038d2-e6c1-4e04-aa03-34f8908aae15 ==============================
[0m03:29:46.085054 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:46.085611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:29:46.167058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19c038d2-e6c1-4e04-aa03-34f8908aae15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83313ce0>]}
[0m03:29:46.225815 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_u99ialx'
[0m03:29:46.226371 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:29:46.288581 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:29:46.289228 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:29:46.326237 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:29:46.329550 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:29:46.881090 [info ] [MainThread]: Installed from version 1.3.0
[0m03:29:46.881737 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:29:46.882396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19c038d2-e6c1-4e04-aa03-34f8908aae15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82443ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82443ef0>]}
[0m03:29:46.882798 [info ] [MainThread]: 
[0m03:29:46.883357 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:29:46.884636 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8409849, "process_user_time": 1.798748, "process_kernel_time": 0.085895, "process_mem_max_rss": "164116", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:29:46.885105 [debug] [MainThread]: Command `dbt deps` succeeded at 03:29:46.885010 after 0.84 seconds
[0m03:29:46.885429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854f8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837b3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d286b0>]}
[0m03:29:46.885789 [debug] [MainThread]: Flushing usage events
[0m03:29:49.864040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5029d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52b9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa493d700>]}


============================== 03:29:49.869876 | f80b76c7-780b-4f4c-b86f-18b6d7f101e8 ==============================
[0m03:29:49.869876 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:49.870755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:29:50.503638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f80b76c7-780b-4f4c-b86f-18b6d7f101e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889042c0>]}
[0m03:29:50.543243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f80b76c7-780b-4f4c-b86f-18b6d7f101e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889d6600>]}
[0m03:29:50.543904 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:29:50.618183 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:50.756483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:29:50.756900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:29:50.796758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f80b76c7-780b-4f4c-b86f-18b6d7f101e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885e2060>]}
[0m03:29:50.898970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f80b76c7-780b-4f4c-b86f-18b6d7f101e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881ce240>]}
[0m03:29:50.899440 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:29:50.900029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f80b76c7-780b-4f4c-b86f-18b6d7f101e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881cdbe0>]}
[0m03:29:50.901837 [info ] [MainThread]: 
[0m03:29:50.902462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:29:50.903261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:29:50.914695 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:29:50.915118 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:50.915480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:51.245737 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:29:51.246605 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:51.247326 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:29:51.247912 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:29:51.248561 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:29:51.249660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:51.250203 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:29:51.250732 [info ] [MainThread]: 
[0m03:29:51.251661 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:29:51.252406 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:29:51.253601 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.425123, "process_user_time": 3.098762, "process_kernel_time": 0.182043, "process_mem_max_rss": "205176", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:29:51.254249 [debug] [MainThread]: Command `dbt snapshot` failed at 03:29:51.254147 after 1.43 seconds
[0m03:29:51.254713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa490fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881cee40>]}
[0m03:29:51.255319 [debug] [MainThread]: Flushing usage events
[0m03:31:47.343860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e2af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4758800>]}


============================== 03:31:47.350821 | 631bee48-e43c-453b-8800-1c877b432b26 ==============================
[0m03:31:47.350821 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:31:47.351549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:31:48.011616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '631bee48-e43c-453b-8800-1c877b432b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ea93a0>]}
[0m03:31:48.051042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '631bee48-e43c-453b-8800-1c877b432b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990e2f30>]}
[0m03:31:48.051706 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:31:48.126524 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:31:48.263561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:31:48.263993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:31:48.304256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '631bee48-e43c-453b-8800-1c877b432b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c03830>]}
[0m03:31:48.409075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '631bee48-e43c-453b-8800-1c877b432b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98901a30>]}
[0m03:31:48.409581 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:31:48.410151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631bee48-e43c-453b-8800-1c877b432b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987f8830>]}
[0m03:31:48.412016 [info ] [MainThread]: 
[0m03:31:48.412664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:31:48.413449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:31:48.424989 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:31:48.425347 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:31:48.425683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:31:48.940581 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:31:48.941458 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:31:48.942116 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:31:48.942600 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:31:48.943213 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:31:48.944111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:31:48.944496 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:31:48.944930 [info ] [MainThread]: 
[0m03:31:48.945736 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m03:31:48.946444 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:31:48.947810 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6403307, "process_user_time": 3.118966, "process_kernel_time": 0.245997, "process_mem_max_rss": "205148", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:31:48.948481 [debug] [MainThread]: Command `dbt snapshot` failed at 03:31:48.948359 after 1.64 seconds
[0m03:31:48.949019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e44740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98806720>]}
[0m03:31:48.949455 [debug] [MainThread]: Flushing usage events
[0m03:31:54.188160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8a1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af05cd0>]}


============================== 03:31:54.194124 | 3f61b7f2-fd90-4792-8784-1f8df9f23e5f ==============================
[0m03:31:54.194124 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:31:54.194836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:31:54.849013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f61b7f2-fd90-4792-8784-1f8df9f23e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af77950>]}
[0m03:31:54.891551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f61b7f2-fd90-4792-8784-1f8df9f23e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff380e0>]}
[0m03:31:54.892334 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:31:54.969193 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:31:55.106241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:31:55.106669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:31:55.146300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f61b7f2-fd90-4792-8784-1f8df9f23e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efde6c0>]}
[0m03:31:55.252651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f61b7f2-fd90-4792-8784-1f8df9f23e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ebaebd0>]}
[0m03:31:55.253187 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:31:55.253805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f61b7f2-fd90-4792-8784-1f8df9f23e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb731d0>]}
[0m03:31:55.255617 [info ] [MainThread]: 
[0m03:31:55.256225 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:31:55.257149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:31:55.322729 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:31:55.339576 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:31:55.340739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:31:55.680537 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:31:55.681443 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:31:55.682437 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:31:55.683016 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:31:55.683636 [debug] [ThreadPool]: On list_RETAIL_DW: No close available on handle
[0m03:31:55.684757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:31:55.685365 [debug] [MainThread]: Connection 'list_RETAIL_DW' was properly closed.
[0m03:31:55.685941 [info ] [MainThread]: 
[0m03:31:55.686885 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m03:31:55.687628 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RETAIL_DW"
  Database Error
    250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m03:31:55.688643 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.5359706, "process_user_time": 3.149276, "process_kernel_time": 0.205808, "process_mem_max_rss": "205112", "process_out_blocks": "1368", "command_success": false, "process_in_blocks": "0"}
[0m03:31:55.689341 [debug] [MainThread]: Command `dbt snapshot` failed at 03:31:55.689231 after 1.54 seconds
[0m03:31:55.689891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a952b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd91d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f01ee10>]}
[0m03:31:55.690471 [debug] [MainThread]: Flushing usage events
[0m03:35:53.942889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2c2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f620170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e623470>]}


============================== 03:35:53.949068 | 5883a978-ee69-41ea-8e81-88ecc0236d16 ==============================
[0m03:35:53.949068 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:35:53.949797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m03:35:54.049092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5883a978-ee69-41ea-8e81-88ecc0236d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edd3140>]}
[0m03:35:54.124404 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-px3np6fk'
[0m03:35:54.124859 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:35:54.259131 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:35:54.259940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:35:54.311015 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:35:54.314400 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:35:54.985125 [info ] [MainThread]: Installed from version 1.3.0
[0m03:35:54.986188 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:35:54.986893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5883a978-ee69-41ea-8e81-88ecc0236d16', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7ae7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d476300>]}
[0m03:35:54.987401 [info ] [MainThread]: 
[0m03:35:54.987871 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:35:54.988896 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0817529, "process_user_time": 1.723625, "process_kernel_time": 0.123405, "process_mem_max_rss": "164136", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:35:54.989449 [debug] [MainThread]: Command `dbt deps` succeeded at 03:35:54.989345 after 1.08 seconds
[0m03:35:54.989865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db7ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edd3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4c7ef0>]}
[0m03:35:54.990326 [debug] [MainThread]: Flushing usage events
[0m03:35:58.072041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937ea690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f7e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937e9eb0>]}


============================== 03:35:58.077937 | dabf378b-a03e-4f19-9514-3f4c0c050d8b ==============================
[0m03:35:58.077937 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:35:58.078711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:35:58.711833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77707710>]}
[0m03:35:58.751504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940b3ec0>]}
[0m03:35:58.752204 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:35:58.826806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:35:58.969825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:35:58.970246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:35:59.010246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77670e30>]}
[0m03:35:59.114138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7707a870>]}
[0m03:35:59.114640 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:35:59.115227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77065c40>]}
[0m03:35:59.117053 [info ] [MainThread]: 
[0m03:35:59.117587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:35:59.118494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:35:59.130014 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:35:59.130406 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:35:59.130758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:00.322032 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.191 seconds
[0m03:36:00.326091 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:36:00.533701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m03:36:00.541204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m03:36:00.544685 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:36:00.547999 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:36:00.548495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m03:36:00.548980 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:36:00.549440 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:36:00.551260 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:36:00.551617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:00.551939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:00.552311 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:36:00.555409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:01.169137 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.617 seconds
[0m03:36:01.173363 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:36:01.178290 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.623 seconds
[0m03:36:01.180998 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:36:01.184018 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.632 seconds
[0m03:36:01.186573 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:36:01.401384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92962420>]}
[0m03:36:01.402493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:36:01.403107 [info ] [MainThread]: 
[0m03:36:01.416843 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m03:36:01.417546 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m03:36:01.419658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m03:36:01.420163 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m03:36:01.427175 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m03:36:01.467481 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:01.467883 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:36:01.468235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:02.124514 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.656 seconds
[0m03:36:02.160687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:02.161200 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:36:03.762979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.601 seconds
[0m03:36:03.770231 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:03.771065 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:36:03.915669 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.144 seconds
[0m03:36:03.924607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:03.925438 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:36:04.113225 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.187 seconds
[0m03:36:04.122056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:04.122798 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:36:04.254742 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.131 seconds
[0m03:36:04.263847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:04.264626 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:36:04.468051 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.203 seconds
[0m03:36:04.481118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:04.481848 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:36:04.652173 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.169 seconds
[0m03:36:04.679787 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:04.680367 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:36:04.927359 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m03:36:04.935280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:04.935841 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:36:05.069981 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.133 seconds
[0m03:36:05.071843 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m03:36:05.077819 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:05.078477 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m03:36:05.316528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m03:36:05.317875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:05.318681 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:36:06.108878 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.789 seconds
[0m03:36:06.110474 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:36:06.111402 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m03:36:06.723343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m03:36:06.751250 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m03:36:06.956860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dabf378b-a03e-4f19-9514-3f4c0c050d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937e80e0>]}
[0m03:36:06.959167 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.53s]
[0m03:36:06.961123 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m03:36:06.963780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:06.964495 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m03:36:06.965033 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m03:36:06.965641 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m03:36:06.966262 [info ] [MainThread]: 
[0m03:36:06.967199 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m03:36:06.968387 [debug] [MainThread]: Command end result
[0m03:36:07.013187 [info ] [MainThread]: 
[0m03:36:07.013751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:07.014080 [info ] [MainThread]: 
[0m03:36:07.014457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:36:07.015218 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.979294, "process_user_time": 3.679256, "process_kernel_time": 0.199556, "process_mem_max_rss": "211696", "process_out_blocks": "2673", "process_in_blocks": "0"}
[0m03:36:07.015711 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:36:07.015609 after 8.98 seconds
[0m03:36:07.016091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f7e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932f00b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ee8c50>]}
[0m03:36:07.016498 [debug] [MainThread]: Flushing usage events
[0m03:36:09.927300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907803b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90783da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90780350>]}


============================== 03:36:09.932958 | fb7c55de-70df-43c5-985b-753c970f81fc ==============================
[0m03:36:09.932958 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:36:09.933718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target test_wh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:36:10.546974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768c3ef0>]}
[0m03:36:10.586530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7524f8c0>]}
[0m03:36:10.587244 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:36:10.663397 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:36:10.760874 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:36:10.761589 [debug] [MainThread]: previous checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m03:36:10.761982 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:36:10.762518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768c11f0>]}
[0m03:36:11.983778 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:36:11.984509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74c217c0>]}
[0m03:36:12.175329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74714e90>]}
[0m03:36:12.275834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74e1f6b0>]}
[0m03:36:12.276303 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:36:12.276871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75043440>]}
[0m03:36:12.278957 [info ] [MainThread]: 
[0m03:36:12.279594 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:36:12.283372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:36:12.289580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:36:12.297014 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:36:12.295310 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:36:12.297644 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:36:12.298034 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:36:12.298465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:12.298806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:13.103311 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.805 seconds
[0m03:36:13.104022 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.805 seconds
[0m03:36:13.105481 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:36:13.110520 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:36:13.392426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m03:36:13.399688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m03:36:13.402655 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:36:13.404467 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:36:13.404883 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:36:13.405266 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:36:13.405617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:13.405962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:13.965756 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.560 seconds
[0m03:36:13.969378 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:36:13.970565 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.565 seconds
[0m03:36:13.974211 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:36:14.178708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m03:36:14.184510 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:36:14.185367 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:36:14.186133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:14.805370 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.619 seconds
[0m03:36:14.806996 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:36:15.017781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74b59f40>]}
[0m03:36:15.018870 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:36:15.019990 [info ] [MainThread]: 
[0m03:36:15.030864 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m03:36:15.031339 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m03:36:15.031813 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m03:36:15.032523 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m03:36:15.033025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m03:36:15.033484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m03:36:15.033869 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m03:36:15.034254 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m03:36:15.039882 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m03:36:15.042178 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m03:36:15.044967 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m03:36:15.051452 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m03:36:15.080239 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m03:36:15.085387 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m03:36:15.087139 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m03:36:15.087841 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m03:36:15.088196 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m03:36:15.088601 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m03:36:15.088961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:15.089294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:15.901708 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m03:36:15.931839 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m03:36:16.158338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9139c2f0>]}
[0m03:36:16.159891 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.12s]
[0m03:36:16.161610 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m03:36:16.162500 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m03:36:16.163342 [info ] [Thread-2 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m03:36:16.164217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_inventory_snapshots)
[0m03:36:16.164737 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m03:36:16.168452 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:36:16.169875 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m03:36:16.172468 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:36:16.173788 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m03:36:16.174185 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m03:36:16.174550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:16.909323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.819 seconds
[0m03:36:16.913559 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m03:36:17.042771 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.868 seconds
[0m03:36:17.046194 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m03:36:17.128695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74123080>]}
[0m03:36:17.130104 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.10s]
[0m03:36:17.132140 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m03:36:17.133124 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_order_items
[0m03:36:17.134117 [info ] [Thread-1 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m03:36:17.135212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_order_items)
[0m03:36:17.135888 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_order_items
[0m03:36:17.140347 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m03:36:17.144986 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_order_items
[0m03:36:17.148049 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m03:36:17.149461 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m03:36:17.149874 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m03:36:17.150334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:17.242051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74123110>]}
[0m03:36:17.243011 [info ] [Thread-2 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.08s]
[0m03:36:17.244130 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m03:36:17.244598 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m03:36:17.245073 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m03:36:17.245655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m03:36:17.246018 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m03:36:17.248624 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m03:36:17.249715 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m03:36:17.253644 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m03:36:17.254838 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m03:36:17.255208 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m03:36:17.255552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:17.936084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m03:36:17.946492 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: Close
[0m03:36:18.064899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m03:36:18.067433 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m03:36:18.148104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74b5acf0>]}
[0m03:36:18.148971 [info ] [Thread-1 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.01s]
[0m03:36:18.150450 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_order_items
[0m03:36:18.151061 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_products
[0m03:36:18.151677 [info ] [Thread-1 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m03:36:18.152492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m03:36:18.152892 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_products
[0m03:36:18.157056 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m03:36:18.159550 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_products
[0m03:36:18.162405 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m03:36:18.163698 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m03:36:18.164061 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m03:36:18.164434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:18.285019 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9451d280>]}
[0m03:36:18.286110 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 1.04s]
[0m03:36:18.287491 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m03:36:18.287898 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m03:36:18.288384 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m03:36:18.289097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.stg_stores)
[0m03:36:18.289464 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m03:36:18.292105 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m03:36:18.293255 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m03:36:18.295952 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m03:36:18.297219 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m03:36:18.297589 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m03:36:18.297951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:18.914552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m03:36:18.918855 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: Close
[0m03:36:19.044019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m03:36:19.047863 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m03:36:19.114830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9451d7c0>]}
[0m03:36:19.116297 [info ] [Thread-1 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.96s]
[0m03:36:19.122460 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_products
[0m03:36:19.126049 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m03:36:19.128196 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m03:36:19.131044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m03:36:19.133620 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m03:36:19.143873 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m03:36:19.146092 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m03:36:19.149538 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m03:36:19.152023 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m03:36:19.152496 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m03:36:19.152969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:19.260903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9451d2b0>]}
[0m03:36:19.261642 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.97s]
[0m03:36:19.262443 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m03:36:19.262884 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m03:36:19.263444 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m03:36:19.263953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m03:36:19.264368 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m03:36:19.270295 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:36:19.271573 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m03:36:19.273719 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:36:19.275174 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m03:36:19.275544 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m03:36:19.275925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:20.956217 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m03:36:20.958026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.806 seconds
[0m03:36:20.963332 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m03:36:20.966842 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m03:36:21.187165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7400ee70>]}
[0m03:36:21.189164 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74121850>]}
[0m03:36:21.190265 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 2.06s]
[0m03:36:21.192224 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.92s]
[0m03:36:21.193379 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m03:36:21.194421 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m03:36:21.195277 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m03:36:21.196138 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m03:36:21.197268 [info ] [Thread-1 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m03:36:21.198198 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m03:36:21.198992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.dim_product)
[0m03:36:21.199556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.dim_store)
[0m03:36:21.200064 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m03:36:21.200584 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m03:36:21.205666 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m03:36:21.209240 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m03:36:21.211008 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m03:36:21.211406 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m03:36:21.213913 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m03:36:21.216101 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m03:36:21.217599 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m03:36:21.218001 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m03:36:21.218600 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m03:36:21.218882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:21.219262 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m03:36:21.220620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:22.874221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.655 seconds
[0m03:36:22.879549 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m03:36:22.961148 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.740 seconds
[0m03:36:22.966501 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m03:36:23.088438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff742861e0>]}
[0m03:36:23.090400 [info ] [Thread-1 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.89s]
[0m03:36:23.092548 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m03:36:23.093548 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m03:36:23.094395 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m03:36:23.095625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now model.retail_dbt.fact_sales)
[0m03:36:23.096234 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m03:36:23.105702 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m03:36:23.107616 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m03:36:23.110878 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m03:36:23.113977 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m03:36:23.114553 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m03:36:23.115128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:23.185996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74b5a540>]}
[0m03:36:23.186970 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.99s]
[0m03:36:23.188120 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m03:36:25.277842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.163 seconds
[0m03:36:25.282843 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m03:36:25.489802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7c55de-70df-43c5-985b-753c970f81fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7404a660>]}
[0m03:36:25.491045 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.39s]
[0m03:36:25.492395 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m03:36:25.495868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:25.496547 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m03:36:25.497224 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m03:36:25.498064 [info ] [MainThread]: 
[0m03:36:25.498887 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m03:36:25.501438 [debug] [MainThread]: Command end result
[0m03:36:25.545163 [info ] [MainThread]: 
[0m03:36:25.545831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:25.546205 [info ] [MainThread]: 
[0m03:36:25.546654 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m03:36:25.548463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.657657, "process_user_time": 5.437929, "process_kernel_time": 0.194248, "process_mem_max_rss": "216668", "process_in_blocks": "336", "process_out_blocks": "4027"}
[0m03:36:25.549177 [debug] [MainThread]: Command `dbt run` succeeded at 03:36:25.549069 after 15.66 seconds
[0m03:36:25.549926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fe7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff747152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9075f5c0>]}
[0m03:36:25.550572 [debug] [MainThread]: Flushing usage events
[0m03:36:28.252293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ada7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa403cc80>]}


============================== 03:36:28.258685 | dd1b51b3-591b-4334-8df5-1918e2e4a803 ==============================
[0m03:36:28.258685 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:36:28.259521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --target test_wh', 'send_anonymous_usage_stats': 'True'}
[0m03:36:28.959460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dd42c0>]}
[0m03:36:28.998873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfc6d80>]}
[0m03:36:28.999587 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:36:29.075743 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:36:29.213352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:36:29.213809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:36:29.254074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ce36b0>]}
[0m03:36:29.365695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877505c0>]}
[0m03:36:29.366206 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:36:29.366813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ce38c0>]}
[0m03:36:29.368926 [info ] [MainThread]: 
[0m03:36:29.369595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:36:29.373537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m03:36:29.374067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m03:36:29.391278 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:36:29.392567 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:36:29.392936 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:36:29.393307 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:36:29.393709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:29.394028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:30.041244 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.647 seconds
[0m03:36:30.045416 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:36:30.046783 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.653 seconds
[0m03:36:30.051030 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:36:30.269870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m03:36:30.275022 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:36:30.276626 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:36:30.277092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:30.813226 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m03:36:30.816276 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:36:31.024301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1b51b3-591b-4334-8df5-1918e2e4a803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e17560>]}
[0m03:36:31.025460 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:36:31.026996 [info ] [MainThread]: 
[0m03:36:31.038881 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:36:31.039355 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:36:31.039764 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m03:36:31.040432 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m03:36:31.041000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m03:36:31.041770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m03:36:31.042171 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:36:31.042558 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:36:31.055577 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:36:31.059974 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:36:31.062404 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:36:31.062736 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:36:31.081095 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:36:31.081704 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:36:31.083296 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:36:31.083855 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:36:31.084181 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m03:36:31.084603 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m03:36:31.084994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:31.085329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:31.878311 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m03:36:31.892054 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m03:36:31.894126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m03:36:31.896110 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m03:36:32.229802 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.19s]
[0m03:36:32.230696 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.19s]
[0m03:36:32.231263 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:36:32.231798 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:36:32.232241 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:36:32.232712 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:36:32.233124 [info ] [Thread-1 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m03:36:32.233590 [info ] [Thread-2 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m03:36:32.234036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m03:36:32.234440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m03:36:32.234832 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:36:32.235178 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:36:32.238897 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:36:32.242175 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:36:32.244443 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:36:32.246502 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:36:32.246811 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:36:32.248886 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:36:32.249832 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:36:32.250219 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m03:36:32.250599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:32.251087 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:36:32.252628 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m03:36:32.253088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:32.856395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m03:36:32.859693 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m03:36:32.987685 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m03:36:32.990819 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m03:36:33.084133 [info ] [Thread-1 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.85s]
[0m03:36:33.085690 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:36:33.086450 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:36:33.087156 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m03:36:33.088257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m03:36:33.088911 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:36:33.094167 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:36:33.095456 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:36:33.099208 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:36:33.100437 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:36:33.100854 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m03:36:33.101216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:33.220423 [info ] [Thread-2 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.99s]
[0m03:36:33.221889 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:36:33.222594 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:36:33.223311 [info ] [Thread-2 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m03:36:33.224102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m03:36:33.224561 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:36:33.228314 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:36:33.229404 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:36:33.231410 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:36:33.232562 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:36:33.232925 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m03:36:33.233314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:33.709541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m03:36:33.713191 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m03:36:33.837464 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m03:36:33.841552 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m03:36:33.919863 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.83s]
[0m03:36:33.921368 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:36:33.922218 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:36:33.922991 [info ] [Thread-1 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m03:36:33.923987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m03:36:33.924660 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:36:33.930593 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:36:33.932964 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:36:33.935053 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:36:33.936248 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:36:33.936611 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m03:36:33.936942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:34.051348 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.83s]
[0m03:36:34.053282 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:36:34.053950 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:36:34.054519 [info ] [Thread-2 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m03:36:34.055395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m03:36:34.055873 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:36:34.059502 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:36:34.060560 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:36:34.062666 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:36:34.064064 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:36:34.064536 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m03:36:34.064887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:34.587567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m03:36:34.590967 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m03:36:34.653717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m03:36:34.657050 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m03:36:34.783085 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.86s]
[0m03:36:34.783846 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:36:34.784617 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:36:34.785076 [info ] [Thread-1 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m03:36:34.785746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m03:36:34.786134 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:36:34.793617 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:36:34.796985 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:36:34.802068 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:36:34.810002 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:36:34.810514 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:34.810907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:34.873230 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.82s]
[0m03:36:34.873912 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:36:34.874349 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:36:34.874814 [info ] [Thread-2 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m03:36:34.875367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m03:36:34.875771 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:36:34.880531 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:36:34.881643 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:36:34.883650 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:36:34.885015 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:36:34.885402 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:34.885796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:35.601352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m03:36:35.604641 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m03:36:35.660803 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m03:36:35.666233 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m03:36:35.811652 [info ] [Thread-1 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.03s]
[0m03:36:35.813287 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:36:35.813992 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:36:35.814592 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m03:36:35.815551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m03:36:35.816062 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:36:35.821828 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:36:35.823952 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:36:35.826031 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:36:35.827321 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:36:35.827683 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:35.827989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:35.871434 [info ] [Thread-2 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.00s]
[0m03:36:35.872299 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:36:35.872783 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:36:35.873173 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m03:36:35.873711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m03:36:35.874061 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:36:35.878848 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:36:35.880159 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:36:35.882277 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:36:35.883615 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:36:35.883988 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:35.884388 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:36.596760 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m03:36:36.600095 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m03:36:36.753260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m03:36:36.755489 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m03:36:36.811030 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.94s]
[0m03:36:36.811959 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:36:36.812438 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:36:36.812904 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m03:36:36.813419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m03:36:36.813803 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:36:36.818615 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:36:36.820340 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:36:36.822615 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:36:36.823992 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:36:36.824395 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:36.824778 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:36.954544 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.14s]
[0m03:36:36.956171 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:36:36.956923 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:36:36.957546 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m03:36:36.958344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m03:36:36.959004 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:36:36.966057 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:36:36.967238 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:36:37.022049 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:36:37.030361 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:36:37.030841 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:37.031268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:37.480936 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m03:36:37.482763 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m03:36:37.616035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m03:36:37.619763 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m03:36:37.714566 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.90s]
[0m03:36:37.716009 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:36:37.716778 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:36:37.717721 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m03:36:37.718765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m03:36:37.719414 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:36:37.725368 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:36:37.726641 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:36:37.728778 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:36:37.730170 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:36:37.730607 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:36:37.731033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:36:37.826276 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.87s]
[0m03:36:37.827595 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:36:37.828246 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:36:37.828790 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m03:36:37.829561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m03:36:37.830151 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:36:37.835989 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:36:37.837959 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:36:37.839971 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:36:37.841177 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:36:37.841555 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m03:36:37.841892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:38.325326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m03:36:38.328575 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m03:36:38.490783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m03:36:38.494011 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m03:36:38.515412 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.80s]
[0m03:36:38.516914 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:36:38.685054 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.86s]
[0m03:36:38.686747 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:36:38.689190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:38.689975 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m03:36:38.690549 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m03:36:38.691490 [info ] [MainThread]: 
[0m03:36:38.693018 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m03:36:38.696236 [debug] [MainThread]: Command end result
[0m03:36:38.739004 [info ] [MainThread]: 
[0m03:36:38.739633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:38.740026 [info ] [MainThread]: 
[0m03:36:38.740437 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m03:36:38.741381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.525471, "process_user_time": 4.186043, "process_kernel_time": 0.289395, "process_mem_max_rss": "211072", "process_out_blocks": "2792", "process_in_blocks": "0"}
[0m03:36:38.741856 [debug] [MainThread]: Command `dbt test` succeeded at 03:36:38.741769 after 10.53 seconds
[0m03:36:38.742210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d0bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c87080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c086300>]}
[0m03:36:38.742562 [debug] [MainThread]: Flushing usage events
[0m03:57:24.163998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d063c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4c8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d173ef0>]}


============================== 03:57:24.170209 | ee758336-5876-4297-a2a4-3a621b3ab76e ==============================
[0m03:57:24.170209 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:57:24.171573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m03:57:24.256794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee758336-5876-4297-a2a4-3a621b3ab76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d623800>]}
[0m03:57:24.328144 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sq0vx2xr'
[0m03:57:24.328599 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:57:24.525147 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:57:24.526390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:57:24.588311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:57:24.593851 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:57:25.398770 [info ] [MainThread]: Installed from version 1.3.0
[0m03:57:25.399559 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:57:25.399992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee758336-5876-4297-a2a4-3a621b3ab76e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3eaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3eb2f0>]}
[0m03:57:25.400489 [info ] [MainThread]: 
[0m03:57:25.400879 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:57:25.401907 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2769984, "process_user_time": 1.714976, "process_kernel_time": 0.103202, "process_mem_max_rss": "164148", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:57:25.402445 [debug] [MainThread]: Command `dbt deps` succeeded at 03:57:25.402323 after 1.28 seconds
[0m03:57:25.402842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4e8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c453140>]}
[0m03:57:25.403227 [debug] [MainThread]: Flushing usage events
[0m03:57:28.193955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829228a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d6ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8303e270>]}


============================== 03:57:28.199586 | bdeea6a7-e98e-4053-a3a9-991f96fa18d6 ==============================
[0m03:57:28.199586 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:57:28.200367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:57:28.862177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff761a62a0>]}
[0m03:57:28.906560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67689880>]}
[0m03:57:28.907276 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:57:28.984641 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:57:29.078758 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:57:29.079491 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed
[0m03:57:29.079884 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:57:29.080384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff761a6450>]}
[0m03:57:30.167133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:57:30.167725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c35460>]}
[0m03:57:30.365074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66d9c170>]}
[0m03:57:30.469279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66dad6a0>]}
[0m03:57:30.469807 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:57:30.470433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c05a00>]}
[0m03:57:30.472332 [info ] [MainThread]: 
[0m03:57:30.473020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:30.473895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:57:30.485262 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:57:30.485711 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:57:30.486034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:31.404132 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.918 seconds
[0m03:57:31.405758 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:57:31.603847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m03:57:31.611597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m03:57:31.612019 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:57:31.614066 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:57:31.614464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m03:57:31.614840 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:57:31.615331 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:57:31.617381 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:57:31.617809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:31.618183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:31.618586 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:57:31.621553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:32.206794 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.589 seconds
[0m03:57:32.211648 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:57:32.215495 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.594 seconds
[0m03:57:32.218478 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:57:32.222485 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.604 seconds
[0m03:57:32.224438 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:57:32.436395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66e0b050>]}
[0m03:57:32.437264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:57:32.438430 [info ] [MainThread]: 
[0m03:57:32.449830 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m03:57:32.450454 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m03:57:32.451110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m03:57:32.451599 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m03:57:32.458726 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m03:57:32.499507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:32.499895 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:57:32.500246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:33.032800 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.532 seconds
[0m03:57:33.078337 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:33.078894 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:57:35.034927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.955 seconds
[0m03:57:35.043324 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.044174 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:57:35.180325 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.135 seconds
[0m03:57:35.185383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.185996 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:57:35.306335 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.120 seconds
[0m03:57:35.309758 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.310164 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:57:35.431273 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.121 seconds
[0m03:57:35.435484 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.436076 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:57:35.591419 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.154 seconds
[0m03:57:35.602963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.603622 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:57:35.730748 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.126 seconds
[0m03:57:35.759385 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:35.760244 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:36.020195 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.259 seconds
[0m03:57:36.029726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:36.030471 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:36.162576 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.131 seconds
[0m03:57:36.164066 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m03:57:36.168798 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:36.169439 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m03:57:36.358325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m03:57:36.359491 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:36.360237 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:57:36.979162 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.618 seconds
[0m03:57:36.980733 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:57:36.981440 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m03:57:37.591920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m03:57:37.609855 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m03:57:37.809652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdeea6a7-e98e-4053-a3a9-991f96fa18d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67336f30>]}
[0m03:57:37.810601 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.36s]
[0m03:57:37.811633 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m03:57:37.813109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:37.813467 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m03:57:37.813758 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m03:57:37.814073 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m03:57:37.814386 [info ] [MainThread]: 
[0m03:57:37.814864 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m03:57:37.815538 [debug] [MainThread]: Command end result
[0m03:57:37.854085 [info ] [MainThread]: 
[0m03:57:37.854558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:37.854865 [info ] [MainThread]: 
[0m03:57:37.855267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:57:37.856065 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.698426, "process_user_time": 4.804265, "process_kernel_time": 0.247767, "process_mem_max_rss": "217108", "process_out_blocks": "3933", "process_in_blocks": "0"}
[0m03:57:37.856559 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:57:37.856462 after 9.70 seconds
[0m03:57:37.856951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ffa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853b1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830ff7a0>]}
[0m03:57:37.857296 [debug] [MainThread]: Flushing usage events
[0m03:57:40.499361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3658980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2fbdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa365adb0>]}


============================== 03:57:40.505224 | ade8fca9-ab2c-4b09-8bb4-d158e79ae34d ==============================
[0m03:57:40.505224 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:57:40.506125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target test_wh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:57:41.137632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30e8b30>]}
[0m03:57:41.176817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8744dbb0>]}
[0m03:57:41.177461 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:57:41.250966 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:57:41.341294 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:57:41.341956 [debug] [MainThread]: previous checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m03:57:41.342341 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:57:41.342862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa362f2c0>]}
[0m03:57:42.404536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:57:42.405291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86785520>]}
[0m03:57:42.595368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a3d9d0>]}
[0m03:57:42.695090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87069310>]}
[0m03:57:42.695589 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:57:42.696209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87267ce0>]}
[0m03:57:42.698236 [info ] [MainThread]: 
[0m03:57:42.698862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:42.702680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:57:42.709333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:57:42.714260 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:57:42.716072 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:57:42.716461 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:57:42.716816 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:57:42.717251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:42.717624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:43.562662 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.845 seconds
[0m03:57:43.564681 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:57:43.590236 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.873 seconds
[0m03:57:43.591648 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:57:43.793769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m03:57:43.794785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m03:57:43.813860 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:57:43.814484 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:57:43.814835 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:57:43.815294 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:57:43.815700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:43.816079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:44.346118 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.530 seconds
[0m03:57:44.348192 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:57:44.384863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.569 seconds
[0m03:57:44.386228 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:57:44.561956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now list_RETAIL_DW_STAGING_STAGING)
[0m03:57:44.569695 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:57:44.570407 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:57:44.570919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:45.117341 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.546 seconds
[0m03:57:45.122518 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:57:45.310303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa445be90>]}
[0m03:57:45.310893 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:57:45.311579 [info ] [MainThread]: 
[0m03:57:45.319632 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m03:57:45.320022 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m03:57:45.320460 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m03:57:45.321094 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m03:57:45.321574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m03:57:45.321985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m03:57:45.322354 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m03:57:45.322711 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m03:57:45.328128 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m03:57:45.330396 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m03:57:45.332617 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m03:57:45.340699 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m03:57:45.369296 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m03:57:45.372381 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m03:57:45.374040 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m03:57:45.374575 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m03:57:45.374887 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m03:57:45.375278 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m03:57:45.375608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:45.375915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:46.097900 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m03:57:46.122868 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m03:57:46.329261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba70b0>]}
[0m03:57:46.330990 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.00s]
[0m03:57:46.333022 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m03:57:46.333811 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m03:57:46.334680 [info ] [Thread-2 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m03:57:46.335833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_inventory_snapshots)
[0m03:57:46.336775 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m03:57:46.341084 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:57:46.343091 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m03:57:46.346471 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:57:46.348220 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m03:57:46.348714 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m03:57:46.349203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:47.119373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m03:57:47.125011 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m03:57:47.145117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m03:57:47.149384 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m03:57:47.356042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b7a450>]}
[0m03:57:47.357788 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.03s]
[0m03:57:47.359779 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m03:57:47.360555 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_order_items
[0m03:57:47.361397 [info ] [Thread-1 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m03:57:47.362329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_order_items)
[0m03:57:47.363814 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_order_items
[0m03:57:47.366318 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba7320>]}
[0m03:57:47.369885 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m03:57:47.370622 [info ] [Thread-2 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.03s]
[0m03:57:47.371797 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m03:57:47.372400 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m03:57:47.373060 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m03:57:47.373859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m03:57:47.374527 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m03:57:47.374981 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_order_items
[0m03:57:47.377800 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m03:57:47.380642 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m03:57:47.382189 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m03:57:47.382894 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m03:57:47.387327 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m03:57:47.387800 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m03:57:47.388388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:47.390399 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m03:57:47.390823 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m03:57:47.391327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:48.085627 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m03:57:48.091785 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m03:57:48.097288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m03:57:48.100909 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: Close
[0m03:57:48.296810 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fbade0>]}
[0m03:57:48.298231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fe3da0>]}
[0m03:57:48.299439 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.92s]
[0m03:57:48.301302 [info ] [Thread-1 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.94s]
[0m03:57:48.302364 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m03:57:48.303222 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_order_items
[0m03:57:48.304005 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m03:57:48.304725 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_stores
[0m03:57:48.305537 [info ] [Thread-2 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m03:57:48.306283 [info ] [Thread-1 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m03:57:48.307019 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.stg_products)
[0m03:57:48.307560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m03:57:48.308071 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m03:57:48.308542 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_stores
[0m03:57:48.312686 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m03:57:48.315247 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m03:57:48.316882 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m03:57:48.317235 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_stores
[0m03:57:48.319916 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m03:57:48.322329 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m03:57:48.323734 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m03:57:48.324146 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m03:57:48.324673 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m03:57:48.324983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:48.325327 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m03:57:48.327023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:49.577243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m03:57:49.578881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.254 seconds
[0m03:57:49.582423 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: Close
[0m03:57:49.585158 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: Close
[0m03:57:49.779295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b5d9a0>]}
[0m03:57:49.781034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b5fd40>]}
[0m03:57:49.782337 [info ] [Thread-1 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.47s]
[0m03:57:49.783453 [info ] [Thread-2 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.47s]
[0m03:57:49.784703 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_stores
[0m03:57:49.785582 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m03:57:49.786294 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m03:57:49.787052 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m03:57:49.788225 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m03:57:49.789361 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m03:57:49.790213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_customer)
[0m03:57:49.790902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.fact_inventory_snapshot)
[0m03:57:49.791564 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m03:57:49.792219 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m03:57:49.803752 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:57:49.799006 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m03:57:49.805588 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m03:57:49.805986 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m03:57:49.810066 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:57:49.812182 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m03:57:49.814552 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m03:57:49.815252 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m03:57:49.815617 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m03:57:49.816080 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m03:57:49.816538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:49.816910 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:51.228286 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.411 seconds
[0m03:57:51.233376 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m03:57:51.268279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.452 seconds
[0m03:57:51.273745 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m03:57:51.441783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85704f80>]}
[0m03:57:51.443384 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.65s]
[0m03:57:51.444933 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m03:57:51.445799 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m03:57:51.446663 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m03:57:51.447695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.dim_store)
[0m03:57:51.448312 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m03:57:51.453926 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m03:57:51.455525 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m03:57:51.458180 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m03:57:51.459621 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m03:57:51.460036 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m03:57:51.460476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:57:51.470540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85705460>]}
[0m03:57:51.471221 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.68s]
[0m03:57:51.471930 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m03:57:51.472330 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m03:57:51.472785 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m03:57:51.473307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.dim_product)
[0m03:57:51.473683 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m03:57:51.476846 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m03:57:51.477904 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m03:57:51.480155 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m03:57:51.481377 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m03:57:51.481752 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m03:57:51.482093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.850618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m03:57:52.856274 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m03:57:52.886112 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.425 seconds
[0m03:57:52.889603 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m03:57:53.061414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ff6c60>]}
[0m03:57:53.063126 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.59s]
[0m03:57:53.065247 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m03:57:53.066183 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m03:57:53.067105 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m03:57:53.068154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now model.retail_dbt.fact_sales)
[0m03:57:53.068768 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m03:57:53.079316 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m03:57:53.081932 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b78650>]}
[0m03:57:53.082960 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.63s]
[0m03:57:53.083477 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m03:57:53.084070 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m03:57:53.086916 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m03:57:53.090251 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m03:57:53.090791 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m03:57:53.091350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:55.306384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.215 seconds
[0m03:57:55.308363 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m03:57:55.511030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade8fca9-ab2c-4b09-8bb4-d158e79ae34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857217f0>]}
[0m03:57:55.512707 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.44s]
[0m03:57:55.514793 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m03:57:55.517613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:55.518170 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m03:57:55.518589 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m03:57:55.519370 [info ] [MainThread]: 
[0m03:57:55.520480 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 12.82 seconds (12.82s).
[0m03:57:55.523106 [debug] [MainThread]: Command end result
[0m03:57:55.567401 [info ] [MainThread]: 
[0m03:57:55.567975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:55.568314 [info ] [MainThread]: 
[0m03:57:55.568738 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m03:57:55.569592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.106138, "process_user_time": 5.313138, "process_kernel_time": 0.232058, "process_mem_max_rss": "215848", "process_out_blocks": "4027", "process_in_blocks": "0"}
[0m03:57:55.570103 [debug] [MainThread]: Command `dbt run` succeeded at 03:57:55.570026 after 15.11 seconds
[0m03:57:55.570476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31e60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa372b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874a9220>]}
[0m03:57:55.570868 [debug] [MainThread]: Flushing usage events
[0m03:57:58.418880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83db8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83bfbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83db8530>]}


============================== 03:57:58.424535 | e3a8e348-6793-450a-8f82-a441c2009db8 ==============================
[0m03:57:58.424535 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:57:58.425059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --target test_wh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:57:59.031264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8421a900>]}
[0m03:57:59.070226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff687bf830>]}
[0m03:57:59.070874 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:57:59.142245 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:57:59.277105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:57:59.277527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:57:59.317089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68310d10>]}
[0m03:57:59.428321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68313da0>]}
[0m03:57:59.428828 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:57:59.429405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839e38c0>]}
[0m03:57:59.431595 [info ] [MainThread]: 
[0m03:57:59.432234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:59.436158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m03:57:59.443976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m03:57:59.449331 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:57:59.451190 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:57:59.451589 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:57:59.451948 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:57:59.452312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:59.452668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:00.073842 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.621 seconds
[0m03:58:00.078225 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:58:00.081851 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.629 seconds
[0m03:58:00.084762 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:58:00.282739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now list_RETAIL_DW_ANALYTICS)
[0m03:58:00.290013 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:58:00.291811 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:58:00.292455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:58:00.812888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.520 seconds
[0m03:58:00.816373 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:58:01.015673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a8e348-6793-450a-8f82-a441c2009db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68cc8e90>]}
[0m03:58:01.017168 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:58:01.018672 [info ] [MainThread]: 
[0m03:58:01.030747 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:58:01.031413 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:58:01.032015 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m03:58:01.033018 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m03:58:01.033763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m03:58:01.034715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m03:58:01.035282 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:58:01.035780 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:58:01.054421 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:58:01.055850 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:58:01.057232 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:58:01.057548 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:58:01.081747 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:58:01.082449 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:58:01.083942 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:58:01.084387 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m03:58:01.084953 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:58:01.085254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:01.085755 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m03:58:01.087283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:01.801319 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m03:58:01.808925 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m03:58:01.810840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m03:58:01.812708 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m03:58:02.044159 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.01s]
[0m03:58:02.046673 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.01s]
[0m03:58:02.048004 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:58:02.048944 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:58:02.049793 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:58:02.050603 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:58:02.051204 [info ] [Thread-2 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m03:58:02.051896 [info ] [Thread-1 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m03:58:02.052994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m03:58:02.053837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m03:58:02.054604 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:58:02.055187 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:58:02.061126 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:58:02.065599 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:58:02.068306 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:58:02.068690 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:58:02.071071 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:58:02.073520 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:58:02.075040 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:58:02.075479 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m03:58:02.076010 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:58:02.076305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:02.076711 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m03:58:02.077553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:02.710816 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m03:58:02.713276 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m03:58:02.870233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m03:58:02.874016 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m03:58:02.935536 [info ] [Thread-2 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.88s]
[0m03:58:02.937697 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:58:02.938483 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:58:02.939136 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m03:58:02.939927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m03:58:02.940448 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:58:02.948897 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:58:02.950703 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:58:02.953475 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:58:02.955115 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:58:02.955637 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m03:58:02.956116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:03.077385 [info ] [Thread-1 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.02s]
[0m03:58:03.078068 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:58:03.078550 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:58:03.079012 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m03:58:03.079492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m03:58:03.080080 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:58:03.084619 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:58:03.086015 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:58:03.088978 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:58:03.090153 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:58:03.090515 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m03:58:03.090855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:03.624503 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m03:58:03.629081 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m03:58:03.679354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m03:58:03.683268 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m03:58:03.822089 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.88s]
[0m03:58:03.823324 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:58:03.824082 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:58:03.824630 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m03:58:03.825095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m03:58:03.825582 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:58:03.829859 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:58:03.831475 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:58:03.833976 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:58:03.835287 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:58:03.835678 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m03:58:03.836086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:03.875162 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.80s]
[0m03:58:03.875789 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:58:03.876187 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:58:03.876590 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m03:58:03.877022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m03:58:03.877388 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:58:03.881416 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:58:03.882539 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:58:03.884560 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:58:03.885974 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:58:03.886371 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m03:58:03.886775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:04.386911 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m03:58:04.391679 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m03:58:04.422232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m03:58:04.426761 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m03:58:04.611401 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.79s]
[0m03:58:04.612755 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:58:04.614692 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:58:04.616483 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m03:58:04.617068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m03:58:04.617841 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:58:04.625778 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:58:04.627447 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.75s]
[0m03:58:04.628098 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:58:04.628409 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:58:04.628794 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:58:04.632378 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:58:04.632798 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m03:58:04.633406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m03:58:04.633817 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:58:04.638171 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:58:04.639121 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:58:04.639552 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:04.639998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:04.640327 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:58:04.643358 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:58:04.644965 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:58:04.645347 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:04.645832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:05.449420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m03:58:05.451237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m03:58:05.455764 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m03:58:05.458385 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m03:58:05.658948 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.04s]
[0m03:58:05.660128 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.03s]
[0m03:58:05.660899 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:58:05.661701 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:58:05.662350 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:58:05.662997 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:58:05.663573 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m03:58:05.664152 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m03:58:05.664816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m03:58:05.665361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m03:58:05.665890 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:58:05.666334 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:58:05.671896 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:58:05.676418 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:58:05.677830 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:58:05.678238 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:58:05.680239 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:58:05.682282 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:58:05.683757 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:58:05.684180 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:05.684909 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:58:05.685200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:05.685576 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:05.686911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:06.312390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m03:58:06.316962 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m03:58:06.497192 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m03:58:06.501333 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m03:58:06.512470 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.85s]
[0m03:58:06.513578 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:58:06.514300 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:58:06.514983 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m03:58:06.515714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m03:58:06.516400 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:58:06.522738 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:58:06.524413 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:58:06.528794 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:58:06.530524 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:58:06.531076 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:06.531555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:06.714211 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.05s]
[0m03:58:06.715018 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:58:06.715496 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:58:06.715881 [info ] [Thread-2 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m03:58:06.716326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m03:58:06.716783 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:58:06.808543 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:58:06.815901 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:58:06.818136 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:58:06.819545 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:58:06.819946 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:06.820419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:07.263217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m03:58:07.267906 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m03:58:07.486200 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.97s]
[0m03:58:07.488003 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:58:07.489022 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:58:07.489879 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m03:58:07.490753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m03:58:07.491381 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:58:07.500285 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:58:07.502296 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:58:07.505162 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:58:07.507125 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:58:07.507650 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:58:07.508114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:07.526925 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m03:58:07.529017 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m03:58:07.718548 [info ] [Thread-2 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.00s]
[0m03:58:07.719565 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:58:07.720079 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:58:07.720552 [info ] [Thread-2 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m03:58:07.721022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m03:58:07.721487 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:58:07.727127 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:58:07.728351 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:58:07.730535 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:58:07.731876 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:58:07.732279 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m03:58:07.732786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:08.170032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m03:58:08.173229 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m03:58:08.314104 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m03:58:08.317267 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m03:58:08.382093 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.89s]
[0m03:58:08.383184 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:58:08.507416 [info ] [Thread-2 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.79s]
[0m03:58:08.508547 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:58:08.510606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:58:08.511112 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m03:58:08.511537 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m03:58:08.512037 [info ] [MainThread]: 
[0m03:58:08.512659 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m03:58:08.515825 [debug] [MainThread]: Command end result
[0m03:58:08.565509 [info ] [MainThread]: 
[0m03:58:08.566218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:58:08.567171 [info ] [MainThread]: 
[0m03:58:08.568340 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m03:58:08.569819 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.185993, "process_user_time": 4.242321, "process_kernel_time": 0.226711, "process_mem_max_rss": "211260", "process_out_blocks": "2792", "process_in_blocks": "0"}
[0m03:58:08.570506 [debug] [MainThread]: Command `dbt test` succeeded at 03:58:08.570367 after 10.19 seconds
[0m03:58:08.571507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e0a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8415bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8415aea0>]}
[0m03:58:08.572918 [debug] [MainThread]: Flushing usage events
[0m03:58:11.495867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3c0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c11cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8cd400>]}


============================== 03:58:11.501600 | 9e8d1c9c-5278-48a5-aa5e-078fadceb88a ==============================
[0m03:58:11.501600 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:11.502411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select state:modified+ --state state --target test_wh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:58:12.164075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8d1c9c-5278-48a5-aa5e-078fadceb88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ff39f70>]}
[0m03:58:12.204421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8d1c9c-5278-48a5-aa5e-078fadceb88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f591e20>]}
[0m03:58:12.205082 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:58:12.280406 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:58:12.418237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:58:12.418659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:58:12.459244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8d1c9c-5278-48a5-aa5e-078fadceb88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc1d60>]}
[0m03:58:12.635217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8d1c9c-5278-48a5-aa5e-078fadceb88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5edc0f80>]}
[0m03:58:12.635716 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:58:12.636299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8d1c9c-5278-48a5-aa5e-078fadceb88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5edc1280>]}
[0m03:58:12.637801 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m03:58:12.639075 [info ] [MainThread]: 
[0m03:58:12.639452 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:58:12.640880 [debug] [MainThread]: Command end result
[0m03:58:12.676726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2169458, "process_user_time": 3.187038, "process_kernel_time": 0.179339, "process_mem_max_rss": "203320", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m03:58:12.677371 [debug] [MainThread]: Command `dbt run` succeeded at 03:58:12.677278 after 1.22 seconds
[0m03:58:12.677844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad78650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8cd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b326c30>]}
[0m03:58:12.678223 [debug] [MainThread]: Flushing usage events
[0m03:58:15.642049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb42450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd46840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd46d20>]}


============================== 03:58:15.647742 | 6cf9d9d6-d2e2-4e66-9c83-f48267b10bec ==============================
[0m03:58:15.647742 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:15.648471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select state:modified+ --state state --target test_wh', 'send_anonymous_usage_stats': 'True'}
[0m03:58:16.268890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf9d9d6-d2e2-4e66-9c83-f48267b10bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817bc2c0>]}
[0m03:58:16.308665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf9d9d6-d2e2-4e66-9c83-f48267b10bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0a2b40>]}
[0m03:58:16.309319 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:58:16.382010 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:58:16.514420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:58:16.514854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:58:16.554369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf9d9d6-d2e2-4e66-9c83-f48267b10bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e61d60>]}
[0m03:58:16.733271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf9d9d6-d2e2-4e66-9c83-f48267b10bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806e3050>]}
[0m03:58:16.733787 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:58:16.734355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf9d9d6-d2e2-4e66-9c83-f48267b10bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ebf320>]}
[0m03:58:16.735896 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m03:58:16.737143 [info ] [MainThread]: 
[0m03:58:16.737491 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:58:16.738819 [debug] [MainThread]: Command end result
[0m03:58:16.774156 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1667862, "process_user_time": 3.116753, "process_kernel_time": 0.129655, "process_mem_max_rss": "204064", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m03:58:16.774728 [debug] [MainThread]: Command `dbt test` succeeded at 03:58:16.774649 after 1.17 seconds
[0m03:58:16.775092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1b9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1ba360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd46d20>]}
[0m03:58:16.775509 [debug] [MainThread]: Flushing usage events
[0m03:58:35.350814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c678440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc4ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc0a540>]}


============================== 03:58:35.357408 | c9bd4dd4-9270-4bdf-8a2c-58af667c91da ==============================
[0m03:58:35.357408 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:35.358272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:58:35.450856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bd4dd4-9270-4bdf-8a2c-58af667c91da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c82c590>]}
[0m03:58:35.522583 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xj9ms6ve'
[0m03:58:35.523060 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:58:35.585205 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:58:35.585910 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:58:35.636311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:58:35.640013 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:58:36.333287 [info ] [MainThread]: Installed from version 1.3.0
[0m03:58:36.334036 [info ] [MainThread]: Updated version available: 1.3.3
[0m03:58:36.334746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9bd4dd4-9270-4bdf-8a2c-58af667c91da', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c803d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c803860>]}
[0m03:58:36.335146 [info ] [MainThread]: 
[0m03:58:36.335586 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:58:36.336597 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0255504, "process_user_time": 2.041951, "process_kernel_time": 0.188862, "process_mem_max_rss": "164156", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m03:58:36.337093 [debug] [MainThread]: Command `dbt deps` succeeded at 03:58:36.337010 after 1.03 seconds
[0m03:58:36.337536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbc1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3d98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c653c80>]}
[0m03:58:36.337887 [debug] [MainThread]: Flushing usage events
[0m03:58:38.861191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4a98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c54aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8a4830>]}


============================== 03:58:38.867081 | 79dee3e3-60d0-4d02-b261-bf1beca2df86 ==============================
[0m03:58:38.867081 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:38.867868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:58:39.608841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713ec2c0>]}
[0m03:58:39.652276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d19d00>]}
[0m03:58:39.653070 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:58:39.742271 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:58:39.843809 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:58:39.844689 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed
[0m03:58:39.845095 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:58:39.845671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7070d5e0>]}
[0m03:58:40.961880 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:58:40.962561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71127e90>]}
[0m03:58:41.154128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a5d00>]}
[0m03:58:41.256691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70626f00>]}
[0m03:58:41.257239 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:58:41.257778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7087ee70>]}
[0m03:58:41.259560 [info ] [MainThread]: 
[0m03:58:41.260222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:58:41.261090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:58:41.271952 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:58:41.272333 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:58:41.272641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:42.137163 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.864 seconds
[0m03:58:42.138910 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:58:42.352297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m03:58:42.358522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m03:58:42.361194 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:58:42.363409 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:58:42.363828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m03:58:42.364257 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:58:42.364642 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:58:42.366554 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:58:42.366917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:58:42.367255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:42.367567 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:58:42.370618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:42.930297 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.563 seconds
[0m03:58:42.933304 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:58:42.941191 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.570 seconds
[0m03:58:42.943669 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:58:42.980787 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.614 seconds
[0m03:58:42.983773 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:58:43.179070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70624050>]}
[0m03:58:43.180233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:58:43.181261 [info ] [MainThread]: 
[0m03:58:43.192939 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m03:58:43.193587 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m03:58:43.194337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now snapshot.retail_dbt.snap_customers)
[0m03:58:43.194697 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m03:58:43.201580 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m03:58:43.242067 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:43.242503 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:58:43.242836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:43.742209 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.499 seconds
[0m03:58:43.781931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:43.782532 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:58:44.920720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m03:58:44.925312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:44.926017 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:58:45.067099 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.140 seconds
[0m03:58:45.072979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.073763 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:58:45.203524 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.129 seconds
[0m03:58:45.207991 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.208955 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:58:45.350824 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.141 seconds
[0m03:58:45.354361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.354762 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m03:58:45.505704 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.150 seconds
[0m03:58:45.516823 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.517607 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m03:58:45.700050 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.182 seconds
[0m03:58:45.724052 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.724679 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:58:45.977681 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.252 seconds
[0m03:58:45.985933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:45.986694 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:58:46.149377 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m03:58:46.150500 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m03:58:46.154352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:46.155007 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m03:58:46.330202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m03:58:46.330899 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:46.331424 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:58:46.960539 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.628 seconds
[0m03:58:46.961460 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m03:58:46.962137 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m03:58:47.634466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m03:58:47.658683 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m03:58:47.867569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79dee3e3-60d0-4d02-b261-bf1beca2df86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdf0980>]}
[0m03:58:47.869361 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 4.67s]
[0m03:58:47.870538 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m03:58:47.871976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:58:47.872422 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m03:58:47.872733 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m03:58:47.873016 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m03:58:47.873377 [info ] [MainThread]: 
[0m03:58:47.873827 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m03:58:47.874433 [debug] [MainThread]: Command end result
[0m03:58:47.912872 [info ] [MainThread]: 
[0m03:58:47.913475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:58:47.913795 [info ] [MainThread]: 
[0m03:58:47.914121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:58:47.914921 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.091301, "process_user_time": 4.98328, "process_kernel_time": 0.224664, "process_mem_max_rss": "217412", "process_out_blocks": "3933", "process_in_blocks": "0"}
[0m03:58:47.915402 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:58:47.915303 after 9.09 seconds
[0m03:58:47.915850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca06480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbbbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4b5370>]}
[0m03:58:47.916205 [debug] [MainThread]: Flushing usage events
[0m03:58:51.089953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf67920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c919a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c919bb0>]}


============================== 03:58:51.096550 | 249e5a94-3ab4-4122-9f96-15a5090fd06c ==============================
[0m03:58:51.096550 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:51.097300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target test_wh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:58:51.773318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8df320>]}
[0m03:58:51.813540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cacad20>]}
[0m03:58:51.814291 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:58:51.893283 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:58:51.988715 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:58:51.989346 [debug] [MainThread]: previous checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m03:58:51.989681 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:58:51.990134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c8e2a0>]}
[0m03:58:53.098210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:58:53.099043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e291c0>]}
[0m03:58:53.293163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e2b230>]}
[0m03:58:53.417332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811ccc50>]}
[0m03:58:53.417866 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:58:53.418446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e014c0>]}
[0m03:58:53.420466 [info ] [MainThread]: 
[0m03:58:53.421092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:58:53.425023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:58:53.431863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m03:58:53.437136 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:58:53.438928 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m03:58:53.439352 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:58:53.439733 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m03:58:53.440096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:53.440424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:54.391379 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.951 seconds
[0m03:58:54.393062 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:58:54.395165 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.955 seconds
[0m03:58:54.396907 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m03:58:54.584787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m03:58:54.585751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m03:58:54.595519 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:58:54.597633 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:58:54.598099 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:58:54.598547 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:58:54.599025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:58:54.599355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:58:55.162063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.563 seconds
[0m03:58:55.165588 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:58:55.170300 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.571 seconds
[0m03:58:55.172936 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:58:55.362018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now list_RETAIL_DW_ANALYTICS)
[0m03:58:55.365229 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:58:55.366314 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:58:55.366662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:58:55.895520 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.529 seconds
[0m03:58:55.897101 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:58:56.096946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a9aba0>]}
[0m03:58:56.097662 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:58:56.098346 [info ] [MainThread]: 
[0m03:58:56.106347 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m03:58:56.106730 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m03:58:56.107200 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m03:58:56.107790 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m03:58:56.108286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m03:58:56.108708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m03:58:56.109119 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m03:58:56.109482 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m03:58:56.114931 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m03:58:56.117186 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m03:58:56.118807 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m03:58:56.126325 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m03:58:56.154227 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m03:58:56.159055 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m03:58:56.160831 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m03:58:56.161399 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m03:58:56.161729 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m03:58:56.162162 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m03:58:56.162607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:56.162972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:56.941659 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m03:58:56.966715 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m03:58:57.170486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d33c2f0>]}
[0m03:58:57.171374 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.06s]
[0m03:58:57.172334 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m03:58:57.172842 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m03:58:57.173446 [info ] [Thread-2 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m03:58:57.174067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_inventory_snapshots)
[0m03:58:57.174439 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m03:58:57.177267 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:58:57.178622 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m03:58:57.181168 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m03:58:57.182852 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m03:58:57.183237 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m03:58:57.183600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:57.383123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.220 seconds
[0m03:58:57.385237 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m03:58:57.580037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80122810>]}
[0m03:58:57.581310 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.47s]
[0m03:58:57.582556 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m03:58:57.583160 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_order_items
[0m03:58:57.583967 [info ] [Thread-1 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m03:58:57.584939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_order_items)
[0m03:58:57.585565 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_order_items
[0m03:58:57.589727 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m03:58:57.591369 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_order_items
[0m03:58:57.594086 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m03:58:57.595437 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m03:58:57.595874 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m03:58:57.596240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:57.891056 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m03:58:57.893826 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m03:58:58.085793 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8017b560>]}
[0m03:58:58.087066 [info ] [Thread-2 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.91s]
[0m03:58:58.088436 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m03:58:58.089216 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m03:58:58.090224 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m03:58:58.091208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m03:58:58.091879 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m03:58:58.096800 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m03:58:58.098413 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m03:58:58.102959 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m03:58:58.104317 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m03:58:58.104735 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m03:58:58.105154 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:58.229130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m03:58:58.231141 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: Close
[0m03:58:58.423713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801bda30>]}
[0m03:58:58.425169 [info ] [Thread-1 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.84s]
[0m03:58:58.427010 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_order_items
[0m03:58:58.428211 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_products
[0m03:58:58.429258 [info ] [Thread-1 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m03:58:58.430454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m03:58:58.431475 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_products
[0m03:58:58.435416 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m03:58:58.436661 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_products
[0m03:58:58.439109 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m03:58:58.440366 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m03:58:58.440820 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m03:58:58.441210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:58.821511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m03:58:58.825376 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m03:58:59.014437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80116f00>]}
[0m03:58:59.015889 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.92s]
[0m03:58:59.017482 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m03:58:59.018514 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m03:58:59.019364 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m03:58:59.020193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.stg_stores)
[0m03:58:59.020859 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m03:58:59.024616 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m03:58:59.027263 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m03:58:59.031002 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m03:58:59.034699 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m03:58:59.035137 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m03:58:59.035521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:58:59.065842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m03:58:59.067960 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: Close
[0m03:58:59.255015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8015ec60>]}
[0m03:58:59.255752 [info ] [Thread-1 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.82s]
[0m03:58:59.256640 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_products
[0m03:58:59.257155 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m03:58:59.257749 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m03:58:59.258341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m03:58:59.258707 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m03:58:59.263103 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m03:58:59.264431 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m03:58:59.266814 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m03:58:59.268524 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m03:58:59.268951 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m03:58:59.269347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:59.675383 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m03:58:59.677421 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m03:58:59.873053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801170e0>]}
[0m03:58:59.874367 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.85s]
[0m03:58:59.876637 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m03:58:59.878067 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m03:58:59.879182 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m03:58:59.880169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m03:58:59.880910 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m03:58:59.887160 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:58:59.888425 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m03:58:59.892225 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m03:58:59.893590 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m03:58:59.894018 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m03:58:59.894464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:00.530124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m03:59:00.533982 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m03:59:00.759016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8000cf50>]}
[0m03:59:00.760442 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.50s]
[0m03:59:00.761563 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m03:59:00.762350 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m03:59:00.763354 [info ] [Thread-1 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m03:59:00.764170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.dim_product)
[0m03:59:00.764723 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m03:59:00.769638 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m03:59:00.770976 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m03:59:00.773439 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m03:59:00.774738 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m03:59:00.775193 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m03:59:00.775584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:01.155154 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m03:59:01.157130 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m03:59:01.349257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80128cb0>]}
[0m03:59:01.350380 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.47s]
[0m03:59:01.351443 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m03:59:01.352199 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m03:59:01.353022 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m03:59:01.353748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.dim_store)
[0m03:59:01.354402 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m03:59:01.360739 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m03:59:01.362135 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m03:59:01.364649 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m03:59:01.366125 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m03:59:01.366560 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m03:59:01.366931 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:01.949512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m03:59:01.951910 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m03:59:02.148260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80160320>]}
[0m03:59:02.149396 [info ] [Thread-1 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.38s]
[0m03:59:02.150695 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m03:59:02.151481 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m03:59:02.152637 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m03:59:02.153517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now model.retail_dbt.fact_sales)
[0m03:59:02.154077 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m03:59:02.159821 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m03:59:02.161224 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m03:59:02.163526 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m03:59:02.166213 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m03:59:02.166699 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m03:59:02.167234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:02.597326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.230 seconds
[0m03:59:02.601833 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m03:59:02.799691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802d6900>]}
[0m03:59:02.801132 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.45s]
[0m03:59:02.802309 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m03:59:04.017873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.850 seconds
[0m03:59:04.021834 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m03:59:04.234463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249e5a94-3ab4-4122-9f96-15a5090fd06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801fade0>]}
[0m03:59:04.235261 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.08s]
[0m03:59:04.236148 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m03:59:04.237641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:04.238065 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m03:59:04.238369 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m03:59:04.238793 [info ] [MainThread]: 
[0m03:59:04.239301 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m03:59:04.241052 [debug] [MainThread]: Command end result
[0m03:59:04.281112 [info ] [MainThread]: 
[0m03:59:04.281898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:59:04.282340 [info ] [MainThread]: 
[0m03:59:04.282712 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m03:59:04.283667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.230183, "process_user_time": 5.346667, "process_kernel_time": 0.237879, "process_mem_max_rss": "216552", "process_out_blocks": "4027", "process_in_blocks": "0"}
[0m03:59:04.284151 [debug] [MainThread]: Command `dbt run` succeeded at 03:59:04.284072 after 13.23 seconds
[0m03:59:04.284506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbce330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e057c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf67920>]}
[0m03:59:04.284862 [debug] [MainThread]: Flushing usage events
[0m03:59:06.974219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d614980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d48e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb65a00>]}


============================== 03:59:06.981083 | 3542249d-950d-4c53-acae-2a857a2a79f9 ==============================
[0m03:59:06.981083 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:59:06.981881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --target test_wh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:59:07.658325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d776270>]}
[0m03:59:07.702370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e298710>]}
[0m03:59:07.703169 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:59:07.778955 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:59:07.948491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:07.948996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:07.989906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e244fe0>]}
[0m03:59:08.114028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7181b500>]}
[0m03:59:08.114543 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:59:08.115261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713ab500>]}
[0m03:59:08.117573 [info ] [MainThread]: 
[0m03:59:08.118266 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:59:08.122265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m03:59:08.130217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m03:59:08.135983 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m03:59:08.137859 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m03:59:08.138258 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m03:59:08.138655 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m03:59:08.139012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:08.139405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:08.746882 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.607 seconds
[0m03:59:08.750502 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m03:59:08.753740 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m03:59:08.757064 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m03:59:08.959577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now list_RETAIL_DW_ANALYTICS)
[0m03:59:08.965592 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m03:59:08.967005 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m03:59:08.967491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:09.480055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.512 seconds
[0m03:59:09.482930 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m03:59:09.687228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3542249d-950d-4c53-acae-2a857a2a79f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7194f0b0>]}
[0m03:59:09.687902 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m03:59:09.688938 [info ] [MainThread]: 
[0m03:59:09.697999 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:59:09.698439 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:59:09.698843 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m03:59:09.699426 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m03:59:09.699907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m03:59:09.700562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m03:59:09.700951 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:59:09.701344 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:59:09.719581 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:59:09.720526 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:59:09.722237 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:59:09.722552 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:59:09.740217 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:59:09.741698 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:59:09.743125 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m03:59:09.743585 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m03:59:09.744155 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m03:59:09.744444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:09.744833 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m03:59:09.746350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:10.428631 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m03:59:10.440631 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m03:59:10.442668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m03:59:10.444881 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m03:59:10.633393 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.93s]
[0m03:59:10.634393 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m03:59:10.635065 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:59:10.635638 [info ] [Thread-2 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m03:59:10.636343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m03:59:10.639452 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.94s]
[0m03:59:10.639909 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:59:10.640555 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m03:59:10.645338 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:59:10.645904 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:59:10.646874 [info ] [Thread-1 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m03:59:10.647486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m03:59:10.647956 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:59:10.652229 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:59:10.652736 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:59:10.656390 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:59:10.657419 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:59:10.659770 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:59:10.660741 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m03:59:10.661478 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m03:59:10.664960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:10.666604 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m03:59:10.667843 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m03:59:10.668484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:11.189002 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m03:59:11.191840 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m03:59:11.313350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m03:59:11.316205 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m03:59:11.380732 [info ] [Thread-2 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.74s]
[0m03:59:11.382244 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m03:59:11.382850 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:59:11.383484 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m03:59:11.384407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m03:59:11.385074 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:59:11.391360 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:59:11.392906 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:59:11.396880 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:59:11.398442 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m03:59:11.398969 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m03:59:11.399453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:11.509722 [info ] [Thread-1 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.86s]
[0m03:59:11.510873 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m03:59:11.511485 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:59:11.512212 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m03:59:11.513023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m03:59:11.513487 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:59:11.517776 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:59:11.519108 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:59:11.521362 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:59:11.522643 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m03:59:11.523036 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m03:59:11.523414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:11.972632 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m03:59:11.975854 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m03:59:12.082030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m03:59:12.084725 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m03:59:12.168438 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.78s]
[0m03:59:12.169992 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m03:59:12.170786 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:59:12.171493 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m03:59:12.172358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m03:59:12.173039 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:59:12.184559 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:59:12.187174 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:59:12.189534 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:59:12.190791 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m03:59:12.191234 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m03:59:12.191680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:12.284891 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.77s]
[0m03:59:12.285788 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m03:59:12.286245 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:59:12.286719 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m03:59:12.287359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m03:59:12.287733 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:59:12.291287 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:59:12.292354 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:59:12.294355 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:59:12.295711 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m03:59:12.296085 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m03:59:12.296425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:12.873622 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m03:59:12.877340 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m03:59:12.899660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m03:59:12.902864 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m03:59:13.089430 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.92s]
[0m03:59:13.091116 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m03:59:13.091965 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:59:13.092820 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m03:59:13.094047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m03:59:13.094719 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:59:13.104445 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:59:13.106555 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.82s]
[0m03:59:13.107362 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:59:13.107851 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m03:59:13.110147 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:59:13.110622 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:59:13.111214 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m03:59:13.111812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m03:59:13.112210 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:59:13.118393 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m03:59:13.119511 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:59:13.119883 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:13.120438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:13.122013 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:59:13.124317 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:59:13.125838 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m03:59:13.126219 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:13.127130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:13.954128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m03:59:13.955419 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m03:59:13.958621 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m03:59:13.961722 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m03:59:14.178322 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.07s]
[0m03:59:14.179270 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.09s]
[0m03:59:14.179841 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m03:59:14.180405 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m03:59:14.180903 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:59:14.181336 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:59:14.181725 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m03:59:14.182253 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m03:59:14.182711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m03:59:14.183145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m03:59:14.183611 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:59:14.184011 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:59:14.189102 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:59:14.193611 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:59:14.195275 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:59:14.195593 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:59:14.197613 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:59:14.199785 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:59:14.201351 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m03:59:14.202092 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m03:59:14.202431 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:14.202894 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:14.203266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:14.203584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:14.796946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m03:59:14.800256 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m03:59:14.912632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m03:59:14.915838 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m03:59:15.002657 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.82s]
[0m03:59:15.003573 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m03:59:15.004020 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:59:15.004439 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m03:59:15.005067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m03:59:15.005421 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:59:15.009693 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:59:15.010875 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:59:15.012954 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:59:15.014306 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m03:59:15.014796 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:15.015293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:15.102638 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.92s]
[0m03:59:15.103572 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m03:59:15.104056 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:59:15.104473 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m03:59:15.105033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m03:59:15.105400 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:59:15.111235 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:59:15.112407 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:59:15.170149 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:59:15.171974 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m03:59:15.172458 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:15.172875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:15.597701 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m03:59:15.601539 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m03:59:15.745592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m03:59:15.748543 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m03:59:15.812992 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.81s]
[0m03:59:15.814601 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m03:59:15.815390 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:59:15.815926 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m03:59:15.816700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m03:59:15.817318 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:59:15.824456 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:59:15.825830 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:59:15.828211 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:59:15.829655 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m03:59:15.830085 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:59:15.830467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:59:15.932330 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.83s]
[0m03:59:15.933229 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m03:59:15.933694 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:59:15.934156 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m03:59:15.934751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m03:59:15.935169 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:59:15.940738 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:59:15.942658 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:59:15.944740 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:59:15.946011 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m03:59:15.946462 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m03:59:15.946833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:59:16.445754 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m03:59:16.448981 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m03:59:16.533170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m03:59:16.536351 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m03:59:16.650336 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.83s]
[0m03:59:16.651967 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m03:59:16.835827 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.90s]
[0m03:59:16.837573 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m03:59:16.839835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:16.840501 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m03:59:16.841110 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m03:59:16.841811 [info ] [MainThread]: 
[0m03:59:16.843051 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 8.72 seconds (8.72s).
[0m03:59:16.846522 [debug] [MainThread]: Command end result
[0m03:59:16.889053 [info ] [MainThread]: 
[0m03:59:16.889685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:59:16.890094 [info ] [MainThread]: 
[0m03:59:16.890523 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m03:59:16.891356 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.953782, "process_user_time": 4.213286, "process_kernel_time": 0.246872, "process_mem_max_rss": "211000", "process_out_blocks": "2792", "process_in_blocks": "0"}
[0m03:59:16.891865 [debug] [MainThread]: Command `dbt test` succeeded at 03:59:16.891776 after 9.95 seconds
[0m03:59:16.892228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3fa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e244b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff246b0>]}
[0m03:59:16.892596 [debug] [MainThread]: Flushing usage events
[0m03:59:21.271119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc76360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0b6570>]}


============================== 03:59:21.277008 | 3fa4c271-a0eb-43ce-a8df-c86427c908c3 ==============================
[0m03:59:21.277008 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:59:21.277748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select state:modified+ --state state --target test_wh', 'send_anonymous_usage_stats': 'True'}
[0m03:59:21.930219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa4c271-a0eb-43ce-a8df-c86427c908c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60887c20>]}
[0m03:59:21.970223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa4c271-a0eb-43ce-a8df-c86427c908c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608626f0>]}
[0m03:59:21.970939 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:59:22.047329 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:59:22.185350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:22.185798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:22.226135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa4c271-a0eb-43ce-a8df-c86427c908c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba83b30>]}
[0m03:59:22.401381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa4c271-a0eb-43ce-a8df-c86427c908c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fd44f50>]}
[0m03:59:22.401895 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:59:22.402506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa4c271-a0eb-43ce-a8df-c86427c908c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61c26930>]}
[0m03:59:22.404048 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m03:59:22.405290 [info ] [MainThread]: 
[0m03:59:22.405615 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:59:22.407048 [debug] [MainThread]: Command end result
[0m03:59:22.443187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2082862, "process_user_time": 3.191762, "process_kernel_time": 0.157592, "process_mem_max_rss": "203360", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m03:59:22.443728 [debug] [MainThread]: Command `dbt run` succeeded at 03:59:22.443628 after 1.21 seconds
[0m03:59:22.444116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddd3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c693b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6ca5a0>]}
[0m03:59:22.444479 [debug] [MainThread]: Flushing usage events
[0m03:59:25.172833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d90c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e57a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea302c0>]}


============================== 03:59:25.178693 | cde6a69b-9868-47a0-b74b-a17ae719104a ==============================
[0m03:59:25.178693 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:59:25.179234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select state:modified+ --state state --target test_wh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:59:25.829511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cde6a69b-9868-47a0-b74b-a17ae719104a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff624abf80>]}
[0m03:59:25.870360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cde6a69b-9868-47a0-b74b-a17ae719104a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7119eea0>]}
[0m03:59:25.871088 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:59:25.948114 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m03:59:26.087044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:26.087492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:26.127891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde6a69b-9868-47a0-b74b-a17ae719104a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6216c290>]}
[0m03:59:26.319187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cde6a69b-9868-47a0-b74b-a17ae719104a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61a33260>]}
[0m03:59:26.319731 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m03:59:26.320192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cde6a69b-9868-47a0-b74b-a17ae719104a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff622531a0>]}
[0m03:59:26.321768 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m03:59:26.323013 [info ] [MainThread]: 
[0m03:59:26.323430 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:59:26.324967 [debug] [MainThread]: Command end result
[0m03:59:26.366636 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.230209, "process_user_time": 3.046556, "process_kernel_time": 0.176523, "process_mem_max_rss": "204080", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m03:59:26.367212 [debug] [MainThread]: Command `dbt test` succeeded at 03:59:26.367105 after 1.23 seconds
[0m03:59:26.367620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e57a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e12bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d27aa0>]}
[0m03:59:26.367989 [debug] [MainThread]: Flushing usage events
[0m01:24:02.073729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83119730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f34350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832d49e0>]}


============================== 01:24:02.079811 | 5bae84c4-cbf7-42a0-9b84-ce7320141a7c ==============================
[0m01:24:02.079811 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:24:02.080334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:24:02.167952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bae84c4-cbf7-42a0-9b84-ce7320141a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b0e6c0>]}
[0m01:24:02.232020 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hs9smz05'
[0m01:24:02.232420 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:24:02.398437 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:24:02.399412 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:24:02.549837 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:24:02.557949 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:24:03.143026 [info ] [MainThread]: Installed from version 1.3.0
[0m01:24:03.143746 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:24:03.144751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5bae84c4-cbf7-42a0-9b84-ce7320141a7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f830b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f70fe0>]}
[0m01:24:03.145097 [info ] [MainThread]: 
[0m01:24:03.145554 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:24:03.146775 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1102089, "process_user_time": 1.661717, "process_kernel_time": 0.215186, "process_mem_max_rss": "164152", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:24:03.147223 [debug] [MainThread]: Command `dbt deps` succeeded at 01:24:03.147147 after 1.11 seconds
[0m01:24:03.147551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832cb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f47860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b0e6c0>]}
[0m01:24:03.147886 [debug] [MainThread]: Flushing usage events
[0m01:24:06.159108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37aef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ff3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ff3a10>]}


============================== 01:24:06.164783 | aa01602c-efac-41fe-9669-ed9533e47f0d ==============================
[0m01:24:06.164783 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:24:06.165515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:06.825232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d62c60>]}
[0m01:24:06.864471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e45a90>]}
[0m01:24:06.865123 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:24:06.938340 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:24:07.031481 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:24:07.032148 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed
[0m01:24:07.032523 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:24:07.033021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97965310>]}
[0m01:24:08.118663 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:24:08.119328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979dac00>]}
[0m01:24:08.309930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a92cf0>]}
[0m01:24:08.410701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97925580>]}
[0m01:24:08.411155 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:24:08.411731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9753dc70>]}
[0m01:24:08.413520 [info ] [MainThread]: 
[0m01:24:08.414138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:08.414956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:24:08.425902 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:24:08.426336 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:24:08.426694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:09.441271 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.014 seconds
[0m01:24:09.444924 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:24:09.648773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m01:24:09.654899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m01:24:09.662025 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:24:09.662467 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:24:09.662903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m01:24:09.663224 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:24:09.663659 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:24:09.665499 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:24:09.665901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:09.666347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:09.666730 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:24:09.669933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:10.193062 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.527 seconds
[0m01:24:10.195151 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:24:10.204391 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.538 seconds
[0m01:24:10.206191 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:24:10.209294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.539 seconds
[0m01:24:10.210942 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:24:10.397955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97126420>]}
[0m01:24:10.398939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:10.399986 [info ] [MainThread]: 
[0m01:24:10.410866 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m01:24:10.411496 [info ] [Thread-1 (]: 1 of 1 START snapshot ANALYTICS.snap_customers ................................. [RUN]
[0m01:24:10.412145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now snapshot.retail_dbt.snap_customers)
[0m01:24:10.412582 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m01:24:10.419732 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m01:24:10.461450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:10.461869 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:24:10.462320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:10.978036 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.515 seconds
[0m01:24:11.022495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:11.023057 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:24:13.011837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.988 seconds
[0m01:24:13.016711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.017252 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:24:13.150031 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.132 seconds
[0m01:24:13.154771 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.155322 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:24:13.462898 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.307 seconds
[0m01:24:13.469502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.470249 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:24:13.617664 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.146 seconds
[0m01:24:13.623508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.624189 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m01:24:13.747905 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.123 seconds
[0m01:24:13.759769 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.760472 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m01:24:13.876974 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.116 seconds
[0m01:24:13.902917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:13.903451 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:24:14.150940 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.247 seconds
[0m01:24:14.158605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:14.159149 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:24:14.316546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.157 seconds
[0m01:24:14.317375 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m01:24:14.320518 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:14.320936 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m01:24:14.500233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m01:24:14.501627 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:14.502394 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:24:15.160813 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.658 seconds
[0m01:24:15.161887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m01:24:15.162541 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m01:24:15.646424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m01:24:15.674849 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m01:24:15.874839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa01602c-efac-41fe-9669-ed9533e47f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e0afc0>]}
[0m01:24:15.876215 [info ] [Thread-1 (]: 1 of 1 OK snapshotted ANALYTICS.snap_customers ................................. [[32mSUCCESS 0[0m in 5.46s]
[0m01:24:15.877638 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m01:24:15.879696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:15.880139 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m01:24:15.880541 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m01:24:15.880926 [debug] [MainThread]: Connection 'snapshot.retail_dbt.snap_customers' was properly closed.
[0m01:24:15.881379 [info ] [MainThread]: 
[0m01:24:15.881972 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m01:24:15.882912 [debug] [MainThread]: Command end result
[0m01:24:15.925691 [info ] [MainThread]: 
[0m01:24:15.926179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:24:15.926499 [info ] [MainThread]: 
[0m01:24:15.926883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:24:15.927668 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.803879, "process_user_time": 5.004403, "process_kernel_time": 0.251697, "process_mem_max_rss": "217044", "process_out_blocks": "3933", "process_in_blocks": "0"}
[0m01:24:15.928111 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:24:15.928037 after 9.80 seconds
[0m01:24:15.928472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c68980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c693d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35fbc50>]}
[0m01:24:15.928873 [debug] [MainThread]: Flushing usage events
[0m01:24:18.978398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89134200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d0f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864cb530>]}


============================== 01:24:18.984083 | ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64 ==============================
[0m01:24:18.984083 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:24:18.984799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target test_wh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:19.595545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a990a70>]}
[0m01:24:19.635086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3a9dc0>]}
[0m01:24:19.635736 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:24:19.711159 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m01:24:19.801391 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:24:19.802043 [debug] [MainThread]: previous checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m01:24:19.802425 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:24:19.802947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a691cd0>]}
[0m01:24:20.861539 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:24:20.862291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad07d40>]}
[0m01:24:21.050534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6abcd7f0>]}
[0m01:24:21.148646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a79cc50>]}
[0m01:24:21.149128 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m01:24:21.149697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a64f3b0>]}
[0m01:24:21.151723 [info ] [MainThread]: 
[0m01:24:21.152258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:21.156025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:24:21.162012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m01:24:21.167565 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:24:21.169346 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m01:24:21.169721 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:24:21.170085 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m01:24:21.170421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:21.170757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:21.870740 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.700 seconds
[0m01:24:21.873280 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:24:21.876270 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.705 seconds
[0m01:24:21.878583 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m01:24:22.088997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m01:24:22.098814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m01:24:22.102367 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m01:24:22.104773 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m01:24:22.105327 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m01:24:22.105731 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m01:24:22.106146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:22.106601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:22.632376 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.526 seconds
[0m01:24:22.637315 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m01:24:22.638511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.532 seconds
[0m01:24:22.643377 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m01:24:22.840429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now list_RETAIL_DW_STAGING_STAGING)
[0m01:24:22.846684 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m01:24:22.847310 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m01:24:22.847870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:23.381140 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.533 seconds
[0m01:24:23.384901 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m01:24:23.576112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a111670>]}
[0m01:24:23.577536 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m01:24:23.579093 [info ] [MainThread]: 
[0m01:24:23.593610 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m01:24:23.594204 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m01:24:23.594889 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m01:24:23.595806 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m01:24:23.596478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m01:24:23.597047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m01:24:23.597484 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m01:24:23.597932 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m01:24:23.604732 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m01:24:23.607182 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m01:24:23.610642 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m01:24:23.610972 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m01:24:23.648034 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m01:24:23.650842 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m01:24:23.652516 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m01:24:23.653224 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m01:24:23.653547 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m01:24:23.653986 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m01:24:23.654368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:23.654781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:24.582845 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.928 seconds
[0m01:24:24.608756 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m01:24:24.809505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d3c410>]}
[0m01:24:24.811210 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.21s]
[0m01:24:24.813286 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m01:24:24.814152 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m01:24:24.815055 [info ] [Thread-2 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m01:24:24.816023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_inventory_snapshots)
[0m01:24:24.817120 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m01:24:24.821941 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:24:24.823871 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m01:24:24.827335 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m01:24:24.828992 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m01:24:24.829490 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m01:24:24.829970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:25.227707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.573 seconds
[0m01:24:25.231877 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m01:24:25.423528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6953d970>]}
[0m01:24:25.425195 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.83s]
[0m01:24:25.426879 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m01:24:25.427535 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_order_items
[0m01:24:25.428280 [info ] [Thread-1 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m01:24:25.429230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_order_items)
[0m01:24:25.429822 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_order_items
[0m01:24:25.434062 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m01:24:25.435539 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_order_items
[0m01:24:25.438704 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m01:24:25.440143 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m01:24:25.440585 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m01:24:25.441045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:25.471902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m01:24:25.474019 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m01:24:25.666130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6951ccb0>]}
[0m01:24:25.667642 [info ] [Thread-2 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.85s]
[0m01:24:25.669356 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m01:24:25.670380 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m01:24:25.671358 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m01:24:25.672463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m01:24:25.673170 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m01:24:25.677261 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m01:24:25.678781 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m01:24:25.683581 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m01:24:25.684949 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m01:24:25.685379 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m01:24:25.685810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:26.098463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m01:24:26.103101 [debug] [Thread-1 (]: On model.retail_dbt.stg_order_items: Close
[0m01:24:26.311962 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m01:24:26.315989 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m01:24:26.341150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69532240>]}
[0m01:24:26.342412 [info ] [Thread-1 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.91s]
[0m01:24:26.343758 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_order_items
[0m01:24:26.344467 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_products
[0m01:24:26.345230 [info ] [Thread-1 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m01:24:26.346032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m01:24:26.346632 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_products
[0m01:24:26.350719 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m01:24:26.351868 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_products
[0m01:24:26.354329 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m01:24:26.355540 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m01:24:26.355988 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m01:24:26.356357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:26.509846 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ebca40>]}
[0m01:24:26.510589 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.84s]
[0m01:24:26.511348 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m01:24:26.511739 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m01:24:26.512430 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m01:24:26.513013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.stg_stores)
[0m01:24:26.516687 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m01:24:26.519392 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m01:24:26.520609 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m01:24:26.523033 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m01:24:26.524255 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m01:24:26.525277 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m01:24:26.525800 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:27.177765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m01:24:27.182825 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: Close
[0m01:24:27.385398 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m01:24:27.389045 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m01:24:27.565370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69517710>]}
[0m01:24:27.566072 [info ] [Thread-1 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.22s]
[0m01:24:27.566826 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_products
[0m01:24:27.567285 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m01:24:27.567857 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m01:24:27.568392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m01:24:27.568760 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m01:24:27.573435 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m01:24:27.574725 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m01:24:27.577015 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m01:24:27.578760 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m01:24:27.579156 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m01:24:27.579539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:27.720231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69517a40>]}
[0m01:24:27.721625 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.21s]
[0m01:24:27.722968 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m01:24:27.723649 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m01:24:27.724479 [info ] [Thread-2 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m01:24:27.725268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m01:24:27.725744 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m01:24:27.732327 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:24:27.734207 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m01:24:27.739051 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m01:24:27.740867 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m01:24:27.741342 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m01:24:27.741781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:29.374702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m01:24:29.379100 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m01:24:29.383786 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.642 seconds
[0m01:24:29.386237 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m01:24:29.712329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6957acf0>]}
[0m01:24:29.713864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69112e70>]}
[0m01:24:29.715088 [info ] [Thread-2 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.99s]
[0m01:24:29.716966 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 2.14s]
[0m01:24:29.718018 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m01:24:29.718859 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m01:24:29.719650 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m01:24:29.720493 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_store
[0m01:24:29.721953 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m01:24:29.723085 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m02:24:31.527209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.dim_product)
[0m02:24:31.527977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.dim_store)
[0m02:24:31.528681 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m02:24:31.529316 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_store
[0m02:24:31.534951 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m02:24:31.539003 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m02:24:31.540663 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m02:24:31.541027 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_store
[0m02:24:31.543466 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m02:24:31.545821 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m02:24:31.547333 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m02:24:31.547755 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m02:24:31.548319 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m02:24:31.548624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:24:31.548998 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m02:24:31.551535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:24:33.517627 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.968 seconds
[0m02:24:33.519380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.968 seconds
[0m02:24:33.524052 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m02:24:33.527477 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: Close
[0m02:24:36.125952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a600890>]}
[0m02:24:36.131561 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 4.60s]
[0m02:24:36.132962 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_store
[0m02:24:36.133559 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m02:24:36.134113 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m02:24:36.134819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now model.retail_dbt.fact_sales)
[0m02:24:36.135361 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m02:24:36.141679 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m02:24:36.144081 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m02:24:36.146954 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m02:24:36.149941 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m02:24:36.150611 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m02:24:36.151191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:24:36.246287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0645ed-4dcb-4f7b-9995-4fcdaa78bc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69562cf0>]}
[0m02:24:36.247005 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 4.72s]
[0m02:24:36.247887 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m05:27:20.931336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99d35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99ea390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99d0920>]}


============================== 05:27:20.938570 | db10fa3a-d2aa-4970-9d39-75d1a43ea858 ==============================
[0m05:27:20.938570 [info ] [MainThread]: Running with dbt=1.8.2
[0m05:27:20.939595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target test_wh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:21.655410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d790e90>]}
[0m05:27:21.695959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f2b140>]}
[0m05:27:21.696620 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:27:21.770159 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m05:27:21.913339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:21.913825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:21.955588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d65d5b0>]}
[0m05:27:22.056888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d65d4c0>]}
[0m05:27:22.057372 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m05:27:22.058046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1e2540>]}
[0m05:27:22.060436 [info ] [MainThread]: 
[0m05:27:22.061296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:27:22.067509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m05:27:22.069259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m05:27:22.088867 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m05:27:22.089302 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m05:27:22.089963 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m05:27:22.090397 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m05:27:22.090843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:22.091201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:24.398927 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.307 seconds
[0m05:27:24.400444 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.310 seconds
[0m05:27:24.403568 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m05:27:24.405995 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m05:27:24.611317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m05:27:24.612314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m05:27:24.624044 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m05:27:24.626563 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m05:27:24.627031 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m05:27:24.627459 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m05:27:24.627892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:24.628268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:25.184661 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.556 seconds
[0m05:27:25.189161 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m05:27:25.245154 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.616 seconds
[0m05:27:25.248264 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m05:27:25.380086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now list_RETAIL_DW_STAGING_STAGING)
[0m05:27:25.386189 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m05:27:25.386831 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m05:27:25.387330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:25.956911 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.569 seconds
[0m05:27:25.962154 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m05:27:26.158624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0ca9c0>]}
[0m05:27:26.160526 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m05:27:26.163231 [info ] [MainThread]: 
[0m05:27:26.178770 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m05:27:26.179884 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m05:27:26.180597 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m05:27:26.181667 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m05:27:26.182348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m05:27:26.182886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m05:27:26.183395 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m05:27:26.183879 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m05:27:26.192625 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m05:27:26.195230 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m05:27:26.196838 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m05:27:26.197171 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m05:27:26.234990 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m05:27:26.236735 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m05:27:26.238312 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m05:27:26.238771 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m05:27:26.239371 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m05:27:26.239677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:26.240044 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m05:27:26.241558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:26.933743 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m05:27:26.959414 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m05:27:27.253812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d75aa50>]}
[0m05:27:27.254848 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.07s]
[0m05:27:27.255822 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m05:27:27.256568 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m05:27:27.257314 [info ] [Thread-2 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m05:27:27.257866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_inventory_snapshots)
[0m05:27:27.258390 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m05:27:27.261327 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m05:27:27.263009 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m05:27:27.265368 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m05:27:27.266566 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m05:27:27.266918 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m05:27:27.267271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:27.963192 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m05:27:27.966623 [debug] [Thread-2 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m05:27:28.209386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.969 seconds
[0m05:27:28.214469 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m05:27:28.324328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c606ea0>]}
[0m05:27:28.326390 [info ] [Thread-2 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.07s]
[0m05:27:28.327796 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m05:27:28.328590 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_order_items
[0m05:27:28.329524 [info ] [Thread-2 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m05:27:28.330720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_order_items)
[0m05:27:28.331506 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_order_items
[0m05:27:28.336045 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m05:27:28.337597 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_order_items
[0m05:27:28.340757 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m05:27:28.342437 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m05:27:28.342987 [debug] [Thread-2 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m05:27:28.343468 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:28.420077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c663380>]}
[0m05:27:28.421106 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.24s]
[0m05:27:28.421990 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m05:27:28.422645 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_orders
[0m05:27:28.423431 [info ] [Thread-1 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m05:27:28.424098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_orders)
[0m05:27:28.424628 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_orders
[0m05:27:28.428129 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m05:27:28.429779 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_orders
[0m05:27:28.432983 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m05:27:28.434337 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m05:27:28.434831 [debug] [Thread-1 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m05:27:28.435277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:29.451379 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.108 seconds
[0m05:27:29.456001 [debug] [Thread-2 (]: On model.retail_dbt.stg_order_items: Close
[0m05:27:29.973820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.538 seconds
[0m05:27:29.979469 [debug] [Thread-1 (]: On model.retail_dbt.stg_orders: Close
[0m05:27:29.981197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7e1880>]}
[0m05:27:29.983942 [info ] [Thread-2 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.65s]
[0m05:27:29.985981 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_order_items
[0m05:27:29.986884 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m05:27:29.987799 [info ] [Thread-2 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m05:27:29.988628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m05:27:29.989147 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m05:27:29.992971 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m05:27:29.994637 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m05:27:29.997820 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m05:27:29.999268 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m05:27:29.999700 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m05:27:30.000105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:30.499541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c67caa0>]}
[0m05:27:30.501400 [info ] [Thread-1 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 2.07s]
[0m05:27:30.502652 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_orders
[0m05:27:30.503691 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_stores
[0m05:27:30.504794 [info ] [Thread-1 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m05:27:30.505755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.stg_stores)
[0m05:27:30.506376 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_stores
[0m05:27:30.511278 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m05:27:30.513240 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_stores
[0m05:27:30.516586 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m05:27:30.518131 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m05:27:30.518658 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m05:27:30.519171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:31.116248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m05:27:31.121877 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: Close
[0m05:27:31.352349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m05:27:31.357549 [debug] [Thread-1 (]: On model.retail_dbt.stg_stores: Close
[0m05:27:31.543416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c69bf80>]}
[0m05:27:31.545108 [info ] [Thread-2 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.55s]
[0m05:27:31.546324 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m05:27:31.547109 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_customer
[0m05:27:31.547994 [info ] [Thread-2 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m05:27:31.549159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m05:27:31.549952 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_customer
[0m05:27:31.560562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6c3290>]}
[0m05:27:31.568143 [info ] [Thread-1 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 1.05s]
[0m05:27:31.571302 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m05:27:31.571918 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_stores
[0m05:27:31.572553 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m05:27:31.573125 [info ] [Thread-1 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m05:27:31.573624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m05:27:31.574088 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m05:27:31.574391 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_customer
[0m05:27:31.578019 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m05:27:31.580281 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m05:27:31.581364 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m05:27:31.582452 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m05:27:31.584603 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m05:27:31.585081 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m05:27:31.585677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:31.587653 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m05:27:31.588107 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m05:27:31.588453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:33.445457 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.860 seconds
[0m05:27:33.449443 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: Close
[0m05:27:33.450639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.862 seconds
[0m05:27:33.456150 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m05:27:33.677495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d08b6e0>]}
[0m05:27:33.679744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d08b140>]}
[0m05:27:33.681368 [info ] [Thread-1 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 2.10s]
[0m05:27:33.682922 [info ] [Thread-2 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 2.13s]
[0m05:27:33.685383 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m05:27:33.686427 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_customer
[0m05:27:33.687667 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m05:27:33.688719 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m05:27:33.689818 [info ] [Thread-1 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m05:27:33.690776 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m05:27:33.691746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.dim_product)
[0m05:27:33.692518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.dim_store)
[0m05:27:33.693164 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m05:27:33.693836 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m05:27:33.699075 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m05:27:33.702827 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m05:27:33.704454 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m05:27:33.704822 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m05:27:33.707500 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m05:27:33.711182 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m05:27:33.712695 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m05:27:33.713128 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m05:27:33.713699 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m05:27:33.713991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:33.714368 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m05:27:33.715544 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:35.592969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.879 seconds
[0m05:27:35.596830 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m05:27:35.685611 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.970 seconds
[0m05:27:35.689321 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m05:27:35.795245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2d17c0>]}
[0m05:27:35.796635 [info ] [Thread-1 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 2.10s]
[0m05:27:35.797749 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m05:27:35.798528 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m05:27:35.799220 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m05:27:35.799899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now model.retail_dbt.fact_sales)
[0m05:27:35.800523 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m05:27:35.807219 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m05:27:35.808577 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m05:27:35.810853 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m05:27:35.813419 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m05:27:35.813933 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m05:27:35.814436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:35.898465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6ce4b0>]}
[0m05:27:35.902837 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 2.21s]
[0m05:27:35.903429 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m05:27:38.233849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.419 seconds
[0m05:27:38.239730 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m05:27:38.441652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db10fa3a-d2aa-4970-9d39-75d1a43ea858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa602b70>]}
[0m05:27:38.443901 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.64s]
[0m05:27:38.445097 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m05:27:38.447951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:38.448541 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m05:27:38.448973 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m05:27:38.449649 [info ] [MainThread]: 
[0m05:27:38.450286 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 16.39 seconds (16.39s).
[0m05:27:38.453294 [debug] [MainThread]: Command end result
[0m05:27:38.498438 [info ] [MainThread]: 
[0m05:27:38.498926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:27:38.499269 [info ] [MainThread]: 
[0m05:27:38.499637 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m05:27:38.500423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.612917, "process_user_time": 6.281374, "process_kernel_time": 0.760995, "process_mem_max_rss": "210480", "process_out_blocks": "5727", "process_in_blocks": "0"}
[0m05:27:38.500919 [debug] [MainThread]: Command `dbt run` succeeded at 05:27:38.500824 after 17.61 seconds
[0m05:27:38.501309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99d35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9596540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d82360>]}
[0m05:27:38.501685 [debug] [MainThread]: Flushing usage events
[0m05:27:41.416357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cdec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78434d0>]}


============================== 05:27:41.422059 | 3653a0d0-a9da-4de3-ac85-f0002ed1f84a ==============================
[0m05:27:41.422059 [info ] [MainThread]: Running with dbt=1.8.2
[0m05:27:41.422789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --target test_wh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:42.032500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1fc2c0>]}
[0m05:27:42.071835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c109f40>]}
[0m05:27:42.072469 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:27:42.146046 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m05:27:42.280340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:42.280836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:42.320333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf103e0>]}
[0m05:27:42.428253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9baa6b40>]}
[0m05:27:42.428745 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m05:27:42.429314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf12030>]}
[0m05:27:42.431432 [info ] [MainThread]: 
[0m05:27:42.432081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:27:42.435976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m05:27:42.444686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m05:27:42.449496 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m05:27:42.451355 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m05:27:42.451813 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m05:27:42.452220 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m05:27:42.452595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:42.452974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:43.567045 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.114 seconds
[0m05:27:43.568157 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.115 seconds
[0m05:27:43.570764 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m05:27:43.573239 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m05:27:43.806674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m05:27:43.814899 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m05:27:43.816173 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m05:27:43.817516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:44.465472 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.648 seconds
[0m05:27:44.469969 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m05:27:44.677297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3653a0d0-a9da-4de3-ac85-f0002ed1f84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7841190>]}
[0m05:27:44.678953 [info ] [MainThread]: Concurrency: 2 threads (target='test_wh')
[0m05:27:44.680738 [info ] [MainThread]: 
[0m05:27:44.694817 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m05:27:44.695607 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m05:27:44.696347 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m05:27:44.697727 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m05:27:44.698963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m05:27:44.700284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m05:27:44.701174 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m05:27:44.701976 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m05:27:44.723884 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m05:27:44.725962 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m05:27:44.728017 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m05:27:44.728433 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m05:27:44.752224 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m05:27:44.753250 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m05:27:44.755314 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m05:27:44.755914 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m05:27:44.756289 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m05:27:44.756762 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m05:27:44.757142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:44.757468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:45.510555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m05:27:45.511697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m05:27:45.524011 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m05:27:45.526640 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m05:27:45.722771 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.02s]
[0m05:27:45.724355 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m05:27:45.725601 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.03s]
[0m05:27:45.726340 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m05:27:45.727528 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m05:27:45.728040 [info ] [Thread-2 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m05:27:45.728824 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m05:27:45.729467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m05:27:45.730085 [info ] [Thread-1 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m05:27:45.730778 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m05:27:45.731315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m05:27:45.736583 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m05:27:45.737030 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m05:27:45.740831 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m05:27:45.742690 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m05:27:45.745750 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m05:27:45.746332 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m05:27:45.748552 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m05:27:45.749411 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m05:27:45.749931 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m05:27:45.750429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:45.751242 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m05:27:45.752942 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m05:27:45.753339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:46.389407 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m05:27:46.392231 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m05:27:46.559651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m05:27:46.563093 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m05:27:46.662201 [info ] [Thread-2 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.93s]
[0m05:27:46.663278 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m05:27:46.663930 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m05:27:46.664619 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m05:27:46.665559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m05:27:46.666212 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m05:27:46.675237 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m05:27:46.676977 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m05:27:46.679396 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m05:27:46.680773 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m05:27:46.681238 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m05:27:46.681741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:27:46.757797 [info ] [Thread-1 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.03s]
[0m05:27:46.759185 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m05:27:46.759745 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m05:27:46.760292 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m05:27:46.761862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m05:27:46.762364 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m05:27:46.767075 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m05:27:46.768540 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m05:27:46.771122 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m05:27:46.772821 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m05:27:46.773293 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m05:27:46.773790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:47.741115 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m06:04:47.743011 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:04:47.762112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m06:04:47.763855 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:04:47.931486 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 2221.27s]
[0m06:04:47.932371 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:04:47.932845 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:04:47.933222 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:04:47.933732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:04:47.934095 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:04:47.937816 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:04:47.938958 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:04:47.940979 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:04:47.942178 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:04:47.942611 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:04:47.942969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:04:47.958632 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 2221.20s]
[0m06:04:47.959270 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:04:47.959694 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:04:47.960069 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:04:47.960630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:04:47.960987 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:04:47.964295 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:04:47.965319 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:04:47.967299 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:04:47.968602 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:04:47.968985 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:04:47.969372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:48.494046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m06:04:48.497517 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:04:48.501844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m06:04:48.504729 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:04:48.689204 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.75s]
[0m06:04:48.691688 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:04:48.693362 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:04:48.694134 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:04:48.697892 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.74s]
[0m06:04:48.698732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:04:48.699865 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:04:48.700594 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:04:48.701371 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:04:48.711173 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:04:48.712452 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:04:48.712890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:04:48.713533 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:04:48.720424 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:04:48.721368 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:04:48.723522 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:04:48.723844 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:04:48.726079 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:04:48.727711 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:04:48.728155 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:48.729180 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:04:48.729509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:04:48.729929 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:48.731543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:49.554496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m06:04:49.559819 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:04:49.564653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m06:04:49.567855 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:04:49.844534 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.13s]
[0m06:04:49.846705 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.15s]
[0m06:04:49.847932 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:04:49.848853 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:04:49.849705 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:04:49.850381 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:04:49.851001 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:04:49.852030 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:04:49.853059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:04:49.853967 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:04:49.854846 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:04:49.855544 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:04:49.863273 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:04:49.868829 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:04:49.871544 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:04:49.871905 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:04:49.874209 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:04:49.876336 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:04:49.877939 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:04:49.878421 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:49.879146 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:04:49.879470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:49.879853 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:49.881485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:04:50.610249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m06:04:50.613590 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:04:50.716172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m06:04:50.720190 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:04:50.888247 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.03s]
[0m06:04:50.889189 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:04:50.889636 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:04:50.890010 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:04:50.890538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:04:50.890892 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:04:50.895069 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:04:50.896109 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:04:50.899634 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:04:50.901077 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:04:50.901478 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:50.901842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:04:51.019258 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.17s]
[0m06:04:51.019908 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:04:51.020332 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:04:51.020708 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:04:51.021206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:04:51.021646 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:04:51.090358 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:04:51.091658 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:04:51.093730 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:04:51.095203 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:04:51.095606 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:51.096034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:51.656014 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m06:04:51.660161 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:04:51.941621 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 1.05s]
[0m06:04:51.943157 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:04:51.943875 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:04:51.944378 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:04:51.945369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:04:51.946887 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:04:51.956236 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:04:51.957970 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:04:51.961102 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:04:51.962522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m06:04:51.964179 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:04:51.966593 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:04:51.967234 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:04:51.967833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:04:52.234362 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.21s]
[0m06:04:52.236539 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:04:52.237373 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:04:52.238050 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:04:52.238725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:04:52.239301 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:04:52.249641 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:04:52.252278 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:04:52.255357 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:04:52.257166 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:04:52.257712 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "test_wh", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:04:52.258193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:52.746315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m06:04:52.751771 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:04:53.116649 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 1.17s]
[0m06:04:53.119025 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:04:53.189203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m06:04:53.193908 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:04:53.603852 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 1.36s]
[0m06:04:53.604988 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:04:53.606746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:53.607151 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:04:53.607562 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:04:53.608031 [info ] [MainThread]: 
[0m06:04:53.608640 [info ] [MainThread]: Finished running 16 data tests in 0 hours 37 minutes and 11.18 seconds (2231.18s).
[0m06:04:53.610540 [debug] [MainThread]: Command end result
[0m06:04:53.654071 [info ] [MainThread]: 
[0m06:04:53.654612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:53.654929 [info ] [MainThread]: 
[0m06:04:53.655298 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:04:53.656004 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.807276, "process_user_time": 4.311055, "process_kernel_time": 0.246632, "process_mem_max_rss": "211188", "process_out_blocks": "2793", "process_in_blocks": "0"}
[0m06:04:53.656505 [debug] [MainThread]: Command `dbt test` succeeded at 06:04:53.656390 after 11.81 seconds
[0m06:04:53.656870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ba1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77fd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77fd9a0>]}
[0m06:04:53.657211 [debug] [MainThread]: Flushing usage events
[0m06:04:57.531511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b06d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5528a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a553cb0>]}


============================== 06:04:57.537564 | 0e7de894-f427-4c8c-80d3-88548bb76ac3 ==============================
[0m06:04:57.537564 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:04:57.538124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select state:modified+ --state state --target test_wh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:04:58.218842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e7de894-f427-4c8c-80d3-88548bb76ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f402ba0>]}
[0m06:04:58.267203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e7de894-f427-4c8c-80d3-88548bb76ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae0f680>]}
[0m06:04:58.268096 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:04:58.344251 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m06:04:58.483102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:04:58.483549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:04:58.526772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e7de894-f427-4c8c-80d3-88548bb76ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e80fcb0>]}
[0m06:04:58.699013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e7de894-f427-4c8c-80d3-88548bb76ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df7cf80>]}
[0m06:04:58.699545 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:04:58.699936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e7de894-f427-4c8c-80d3-88548bb76ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5d2510>]}
[0m06:04:58.701388 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m06:04:58.702550 [info ] [MainThread]: 
[0m06:04:58.702896 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:04:58.704307 [debug] [MainThread]: Command end result
[0m06:04:58.739051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2445812, "process_user_time": 3.273087, "process_kernel_time": 0.203278, "process_mem_max_rss": "203272", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m06:04:58.739564 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:58.739471 after 1.25 seconds
[0m06:04:58.739941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a929c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4b7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec3b0e0>]}
[0m06:04:58.740317 [debug] [MainThread]: Flushing usage events
[0m06:05:01.401418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87affda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8762d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b78fe0>]}


============================== 06:05:01.407132 | 6c3252bb-f063-47b0-a542-7fefcdfe4a45 ==============================
[0m06:05:01.407132 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:05:01.407858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select state:modified+ --state state --target test_wh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:05:02.070330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3252bb-f063-47b0-a542-7fefcdfe4a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c590b60>]}
[0m06:05:02.111577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3252bb-f063-47b0-a542-7fefcdfe4a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88298740>]}
[0m06:05:02.112316 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:05:02.192222 [debug] [MainThread]: checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed, vars: {}, profile: , target: test_wh, version: 1.8.2
[0m06:05:02.355794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:02.356236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:02.401421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3252bb-f063-47b0-a542-7fefcdfe4a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b81ac30>]}
[0m06:05:02.654929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3252bb-f063-47b0-a542-7fefcdfe4a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b0332c0>]}
[0m06:05:02.655562 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:05:02.656187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3252bb-f063-47b0-a542-7fefcdfe4a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b26f470>]}
[0m06:05:02.657716 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m06:05:02.659093 [info ] [MainThread]: 
[0m06:05:02.659591 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:05:02.661189 [debug] [MainThread]: Command end result
[0m06:05:02.734457 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.368461, "process_user_time": 3.274937, "process_kernel_time": 0.169255, "process_mem_max_rss": "204072", "process_out_blocks": "2631", "process_in_blocks": "0"}
[0m06:05:02.736086 [debug] [MainThread]: Command `dbt test` succeeded at 06:05:02.735811 after 1.37 seconds
[0m06:05:02.737753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87109910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86eeb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f87e00>]}
[0m06:05:02.738750 [debug] [MainThread]: Flushing usage events
[0m06:28:02.168849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913bcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913bdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93908440>]}


============================== 06:28:02.174626 | 42aa20f6-2c77-4e9f-b647-8be2d50f1311 ==============================
[0m06:28:02.174626 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:28:02.175244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:28:02.259629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42aa20f6-2c77-4e9f-b647-8be2d50f1311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a18650>]}
[0m06:28:02.316182 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tpxpcbi3'
[0m06:28:02.316603 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:28:02.471100 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:28:02.472044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:28:02.533684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:28:02.539467 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:28:03.119337 [info ] [MainThread]: Installed from version 1.3.0
[0m06:28:03.119829 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:28:03.120469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42aa20f6-2c77-4e9f-b647-8be2d50f1311', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9062bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90603230>]}
[0m06:28:03.120908 [info ] [MainThread]: 
[0m06:28:03.121346 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:28:03.122261 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9885467, "process_user_time": 1.68466, "process_kernel_time": 0.115181, "process_mem_max_rss": "101508", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:28:03.122700 [debug] [MainThread]: Command `dbt deps` succeeded at 06:28:03.122609 after 0.99 seconds
[0m06:28:03.123033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915acaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912ae6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bef680>]}
[0m06:28:03.123321 [debug] [MainThread]: Flushing usage events
[0m06:28:05.179460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed6d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad38d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5a4440>]}


============================== 06:28:05.185037 | 79860218-2fc6-4c61-99f9-5294d9fb2db8 ==============================
[0m06:28:05.185037 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:28:05.185599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:05.815556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912605c0>]}
[0m06:28:05.858258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e2ea50>]}
[0m06:28:05.858925 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:28:05.931237 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:28:06.020335 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:28:06.020865 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 08d0f2c01916e6605fe228812a3e12fd7d2de2865a80e139021cd5dfa0a7c2ed
[0m06:28:06.021282 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:28:06.021832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90891940>]}
[0m06:28:07.082730 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:28:07.083351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad244140>]}
[0m06:28:07.272699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9074dca0>]}
[0m06:28:07.369501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c74560>]}
[0m06:28:07.369958 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:28:07.370344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ec8e30>]}
[0m06:28:07.372357 [info ] [MainThread]: 
[0m06:28:07.372933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:28:07.376705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:28:07.383238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:28:07.388360 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:28:07.390135 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:28:07.390498 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:28:07.390861 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:28:07.391196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:07.391510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:09.106866 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.715 seconds
[0m06:28:09.108035 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.717 seconds
[0m06:28:09.109936 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:28:09.111534 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:28:09.331136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m06:28:09.332239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m06:28:09.339894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:28:09.345910 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:28:09.348541 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:28:09.350890 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:28:09.351322 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:28:09.351692 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:28:09.352072 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:28:09.352503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:09.352877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:09.353216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:09.918505 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.566 seconds
[0m06:28:09.919757 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.567 seconds
[0m06:28:09.920492 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.567 seconds
[0m06:28:09.924208 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:28:09.925674 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:28:09.928933 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:28:10.117742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada51e50>]}
[0m06:28:10.118604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:10.119115 [info ] [MainThread]: 
[0m06:28:10.129399 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m06:28:10.130095 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m06:28:10.130744 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m06:28:10.131202 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m06:28:10.131660 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m06:28:10.132066 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m06:28:10.132620 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m06:28:10.133176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m06:28:10.133678 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m06:28:10.134657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m06:28:10.135011 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m06:28:10.135382 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m06:28:10.135842 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m06:28:10.136214 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m06:28:10.136577 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m06:28:10.141749 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m06:28:10.142150 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m06:28:10.144354 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m06:28:10.146432 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:28:10.148859 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m06:28:10.149831 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m06:28:10.171880 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m06:28:10.172316 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m06:28:10.172605 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m06:28:10.173063 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m06:28:10.189494 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:28:10.191935 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m06:28:10.192641 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m06:28:10.195749 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m06:28:10.196715 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m06:28:10.197407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:10.197975 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m06:28:10.198465 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m06:28:10.199990 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m06:28:10.200591 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m06:28:10.200953 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m06:28:10.201392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:10.201878 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m06:28:10.202244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:10.203683 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:28:11.043249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m06:28:11.044926 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m06:28:11.045878 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m06:28:11.074144 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m06:28:11.075725 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m06:28:11.077379 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m06:28:11.271869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf48710>]}
[0m06:28:11.273675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7c5eb0>]}
[0m06:28:11.275011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d36e40>]}
[0m06:28:11.276122 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.13s]
[0m06:28:11.277578 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.14s]
[0m06:28:11.279086 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.14s]
[0m06:28:11.280028 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m06:28:11.280801 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m06:28:11.281550 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m06:28:11.282277 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m06:28:11.283055 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m06:28:11.283914 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m06:28:11.284663 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m06:28:11.285507 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m06:28:11.286223 [info ] [Thread-3 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m06:28:11.286920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m06:28:11.287420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m06:28:11.287912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m06:28:11.288378 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m06:28:11.288831 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m06:28:11.289246 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m06:28:11.292715 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m06:28:11.295416 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m06:28:11.298027 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m06:28:11.299624 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m06:28:11.302160 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m06:28:11.302474 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m06:28:11.302930 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m06:28:11.305152 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m06:28:11.307318 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m06:28:11.308195 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m06:28:11.308569 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m06:28:11.308958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:11.310691 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m06:28:11.311431 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m06:28:11.311771 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m06:28:11.312214 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m06:28:11.312546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:28:11.312900 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:11.776365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m06:28:11.781457 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m06:28:11.971041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c76660>]}
[0m06:28:11.972748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m06:28:11.974124 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.84s]
[0m06:28:11.977059 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m06:28:11.980022 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m06:28:11.980897 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m06:28:11.981764 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m06:28:11.984096 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m06:28:11.988290 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m06:28:11.988801 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m06:28:11.992882 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m06:28:11.993487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m06:28:11.993957 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m06:28:11.999982 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m06:28:12.000999 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m06:28:12.003514 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m06:28:12.005123 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m06:28:12.005485 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m06:28:12.005841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:12.202462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f35a330>]}
[0m06:28:12.203870 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.91s]
[0m06:28:12.205208 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02cd160>]}
[0m06:28:12.205867 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m06:28:12.206747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7e94f0>]}
[0m06:28:12.207546 [info ] [Thread-3 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.92s]
[0m06:28:12.208798 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m06:28:12.209618 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.92s]
[0m06:28:12.210432 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m06:28:12.210985 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m06:28:12.211657 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m06:28:12.212187 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m06:28:12.212767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.fact_inventory_snapshot)
[0m06:28:12.213253 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m06:28:12.213751 [info ] [Thread-3 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m06:28:12.214295 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m06:28:12.214771 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m06:28:12.215322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m06:28:12.219491 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:28:12.219907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_store)
[0m06:28:12.220259 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m06:28:12.220802 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m06:28:12.223795 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m06:28:12.226812 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m06:28:12.227293 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m06:28:12.229664 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:28:12.230249 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m06:28:12.232297 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m06:28:12.232583 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m06:28:12.234880 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m06:28:12.235641 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m06:28:12.236111 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m06:28:12.236510 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:28:12.237632 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m06:28:12.238487 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m06:28:12.239305 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m06:28:12.239615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:12.239980 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m06:28:12.241301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:13.391488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.385 seconds
[0m06:28:13.397997 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m06:28:13.404103 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m06:28:13.406151 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m06:28:13.409612 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m06:28:13.412613 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m06:28:13.454764 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.213 seconds
[0m06:28:13.457792 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m06:28:13.617470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f39ce00>]}
[0m06:28:13.619291 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.62s]
[0m06:28:13.621199 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m06:28:13.623495 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m06:28:13.624284 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m06:28:13.625043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m06:28:13.626355 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3b32f0>]}
[0m06:28:13.627560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3b25d0>]}
[0m06:28:13.628103 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m06:28:13.629001 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.41s]
[0m06:28:13.630017 [info ] [Thread-3 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.41s]
[0m06:28:13.638713 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m06:28:13.639295 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m06:28:13.639839 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m06:28:13.641296 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m06:28:13.643902 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m06:28:13.646784 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m06:28:13.647269 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m06:28:13.647707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:13.662494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3bc2c0>]}
[0m06:28:13.663076 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.44s]
[0m06:28:13.663653 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m06:28:15.538379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.891 seconds
[0m06:28:15.540444 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m06:28:15.732983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79860218-2fc6-4c61-99f9-5294d9fb2db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7e8050>]}
[0m06:28:15.734668 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.11s]
[0m06:28:15.736058 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m06:28:15.738923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:15.739540 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m06:28:15.740072 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m06:28:15.740524 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m06:28:15.740999 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m06:28:15.741625 [info ] [MainThread]: 
[0m06:28:15.742296 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m06:28:15.744924 [debug] [MainThread]: Command end result
[0m06:28:15.786095 [info ] [MainThread]: 
[0m06:28:15.786526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:28:15.786924 [info ] [MainThread]: 
[0m06:28:15.787418 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m06:28:15.788208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.643158, "process_user_time": 5.511898, "process_kernel_time": 0.474368, "process_mem_max_rss": "222684", "process_out_blocks": "8345", "process_in_blocks": "0"}
[0m06:28:15.788648 [debug] [MainThread]: Command `dbt run` succeeded at 06:28:15.788568 after 10.64 seconds
[0m06:28:15.788981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac52d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac52d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e2d2e0>]}
[0m06:28:15.789278 [debug] [MainThread]: Flushing usage events
[0m06:28:17.991539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae1fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97ba7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99ab620>]}


============================== 06:28:17.997381 | dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7 ==============================
[0m06:28:17.997381 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:28:17.997996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:18.628199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5f6420>]}
[0m06:28:18.667494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bc5370>]}
[0m06:28:18.668146 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:28:18.741965 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:28:18.867339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:28:18.867732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:28:18.907319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4c30b0>]}
[0m06:28:19.013007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf30680>]}
[0m06:28:19.013436 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:28:19.013761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6b6600>]}
[0m06:28:19.015926 [info ] [MainThread]: 
[0m06:28:19.016475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:28:19.020295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:28:19.029277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:28:19.035410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:28:19.041768 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:28:19.043435 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:28:19.043836 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:28:19.044243 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:28:19.044593 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:28:19.044914 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:28:19.045222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:19.045502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:19.045846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:19.718774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.673 seconds
[0m06:28:19.720423 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.675 seconds
[0m06:28:19.723908 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:28:19.726973 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:28:19.754349 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.709 seconds
[0m06:28:19.756967 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:28:19.962065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc2b1a9-92b1-4a9e-95fd-e25ee68919f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d992570>]}
[0m06:28:19.963058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:19.963680 [info ] [MainThread]: 
[0m06:28:19.976510 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:28:19.976970 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:28:19.977443 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:28:19.977857 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m06:28:19.978345 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:28:19.978750 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m06:28:19.979295 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m06:28:19.979880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m06:28:19.980325 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m06:28:19.980828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m06:28:19.981275 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m06:28:19.981730 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:28:19.982238 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m06:28:19.982647 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:28:19.982994 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:28:19.995704 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:28:19.996967 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:28:20.000239 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:28:20.004232 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:28:20.007346 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:28:20.010069 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:28:20.017469 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:28:20.032880 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:28:20.033217 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:28:20.035756 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:28:20.036260 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:28:20.038259 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:28:20.040437 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:28:20.041185 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:28:20.042232 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:28:20.042564 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m06:28:20.043162 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m06:28:20.043714 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:28:20.045210 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m06:28:20.044319 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:20.044827 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:28:20.043952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:20.045540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:20.047199 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m06:28:20.049911 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:28:20.668410 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m06:28:20.671927 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m06:28:20.686246 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m06:28:20.688058 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m06:28:20.688991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m06:28:20.696156 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m06:28:20.694593 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m06:28:20.691036 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m06:28:20.878710 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.90s]
[0m06:28:20.881140 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:28:20.882198 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:28:20.883211 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m06:28:20.884725 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m06:28:20.886131 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.91s]
[0m06:28:20.886969 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:28:20.889352 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:28:20.890636 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.91s]
[0m06:28:20.893885 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.91s]
[0m06:28:20.898008 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:28:20.898582 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:28:20.899350 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:28:20.899975 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:28:20.900671 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m06:28:20.901641 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:28:20.902214 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:28:20.902711 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:28:20.903126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m06:28:20.903543 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:28:20.908975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:28:20.908231 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:28:20.908612 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:28:20.904128 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:28:20.909326 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:28:20.912714 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:28:20.913167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:28:20.916568 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:28:20.917165 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:28:20.917595 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:28:20.918201 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:28:20.918511 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m06:28:20.921838 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:28:20.923789 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:28:20.924203 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:28:20.924480 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:28:20.926426 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:28:20.928438 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:28:20.930504 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:28:20.931318 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:28:20.932018 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m06:28:20.932422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:20.932998 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:28:20.934408 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:28:20.934945 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:28:20.935998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:20.935512 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:28:20.936462 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:21.454467 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m06:28:21.459498 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:28:21.478264 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m06:28:21.480891 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:28:21.482378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m06:28:21.485370 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:28:21.489141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m06:28:21.490892 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:28:21.650214 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.76s]
[0m06:28:21.653229 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:28:21.655940 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:28:21.658016 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:28:21.660202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:28:21.660914 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:28:21.670978 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:28:21.673364 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.76s]
[0m06:28:21.674264 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:28:21.674656 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:28:21.675150 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:28:21.678178 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:28:21.678905 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.77s]
[0m06:28:21.679205 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:28:21.680244 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:28:21.680746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:28:21.681558 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:28:21.683270 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:28:21.683621 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:28:21.685036 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:28:21.685820 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.78s]
[0m06:28:21.686494 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:21.692893 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:28:21.693465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:28:21.694064 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:28:21.694593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:28:21.695334 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:28:21.695922 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:28:21.696578 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:28:21.703236 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:28:21.703750 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:28:21.706437 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:28:21.707266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:28:21.709882 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:28:21.710356 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:28:21.715113 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:28:21.717301 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:28:21.718169 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:28:21.719153 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:21.719595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:21.720753 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:28:21.721620 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:28:21.724988 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:28:21.725443 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:21.726605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:21.729883 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:28:21.730578 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:21.731368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:22.297673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m06:28:22.300297 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:28:22.424150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m06:28:22.428272 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:28:22.429596 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m06:28:22.435269 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:28:22.438393 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m06:28:22.441768 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:28:22.492120 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.78s]
[0m06:28:22.493561 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:28:22.494567 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:28:22.495382 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:28:22.496240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:28:22.496831 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:28:22.503873 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:28:22.505434 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:28:22.508048 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:28:22.509658 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:28:22.510103 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:22.510520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:22.620454 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.96s]
[0m06:28:22.621957 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:28:22.623017 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.93s]
[0m06:28:22.624071 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.94s]
[0m06:28:22.624732 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:28:22.625572 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:28:22.626238 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:28:22.626716 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:28:22.628242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:28:22.627787 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:28:22.627289 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:28:22.628630 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:28:22.629049 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:28:22.629639 [info ] [Thread-2 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:28:22.635575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:28:22.635218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:28:22.634788 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:28:22.635892 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:28:22.636238 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:28:22.641876 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:28:22.696011 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:28:22.696807 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:28:22.699757 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:28:22.700388 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:28:22.702358 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:28:22.702778 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:28:22.704870 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:28:22.705941 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:28:22.710203 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:22.710957 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:28:22.713127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:28:22.713652 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:28:22.714228 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:28:22.715780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:22.716238 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:28:22.717664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:23.102678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m06:28:23.105801 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:28:23.293533 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m06:28:23.299378 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:28:23.300782 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m06:28:23.303745 [info ] [Thread-1 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.81s]
[0m06:28:23.307811 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:28:23.309455 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:28:23.310460 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m06:28:23.314607 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:28:23.498953 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.86s]
[0m06:28:23.500493 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:28:23.508722 [info ] [Thread-2 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.87s]
[0m06:28:23.510348 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:28:23.512902 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.88s]
[0m06:28:23.513941 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:28:23.516422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:23.516973 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:28:23.517506 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m06:28:23.517977 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:28:23.518442 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m06:28:23.518893 [info ] [MainThread]: 
[0m06:28:23.519348 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m06:28:23.522032 [debug] [MainThread]: Command end result
[0m06:28:23.563541 [info ] [MainThread]: 
[0m06:28:23.563990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:28:23.564363 [info ] [MainThread]: 
[0m06:28:23.564716 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:28:23.565522 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.6108623, "process_user_time": 3.983674, "process_kernel_time": 0.248353, "process_mem_max_rss": "214180", "process_out_blocks": "2789", "process_in_blocks": "0"}
[0m06:28:23.565975 [debug] [MainThread]: Command `dbt test` succeeded at 06:28:23.565905 after 5.61 seconds
[0m06:28:23.566298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfde450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa939c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d697c80>]}
[0m06:28:23.566588 [debug] [MainThread]: Flushing usage events
[0m06:29:38.866467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9747980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95bf0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96640b0>]}


============================== 06:29:38.872068 | 7242e9ca-98ab-4f6e-8210-24f98117218d ==============================
[0m06:29:38.872068 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:29:38.872738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:38.956065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7242e9ca-98ab-4f6e-8210-24f98117218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89af4d0>]}
[0m06:29:39.048231 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fc2bziog'
[0m06:29:39.048689 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:39.169434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:39.170172 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:39.329498 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:39.337786 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:39.920595 [info ] [MainThread]: Installed from version 1.3.0
[0m06:29:39.921178 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:39.921774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7242e9ca-98ab-4f6e-8210-24f98117218d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d2fe30>]}
[0m06:29:39.922186 [info ] [MainThread]: 
[0m06:29:39.922536 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:39.923540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0916022, "process_user_time": 1.666317, "process_kernel_time": 0.109348, "process_mem_max_rss": "101472", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:29:39.924010 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:39.923929 after 1.09 seconds
[0m06:29:39.924305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a210d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a21220>]}
[0m06:29:39.924579 [debug] [MainThread]: Flushing usage events
[0m06:29:41.969079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7970080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95c9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ce1880>]}


============================== 06:29:41.974790 | f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404 ==============================
[0m06:29:41.974790 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:29:41.975342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:29:42.578061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c38a8a0>]}
[0m06:29:42.617094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7990ef0>]}
[0m06:29:42.617746 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:29:42.689964 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:29:42.818046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:42.818501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:42.858500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1b9be0>]}
[0m06:29:42.956296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4c9eb0>]}
[0m06:29:42.956828 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:29:42.957240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75cbe90>]}
[0m06:29:42.959266 [info ] [MainThread]: 
[0m06:29:42.959861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:29:42.963690 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:29:42.971062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:29:42.976005 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:29:42.978325 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:29:42.978720 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:29:42.979082 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:29:42.979419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:42.979740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:43.928054 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.948 seconds
[0m06:29:43.930789 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:29:44.017980 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.038 seconds
[0m06:29:44.021050 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:29:44.216904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m06:29:44.224081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m06:29:44.227027 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:29:44.229200 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:29:44.229687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:29:44.230108 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:29:44.230535 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:29:44.232504 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:29:44.232934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:44.233243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:44.233543 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:29:44.236599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:44.819851 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.587 seconds
[0m06:29:44.824235 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:29:44.827586 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.594 seconds
[0m06:29:44.830676 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:29:44.864214 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.628 seconds
[0m06:29:44.866789 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:29:45.069586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca1f020>]}
[0m06:29:45.071158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:45.071961 [info ] [MainThread]: 
[0m06:29:45.087383 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m06:29:45.087984 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m06:29:45.088488 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m06:29:45.089148 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m06:29:45.089742 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m06:29:45.090330 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m06:29:45.091060 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m06:29:45.092328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m06:29:45.092836 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m06:29:45.093400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m06:29:45.093882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m06:29:45.094314 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m06:29:45.094862 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m06:29:45.095282 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m06:29:45.095734 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m06:29:45.101762 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m06:29:45.102170 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m06:29:45.104535 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m06:29:45.106832 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:29:45.109229 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m06:29:45.110689 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m06:29:45.110994 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m06:29:45.135411 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m06:29:45.135860 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m06:29:45.136154 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m06:29:45.154315 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:29:45.159064 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m06:29:45.161451 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m06:29:45.162865 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m06:29:45.163434 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m06:29:45.163967 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m06:29:45.164479 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m06:29:45.166039 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m06:29:45.165374 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m06:29:45.165679 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m06:29:45.164773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:45.166317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:45.166638 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m06:29:45.166973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:45.169670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:29:46.273863 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m06:29:46.275547 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m06:29:46.306464 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m06:29:46.306964 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m06:29:46.307643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m06:29:46.312029 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m06:29:46.526968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9180080>]}
[0m06:29:46.529367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c292fc0>]}
[0m06:29:46.530307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3a81a0>]}
[0m06:29:46.531118 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.43s]
[0m06:29:46.532048 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.43s]
[0m06:29:46.534287 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m06:29:46.533684 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m06:29:46.532879 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.44s]
[0m06:29:46.536252 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m06:29:46.535495 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m06:29:46.534854 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m06:29:46.537964 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m06:29:46.537320 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m06:29:46.536722 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m06:29:46.538482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m06:29:46.538951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m06:29:46.539413 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m06:29:46.539876 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m06:29:46.540277 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m06:29:46.540719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m06:29:46.543953 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m06:29:46.546274 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m06:29:46.546669 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m06:29:46.549536 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m06:29:46.550442 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m06:29:46.550740 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m06:29:46.554467 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m06:29:46.556779 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m06:29:46.557184 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m06:29:46.559613 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m06:29:46.560452 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m06:29:46.561005 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m06:29:46.561898 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:29:46.561643 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m06:29:46.564056 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m06:29:46.564421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:46.563719 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m06:29:46.564840 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m06:29:46.566095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:46.696720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.532 seconds
[0m06:29:46.699111 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m06:29:46.892201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b33e750>]}
[0m06:29:46.893738 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.80s]
[0m06:29:46.895168 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m06:29:46.896241 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m06:29:46.897172 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m06:29:46.897971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m06:29:46.898661 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m06:29:46.915125 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:29:46.920566 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m06:29:46.922874 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:29:46.925944 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m06:29:46.926319 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m06:29:46.926746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:47.190592 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m06:29:47.195133 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m06:29:47.200320 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m06:29:47.201147 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m06:29:47.203563 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m06:29:47.205544 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m06:29:47.401969 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b33cf20>]}
[0m06:29:47.403778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b365400>]}
[0m06:29:47.405852 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.86s]
[0m06:29:47.407076 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.86s]
[0m06:29:47.408263 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m06:29:47.409428 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdc2960>]}
[0m06:29:47.410262 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m06:29:47.411110 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_customer
[0m06:29:47.412234 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.87s]
[0m06:29:47.413121 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m06:29:47.413956 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m06:29:47.415047 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m06:29:47.415809 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m06:29:47.416688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m06:29:47.417382 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m06:29:47.418008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m06:29:47.418555 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_customer
[0m06:29:47.419171 [info ] [Thread-4 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m06:29:47.419717 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m06:29:47.425686 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m06:29:47.426186 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_store)
[0m06:29:47.431379 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m06:29:47.431955 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m06:29:47.435073 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m06:29:47.435590 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_customer
[0m06:29:47.437949 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m06:29:47.438426 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m06:29:47.440696 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m06:29:47.441004 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m06:29:47.443206 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m06:29:47.444420 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m06:29:47.444927 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m06:29:47.445690 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m06:29:47.446026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:47.446538 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m06:29:47.446832 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m06:29:47.448370 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m06:29:47.448781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:47.449145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:29:48.333399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m06:29:48.336848 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m06:29:48.526040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a993f20>]}
[0m06:29:48.527372 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.63s]
[0m06:29:48.528539 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m06:29:48.631538 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m06:29:48.635039 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: Close
[0m06:29:48.675514 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.227 seconds
[0m06:29:48.679575 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m06:29:48.791638 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m06:29:48.795527 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m06:29:48.827719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3650a0>]}
[0m06:29:48.829060 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.41s]
[0m06:29:48.830320 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_customer
[0m06:29:48.831433 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m06:29:48.832190 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m06:29:48.832959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.fact_sales)
[0m06:29:48.833507 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m06:29:48.843028 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m06:29:48.844490 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m06:29:48.847485 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m06:29:48.850267 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m06:29:48.850874 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m06:29:48.851679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:48.867948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b7860>]}
[0m06:29:48.868639 [info ] [Thread-4 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.44s]
[0m06:29:48.869309 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m06:29:48.989528 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b5880>]}
[0m06:29:48.990458 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.57s]
[0m06:29:48.991362 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m06:29:50.673065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m06:29:50.678438 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m06:29:50.883566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07f5fa3-d0d5-4634-8d0d-9ebb09ec9404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b39b0>]}
[0m06:29:50.885455 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.05s]
[0m06:29:50.886657 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m06:29:50.889557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:50.890220 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m06:29:50.890781 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m06:29:50.891279 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m06:29:50.891732 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m06:29:50.892403 [info ] [MainThread]: 
[0m06:29:50.893030 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m06:29:50.895820 [debug] [MainThread]: Command end result
[0m06:29:51.005506 [info ] [MainThread]: 
[0m06:29:51.006029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:51.006456 [info ] [MainThread]: 
[0m06:29:51.006899 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m06:29:51.007777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.074183, "process_user_time": 4.00521, "process_kernel_time": 0.252265, "process_mem_max_rss": "212992", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m06:29:51.008204 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:51.008134 after 9.07 seconds
[0m06:29:51.008499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa869fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ce1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa858e600>]}
[0m06:29:51.008784 [debug] [MainThread]: Flushing usage events
[0m06:29:53.193713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8370b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ec0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb91381a0>]}


============================== 06:29:53.199367 | ea1ea870-6907-40ca-b8a4-e868dfce1c1a ==============================
[0m06:29:53.199367 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:29:53.199929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:53.819718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d05c2c0>]}
[0m06:29:53.859505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2a0ce0>]}
[0m06:29:53.860175 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:29:53.932533 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:29:54.058766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:54.059171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:54.099177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca43320>]}
[0m06:29:54.205378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5d2900>]}
[0m06:29:54.205800 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:29:54.206173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c48a240>]}
[0m06:29:54.208360 [info ] [MainThread]: 
[0m06:29:54.208933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:29:54.212827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:29:54.220888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:29:54.226668 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:29:54.228386 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:29:54.228779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:29:54.229122 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:29:54.229471 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:29:54.231276 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:29:54.231604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:54.231964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:54.232289 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:29:54.235888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:54.842170 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.610 seconds
[0m06:29:54.846748 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:29:54.850712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m06:29:54.854507 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:29:54.861461 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.630 seconds
[0m06:29:54.863879 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:29:55.065979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1ea870-6907-40ca-b8a4-e868dfce1c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d52b1d0>]}
[0m06:29:55.066957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:55.067584 [info ] [MainThread]: 
[0m06:29:55.080118 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:29:55.080552 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:29:55.080937 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:29:55.081368 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m06:29:55.081907 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:29:55.082317 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m06:29:55.082822 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m06:29:55.083534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m06:29:55.083992 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m06:29:55.084613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m06:29:55.084978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m06:29:55.085332 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:29:55.085737 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m06:29:55.086065 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:29:55.086426 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:29:55.099428 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:29:55.099734 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:29:55.102829 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:29:55.106832 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:29:55.110105 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:29:55.111137 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:29:55.124108 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:29:55.127257 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:29:55.129290 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:29:55.129770 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:29:55.130063 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:29:55.132453 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:29:55.134523 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:29:55.135185 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:29:55.136003 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:29:55.136372 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m06:29:55.136765 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m06:29:55.137195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:55.137768 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:29:55.138294 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:29:55.138536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:55.140136 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m06:29:55.140559 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m06:29:55.142193 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:29:55.142865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:55.834780 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m06:29:55.852259 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m06:29:55.854721 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m06:29:55.858020 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m06:29:55.860127 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m06:29:55.861958 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m06:29:55.864357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m06:29:55.866675 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m06:29:56.050693 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.96s]
[0m06:29:56.052435 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.97s]
[0m06:29:56.053361 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:29:56.054275 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:29:56.055041 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:29:56.055828 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:29:56.056510 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m06:29:56.057315 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m06:29:56.059381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m06:29:56.060383 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.98s]
[0m06:29:56.061043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m06:29:56.061998 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.98s]
[0m06:29:56.062522 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:29:56.063199 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:29:56.063590 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:29:56.064117 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:29:56.068829 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:29:56.069365 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:29:56.074349 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:29:56.074776 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:29:56.075307 [info ] [Thread-1 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:29:56.076140 [info ] [Thread-2 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:29:56.076769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:29:56.077184 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:29:56.077445 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:29:56.077717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:29:56.078050 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:29:56.080160 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:29:56.082121 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:29:56.082463 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:29:56.085608 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:29:56.089274 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:29:56.090383 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:29:56.091049 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:29:56.091395 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m06:29:56.091900 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m06:29:56.092273 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:29:56.092545 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:29:56.092797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:29:56.093121 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:56.095043 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:29:56.096931 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:29:56.100968 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:29:56.101674 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:29:56.101975 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:29:56.102459 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:29:56.102859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:56.103193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:56.683947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m06:29:56.685743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m06:29:56.690223 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:29:56.691552 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m06:29:56.694283 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:29:56.698931 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:29:56.712148 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m06:29:56.714214 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:29:56.892971 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.82s]
[0m06:29:56.894566 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:29:56.895508 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:29:56.896480 [info ] [Thread-1 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:29:56.898263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:29:56.900543 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:29:56.905184 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.84s]
[0m06:29:56.912239 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:29:56.914405 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:29:56.915424 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.86s]
[0m06:29:56.915927 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:29:56.916800 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:29:56.917320 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:29:56.917993 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:29:56.918682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:29:56.919045 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:29:56.919552 [info ] [Thread-4 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:29:56.920122 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:29:56.922717 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:29:56.923126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:29:56.929392 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:29:56.929949 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:29:56.934510 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:29:56.935436 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:29:56.935897 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:56.936271 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:29:56.936544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:56.938692 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:29:56.939648 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:29:56.942833 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:29:56.943966 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:29:56.944390 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:56.945229 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:29:56.945556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:56.946128 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:56.948361 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:29:56.950250 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.87s]
[0m06:29:56.951129 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:29:56.951743 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:29:56.952280 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:29:56.952839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:29:56.953171 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:29:56.958038 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:29:56.958897 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:29:56.960867 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:29:56.962047 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:29:56.962419 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:56.962768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:57.588501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m06:29:57.594067 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:29:57.636316 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m06:29:57.639807 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:29:57.644627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m06:29:57.647136 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:29:57.719954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m06:29:57.723657 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:29:57.796153 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.84s]
[0m06:29:57.797791 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:29:57.798770 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:29:57.799580 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:29:57.800471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:29:57.801146 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:29:57.810459 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:29:57.812179 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:29:57.815067 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:29:57.816859 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:29:57.817378 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:57.817790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:29:57.859269 [info ] [Thread-4 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.94s]
[0m06:29:57.860488 [info ] [Thread-1 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.96s]
[0m06:29:57.861368 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:29:57.862030 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:29:57.862567 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:29:57.863051 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:29:57.863509 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:29:57.864058 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:29:57.864673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:29:57.865119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:29:57.865539 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:29:57.865923 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:29:57.870772 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:29:57.876294 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:29:57.877520 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:29:57.944713 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:29:57.945154 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:29:57.947304 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:29:57.949373 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:29:57.950570 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:57.950135 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.03s]
[0m06:29:57.951031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:29:57.951829 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:29:57.952275 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:29:57.954002 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:29:57.954579 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:29:57.955038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:57.955456 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:29:57.957278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:29:57.957809 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:29:57.963679 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:29:57.964510 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:29:57.966539 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:29:57.967475 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:29:57.967780 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:29:57.968056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:29:58.454773 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m06:29:58.458020 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:29:58.536075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m06:29:58.538355 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m06:29:58.541978 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:29:58.544830 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:29:58.566434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m06:29:58.569116 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:29:58.656242 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.86s]
[0m06:29:58.657415 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:29:58.748699 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.79s]
[0m06:29:58.750258 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.88s]
[0m06:29:58.751619 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:29:58.752480 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:29:58.771729 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.91s]
[0m06:29:58.772957 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:29:58.775675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:58.776272 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:29:58.776828 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:29:58.777316 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m06:29:58.777736 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m06:29:58.778286 [info ] [MainThread]: 
[0m06:29:58.778867 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m06:29:58.782073 [debug] [MainThread]: Command end result
[0m06:29:58.823326 [info ] [MainThread]: 
[0m06:29:58.823847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:58.824204 [info ] [MainThread]: 
[0m06:29:58.824590 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:29:58.825445 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.666574, "process_user_time": 4.022785, "process_kernel_time": 0.224434, "process_mem_max_rss": "214200", "process_out_blocks": "2789", "process_in_blocks": "0"}
[0m06:29:58.825954 [debug] [MainThread]: Command `dbt test` succeeded at 06:29:58.825866 after 5.67 seconds
[0m06:29:58.826299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b4fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5d3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5d2900>]}
[0m06:29:58.826598 [debug] [MainThread]: Flushing usage events
[0m06:35:06.839648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa268f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27b95b0>]}


============================== 06:35:06.845964 | c6cf5ab9-598c-4219-8468-063c712ef322 ==============================
[0m06:35:06.845964 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:35:06.846751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:35:06.945283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6cf5ab9-598c-4219-8468-063c712ef322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1be3770>]}
[0m06:35:07.016283 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6_5v4lfq'
[0m06:35:07.016751 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:35:07.086319 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:35:07.087032 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:35:07.118934 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:35:07.122640 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:35:07.731222 [info ] [MainThread]: Installed from version 1.3.0
[0m06:35:07.731922 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:35:07.732418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c6cf5ab9-598c-4219-8468-063c712ef322', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c277a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa241a630>]}
[0m06:35:07.732806 [info ] [MainThread]: 
[0m06:35:07.733303 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:35:07.734329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.93100864, "process_user_time": 1.783029, "process_kernel_time": 0.199338, "process_mem_max_rss": "164160", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:35:07.734823 [debug] [MainThread]: Command `dbt deps` succeeded at 06:35:07.734743 after 0.93 seconds
[0m06:35:07.735165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22ad8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b18ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2996570>]}
[0m06:35:07.735529 [debug] [MainThread]: Flushing usage events
[0m06:35:11.107751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bf3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818471d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818443e0>]}


============================== 06:35:11.113614 | b78dd61f-a15a-4577-b689-f6959bb52365 ==============================
[0m06:35:11.113614 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:35:11.114348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:35:11.786408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb71a90>]}
[0m06:35:11.825899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82888b00>]}
[0m06:35:11.826532 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:35:11.902024 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:35:12.048405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:35:12.048844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:35:12.089450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65913f20>]}
[0m06:35:12.213788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6544e450>]}
[0m06:35:12.214335 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:35:12.214941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81241d90>]}
[0m06:35:12.217095 [info ] [MainThread]: 
[0m06:35:12.217945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:35:12.222883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:35:12.230906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:35:12.246163 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:35:12.246730 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:35:12.247061 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:35:12.247489 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:35:12.247911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:12.248316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:13.207581 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.959 seconds
[0m06:35:13.209019 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.961 seconds
[0m06:35:13.212330 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:35:13.214775 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:35:13.425499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m06:35:13.426634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m06:35:13.434333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:35:13.440474 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:35:13.443124 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:35:13.445468 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:35:13.446000 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:35:13.446505 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:35:13.446933 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:35:13.447343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:35:13.447718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:35:13.448084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:13.956439 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.508 seconds
[0m06:35:13.960729 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:35:13.995417 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.547 seconds
[0m06:35:13.999796 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:35:14.012300 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.565 seconds
[0m06:35:14.015868 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:35:14.217555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658bddf0>]}
[0m06:35:14.218456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:35:14.219319 [info ] [MainThread]: 
[0m06:35:14.229372 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m06:35:14.229769 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m06:35:14.230169 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m06:35:14.230664 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m06:35:14.231060 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m06:35:14.231473 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m06:35:14.231993 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m06:35:14.233026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m06:35:14.233420 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m06:35:14.233879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m06:35:14.234335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m06:35:14.234715 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m06:35:14.235212 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m06:35:14.235617 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m06:35:14.235991 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m06:35:14.241433 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m06:35:14.241824 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m06:35:14.244052 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m06:35:14.246238 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:35:14.248650 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m06:35:14.249595 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m06:35:14.273608 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m06:35:14.274213 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m06:35:14.280703 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m06:35:14.292588 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m06:35:14.294071 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:35:14.298356 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m06:35:14.299032 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m06:35:14.301199 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m06:35:14.302138 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m06:35:14.302775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:14.303315 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m06:35:14.305119 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m06:35:14.305675 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m06:35:14.306453 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m06:35:14.306790 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m06:35:14.307191 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:14.307629 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m06:35:14.307975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:14.309350 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:35:14.929875 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m06:35:14.961657 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m06:35:14.980284 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m06:35:14.982556 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m06:35:14.993453 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m06:35:14.995472 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m06:35:15.161739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65a03200>]}
[0m06:35:15.163465 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.92s]
[0m06:35:15.165768 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m06:35:15.166821 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_orders
[0m06:35:15.167824 [info ] [Thread-3 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m06:35:15.168806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m06:35:15.169469 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_orders
[0m06:35:15.173593 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m06:35:15.176017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64923830>]}
[0m06:35:15.177395 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_orders
[0m06:35:15.177012 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.94s]
[0m06:35:15.180725 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m06:35:15.181370 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m06:35:15.182079 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m06:35:15.182706 [info ] [Thread-2 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m06:35:15.183349 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_products)
[0m06:35:15.183799 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m06:35:15.186454 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m06:35:15.187003 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m06:35:15.187530 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m06:35:15.187992 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:15.191128 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m06:35:15.193491 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m06:35:15.194648 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m06:35:15.195011 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m06:35:15.195406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:15.219793 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652ac320>]}
[0m06:35:15.220424 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.98s]
[0m06:35:15.221127 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m06:35:15.221578 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m06:35:15.222044 [info ] [Thread-4 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m06:35:15.222575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m06:35:15.222924 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m06:35:15.225252 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m06:35:15.226235 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m06:35:15.228542 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m06:35:15.229657 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m06:35:15.229997 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m06:35:15.230358 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:35:15.855940 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m06:35:15.861267 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: Close
[0m06:35:15.872466 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m06:35:15.875828 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m06:35:16.048267 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m06:35:16.052532 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: Close
[0m06:35:16.054494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64961c10>]}
[0m06:35:16.058582 [info ] [Thread-3 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.88s]
[0m06:35:16.060094 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_orders
[0m06:35:16.060910 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m06:35:16.061703 [info ] [Thread-3 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m06:35:16.062674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m06:35:16.063365 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m06:35:16.080945 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:35:16.082369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64945610>]}
[0m06:35:16.082947 [info ] [Thread-4 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.86s]
[0m06:35:16.083746 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m06:35:16.084201 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m06:35:16.086720 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:35:16.087181 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m06:35:16.087934 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m06:35:16.088503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_customer)
[0m06:35:16.088881 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m06:35:16.092923 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m06:35:16.093851 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m06:35:16.094307 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m06:35:16.094705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:16.095153 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m06:35:16.097790 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m06:35:16.099855 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m06:35:16.100274 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m06:35:16.100706 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:35:16.104639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.802 seconds
[0m06:35:16.106516 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m06:35:16.241044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64963c20>]}
[0m06:35:16.241757 [info ] [Thread-2 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 1.06s]
[0m06:35:16.242483 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m06:35:16.242951 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m06:35:16.243546 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m06:35:16.244053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_store)
[0m06:35:16.244402 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m06:35:16.248895 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m06:35:16.249862 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m06:35:16.252100 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m06:35:16.253311 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m06:35:16.253638 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m06:35:16.253919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:16.293847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652bb0b0>]}
[0m06:35:16.294438 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.06s]
[0m06:35:16.294959 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m06:35:16.295360 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m06:35:16.295792 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m06:35:16.296183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_product)
[0m06:35:16.296529 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m06:35:16.299549 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m06:35:16.300538 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m06:35:16.302605 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m06:35:16.303767 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m06:35:16.304117 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m06:35:16.304492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:17.412434 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.311 seconds
[0m06:35:17.414292 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.319 seconds
[0m06:35:17.418521 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: Close
[0m06:35:17.421732 [debug] [Thread-3 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m06:35:17.444493 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.190 seconds
[0m06:35:17.447548 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m06:35:17.518278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.214 seconds
[0m06:35:17.523629 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m06:35:17.630052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64912ba0>]}
[0m06:35:17.631474 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649139b0>]}
[0m06:35:17.632645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64911fd0>]}
[0m06:35:17.633648 [info ] [Thread-3 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.57s]
[0m06:35:17.634571 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.54s]
[0m06:35:17.635391 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.39s]
[0m06:35:17.636270 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m06:35:17.636856 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m06:35:17.637472 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m06:35:17.638544 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_sales
[0m06:35:17.639278 [info ] [Thread-3 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m06:35:17.639863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now model.retail_dbt.fact_sales)
[0m06:35:17.640388 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_sales
[0m06:35:17.647256 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m06:35:17.648662 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_sales
[0m06:35:17.651100 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m06:35:17.653619 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m06:35:17.654161 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m06:35:17.654671 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:17.704122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65564950>]}
[0m06:35:17.704833 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.41s]
[0m06:35:17.705492 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m06:35:19.351054 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m06:35:19.353538 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: Close
[0m06:35:19.541898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78dd61f-a15a-4577-b689-f6959bb52365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64955bb0>]}
[0m06:35:19.542964 [info ] [Thread-3 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 1.90s]
[0m06:35:19.543754 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_sales
[0m06:35:19.545790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:19.546262 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m06:35:19.546742 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m06:35:19.547109 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m06:35:19.547487 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m06:35:19.547983 [info ] [MainThread]: 
[0m06:35:19.548415 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m06:35:19.550283 [debug] [MainThread]: Command end result
[0m06:35:19.662634 [info ] [MainThread]: 
[0m06:35:19.663099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:35:19.663490 [info ] [MainThread]: 
[0m06:35:19.663828 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m06:35:19.664586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.595791, "process_user_time": 4.05719, "process_kernel_time": 0.286861, "process_mem_max_rss": "212768", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m06:35:19.665075 [debug] [MainThread]: Command `dbt run` succeeded at 06:35:19.664969 after 8.60 seconds
[0m06:35:19.665488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d9a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a1bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817e76b0>]}
[0m06:35:19.665837 [debug] [MainThread]: Flushing usage events
[0m06:35:23.254959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b1d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4722ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3fcbe30>]}


============================== 06:35:23.260479 | d298c560-92d2-4a9f-8728-8fb21584fa4e ==============================
[0m06:35:23.260479 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:35:23.261197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:35:23.876065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88528980>]}
[0m06:35:23.915983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885885f0>]}
[0m06:35:23.916660 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:35:23.990312 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:35:24.124276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:35:24.124677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:35:24.164888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881b5be0>]}
[0m06:35:24.273189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cacb00>]}
[0m06:35:24.273642 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:35:24.274222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39438c0>]}
[0m06:35:24.276348 [info ] [MainThread]: 
[0m06:35:24.276969 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:35:24.280923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:35:24.281456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:35:24.288158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:35:24.294795 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:35:24.296526 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:35:24.298415 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:35:24.298779 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:35:24.299147 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:35:24.299487 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:35:24.299878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:24.300186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:24.300488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:24.920528 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.620 seconds
[0m06:35:24.923111 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:35:24.925804 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.626 seconds
[0m06:35:24.928657 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:35:24.934698 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.635 seconds
[0m06:35:24.936419 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:35:25.148547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd298c560-92d2-4a9f-8728-8fb21584fa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5130440>]}
[0m06:35:25.149885 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:35:25.151069 [info ] [MainThread]: 
[0m06:35:25.164297 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:35:25.164799 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:35:25.165229 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:35:25.165643 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m06:35:25.166155 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:35:25.166543 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m06:35:25.167063 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m06:35:25.167693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m06:35:25.168172 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m06:35:25.168679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m06:35:25.169163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m06:35:25.169595 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:35:25.170117 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m06:35:25.170573 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:35:25.170974 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:35:25.184932 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:35:25.185282 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:35:25.188479 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:35:25.192695 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:35:25.196143 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:35:25.196956 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:35:25.204552 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:35:25.219169 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:35:25.222365 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:35:25.222697 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:35:25.223068 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:35:25.225277 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:35:25.227266 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:35:25.228008 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:35:25.228831 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:35:25.229304 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m06:35:25.229955 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:35:25.230320 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m06:35:25.230954 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:35:25.231234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:25.231592 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m06:35:25.231930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:25.232287 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m06:35:25.233738 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:35:25.235305 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:26.013738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m06:35:26.024506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m06:35:26.025712 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m06:35:26.026687 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m06:35:26.040589 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m06:35:26.042875 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m06:35:26.045238 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m06:35:26.046848 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m06:35:26.261777 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.09s]
[0m06:35:26.263848 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.09s]
[0m06:35:26.265740 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:35:26.267025 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.10s]
[0m06:35:26.268190 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:35:26.269440 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.10s]
[0m06:35:26.270220 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:35:26.271054 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:35:26.271668 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:35:26.272343 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:35:26.272870 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m06:35:26.273489 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:35:26.273989 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m06:35:26.274643 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:35:26.275237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m06:35:26.275740 [info ] [Thread-2 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:35:26.276333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m06:35:26.276803 [info ] [Thread-4 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:35:26.277350 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:35:26.277790 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:35:26.278204 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:35:26.278705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:35:26.283777 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:35:26.284174 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:35:26.288969 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:35:26.289416 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:35:26.292808 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:35:26.296283 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:35:26.296971 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:35:26.299279 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:35:26.299583 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:35:26.301691 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:35:26.302005 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:35:26.302600 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:35:26.304542 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:35:26.305102 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:35:26.306994 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:35:26.307772 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:35:26.308067 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m06:35:26.308680 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m06:35:26.309279 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:35:26.309559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:26.309922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:26.310443 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:35:26.310735 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:35:26.313238 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:35:26.313655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:26.314011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:35:26.833970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m06:35:26.837104 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:35:26.847420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m06:35:26.849505 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:35:26.861325 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m06:35:26.863350 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:35:26.879938 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m06:35:26.881843 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:35:27.034464 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.76s]
[0m06:35:27.036653 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:35:27.038170 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:35:27.038899 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:35:27.039842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:35:27.040405 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:35:27.042817 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.77s]
[0m06:35:27.050247 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:35:27.053208 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:35:27.053753 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:35:27.054464 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:35:27.055072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:35:27.055673 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:35:27.060919 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:35:27.061938 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:35:27.065813 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:35:27.067647 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.79s]
[0m06:35:27.068399 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:35:27.068869 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:35:27.069570 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.79s]
[0m06:35:27.070348 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:35:27.072466 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:35:27.072888 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:35:27.073384 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:35:27.073781 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:27.074335 [info ] [Thread-4 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:35:27.074807 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:35:27.075189 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:27.075596 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:35:27.076364 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:35:27.076660 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:35:27.078239 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:35:27.078752 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:27.079230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:35:27.083929 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:35:27.084438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:27.084821 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:35:27.090735 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:35:27.091367 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:35:27.093523 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:35:27.094191 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:35:27.096127 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:35:27.097167 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:35:27.097558 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:27.097932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:35:27.098751 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:35:27.100124 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:27.100758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:27.655448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m06:35:27.660447 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:35:27.754905 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m06:35:27.756712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m06:35:27.760509 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:35:27.763758 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:35:27.859502 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m06:35:27.861427 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.78s]
[0m06:35:27.864470 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:35:27.865587 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:35:27.867898 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:35:27.869505 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:35:27.870637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:35:27.871196 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:35:27.877470 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:35:27.878999 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:35:27.881491 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:35:27.883204 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:35:27.883691 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:27.884206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:35:27.955259 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.90s]
[0m06:35:27.956486 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:35:27.957533 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:35:27.959604 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:35:27.960671 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.92s]
[0m06:35:27.961257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:35:27.962056 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:35:27.962591 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:35:27.963181 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:35:27.970233 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:35:27.970687 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:35:27.971359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:35:27.971722 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:35:28.041289 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:35:28.041998 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:35:28.044345 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:35:28.045191 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:35:28.047339 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:35:28.048221 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:35:28.048762 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:28.049218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:28.051299 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:35:28.051691 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:28.052028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:35:28.086048 [info ] [Thread-4 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.01s]
[0m06:35:28.086842 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:35:28.087267 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:35:28.087624 [info ] [Thread-4 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:35:28.088090 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:35:28.088452 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:35:28.093807 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:35:28.096254 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:35:28.098466 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:35:28.100522 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:35:28.100926 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:35:28.101309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:35:28.533672 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m06:35:28.537254 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:35:28.674230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m06:35:28.679270 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:35:28.683365 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m06:35:28.686681 [debug] [Thread-4 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:35:28.690906 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m06:35:28.692940 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:35:28.741003 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.87s]
[0m06:35:28.742476 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:35:28.890306 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.93s]
[0m06:35:28.893262 [info ] [Thread-4 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.80s]
[0m06:35:28.894565 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:35:28.895600 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:35:28.897912 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.93s]
[0m06:35:28.898729 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:35:28.901168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:28.901855 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m06:35:28.902500 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m06:35:28.903037 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:35:28.903533 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:35:28.904065 [info ] [MainThread]: 
[0m06:35:28.904888 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m06:35:28.907661 [debug] [MainThread]: Command end result
[0m06:35:28.951675 [info ] [MainThread]: 
[0m06:35:28.952193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:35:28.952550 [info ] [MainThread]: 
[0m06:35:28.952924 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:35:28.953665 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.7343864, "process_user_time": 3.985255, "process_kernel_time": 0.241561, "process_mem_max_rss": "214068", "process_out_blocks": "2791", "process_in_blocks": "0"}
[0m06:35:28.954131 [debug] [MainThread]: Command `dbt test` succeeded at 06:35:28.954041 after 5.73 seconds
[0m06:35:28.954503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa458bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cb7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971c15b0>]}
[0m06:35:28.954842 [debug] [MainThread]: Flushing usage events
[0m06:43:38.933438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c091700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d81bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b66d7c0>]}


============================== 06:43:38.940010 | 59c9cbfa-794b-4d52-aad0-60a4c323087d ==============================
[0m06:43:38.940010 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:43:38.940866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:43:39.072829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c9cbfa-794b-4d52-aad0-60a4c323087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6b6c90>]}
[0m06:43:39.183419 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m8zm1lph'
[0m06:43:39.183946 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:43:39.336769 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:43:39.337487 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:43:39.394025 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:43:39.398317 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:43:40.006331 [info ] [MainThread]: Installed from version 1.3.0
[0m06:43:40.007026 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:43:40.007481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59c9cbfa-794b-4d52-aad0-60a4c323087d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0c49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1ef9e0>]}
[0m06:43:40.007866 [info ] [MainThread]: 
[0m06:43:40.008346 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:43:40.009238 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1311847, "process_user_time": 1.809827, "process_kernel_time": 0.143172, "process_mem_max_rss": "164164", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:43:40.009800 [debug] [MainThread]: Command `dbt deps` succeeded at 06:43:40.009687 after 1.13 seconds
[0m06:43:40.010181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b66d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4cd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b453140>]}
[0m06:43:40.010551 [debug] [MainThread]: Flushing usage events
[0m06:43:42.829048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf309790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafea3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8679b0>]}


============================== 06:43:42.834711 | d604032e-23f1-4ba6-8fd4-66d71d578733 ==============================
[0m06:43:42.834711 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:43:42.835495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:43:43.458663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943d1430>]}
[0m06:43:43.498067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb110fd70>]}
[0m06:43:43.498703 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:43:43.573268 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:43:43.715912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:43.716318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:43.755999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9408c530>]}
[0m06:43:43.857314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c0d730>]}
[0m06:43:43.857813 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:43:43.858430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95372ae0>]}
[0m06:43:43.860480 [info ] [MainThread]: 
[0m06:43:43.861058 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:43:43.864822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:43:43.873881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:43:43.877071 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:43:43.879385 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:43:43.879781 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:43:43.880145 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:43:43.880481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:43.880797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:45.275330 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.395 seconds
[0m06:43:45.276804 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.396 seconds
[0m06:43:45.279475 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:43:45.281758 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:43:45.478716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m06:43:45.479875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m06:43:45.487426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:43:45.493536 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:43:45.496163 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:43:45.498593 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:43:45.499040 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:43:45.499473 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:43:45.499878 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:43:45.500264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:45.500649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:45.501042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:46.038837 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.537 seconds
[0m06:43:46.041783 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.541 seconds
[0m06:43:46.045871 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:43:46.047159 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.547 seconds
[0m06:43:46.049694 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:43:46.053713 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:43:46.243588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9359edb0>]}
[0m06:43:46.244539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:46.245475 [info ] [MainThread]: 
[0m06:43:46.255856 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m06:43:46.256287 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m06:43:46.256640 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m06:43:46.257101 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m06:43:46.257509 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m06:43:46.257894 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m06:43:46.258390 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m06:43:46.259427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m06:43:46.259809 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m06:43:46.260250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m06:43:46.260678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m06:43:46.261055 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m06:43:46.261522 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m06:43:46.261879 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m06:43:46.262234 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m06:43:46.267768 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m06:43:46.268182 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m06:43:46.270477 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m06:43:46.272756 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:43:46.275083 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m06:43:46.275877 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m06:43:46.300123 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m06:43:46.300566 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m06:43:46.300978 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m06:43:46.307879 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m06:43:46.317610 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:43:46.319910 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m06:43:46.322089 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m06:43:46.322785 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m06:43:46.323723 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m06:43:46.324123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:46.326066 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m06:43:46.326923 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m06:43:46.327275 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m06:43:46.327863 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m06:43:46.328174 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m06:43:46.328556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:46.328908 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m06:43:46.329236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:43:46.330454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:47.060145 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m06:43:47.062148 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m06:43:47.063432 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m06:43:47.097291 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m06:43:47.099046 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m06:43:47.099848 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m06:43:47.294898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93802f00>]}
[0m06:43:47.296913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dbf4a0>]}
[0m06:43:47.298547 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b0f170>]}
[0m06:43:47.299680 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.03s]
[0m06:43:47.301253 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.04s]
[0m06:43:47.302299 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.04s]
[0m06:43:47.303307 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m06:43:47.304144 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m06:43:47.304937 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m06:43:47.305665 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m06:43:47.306263 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m06:43:47.306976 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m06:43:47.307726 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m06:43:47.308361 [info ] [Thread-2 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m06:43:47.309072 [info ] [Thread-3 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m06:43:47.309691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m06:43:47.310223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_products)
[0m06:43:47.310754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m06:43:47.311234 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m06:43:47.311716 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m06:43:47.312166 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m06:43:47.315593 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m06:43:47.318199 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m06:43:47.320648 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m06:43:47.322339 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m06:43:47.322650 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m06:43:47.322929 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m06:43:47.326729 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m06:43:47.329123 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m06:43:47.331204 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m06:43:47.332617 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m06:43:47.333196 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m06:43:47.333542 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m06:43:47.334118 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m06:43:47.334533 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m06:43:47.334882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:43:47.335208 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m06:43:47.335541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:47.336855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:47.832067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.507 seconds
[0m06:43:47.837478 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m06:43:47.954512 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m06:43:47.960225 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m06:43:47.961639 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m06:43:47.966431 [debug] [Thread-2 (]: On model.retail_dbt.stg_products: Close
[0m06:43:47.976029 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m06:43:47.978893 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m06:43:48.035472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b917c0>]}
[0m06:43:48.036783 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.78s]
[0m06:43:48.038534 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m06:43:48.039349 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m06:43:48.040165 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m06:43:48.041109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_customer)
[0m06:43:48.041732 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m06:43:48.058140 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m06:43:48.061626 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m06:43:48.064063 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m06:43:48.066585 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m06:43:48.067017 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m06:43:48.067414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:48.157374 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921a04d0>]}
[0m06:43:48.158215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b74d40>]}
[0m06:43:48.158762 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.85s]
[0m06:43:48.159576 [info ] [Thread-2 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.85s]
[0m06:43:48.160473 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m06:43:48.161030 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m06:43:48.161517 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m06:43:48.162175 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m06:43:48.162583 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m06:43:48.163189 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m06:43:48.163711 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m06:43:48.164184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m06:43:48.164585 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m06:43:48.164980 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m06:43:48.169033 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:43:48.172603 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m06:43:48.173771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935ae720>]}
[0m06:43:48.174492 [info ] [Thread-3 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.86s]
[0m06:43:48.175165 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m06:43:48.175906 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m06:43:48.176371 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m06:43:48.176671 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m06:43:48.180079 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:43:48.180537 [info ] [Thread-3 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m06:43:48.182743 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m06:43:48.183296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m06:43:48.183844 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m06:43:48.186869 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m06:43:48.187819 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m06:43:48.188279 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m06:43:48.188876 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m06:43:48.189185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:43:48.189611 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m06:43:48.189904 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m06:43:48.191222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:48.193721 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m06:43:48.196324 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m06:43:48.196734 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m06:43:48.197065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:49.313248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.246 seconds
[0m06:43:49.316196 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m06:43:49.340891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m06:43:49.343514 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m06:43:49.393508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.196 seconds
[0m06:43:49.396641 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m06:43:49.414980 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.226 seconds
[0m06:43:49.418157 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m06:43:49.499595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bc7440>]}
[0m06:43:49.501246 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.46s]
[0m06:43:49.503407 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m06:43:49.507013 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m06:43:49.507881 [info ] [Thread-1 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m06:43:49.509130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m06:43:49.509894 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m06:43:49.518688 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m06:43:49.520259 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m06:43:49.523329 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m06:43:49.526273 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m06:43:49.526793 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m06:43:49.527360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:49.556258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b84c20>]}
[0m06:43:49.556986 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.39s]
[0m06:43:49.557946 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m06:43:49.579476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b90440>]}
[0m06:43:49.580088 [info ] [Thread-3 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.40s]
[0m06:43:49.580792 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m06:43:49.602857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b93cb0>]}
[0m06:43:49.603563 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.44s]
[0m06:43:49.604356 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m06:43:51.359931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.832 seconds
[0m06:43:51.365209 [debug] [Thread-1 (]: On model.retail_dbt.fact_sales: Close
[0m06:43:51.566450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd604032e-23f1-4ba6-8fd4-66d71d578733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bb78f0>]}
[0m06:43:51.568328 [info ] [Thread-1 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.06s]
[0m06:43:51.570298 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m06:43:51.573518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:51.574192 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m06:43:51.574814 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m06:43:51.575281 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m06:43:51.575703 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m06:43:51.576397 [info ] [MainThread]: 
[0m06:43:51.577331 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m06:43:51.579729 [debug] [MainThread]: Command end result
[0m06:43:51.688449 [info ] [MainThread]: 
[0m06:43:51.689067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:51.689406 [info ] [MainThread]: 
[0m06:43:51.689775 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m06:43:51.690543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.896724, "process_user_time": 4.05036, "process_kernel_time": 0.254089, "process_mem_max_rss": "212560", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m06:43:51.691022 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:51.690925 after 8.90 seconds
[0m06:43:51.691406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5fa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921ca9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921c8ad0>]}
[0m06:43:51.691785 [debug] [MainThread]: Flushing usage events
[0m06:43:55.013322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab305b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface33e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab353b00>]}


============================== 06:43:55.019022 | 5a5ebbbe-49d0-4477-8ae2-84c42e913086 ==============================
[0m06:43:55.019022 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:43:55.019765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:43:55.628624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9c29f0>]}
[0m06:43:55.667825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e350380>]}
[0m06:43:55.668480 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:43:55.747679 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:43:55.883828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:55.884283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:55.924145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f41b0b0>]}
[0m06:43:56.032323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efb74a0>]}
[0m06:43:56.032769 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:43:56.033325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaaeb8c0>]}
[0m06:43:56.035506 [info ] [MainThread]: 
[0m06:43:56.036160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:43:56.040011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:43:56.047765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:43:56.053154 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:43:56.055110 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:43:56.055538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:43:56.055904 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:43:56.056273 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:43:56.058069 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:43:56.058474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:56.058795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:56.059120 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:43:56.062738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:56.676588 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.614 seconds
[0m06:43:56.681876 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:43:56.685712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.627 seconds
[0m06:43:56.688690 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.630 seconds
[0m06:43:56.691244 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:43:56.693642 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:43:56.903132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5ebbbe-49d0-4477-8ae2-84c42e913086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f41a900>]}
[0m06:43:56.904611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:56.905224 [info ] [MainThread]: 
[0m06:43:56.919260 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:43:56.919785 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:43:56.920204 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:43:56.920633 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m06:43:56.921088 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:43:56.921454 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m06:43:56.921960 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m06:43:56.922717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m06:43:56.923207 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m06:43:56.923752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m06:43:56.924230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m06:43:56.924673 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:43:56.925211 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m06:43:56.925639 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:43:56.926045 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:43:56.939111 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:43:56.940324 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:43:56.943468 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:43:56.947646 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:43:56.950800 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:43:56.952378 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:43:56.952708 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:43:56.959507 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:43:56.965700 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:43:56.968649 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:43:56.970600 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:43:56.972571 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:43:56.974664 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:43:56.976413 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:43:56.977011 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:43:56.977347 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m06:43:56.977861 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:43:56.978458 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:43:56.978752 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m06:43:56.979122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:56.979468 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m06:43:56.979828 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m06:43:56.980152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:56.981593 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:56.981944 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:43:57.604592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m06:43:57.606462 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m06:43:57.623087 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m06:43:57.625084 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m06:43:57.627875 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m06:43:57.630045 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m06:43:57.632278 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m06:43:57.634973 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m06:43:57.820858 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.90s]
[0m06:43:57.822807 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.90s]
[0m06:43:57.823826 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:43:57.826107 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:43:57.827396 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.90s]
[0m06:43:57.828731 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:43:57.829664 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:43:57.830915 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.91s]
[0m06:43:57.831732 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:43:57.832349 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m06:43:57.832956 [info ] [Thread-2 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m06:43:57.833696 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:43:57.834257 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:43:57.834845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m06:43:57.835398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m06:43:57.835950 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:43:57.836463 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:43:57.837046 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:43:57.837553 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:43:57.838122 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:43:57.838809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:43:57.843459 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:43:57.848529 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:43:57.848974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:43:57.849385 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:43:57.850299 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:43:57.853578 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:43:57.857097 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:43:57.857502 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:43:57.857836 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:43:57.860265 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:43:57.862240 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:43:57.862704 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:43:57.863273 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:43:57.865146 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:43:57.867185 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:43:57.867711 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:43:57.868426 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:43:57.868954 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m06:43:57.869405 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m06:43:57.870015 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:43:57.870400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:57.870992 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:43:57.871272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:57.871679 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:43:57.873143 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:43:57.874569 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:43:57.874980 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:58.384036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m06:43:58.385939 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:43:58.387782 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m06:43:58.389550 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:43:58.406712 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m06:43:58.407326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m06:43:58.408700 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:43:58.410127 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:43:58.568475 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.72s]
[0m06:43:58.569932 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:43:58.571220 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.74s]
[0m06:43:58.571883 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:43:58.572611 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:43:58.573177 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:43:58.573793 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:43:58.574379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:43:58.574922 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:43:58.575519 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:43:58.576047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:43:58.584941 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:43:58.585397 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:43:58.589947 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:43:58.591372 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:43:58.592186 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:43:58.595795 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:43:58.598295 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:43:58.598988 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.76s]
[0m06:43:58.599692 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.76s]
[0m06:43:58.600331 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:43:58.600820 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:43:58.601671 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:43:58.602038 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:43:58.602946 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:43:58.603334 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:43:58.603747 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:58.604172 [info ] [Thread-4 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:43:58.604594 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:58.604985 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:43:58.605371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:43:58.605722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:43:58.606123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:58.606478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:43:58.608080 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:43:58.609535 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:43:58.614385 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:43:58.619313 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:43:58.620570 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:43:58.620900 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:43:58.623040 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:43:58.625004 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:43:58.626509 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:43:58.626931 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:58.627667 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:43:58.627955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:43:58.628357 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:58.629788 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:59.220398 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m06:43:59.224976 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:43:59.288146 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m06:43:59.290352 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:43:59.293198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m06:43:59.294799 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:43:59.300624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m06:43:59.302151 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:43:59.412186 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.81s]
[0m06:43:59.413518 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:43:59.414283 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:43:59.414917 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:43:59.415672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:43:59.416197 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:43:59.422303 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:43:59.423764 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:43:59.426188 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:43:59.427791 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:43:59.428290 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:59.428819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:43:59.471677 [info ] [Thread-4 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.87s]
[0m06:43:59.473106 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:43:59.473697 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:43:59.474237 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:43:59.475210 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.90s]
[0m06:43:59.475669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:43:59.476270 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:43:59.476689 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:43:59.477188 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:43:59.482172 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:43:59.482857 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:43:59.483474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:43:59.484251 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.91s]
[0m06:43:59.484595 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:43:59.485146 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:43:59.490842 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:43:59.491218 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:43:59.491558 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:43:59.542116 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:43:59.542652 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:43:59.543406 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:43:59.544021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:43:59.546128 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:43:59.546696 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:43:59.547455 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:43:59.552653 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:43:59.553129 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:59.554242 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:43:59.554558 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:43:59.555034 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:43:59.556427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:59.556729 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:43:59.559817 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:43:59.561454 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:43:59.561832 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:43:59.562201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:44:00.044480 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m06:44:00.048661 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:44:00.116795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m06:44:00.122424 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:44:00.128294 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m06:44:00.129529 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m06:44:00.132209 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:44:00.134483 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:44:00.236466 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.82s]
[0m06:44:00.238510 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:44:00.311127 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.83s]
[0m06:44:00.311997 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:44:00.334479 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.86s]
[0m06:44:00.335665 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:44:00.336546 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.79s]
[0m06:44:00.337392 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:44:00.339197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:00.339596 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:44:00.339924 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m06:44:00.340299 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:44:00.340619 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m06:44:00.341020 [info ] [MainThread]: 
[0m06:44:00.341509 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m06:44:00.343337 [debug] [MainThread]: Command end result
[0m06:44:00.383948 [info ] [MainThread]: 
[0m06:44:00.384598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:44:00.384975 [info ] [MainThread]: 
[0m06:44:00.385470 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:44:00.386213 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.40801, "process_user_time": 3.977713, "process_kernel_time": 0.219696, "process_mem_max_rss": "213984", "process_out_blocks": "2791", "process_in_blocks": "0"}
[0m06:44:00.386703 [debug] [MainThread]: Command `dbt test` succeeded at 06:44:00.386603 after 5.41 seconds
[0m06:44:00.387097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab305b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2b75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad07800>]}
[0m06:44:00.387437 [debug] [MainThread]: Flushing usage events
[0m06:57:46.615951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f105f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa294e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27ed490>]}


============================== 06:57:46.638515 | 6a6ddda3-a916-4018-917b-ae939240e73d ==============================
[0m06:57:46.638515 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:57:46.639420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:57:46.724964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a6ddda3-a916-4018-917b-ae939240e73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65bb140>]}
[0m06:57:46.815260 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-89kvkj7y'
[0m06:57:46.815749 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:57:46.912389 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:57:46.913145 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:57:46.947799 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:57:46.951202 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:57:47.582258 [info ] [MainThread]: Installed from version 1.3.0
[0m06:57:47.583048 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:57:47.583709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6a6ddda3-a916-4018-917b-ae939240e73d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c70350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c70320>]}
[0m06:57:47.584270 [info ] [MainThread]: 
[0m06:57:47.584755 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:57:47.585784 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0074393, "process_user_time": 2.072187, "process_kernel_time": 0.184419, "process_mem_max_rss": "171296", "process_out_blocks": "5550", "process_in_blocks": "0"}
[0m06:57:47.586301 [debug] [MainThread]: Command `dbt deps` succeeded at 06:57:47.586188 after 1.01 seconds
[0m06:57:47.586690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f105f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65bb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23a5b20>]}
[0m06:57:47.587112 [debug] [MainThread]: Flushing usage events
[0m06:57:50.922977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac011e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad17e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac108b30>]}


============================== 06:57:50.928747 | a971d4d8-efc8-4171-a685-48cef6706d15 ==============================
[0m06:57:50.928747 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:57:50.929325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:57:52.657839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0adbfe0>]}
[0m06:57:52.699065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f5e180>]}
[0m06:57:52.699753 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:57:52.774920 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:57:52.906407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:57:52.906814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:57:52.946577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9087fe30>]}
[0m06:57:53.046690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907050a0>]}
[0m06:57:53.047167 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:57:53.047784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92110f20>]}
[0m06:57:53.049761 [info ] [MainThread]: 
[0m06:57:53.050402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:57:53.054090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:57:53.062965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m06:57:53.066191 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:57:53.067961 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m06:57:53.068361 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:57:53.068779 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m06:57:53.069121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:53.069455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:55.314984 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.246 seconds
[0m06:57:55.317724 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:57:55.322032 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.253 seconds
[0m06:57:55.323817 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m06:57:55.522691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m06:57:55.523808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m06:57:55.537105 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:57:55.537829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:57:55.540494 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:57:55.541045 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:57:55.544424 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:57:55.544865 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:57:55.545287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:57:55.545702 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:57:55.546091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:57:55.548022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:56.090264 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.545 seconds
[0m06:57:56.094575 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:57:56.114024 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.566 seconds
[0m06:57:56.117161 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:57:56.118650 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.572 seconds
[0m06:57:56.123924 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:57:56.314914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b5ed50>]}
[0m06:57:56.316180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:57:56.316889 [info ] [MainThread]: 
[0m06:57:56.329670 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m06:57:56.330092 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m06:57:56.330855 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m06:57:56.331369 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m06:57:56.331839 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m06:57:56.332291 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m06:57:56.332874 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m06:57:56.333504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m06:57:56.334073 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m06:57:56.335172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m06:57:56.335592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m06:57:56.336046 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m06:57:56.336587 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m06:57:56.336998 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m06:57:56.337410 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m06:57:56.342861 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m06:57:56.343337 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m06:57:56.345698 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m06:57:56.347905 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:57:56.350282 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m06:57:56.353330 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m06:57:56.363899 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m06:57:56.375819 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m06:57:56.387911 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m06:57:56.397375 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m06:57:56.399076 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m06:57:56.401280 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m06:57:56.403806 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m06:57:56.405952 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m06:57:56.406615 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m06:57:56.406963 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m06:57:56.407664 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m06:57:56.407979 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m06:57:56.408596 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m06:57:56.410002 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m06:57:56.409318 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m06:57:56.409680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:57:56.408957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:57:56.410301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:57:56.410648 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:57:57.091036 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m06:57:57.092886 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m06:57:57.093878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m06:57:57.123748 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m06:57:57.124608 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m06:57:57.126437 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m06:57:57.308398 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9ec530>]}
[0m06:57:57.309158 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.97s]
[0m06:57:57.310239 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m06:57:57.310735 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m06:57:57.311267 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m06:57:57.312071 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b55b50>]}
[0m06:57:57.312468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m06:57:57.313068 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.98s]
[0m06:57:57.313538 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m06:57:57.314125 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m06:57:57.316819 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m06:57:57.317676 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m06:57:57.318666 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m06:57:57.319561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5aab40>]}
[0m06:57:57.319960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m06:57:57.320556 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.98s]
[0m06:57:57.321163 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m06:57:57.321501 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m06:57:57.322078 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m06:57:57.324598 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m06:57:57.326831 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m06:57:57.327249 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m06:57:57.328101 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m06:57:57.328559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m06:57:57.328957 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m06:57:57.329596 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m06:57:57.332850 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m06:57:57.332465 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m06:57:57.332132 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m06:57:57.333154 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:57:57.335353 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m06:57:57.337602 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m06:57:57.341470 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m06:57:57.342372 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m06:57:57.342957 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m06:57:57.343328 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:57:57.343837 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m06:57:57.345273 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m06:57:57.345704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:57:57.985095 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m06:57:57.992109 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m06:57:57.996879 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m06:57:58.001776 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m06:57:58.006657 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m06:57:58.009531 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m06:57:58.084099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m06:57:58.086619 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m06:57:58.202551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f500b60>]}
[0m06:57:58.204209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb47950>]}
[0m06:57:58.204927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb06630>]}
[0m06:57:58.205462 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.88s]
[0m06:57:58.206107 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.89s]
[0m06:57:58.206709 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.88s]
[0m06:57:58.208283 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m06:57:58.207811 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m06:57:58.207304 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m06:57:58.208663 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m06:57:58.209129 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m06:57:58.209660 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_store
[0m06:57:58.210122 [info ] [Thread-2 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m06:57:58.210610 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m06:57:58.211066 [info ] [Thread-3 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m06:57:58.212205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_store)
[0m06:57:58.211853 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m06:57:58.211465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.fact_inventory_snapshot)
[0m06:57:58.213243 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m06:57:58.212909 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m06:57:58.212553 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_store
[0m06:57:58.225449 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:57:58.229680 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m06:57:58.232544 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m06:57:58.234310 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m06:57:58.234675 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m06:57:58.234947 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_store
[0m06:57:58.237102 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m06:57:58.239107 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m06:57:58.241136 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m06:57:58.242913 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m06:57:58.243310 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m06:57:58.244398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:57:58.244113 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m06:57:58.245633 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m06:57:58.246908 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m06:57:58.247575 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m06:57:58.248358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:57:58.248013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:57:58.285057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5c4f20>]}
[0m06:57:58.285676 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.95s]
[0m06:57:58.286258 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m06:57:58.286660 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_product
[0m06:57:58.287067 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m06:57:58.287511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_product)
[0m06:57:58.287864 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_product
[0m06:57:58.340731 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m06:57:58.345943 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_product
[0m06:57:58.349912 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m06:57:58.351372 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m06:57:58.351782 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m06:57:58.352142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:57:59.554469 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.310 seconds
[0m06:57:59.556552 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.308 seconds
[0m06:57:59.561095 [debug] [Thread-4 (]: On model.retail_dbt.dim_customer: Close
[0m06:57:59.563071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m06:57:59.566445 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m06:57:59.567683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.215 seconds
[0m06:57:59.572945 [debug] [Thread-3 (]: On model.retail_dbt.dim_store: Close
[0m06:57:59.577080 [debug] [Thread-1 (]: On model.retail_dbt.dim_product: Close
[0m06:57:59.760982 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb63c20>]}
[0m06:57:59.766603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb6a1b0>]}
[0m06:57:59.767904 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.55s]
[0m06:57:59.770097 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb5d5b0>]}
[0m06:57:59.771146 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.48s]
[0m06:57:59.772391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb5d430>]}
[0m06:57:59.773358 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m06:57:59.774228 [info ] [Thread-3 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.56s]
[0m06:57:59.775142 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_product
[0m06:57:59.776026 [info ] [Thread-2 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.56s]
[0m06:57:59.777121 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_sales
[0m06:57:59.777711 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_store
[0m06:57:59.778600 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m06:57:59.779183 [info ] [Thread-4 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m06:57:59.780228 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m06:57:59.780738 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_sales
[0m06:57:59.788009 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m06:57:59.789295 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_sales
[0m06:57:59.791888 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m06:57:59.794414 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m06:57:59.794834 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m06:57:59.795256 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:58:01.599191 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.803 seconds
[0m06:58:01.606448 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: Close
[0m06:58:01.831078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a971d4d8-efc8-4171-a685-48cef6706d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907a6d50>]}
[0m06:58:01.833182 [info ] [Thread-4 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.05s]
[0m06:58:01.834450 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_sales
[0m06:58:01.837558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:01.838196 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m06:58:01.838960 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m06:58:01.839618 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m06:58:01.840225 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m06:58:01.840953 [info ] [MainThread]: 
[0m06:58:01.841612 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m06:58:01.844589 [debug] [MainThread]: Command end result
[0m06:58:01.886045 [info ] [MainThread]: 
[0m06:58:01.886683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:58:01.887148 [info ] [MainThread]: 
[0m06:58:01.887626 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m06:58:01.888479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.00227, "process_user_time": 5.541323, "process_kernel_time": 0.505312, "process_mem_max_rss": "220244", "process_out_blocks": "27878", "process_in_blocks": "0"}
[0m06:58:01.888904 [debug] [MainThread]: Command `dbt run` succeeded at 06:58:01.888837 after 11.00 seconds
[0m06:58:01.889206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac16f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffdb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffdbfe0>]}
[0m06:58:01.889540 [debug] [MainThread]: Flushing usage events
[0m06:58:04.948232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a445a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ce7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8934c980>]}


============================== 06:58:04.953834 | 7217d208-16fe-45bf-9e88-b047bc3ea8f9 ==============================
[0m06:58:04.953834 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:58:04.954571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m06:58:05.565009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d6a42c0>]}
[0m06:58:05.604374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d574a40>]}
[0m06:58:05.605036 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:58:05.678117 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:58:05.810785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:05.811194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:05.851069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dbdafc0>]}
[0m06:58:05.958960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cfaae40>]}
[0m06:58:05.959427 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m06:58:05.960013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d36a930>]}
[0m06:58:05.962197 [info ] [MainThread]: 
[0m06:58:05.962838 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:58:05.966726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m06:58:05.974657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m06:58:05.980075 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m06:58:05.981948 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m06:58:05.982348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m06:58:05.982737 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m06:58:05.983163 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m06:58:05.984965 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m06:58:05.985311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:05.985660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:05.986015 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m06:58:05.989470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:06.589410 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.604 seconds
[0m06:58:06.592863 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m06:58:06.598208 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.612 seconds
[0m06:58:06.599284 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.610 seconds
[0m06:58:06.601339 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m06:58:06.603336 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m06:58:06.797508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7217d208-16fe-45bf-9e88-b047bc3ea8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cec8080>]}
[0m06:58:06.798441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:58:06.799327 [info ] [MainThread]: 
[0m06:58:06.810671 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:58:06.811154 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:58:06.811580 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:58:06.812023 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m06:58:06.812463 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:58:06.812798 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m06:58:06.813221 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m06:58:06.813787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m06:58:06.814191 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m06:58:06.814671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m06:58:06.815079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m06:58:06.815464 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:58:06.815930 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m06:58:06.816303 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:58:06.816657 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:58:06.830186 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:58:06.830552 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:58:06.833749 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:58:06.837822 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:58:06.841274 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:58:06.843948 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:58:06.849989 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:58:06.850321 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:58:06.860036 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:58:06.862030 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:58:06.862542 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:58:06.864443 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:58:06.866786 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:58:06.867914 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m06:58:06.868537 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m06:58:06.868953 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m06:58:06.869445 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m06:58:06.869989 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m06:58:06.870520 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m06:58:06.870892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:58:06.871224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:06.871604 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m06:58:06.871991 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m06:58:06.874423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:58:06.875201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:58:07.510304 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m06:58:07.522503 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m06:58:07.534392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m06:58:07.536650 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m06:58:07.539707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m06:58:07.541771 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m06:58:07.542886 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m06:58:07.545462 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m06:58:07.728870 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.91s]
[0m06:58:07.731445 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m06:58:07.732815 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.92s]
[0m06:58:07.733621 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:58:07.734599 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m06:58:07.735642 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.92s]
[0m06:58:07.736152 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m06:58:07.737225 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:58:07.737981 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m06:58:07.738942 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.92s]
[0m06:58:07.739435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m06:58:07.739991 [info ] [Thread-2 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m06:58:07.740673 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:58:07.741292 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m06:58:07.741765 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:58:07.742209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m06:58:07.742649 [info ] [Thread-1 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m06:58:07.743179 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:58:07.747718 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:58:07.748250 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:58:07.748708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m06:58:07.749106 [info ] [Thread-3 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m06:58:07.754065 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:58:07.754477 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:58:07.754931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m06:58:07.755641 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:58:07.758694 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:58:07.759138 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:58:07.761255 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:58:07.761672 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:58:07.765092 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:58:07.767264 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:58:07.767829 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:58:07.769840 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:58:07.770405 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m06:58:07.771001 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m06:58:07.771310 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:58:07.771825 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m06:58:07.772138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:58:07.774217 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:58:07.774646 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m06:58:07.775196 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m06:58:07.776805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:58:07.777332 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m06:58:07.778443 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m06:58:07.779392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:07.779975 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m06:58:07.781334 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:58:08.299881 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m06:58:08.302628 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m06:58:08.318650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m06:58:08.320472 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m06:58:08.325173 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m06:58:08.326623 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m06:58:08.335076 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m06:58:08.336527 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m06:58:08.488741 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.75s]
[0m06:58:08.490842 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m06:58:08.491675 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:58:08.492357 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m06:58:08.493602 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m06:58:08.494667 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:58:08.506003 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:58:08.508303 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.76s]
[0m06:58:08.509430 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m06:58:08.510044 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:58:08.510530 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:58:08.511367 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.77s]
[0m06:58:08.511822 [info ] [Thread-1 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m06:58:08.514566 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:58:08.515089 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m06:58:08.515518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m06:58:08.516572 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:58:08.517362 [info ] [Thread-3 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.76s]
[0m06:58:08.517742 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:58:08.518198 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m06:58:08.518769 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m06:58:08.525086 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:58:08.525857 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m06:58:08.526212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m06:58:08.526638 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:58:08.527197 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:08.527653 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:58:08.528038 [info ] [Thread-3 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m06:58:08.528585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:58:08.528888 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:58:08.533472 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:58:08.533938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m06:58:08.537231 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:58:08.537804 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:58:08.542362 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:58:08.542912 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:58:08.545084 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:58:08.546084 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m06:58:08.546545 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:08.546889 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:58:08.547228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:08.549317 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:58:08.550068 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m06:58:08.551742 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:08.552137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:58:08.553893 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m06:58:08.554321 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:08.554735 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:58:09.144721 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m06:58:09.148239 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m06:58:09.259305 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m06:58:09.260924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m06:58:09.263261 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m06:58:09.265297 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m06:58:09.280572 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m06:58:09.282363 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m06:58:09.340934 [info ] [Thread-3 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.81s]
[0m06:58:09.342316 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m06:58:09.343044 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:58:09.343746 [info ] [Thread-3 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m06:58:09.344656 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m06:58:09.345233 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:58:09.351610 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:58:09.352946 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:58:09.355567 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:58:09.358288 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m06:58:09.358717 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:09.359141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:58:09.452697 [info ] [Thread-1 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.94s]
[0m06:58:09.453967 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m06:58:09.454779 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:58:09.455509 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m06:58:09.456362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m06:58:09.457011 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:58:09.463059 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:58:09.464271 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:58:09.528130 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:58:09.529669 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.04s]
[0m06:58:09.530522 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m06:58:09.531326 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.00s]
[0m06:58:09.531823 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:58:09.532684 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m06:58:09.533125 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m06:58:09.533561 [info ] [Thread-4 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m06:58:09.534096 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:09.534549 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:58:09.534952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m06:58:09.535307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:09.535735 [info ] [Thread-2 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m06:58:09.536152 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:58:09.537463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m06:58:09.541795 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:58:09.542209 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:58:09.548031 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:58:09.549199 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:58:09.551365 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:58:09.557403 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:58:09.559545 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:58:09.560533 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m06:58:09.560941 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:58:09.561332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:58:09.562625 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m06:58:09.563346 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m06:58:09.563830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:58:09.956178 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m06:58:09.961038 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m06:58:10.102224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m06:58:10.106671 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m06:58:10.139942 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m06:58:10.141018 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m06:58:10.143458 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m06:58:10.145341 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m06:58:10.150748 [info ] [Thread-3 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.81s]
[0m06:58:10.152320 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m06:58:10.301211 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.84s]
[0m06:58:10.302417 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m06:58:10.336573 [info ] [Thread-2 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.80s]
[0m06:58:10.337564 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m06:58:10.411104 [info ] [Thread-4 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.88s]
[0m06:58:10.413007 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m06:58:10.415770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:10.416318 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m06:58:10.416940 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m06:58:10.417633 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m06:58:10.418279 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m06:58:10.418968 [info ] [MainThread]: 
[0m06:58:10.419630 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m06:58:10.422216 [debug] [MainThread]: Command end result
[0m06:58:10.484266 [info ] [MainThread]: 
[0m06:58:10.485011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:58:10.485451 [info ] [MainThread]: 
[0m06:58:10.485965 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m06:58:10.486829 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.574045, "process_user_time": 3.972047, "process_kernel_time": 0.205157, "process_mem_max_rss": "214032", "process_out_blocks": "2789", "process_in_blocks": "0"}
[0m06:58:10.487326 [debug] [MainThread]: Command `dbt test` succeeded at 06:58:10.487240 after 5.57 seconds
[0m06:58:10.487718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89371610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b724b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895961b0>]}
[0m06:58:10.488091 [debug] [MainThread]: Flushing usage events
[0m07:10:33.212650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8653e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6514650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74cfb90>]}


============================== 07:10:33.218984 | 15e15f98-fb33-48b0-8e7b-eaa1a7b3892b ==============================
[0m07:10:33.218984 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:10:33.219768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:10:33.305817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15e15f98-fb33-48b0-8e7b-eaa1a7b3892b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76a8650>]}
[0m07:10:33.367152 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ly_0i813'
[0m07:10:33.367679 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:10:33.481309 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:10:33.482082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:10:33.530524 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:10:33.534033 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:10:34.099483 [info ] [MainThread]: Installed from version 1.3.0
[0m07:10:34.100152 [info ] [MainThread]: Updated version available: 1.3.3
[0m07:10:34.101405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15e15f98-fb33-48b0-8e7b-eaa1a7b3892b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63201a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6320f20>]}
[0m07:10:34.101849 [info ] [MainThread]: 
[0m07:10:34.102435 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:10:34.103506 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92645323, "process_user_time": 1.701361, "process_kernel_time": 0.144605, "process_mem_max_rss": "170724", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m07:10:34.103959 [debug] [MainThread]: Command `dbt deps` succeeded at 07:10:34.103885 after 0.93 seconds
[0m07:10:34.104287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6514650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6517680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76a8650>]}
[0m07:10:34.104661 [debug] [MainThread]: Flushing usage events
[0m07:10:37.450045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d3f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d3fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d3ff80>]}


============================== 07:10:37.455853 | e097887c-10c0-47a4-b543-7f9da7fd2dca ==============================
[0m07:10:37.455853 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:10:37.456860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:10:38.166742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c2ef00>]}
[0m07:10:38.206476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804ecbc0>]}
[0m07:10:38.207143 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:10:38.287775 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:10:38.457174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:38.457647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:38.498772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649be180>]}
[0m07:10:38.603989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645d2930>]}
[0m07:10:38.604480 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:10:38.605162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64ee4a10>]}
[0m07:10:38.607247 [info ] [MainThread]: 
[0m07:10:38.607925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:10:38.611735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m07:10:38.620027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m07:10:38.624125 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m07:10:38.626485 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m07:10:38.626867 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m07:10:38.627235 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m07:10:38.627608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:38.627929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:39.484006 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.856 seconds
[0m07:10:39.485912 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.858 seconds
[0m07:10:39.489052 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m07:10:39.491724 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m07:10:39.684508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m07:10:39.685223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m07:10:39.692878 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:10:39.693303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:10:39.695094 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:10:39.695551 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:10:39.697427 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:10:39.697828 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:10:39.698184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:39.698554 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:10:39.698880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:39.699800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:40.235853 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.537 seconds
[0m07:10:40.240716 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m07:10:40.249018 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.550 seconds
[0m07:10:40.250045 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.550 seconds
[0m07:10:40.252797 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m07:10:40.255560 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m07:10:40.452288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645d2210>]}
[0m07:10:40.453467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:40.454579 [info ] [MainThread]: 
[0m07:10:40.465971 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m07:10:40.466453 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m07:10:40.466849 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m07:10:40.467403 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m07:10:40.467813 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m07:10:40.468225 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m07:10:40.468730 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m07:10:40.469740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.dim_date)
[0m07:10:40.470124 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m07:10:40.470596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m07:10:40.471004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m07:10:40.471396 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m07:10:40.471853 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m07:10:40.472210 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m07:10:40.472663 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m07:10:40.478271 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m07:10:40.478731 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m07:10:40.480961 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m07:10:40.483168 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m07:10:40.485665 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m07:10:40.486723 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m07:10:40.510712 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m07:10:40.511099 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m07:10:40.511464 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m07:10:40.511917 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m07:10:40.528250 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m07:10:40.530572 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m07:10:40.532840 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m07:10:40.533548 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m07:10:40.534741 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m07:10:40.535157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:40.536444 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m07:10:40.537052 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m07:10:40.537946 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m07:10:40.538728 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m07:10:40.539037 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m07:10:40.539437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:10:40.539818 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m07:10:40.540197 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:10:40.541655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:10:41.158350 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m07:10:41.186616 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m07:10:41.187367 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m07:10:41.190204 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m07:10:41.215719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m07:10:41.217779 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m07:10:41.385422 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b331a0>]}
[0m07:10:41.386361 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.91s]
[0m07:10:41.387907 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m07:10:41.388535 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m07:10:41.389145 [info ] [Thread-4 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m07:10:41.390003 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a30e00>]}
[0m07:10:41.390466 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m07:10:41.391099 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.92s]
[0m07:10:41.391633 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m07:10:41.392207 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m07:10:41.395407 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m07:10:41.395933 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m07:10:41.396743 [info ] [Thread-3 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m07:10:41.397277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m07:10:41.397645 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m07:10:41.400044 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m07:10:41.400378 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m07:10:41.404177 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m07:10:41.404990 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m07:10:41.407218 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m07:10:41.407899 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m07:10:41.408261 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m07:10:41.408707 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:10:41.409274 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m07:10:41.410652 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m07:10:41.411160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:10:41.449104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63b832f0>]}
[0m07:10:41.449734 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.98s]
[0m07:10:41.450520 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m07:10:41.450945 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m07:10:41.451397 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m07:10:41.451942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m07:10:41.452270 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m07:10:41.454668 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m07:10:41.455731 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m07:10:41.458052 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m07:10:41.459262 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m07:10:41.459632 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m07:10:41.459952 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:10:42.031492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m07:10:42.036683 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m07:10:42.043891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m07:10:42.047438 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m07:10:42.105217 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m07:10:42.109527 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m07:10:42.229683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6318d190>]}
[0m07:10:42.231121 [info ] [Thread-4 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.84s]
[0m07:10:42.232994 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m07:10:42.233840 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m07:10:42.234613 [info ] [Thread-4 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m07:10:42.235594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m07:10:42.236368 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m07:10:42.253198 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m07:10:42.253937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6318d010>]}
[0m07:10:42.254669 [info ] [Thread-3 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.86s]
[0m07:10:42.255391 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m07:10:42.255801 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_customer
[0m07:10:42.256430 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m07:10:42.256837 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m07:10:42.257170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_customer)
[0m07:10:42.259473 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m07:10:42.259863 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_customer
[0m07:10:42.264211 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m07:10:42.265303 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m07:10:42.265718 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m07:10:42.266125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:10:42.266425 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_customer
[0m07:10:42.269559 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m07:10:42.271620 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m07:10:42.272069 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m07:10:42.272520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:10:42.325311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631c30e0>]}
[0m07:10:42.325902 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.87s]
[0m07:10:42.326604 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m07:10:42.327004 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m07:10:42.327429 [info ] [Thread-2 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m07:10:42.327937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m07:10:42.328264 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m07:10:42.331272 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m07:10:42.332254 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m07:10:42.334427 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m07:10:42.335425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m07:10:42.337096 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m07:10:42.338705 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m07:10:42.339350 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m07:10:42.339847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:10:42.558598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63bf4b00>]}
[0m07:10:42.559665 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.09s]
[0m07:10:42.560772 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m07:10:42.561372 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_store
[0m07:10:42.561950 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m07:10:42.562609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_store)
[0m07:10:42.563072 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_store
[0m07:10:42.567544 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m07:10:42.569013 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_store
[0m07:10:42.571509 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m07:10:42.572978 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m07:10:42.573484 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m07:10:42.573990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:43.569080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m07:10:43.570811 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.305 seconds
[0m07:10:43.571874 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m07:10:43.575948 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m07:10:43.579138 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m07:10:43.581745 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: Close
[0m07:10:43.783456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63bdbef0>]}
[0m07:10:43.785158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a31fd0>]}
[0m07:10:43.787390 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.53s]
[0m07:10:43.789312 [info ] [Thread-4 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.55s]
[0m07:10:43.790496 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_customer
[0m07:10:43.791883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63bda0c0>]}
[0m07:10:43.792802 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m07:10:43.793983 [debug] [Thread-3 (]: Began running node model.retail_dbt.fact_sales
[0m07:10:43.794788 [info ] [Thread-2 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.46s]
[0m07:10:43.796156 [info ] [Thread-3 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m07:10:43.797079 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m07:10:43.797806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m07:10:43.798659 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fact_sales
[0m07:10:43.806418 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m07:10:43.807638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m07:10:43.810045 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: Close
[0m07:10:43.812252 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fact_sales
[0m07:10:43.814911 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m07:10:43.817467 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m07:10:43.817922 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m07:10:43.818418 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:10:44.013823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631d7ef0>]}
[0m07:10:44.018107 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.45s]
[0m07:10:44.019184 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_store
[0m07:10:45.933739 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.115 seconds
[0m07:10:45.938976 [debug] [Thread-3 (]: On model.retail_dbt.fact_sales: Close
[0m07:10:46.147325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e097887c-10c0-47a4-b543-7f9da7fd2dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63122b70>]}
[0m07:10:46.149156 [info ] [Thread-3 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.35s]
[0m07:10:46.150900 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fact_sales
[0m07:10:46.153762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:46.154327 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m07:10:46.154778 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m07:10:46.155231 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m07:10:46.155679 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m07:10:46.156357 [info ] [MainThread]: 
[0m07:10:46.157309 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m07:10:46.160222 [debug] [MainThread]: Command end result
[0m07:10:46.269979 [info ] [MainThread]: 
[0m07:10:46.270592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:46.270919 [info ] [MainThread]: 
[0m07:10:46.271289 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m07:10:46.272016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.858877, "process_user_time": 4.13688, "process_kernel_time": 0.279924, "process_mem_max_rss": "212580", "process_out_blocks": "2767", "process_in_blocks": "0"}
[0m07:10:46.272527 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:46.272455 after 8.86 seconds
[0m07:10:46.272879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff662d06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8105f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63188950>]}
[0m07:10:46.273268 [debug] [MainThread]: Flushing usage events
[0m07:12:47.163486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afde450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b38f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afde6f0>]}


============================== 07:12:47.169252 | 93227acd-d78c-4752-a94d-99b579512504 ==============================
[0m07:12:47.169252 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:12:47.170005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:12:47.252534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93227acd-d78c-4752-a94d-99b579512504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a99f4d0>]}
[0m07:12:47.320452 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nqctp9r3'
[0m07:12:47.320919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:12:47.429778 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:12:47.430435 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:12:47.494488 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:12:47.498816 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:12:48.123277 [info ] [MainThread]: Installed from version 1.3.0
[0m07:12:48.123958 [info ] [MainThread]: Updated version available: 1.3.3
[0m07:12:48.124478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93227acd-d78c-4752-a94d-99b579512504', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7132f0>]}
[0m07:12:48.124897 [info ] [MainThread]: 
[0m07:12:48.125422 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:12:48.126515 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.99928623, "process_user_time": 1.973177, "process_kernel_time": 0.11734, "process_mem_max_rss": "170728", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m07:12:48.127005 [debug] [MainThread]: Command `dbt deps` succeeded at 07:12:48.126915 after 1.00 seconds
[0m07:12:48.127365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b23b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aea6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7f13d0>]}
[0m07:12:48.127772 [debug] [MainThread]: Flushing usage events
[0m07:12:51.112766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9faadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1fd940>]}


============================== 07:12:51.118426 | 594f2152-d48b-4d78-9b24-957c4f678c66 ==============================
[0m07:12:51.118426 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:12:51.119255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:12:51.740380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ba3ec0>]}
[0m07:12:51.779596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815bdca0>]}
[0m07:12:51.780256 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:12:51.853458 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:12:51.991004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:12:51.991444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:12:52.031266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814dc320>]}
[0m07:12:52.131898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f422d0>]}
[0m07:12:52.132368 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:12:52.132956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813cddc0>]}
[0m07:12:52.135007 [info ] [MainThread]: 
[0m07:12:52.135639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:12:52.139328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m07:12:52.148288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m07:12:52.151511 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m07:12:52.153803 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m07:12:52.154229 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m07:12:52.154609 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m07:12:52.155035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:52.155358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:53.012312 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.857 seconds
[0m07:12:53.014546 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m07:12:53.015368 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.860 seconds
[0m07:12:53.018017 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m07:12:53.209948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m07:12:53.211022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m07:12:53.218140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:12:53.224680 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:12:53.227338 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:12:53.229875 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:12:53.230321 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:12:53.230739 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:12:53.231171 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:12:53.231546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:12:53.231955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:12:53.232350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:53.766586 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.534 seconds
[0m07:12:53.768508 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m07:12:53.773242 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m07:12:53.774688 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m07:12:53.777305 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m07:12:53.782779 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m07:12:53.983771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d120c0>]}
[0m07:12:53.984765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:12:53.985902 [info ] [MainThread]: 
[0m07:12:53.997524 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m07:12:53.998026 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m07:12:53.998463 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m07:12:53.999036 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m07:12:53.999531 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m07:12:54.000036 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m07:12:54.000681 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m07:12:54.001808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m07:12:54.002279 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m07:12:54.002850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m07:12:54.003243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m07:12:54.003628 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m07:12:54.004107 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m07:12:54.004452 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m07:12:54.004778 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m07:12:54.010068 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m07:12:54.010455 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m07:12:54.012701 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m07:12:54.014914 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m07:12:54.017236 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m07:12:54.018080 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m07:12:54.039200 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m07:12:54.048229 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m07:12:54.059164 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m07:12:54.059510 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m07:12:54.059995 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m07:12:54.062370 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m07:12:54.064739 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m07:12:54.065660 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m07:12:54.066375 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m07:12:54.066927 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m07:12:54.067470 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m07:12:54.068042 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m07:12:54.068439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:54.068832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:12:54.069341 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m07:12:54.069719 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m07:12:54.072687 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m07:12:54.073249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:12:54.073623 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:12:54.694781 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m07:12:54.710864 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m07:12:54.728863 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m07:12:54.728076 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m07:12:54.732492 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m07:12:54.735192 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m07:12:54.917238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8030d7f0>]}
[0m07:12:54.918609 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.91s]
[0m07:12:54.920130 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m07:12:54.921387 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_orders
[0m07:12:54.922438 [info ] [Thread-3 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m07:12:54.923338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_orders)
[0m07:12:54.924455 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d90ce0>]}
[0m07:12:54.924922 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_orders
[0m07:12:54.925771 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.92s]
[0m07:12:54.929344 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m07:12:54.930095 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m07:12:54.930965 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m07:12:54.931528 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m07:12:54.932090 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m07:12:54.932476 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m07:12:54.935202 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m07:12:54.935592 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_orders
[0m07:12:54.940604 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m07:12:54.941290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fadd00>]}
[0m07:12:54.942029 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.94s]
[0m07:12:54.942449 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m07:12:54.942923 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m07:12:54.945336 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m07:12:54.945812 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m07:12:54.946346 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m07:12:54.947035 [info ] [Thread-2 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m07:12:54.947585 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m07:12:54.948042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m07:12:54.948606 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m07:12:54.948912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:12:54.949277 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m07:12:54.949624 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m07:12:54.952896 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m07:12:54.953318 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:12:54.955342 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m07:12:54.957696 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m07:12:54.958834 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m07:12:54.959208 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m07:12:54.959575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:12:55.475951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m07:12:55.481220 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m07:12:55.565063 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m07:12:55.568947 [debug] [Thread-3 (]: On model.retail_dbt.stg_orders: Close
[0m07:12:55.577265 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m07:12:55.581308 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m07:12:55.614435 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m07:12:55.617801 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m07:12:55.676364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80350260>]}
[0m07:12:55.677804 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.67s]
[0m07:12:55.679652 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m07:12:55.680406 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m07:12:55.681187 [info ] [Thread-1 (]: 8 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m07:12:55.682011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m07:12:55.682546 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m07:12:55.700243 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m07:12:55.701761 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m07:12:55.704225 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m07:12:55.705676 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m07:12:55.706097 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m07:12:55.706460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:55.764887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80faf7a0>]}
[0m07:12:55.765770 [info ] [Thread-3 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.84s]
[0m07:12:55.766925 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_orders
[0m07:12:55.767495 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_customer
[0m07:12:55.768042 [info ] [Thread-3 (]: 9 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m07:12:55.768659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m07:12:55.769180 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_customer
[0m07:12:55.774395 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m07:12:55.776102 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d70f80>]}
[0m07:12:55.776802 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.84s]
[0m07:12:55.777391 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m07:12:55.778033 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_product
[0m07:12:55.778354 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_customer
[0m07:12:55.778758 [info ] [Thread-4 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m07:12:55.782561 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m07:12:55.783190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m07:12:55.783763 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_product
[0m07:12:55.786674 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m07:12:55.788020 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m07:12:55.788455 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m07:12:55.788841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:12:55.789682 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_product
[0m07:12:55.792513 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m07:12:55.793713 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m07:12:55.794095 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m07:12:55.794468 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:12:55.815949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80db1be0>]}
[0m07:12:55.816529 [info ] [Thread-2 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.87s]
[0m07:12:55.817242 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m07:12:55.817790 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m07:12:55.818255 [info ] [Thread-2 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m07:12:55.818839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m07:12:55.819198 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m07:12:55.822258 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m07:12:55.823684 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m07:12:55.825804 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m07:12:55.826997 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m07:12:55.827361 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m07:12:55.827701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:12:56.997709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.291 seconds
[0m07:12:56.999521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.211 seconds
[0m07:12:57.003962 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m07:12:57.005875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.211 seconds
[0m07:12:57.007000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.179 seconds
[0m07:12:57.010079 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: Close
[0m07:12:57.014152 [debug] [Thread-4 (]: On model.retail_dbt.dim_product: Close
[0m07:12:57.016920 [debug] [Thread-2 (]: On model.retail_dbt.dim_store: Close
[0m07:12:57.218056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803b83b0>]}
[0m07:12:57.219521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d4a390>]}
[0m07:12:57.220749 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80df7020>]}
[0m07:12:57.222111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d48f50>]}
[0m07:12:57.223187 [info ] [Thread-2 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.40s]
[0m07:12:57.224736 [info ] [Thread-3 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.45s]
[0m07:12:57.225813 [info ] [Thread-4 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.44s]
[0m07:12:57.226963 [info ] [Thread-1 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.54s]
[0m07:12:57.227939 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m07:12:57.228843 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_customer
[0m07:12:57.229709 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_product
[0m07:12:57.230514 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m07:12:57.231792 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m07:12:57.232784 [info ] [Thread-2 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m07:12:57.233505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now model.retail_dbt.fact_sales)
[0m07:12:57.233962 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m07:12:57.241082 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m07:12:57.242628 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m07:12:57.245178 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m07:12:57.247682 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m07:12:57.248262 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m07:12:57.248713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:12:58.939198 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.690 seconds
[0m07:12:58.942169 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: Close
[0m07:12:59.126491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594f2152-d48b-4d78-9b24-957c4f678c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8038c7a0>]}
[0m07:12:59.127215 [info ] [Thread-2 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 1.89s]
[0m07:12:59.128140 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m07:12:59.129854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:12:59.130227 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m07:12:59.130534 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m07:12:59.130833 [debug] [MainThread]: Connection 'model.retail_dbt.dim_customer' was properly closed.
[0m07:12:59.131108 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m07:12:59.131596 [info ] [MainThread]: 
[0m07:12:59.132127 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m07:12:59.133671 [debug] [MainThread]: Command end result
[0m07:12:59.222673 [info ] [MainThread]: 
[0m07:12:59.223296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:12:59.223634 [info ] [MainThread]: 
[0m07:12:59.224025 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m07:12:59.224791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.147758, "process_user_time": 4.032786, "process_kernel_time": 0.212251, "process_mem_max_rss": "212628", "process_out_blocks": "2766", "process_in_blocks": "0"}
[0m07:12:59.225269 [debug] [MainThread]: Command `dbt run` succeeded at 07:12:59.225192 after 8.15 seconds
[0m07:12:59.225635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9faadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83149220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81eabef0>]}
[0m07:12:59.226053 [debug] [MainThread]: Flushing usage events
[0m07:14:51.190309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa810d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa810fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa810fe00>]}


============================== 07:14:51.196675 | fb5c41c7-ef06-4f16-8702-1802ffaeb37a ==============================
[0m07:14:51.196675 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:14:51.197643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:14:51.854256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc2c2c0>]}
[0m07:14:51.897297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6d0e30>]}
[0m07:14:51.898046 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:14:51.971136 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:14:52.100218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:52.100651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:52.140818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be3c3e0>]}
[0m07:14:52.249530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8ac4a0>]}
[0m07:14:52.250045 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:14:52.250683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be3ecc0>]}
[0m07:14:52.252807 [info ] [MainThread]: 
[0m07:14:52.253517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:14:52.257457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:14:52.265578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:14:52.271020 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:14:52.272913 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:14:52.273324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:14:52.273707 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:14:52.274074 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:14:52.275868 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:14:52.276220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:52.276550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:52.276881 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:14:52.280404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:53.155586 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.879 seconds
[0m07:14:53.156745 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.880 seconds
[0m07:14:53.157592 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.877 seconds
[0m07:14:53.160892 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m07:14:53.163437 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m07:14:53.165533 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m07:14:53.369084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5c41c7-ef06-4f16-8702-1802ffaeb37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be3f290>]}
[0m07:14:53.370578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:53.371887 [info ] [MainThread]: 
[0m07:14:53.385083 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:14:53.385620 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:14:53.386048 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:14:53.386478 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m07:14:53.386983 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:14:53.387406 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m07:14:53.387889 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m07:14:53.388485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m07:14:53.388945 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m07:14:53.389459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m07:14:53.389908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m07:14:53.390484 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:14:53.391060 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m07:14:53.391488 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:14:53.391895 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:14:53.405378 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:14:53.405748 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:14:53.408931 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:14:53.413134 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:14:53.416581 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:14:53.417584 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:14:53.424557 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:14:53.439093 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:14:53.442955 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:14:53.443344 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:14:53.443715 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:14:53.445884 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:14:53.447919 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:14:53.448903 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:14:53.449548 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:14:53.449895 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m07:14:53.450317 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m07:14:53.450959 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:14:53.451245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:14:53.451766 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:14:53.452154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:53.452619 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m07:14:53.454243 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m07:14:53.455903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:14:53.456424 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:14:54.554031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.101 seconds
[0m07:14:54.556474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m07:14:54.563391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.107 seconds
[0m07:14:54.572209 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m07:14:54.573276 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.122 seconds
[0m07:14:54.575824 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m07:14:54.577688 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m07:14:54.581858 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m07:14:54.786592 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 1.39s]
[0m07:14:54.788561 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 1.40s]
[0m07:14:54.789685 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:14:54.791209 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 1.40s]
[0m07:14:54.793718 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:14:54.795214 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 1.41s]
[0m07:14:54.795971 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:14:54.796939 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:14:54.797669 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:14:54.798587 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:14:54.799287 [info ] [Thread-4 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m07:14:54.799909 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:14:54.800568 [info ] [Thread-2 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m07:14:54.801184 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:14:54.801761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m07:14:54.802283 [info ] [Thread-3 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m07:14:54.802875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m07:14:54.803369 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m07:14:54.803916 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:14:54.804446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m07:14:54.804935 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:14:54.805439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m07:14:54.810551 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:14:54.810935 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:14:54.815960 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:14:54.816360 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:14:54.819822 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:14:54.823327 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:14:54.823907 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:14:54.826237 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:14:54.826557 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:14:54.828622 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:14:54.829201 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:14:54.829495 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:14:54.831570 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:14:54.833813 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:14:54.834375 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:14:54.835066 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:14:54.835755 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m07:14:54.836489 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:14:54.836829 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m07:14:54.837208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:14:54.837659 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:14:54.839651 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m07:14:54.838361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:14:54.838003 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m07:14:54.840151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:54.841578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:14:55.353939 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m07:14:55.358017 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m07:14:55.375836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m07:14:55.378458 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m07:14:55.382734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m07:14:55.385402 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m07:14:55.386345 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m07:14:55.389269 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m07:14:55.547703 [info ] [Thread-4 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.74s]
[0m07:14:55.549494 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:14:55.550451 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:14:55.551410 [info ] [Thread-4 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m07:14:55.552544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m07:14:55.553236 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:14:55.566045 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:14:55.567765 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:14:55.570635 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:14:55.572280 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:14:55.572734 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:55.573190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:14:55.592148 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.79s]
[0m07:14:55.593050 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.79s]
[0m07:14:55.593525 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:14:55.594049 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:14:55.594737 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.79s]
[0m07:14:55.595400 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:14:55.595820 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:14:55.596292 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:14:55.596650 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m07:14:55.597245 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m07:14:55.597715 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:14:55.598163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m07:14:55.598573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m07:14:55.598960 [info ] [Thread-2 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m07:14:55.599418 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:14:55.599853 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:14:55.600234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m07:14:55.606131 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:14:55.613005 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:14:55.613675 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:14:55.620136 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:14:55.621297 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:14:55.624059 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:14:55.624512 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:14:55.628324 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:14:55.628756 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:14:55.631096 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:14:55.632132 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:14:55.632758 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:55.633414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:14:55.634348 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:14:55.636204 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:55.636911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:55.637767 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:14:55.639412 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:55.639803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:14:56.549373 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.909 seconds
[0m07:14:56.552901 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m07:14:56.556623 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.983 seconds
[0m07:14:56.560211 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m07:14:56.625283 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m07:14:56.626855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m07:14:56.630759 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m07:14:56.633659 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m07:14:56.743430 [info ] [Thread-2 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 1.14s]
[0m07:14:56.746277 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:14:56.747177 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:14:56.747986 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m07:14:56.749190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m07:14:56.750582 [info ] [Thread-4 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 1.20s]
[0m07:14:56.751607 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:14:56.752573 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:14:56.760222 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:14:56.760803 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:14:56.761641 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m07:14:56.762379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m07:14:56.762923 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:14:56.764561 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:14:56.769177 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:14:56.773243 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:14:56.775108 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:14:56.775475 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:14:56.775832 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:56.843913 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:14:56.844860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:14:56.845720 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.25s]
[0m07:14:56.846531 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 1.25s]
[0m07:14:56.848382 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:14:56.849195 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:14:56.849762 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:14:56.850527 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:14:56.850967 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:14:56.851414 [info ] [Thread-1 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m07:14:56.851970 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:56.852439 [info ] [Thread-3 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m07:14:56.853206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m07:14:56.853631 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:14:56.854007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m07:14:56.854412 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:14:56.855779 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:14:56.859918 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:14:56.865069 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:14:56.866619 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:14:56.866947 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:14:56.868936 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:14:56.870933 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:14:56.872205 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:14:56.872588 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m07:14:56.873403 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:14:56.873710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:14:56.874081 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:14:56.875665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:57.419692 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m07:14:57.423207 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m07:14:57.478783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m07:14:57.483905 [debug] [Thread-3 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m07:14:57.486914 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m07:14:57.488994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m07:14:57.491094 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m07:14:57.492977 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m07:14:57.633248 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.88s]
[0m07:14:57.635256 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:14:57.680059 [info ] [Thread-3 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.83s]
[0m07:14:57.682605 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:14:57.695975 [info ] [Thread-1 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.84s]
[0m07:14:57.698102 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.94s]
[0m07:14:57.699679 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:14:57.700720 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:14:57.703857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:57.704482 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m07:14:57.705033 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m07:14:57.705548 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m07:14:57.706023 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m07:14:57.706506 [info ] [MainThread]: 
[0m07:14:57.707289 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m07:14:57.709974 [debug] [MainThread]: Command end result
[0m07:14:57.751523 [info ] [MainThread]: 
[0m07:14:57.752195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:57.752621 [info ] [MainThread]: 
[0m07:14:57.753038 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m07:14:57.753872 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.598739, "process_user_time": 4.057741, "process_kernel_time": 0.256946, "process_mem_max_rss": "213752", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m07:14:57.754294 [debug] [MainThread]: Command `dbt test` succeeded at 07:14:57.754229 after 6.60 seconds
[0m07:14:57.754608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa771c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8f0d40>]}
[0m07:14:57.754892 [debug] [MainThread]: Flushing usage events
[0m07:15:02.919124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae28b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da885f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6c7320>]}


============================== 07:15:02.924707 | 4802a940-136c-44a0-9017-e3940c240dc2 ==============================
[0m07:15:02.924707 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:15:02.925442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:15:03.538003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60bec2c0>]}
[0m07:15:03.577035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60bec350>]}
[0m07:15:03.577684 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:15:03.649063 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:15:03.784380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:15:03.784797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:15:03.824573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f2d4830>]}
[0m07:15:03.931919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef170b0>]}
[0m07:15:03.932424 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:15:03.933003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f34a4b0>]}
[0m07:15:03.935101 [info ] [MainThread]: 
[0m07:15:03.935716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:15:03.939659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:15:03.947547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:15:03.952850 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:15:03.954736 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:15:03.955157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:15:03.955530 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:15:03.955890 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:15:03.957688 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:15:03.958033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:03.958382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:03.958713 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:15:03.962185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:04.591840 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m07:15:04.595992 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m07:15:04.600998 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.643 seconds
[0m07:15:04.604775 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m07:15:04.606056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.644 seconds
[0m07:15:04.609464 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m07:15:04.816750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4802a940-136c-44a0-9017-e3940c240dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5edd0e30>]}
[0m07:15:04.817539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:15:04.818388 [info ] [MainThread]: 
[0m07:15:04.827777 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:15:04.828198 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:15:04.828547 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:15:04.828907 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m07:15:04.829303 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:15:04.829623 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m07:15:04.830050 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m07:15:04.830555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m07:15:04.830950 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m07:15:04.831393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m07:15:04.831807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m07:15:04.832197 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:15:04.832654 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m07:15:04.833018 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:15:04.833452 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:15:04.846632 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:15:04.846987 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:15:04.850381 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:15:04.854588 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:15:04.857904 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:15:04.859613 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:15:04.872584 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:15:04.872946 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:15:04.875953 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:15:04.876306 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:15:04.878313 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:15:04.880249 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:15:04.882369 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:15:04.883471 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m07:15:04.883900 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m07:15:04.884414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:04.884957 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m07:15:04.886642 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m07:15:04.887240 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m07:15:04.887766 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m07:15:04.888064 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:15:04.888454 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m07:15:04.888932 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m07:15:04.890208 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:04.890786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:05.438077 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m07:15:05.440431 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m07:15:05.447324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m07:15:05.454106 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m07:15:05.456804 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m07:15:05.457659 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m07:15:05.459401 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m07:15:05.465261 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m07:15:05.685475 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.85s]
[0m07:15:05.689684 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m07:15:05.694050 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:15:05.691625 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.86s]
[0m07:15:05.693395 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.86s]
[0m07:15:05.695416 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m07:15:05.696752 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.87s]
[0m07:15:05.697821 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m07:15:05.698675 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m07:15:05.699330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m07:15:05.700001 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m07:15:05.700607 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:15:05.701212 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:15:05.701717 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:15:05.702288 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:15:05.702805 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m07:15:05.703532 [info ] [Thread-4 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m07:15:05.705219 [info ] [Thread-1 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m07:15:05.709305 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:15:05.709750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m07:15:05.710267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m07:15:05.710740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m07:15:05.711418 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:15:05.711854 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:15:05.712320 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:15:05.715933 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:15:05.716271 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:15:05.720987 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:15:05.724182 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:15:05.726395 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:15:05.727204 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:15:05.729486 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:15:05.729989 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:15:05.732020 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:15:05.732349 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:15:05.734487 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:15:05.735056 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m07:15:05.735582 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m07:15:05.736173 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m07:15:05.736782 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m07:15:05.737092 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m07:15:05.737814 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m07:15:05.738102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:05.738484 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m07:15:05.738824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:05.739172 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m07:15:05.740512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:05.742036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:06.322395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m07:15:06.325261 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m07:15:06.357193 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m07:15:06.358289 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m07:15:06.360634 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m07:15:06.361795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m07:15:06.363571 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m07:15:06.366632 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m07:15:06.512097 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.80s]
[0m07:15:06.513873 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m07:15:06.514717 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:15:06.515446 [info ] [Thread-3 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m07:15:06.516402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m07:15:06.517057 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:15:06.527501 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:15:06.528999 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:15:06.531479 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:15:06.533102 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m07:15:06.533589 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:06.534042 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:06.554715 [info ] [Thread-4 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.84s]
[0m07:15:06.555801 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m07:15:06.556342 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:15:06.556746 [info ] [Thread-4 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m07:15:06.557495 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.86s]
[0m07:15:06.557903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m07:15:06.558428 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m07:15:06.558812 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:15:06.559260 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:15:06.565659 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:15:06.566125 [info ] [Thread-2 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m07:15:06.566754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m07:15:06.567156 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:15:06.571561 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:15:06.572061 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:15:06.574132 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:15:06.574723 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:15:06.576645 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:15:06.578083 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m07:15:06.578872 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.87s]
[0m07:15:06.579276 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:06.579820 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m07:15:06.580556 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m07:15:06.580940 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:06.581371 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:15:06.581760 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:06.583229 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m07:15:06.583966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:06.584422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m07:15:06.585749 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:15:06.590432 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:15:06.591488 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:15:06.593510 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:15:06.594825 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m07:15:06.595237 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:06.595602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:07.065588 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m07:15:07.070710 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m07:15:07.098039 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m07:15:07.103672 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m07:15:07.106390 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m07:15:07.109060 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m07:15:07.113272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m07:15:07.115190 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m07:15:07.259296 [info ] [Thread-3 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.74s]
[0m07:15:07.261409 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m07:15:07.262310 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:15:07.263074 [info ] [Thread-3 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m07:15:07.264173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m07:15:07.264821 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:15:07.271855 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:15:07.273503 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:15:07.276154 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:15:07.277771 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m07:15:07.278231 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:07.278717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:07.315439 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.73s]
[0m07:15:07.316439 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m07:15:07.317006 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:15:07.317474 [info ] [Thread-1 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m07:15:07.318053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m07:15:07.318547 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:15:07.323600 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:15:07.325477 [info ] [Thread-4 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.77s]
[0m07:15:07.326287 [info ] [Thread-2 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.76s]
[0m07:15:07.326781 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m07:15:07.327094 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:15:07.327539 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m07:15:07.327973 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:15:07.331468 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:15:07.331895 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:15:07.332295 [info ] [Thread-4 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m07:15:07.332880 [info ] [Thread-2 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m07:15:07.333429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m07:15:07.333881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m07:15:07.334710 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m07:15:07.335001 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:15:07.335410 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:15:07.335789 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:07.389336 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:15:07.394433 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:15:07.395086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:07.397524 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:15:07.397917 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:15:07.400074 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:15:07.402069 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:15:07.403971 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m07:15:07.404418 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:15:07.404882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:07.405503 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m07:15:07.406976 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:07.407551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:07.783817 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m07:15:07.787155 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m07:15:07.911030 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m07:15:07.916011 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m07:15:07.917439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m07:15:07.918360 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m07:15:07.922895 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m07:15:07.926332 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m07:15:08.020849 [info ] [Thread-3 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.76s]
[0m07:15:08.021826 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m07:15:08.113965 [info ] [Thread-4 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.78s]
[0m07:15:08.116344 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m07:15:08.117617 [info ] [Thread-2 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.78s]
[0m07:15:08.118786 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m07:15:08.119989 [info ] [Thread-1 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.80s]
[0m07:15:08.121135 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m07:15:08.123319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:08.123728 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m07:15:08.124168 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m07:15:08.124544 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m07:15:08.124921 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m07:15:08.125378 [info ] [MainThread]: 
[0m07:15:08.126038 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m07:15:08.128503 [debug] [MainThread]: Command end result
[0m07:15:08.170033 [info ] [MainThread]: 
[0m07:15:08.170533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:15:08.170854 [info ] [MainThread]: 
[0m07:15:08.171243 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m07:15:08.171976 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.288133, "process_user_time": 4.01579, "process_kernel_time": 0.213316, "process_mem_max_rss": "213996", "process_out_blocks": "2790", "process_in_blocks": "0"}
[0m07:15:08.172477 [debug] [MainThread]: Command `dbt test` succeeded at 07:15:08.172380 after 5.29 seconds
[0m07:15:08.172857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f9cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f0bc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc23dd0>]}
[0m07:15:08.173277 [debug] [MainThread]: Flushing usage events
[0m07:36:32.156389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb158bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22a78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1588890>]}


============================== 07:36:32.180161 | bfb512ac-46fb-4e7a-8a1b-528f57725d25 ==============================
[0m07:36:32.180161 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:36:32.180903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:36:34.381568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfb512ac-46fb-4e7a-8a1b-528f57725d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e29100>]}
[0m07:36:34.427187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfb512ac-46fb-4e7a-8a1b-528f57725d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b7fe60>]}
[0m07:36:34.428065 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:36:34.524985 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:36:34.704407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:34.704975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:34.769245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfb512ac-46fb-4e7a-8a1b-528f57725d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9738b5f0>]}
[0m07:36:34.822216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfb512ac-46fb-4e7a-8a1b-528f57725d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95397380>]}
[0m07:36:34.822844 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:36:34.823345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfb512ac-46fb-4e7a-8a1b-528f57725d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9589f380>]}
[0m07:36:34.826193 [info ] [MainThread]: 
[0m07:36:34.826903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:36:34.832203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:36:34.842100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:36:34.859389 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:36:34.861272 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:36:34.861803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:36:34.862163 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:34.862716 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:34.865095 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:36:34.865630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:34.866073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:34.866534 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:34.872974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:38.330499 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:38.332805 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.342092 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:38.342497 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.344308 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:36:38.349720 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:38.350098 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.350475 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:38.350765 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.351086 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:36:38.353972 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:38.354277 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.354584 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:38.354872 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:38.355151 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:36:38.355707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:38.355993 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:36:38.356243 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:36:38.356507 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:36:38.357022 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m07:36:38.358001 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 6.2401547, "process_user_time": 6.420221, "process_kernel_time": 1.057906, "process_mem_max_rss": "218276", "process_in_blocks": "64", "process_out_blocks": "38021", "command_success": false}
[0m07:36:38.358605 [debug] [MainThread]: Command `dbt docs generate` failed at 07:36:38.358515 after 6.24 seconds
[0m07:36:38.358965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9589fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95294b90>]}
[0m07:36:38.359369 [debug] [MainThread]: Flushing usage events
[0m07:36:43.215701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f44a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891facc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b0fce0>]}


============================== 07:36:43.221280 | 129e4da2-b4ec-4dbe-9e56-e0778593444b ==============================
[0m07:36:43.221280 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:36:43.221783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:36:43.849397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129e4da2-b4ec-4dbe-9e56-e0778593444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89577440>]}
[0m07:36:43.890154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129e4da2-b4ec-4dbe-9e56-e0778593444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e553cb0>]}
[0m07:36:43.890836 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:36:43.967050 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:36:44.091107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:44.091497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:44.132236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129e4da2-b4ec-4dbe-9e56-e0778593444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d618fb0>]}
[0m07:36:44.144805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129e4da2-b4ec-4dbe-9e56-e0778593444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d175280>]}
[0m07:36:44.145191 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:36:44.145501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e4da2-b4ec-4dbe-9e56-e0778593444b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d61a840>]}
[0m07:36:44.147495 [info ] [MainThread]: 
[0m07:36:44.147967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:36:44.151803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:36:44.162270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:36:44.167987 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:36:44.169774 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:36:44.170177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:36:44.170500 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:44.170838 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:44.172492 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:36:44.172807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:44.173083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:44.173357 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:44.178259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:44.631472 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:44.631936 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.632365 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:44.632700 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.633028 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:36:44.634689 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:44.635025 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.635349 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:44.635636 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.635924 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:36:44.648789 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:44.649079 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.649344 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:44.649571 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:44.649793 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:36:44.650212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:44.650488 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:36:44.650702 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:36:44.650892 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:36:44.651216 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m07:36:44.651997 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.4719014, "process_user_time": 3.018883, "process_kernel_time": 0.162316, "process_mem_max_rss": "207636", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:36:44.652518 [debug] [MainThread]: Command `dbt docs generate` failed at 07:36:44.652428 after 1.47 seconds
[0m07:36:44.652857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89574260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d651fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d09f2f0>]}
[0m07:36:44.653190 [debug] [MainThread]: Flushing usage events
[0m07:36:49.299373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca93800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e095a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d357b30>]}


============================== 07:36:49.305010 | 91a28d17-b3e1-439d-a7ac-e9896922c606 ==============================
[0m07:36:49.305010 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:36:49.305540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m07:36:49.942005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a28d17-b3e1-439d-a7ac-e9896922c606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be82d20>]}
[0m07:36:49.981940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a28d17-b3e1-439d-a7ac-e9896922c606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c258b00>]}
[0m07:36:49.982635 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:36:50.056907 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:36:50.189616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:50.190019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:50.230012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a28d17-b3e1-439d-a7ac-e9896922c606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607e38c0>]}
[0m07:36:50.246501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a28d17-b3e1-439d-a7ac-e9896922c606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6031ef90>]}
[0m07:36:50.247047 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:36:50.247611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a28d17-b3e1-439d-a7ac-e9896922c606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff605c8860>]}
[0m07:36:50.250375 [info ] [MainThread]: 
[0m07:36:50.251237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:36:50.255799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:36:50.256528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:36:50.274682 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:36:50.275578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:36:50.279689 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:36:50.280984 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:50.328863 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:36:50.337577 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:50.330788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:50.330067 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:50.339484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:50.350928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:50.665696 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:50.666503 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:50.666874 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.667685 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.668318 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:50.668682 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:50.669083 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:50.669437 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.669736 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.670048 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.670395 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:50.670725 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:36:50.671052 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:36:50.671352 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:50.672266 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:36:50.672762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:50.673019 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:36:50.673266 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:36:50.673560 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:36:50.673934 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:36:50.674657 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.411166, "process_user_time": 3.178417, "process_kernel_time": 0.196528, "process_mem_max_rss": "207668", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:36:50.675104 [debug] [MainThread]: Command `dbt docs generate` failed at 07:36:50.675031 after 1.41 seconds
[0m07:36:50.675416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be82b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6081b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603dfbf0>]}
[0m07:36:50.675746 [debug] [MainThread]: Flushing usage events
[0m07:36:55.476850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf312b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad30890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad33b00>]}


============================== 07:36:55.482468 | 51563bf7-2589-4c49-b1af-7bc19a679d4f ==============================
[0m07:36:55.482468 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:36:55.482967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:36:56.120190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51563bf7-2589-4c49-b1af-7bc19a679d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9079aae0>]}
[0m07:36:56.160376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51563bf7-2589-4c49-b1af-7bc19a679d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f581970>]}
[0m07:36:56.161112 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:36:56.237171 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:36:56.365835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:56.366243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:56.406339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51563bf7-2589-4c49-b1af-7bc19a679d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee34da0>]}
[0m07:36:56.419285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51563bf7-2589-4c49-b1af-7bc19a679d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f438e00>]}
[0m07:36:56.419831 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:36:56.420171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51563bf7-2589-4c49-b1af-7bc19a679d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f02de80>]}
[0m07:36:56.423351 [info ] [MainThread]: 
[0m07:36:56.424003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:36:56.428662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:36:56.438033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:36:56.443858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:36:56.449456 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:36:56.452308 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:36:56.453590 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:36:56.454020 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:56.454348 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:56.454666 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:56.454948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:56.455216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:56.455474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:56.810197 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:36:56.811172 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:36:56.811537 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.812767 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:36:56.813042 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.813464 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:56.813816 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.814202 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:56.814522 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.814889 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:36:56.815179 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.815512 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:36:56.815800 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:36:56.816100 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:36:56.816910 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:36:56.817585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:56.817843 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:36:56.818094 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:36:56.818327 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:36:56.818716 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:36:56.819530 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.3785212, "process_user_time": 3.055829, "process_kernel_time": 0.18095, "process_mem_max_rss": "207768", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:36:56.820128 [debug] [MainThread]: Command `dbt docs generate` failed at 07:36:56.819996 after 1.38 seconds
[0m07:36:56.820482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5d81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec1ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9283b0>]}
[0m07:36:56.820810 [debug] [MainThread]: Flushing usage events
[0m07:37:01.860880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dcd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6be83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dcd790>]}


============================== 07:37:01.866553 | bd1a7f51-be92-477a-838d-b65d27af45b6 ==============================
[0m07:37:01.866553 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:37:01.867116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:37:02.498350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd1a7f51-be92-477a-838d-b65d27af45b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88430a70>]}
[0m07:37:02.539825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd1a7f51-be92-477a-838d-b65d27af45b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a217080>]}
[0m07:37:02.540613 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:37:02.615969 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:37:02.744357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:02.744840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:02.784896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd1a7f51-be92-477a-838d-b65d27af45b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884ddbe0>]}
[0m07:37:02.797114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd1a7f51-be92-477a-838d-b65d27af45b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884df440>]}
[0m07:37:02.797533 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:37:02.797909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd1a7f51-be92-477a-838d-b65d27af45b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883f4530>]}
[0m07:37:02.800046 [info ] [MainThread]: 
[0m07:37:02.800573 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:37:02.804274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:37:02.812861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:37:02.823788 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:37:02.825802 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:37:02.826090 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:02.826471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:37:02.826823 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:02.827172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:02.829878 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:37:02.830187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:02.832441 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:02.834557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:03.139335 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:03.139787 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.140138 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:03.140417 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.140766 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:37:03.142398 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:03.143160 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.143736 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:03.144032 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:03.144453 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.144760 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.145095 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:03.145411 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:37:03.145729 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:03.146250 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:37:03.146690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:03.146937 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:37:03.147181 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:37:03.147409 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:37:03.147783 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:37:03.148487 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.3230519, "process_user_time": 3.058367, "process_kernel_time": 0.160428, "process_mem_max_rss": "207536", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:37:03.148963 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:03.148893 after 1.32 seconds
[0m07:37:03.149264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d83ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8851a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880e9790>]}
[0m07:37:03.149587 [debug] [MainThread]: Flushing usage events
[0m07:37:09.024457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b098e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa338e480>]}


============================== 07:37:09.030030 | a99dcef4-3c15-493a-b2fd-d2e7980e32db ==============================
[0m07:37:09.030030 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:37:09.030566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:37:09.644702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99dcef4-3c15-493a-b2fd-d2e7980e32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941d20f0>]}
[0m07:37:09.685134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a99dcef4-3c15-493a-b2fd-d2e7980e32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941d1dc0>]}
[0m07:37:09.685825 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:37:09.759118 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:37:09.886103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:09.886492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:09.926210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a99dcef4-3c15-493a-b2fd-d2e7980e32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa090dee0>]}
[0m07:37:09.938759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a99dcef4-3c15-493a-b2fd-d2e7980e32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d712b0>]}
[0m07:37:09.939168 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:37:09.939497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99dcef4-3c15-493a-b2fd-d2e7980e32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8516a840>]}
[0m07:37:09.941500 [info ] [MainThread]: 
[0m07:37:09.941981 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:37:09.945733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:37:09.955863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:37:09.961373 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:37:09.963102 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:37:09.963502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:37:09.963799 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:09.964152 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:09.965875 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:37:09.966198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:09.966510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:09.966817 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:09.971473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:10.291324 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:10.292237 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:10.292658 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.293085 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.293598 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:10.294705 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:10.295552 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:10.295883 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.296217 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.296580 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.296984 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:37:10.297339 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:37:10.297750 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:10.298725 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:10.299049 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:37:10.299589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:10.299884 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:37:10.300163 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:37:10.300458 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:37:10.300924 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:37:10.301865 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.3127812, "process_user_time": 2.987598, "process_kernel_time": 0.155926, "process_mem_max_rss": "207724", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:37:10.302451 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:10.302342 after 1.31 seconds
[0m07:37:10.302843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa503bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852518e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e01310>]}
[0m07:37:10.303225 [debug] [MainThread]: Flushing usage events
[0m07:37:17.710041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97aa48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9865af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97aa4170>]}


============================== 07:37:17.715636 | afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4 ==============================
[0m07:37:17.715636 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:37:17.716113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:37:18.340621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97af4080>]}
[0m07:37:18.380107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c517e90>]}
[0m07:37:18.380738 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:37:18.454092 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:37:18.579538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:18.579905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:18.621736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3e3260>]}
[0m07:37:18.633781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf3d940>]}
[0m07:37:18.634186 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:37:18.634542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb5ec95-7184-4843-8b0d-ab2b2b2d1ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ce0fe0>]}
[0m07:37:18.636615 [info ] [MainThread]: 
[0m07:37:18.637059 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:37:18.640693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:37:18.648882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:37:18.659996 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:37:18.661446 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:37:18.661858 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:18.662249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:37:18.662601 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:18.662935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:18.665418 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:37:18.665753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:18.666967 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:18.669602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:19.181716 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:19.182347 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.182823 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:19.183188 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.183600 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:37:19.189119 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:19.189538 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.189939 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:19.190281 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.190718 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:37:19.231131 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:19.231725 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.232185 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:19.232561 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:19.232943 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:37:19.233594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:19.233940 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:37:19.234255 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:37:19.234596 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:37:19.235126 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:37:19.236200 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.5614164, "process_user_time": 3.067405, "process_kernel_time": 0.143597, "process_mem_max_rss": "207376", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:37:19.236968 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:19.236866 after 1.56 seconds
[0m07:37:19.237495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9865af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c41b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cba7980>]}
[0m07:37:19.237870 [debug] [MainThread]: Flushing usage events
[0m07:37:29.835317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f91d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f91d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f91d700>]}


============================== 07:37:29.840860 | 3fe77149-135b-475a-9c13-2db3b45f7aa4 ==============================
[0m07:37:29.840860 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:37:29.841374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:30.464372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fe77149-135b-475a-9c13-2db3b45f7aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f91f9e0>]}
[0m07:37:30.503981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fe77149-135b-475a-9c13-2db3b45f7aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff647b9970>]}
[0m07:37:30.504616 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:37:30.579266 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:37:30.711084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:30.711501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:30.751224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fe77149-135b-475a-9c13-2db3b45f7aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6403cfb0>]}
[0m07:37:30.763118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fe77149-135b-475a-9c13-2db3b45f7aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63b990a0>]}
[0m07:37:30.763518 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:37:30.763802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe77149-135b-475a-9c13-2db3b45f7aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64075f70>]}
[0m07:37:30.765792 [info ] [MainThread]: 
[0m07:37:30.766308 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:37:30.770088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:37:30.778922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:37:30.787222 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:37:30.785665 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:37:30.787981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:37:30.788241 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:30.788622 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:30.790318 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:37:30.790672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:30.790945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:30.791245 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:30.795794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:31.110319 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:31.110993 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.111587 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:31.112049 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.112523 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:37:31.114335 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:31.114817 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.115304 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:31.115756 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.116146 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:37:31.146691 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:31.147171 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.147685 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:31.148106 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:31.148622 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:37:31.149364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:31.149786 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:37:31.150189 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:37:31.150562 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:37:31.151130 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:37:31.152049 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.3520938, "process_user_time": 3.016336, "process_kernel_time": 0.16023, "process_mem_max_rss": "207720", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:37:31.152660 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:31.152563 after 1.35 seconds
[0m07:37:31.153077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d12390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f50260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6422c4d0>]}
[0m07:37:31.153547 [debug] [MainThread]: Flushing usage events
[0m07:37:48.133775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a8f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847eebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844a28a0>]}


============================== 07:37:48.139451 | d8760db6-d456-4281-a764-0955a5e0cbf1 ==============================
[0m07:37:48.139451 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:37:48.139950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m07:37:48.753956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8760db6-d456-4281-a764-0955a5e0cbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d33410>]}
[0m07:37:48.793340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8760db6-d456-4281-a764-0955a5e0cbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68e29f40>]}
[0m07:37:48.793974 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:37:48.865528 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:37:48.991058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:48.991455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:49.031399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8760db6-d456-4281-a764-0955a5e0cbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6edd2360>]}
[0m07:37:49.043254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8760db6-d456-4281-a764-0955a5e0cbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ccd310>]}
[0m07:37:49.043678 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:37:49.044015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8760db6-d456-4281-a764-0955a5e0cbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68978e00>]}
[0m07:37:49.046070 [info ] [MainThread]: 
[0m07:37:49.046545 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:37:49.050167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:37:49.058735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:37:49.069597 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:37:49.071158 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:37:49.071556 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:49.071936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:37:49.072292 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:49.072652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:49.075286 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:37:49.075663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:49.077871 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:49.079451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:49.451411 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:37:49.452786 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:37:49.453334 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.454084 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:37:49.454601 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.455091 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:49.455555 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.456034 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:49.456478 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.456942 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:37:49.457359 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.457812 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:37:49.458212 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:37:49.458647 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:37:49.459501 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:37:49.460314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:49.460609 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:37:49.460890 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:37:49.461154 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:37:49.461645 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:37:49.462509 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.3709259, "process_user_time": 3.01998, "process_kernel_time": 0.165272, "process_mem_max_rss": "207344", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:37:49.463037 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:49.462952 after 1.37 seconds
[0m07:37:49.463426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872c5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68bd21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6877a3c0>]}
[0m07:37:49.463846 [debug] [MainThread]: Flushing usage events
[0m07:38:19.315724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4b3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce6d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc748c0>]}


============================== 07:38:19.321471 | 93b5c35f-c740-4fe0-ab78-b43d579c1e21 ==============================
[0m07:38:19.321471 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:38:19.321984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:38:19.934619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b5c35f-c740-4fe0-ab78-b43d579c1e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc9b350>]}
[0m07:38:19.974178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b5c35f-c740-4fe0-ab78-b43d579c1e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777e9010>]}
[0m07:38:19.974788 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m07:38:20.048785 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:38:20.178493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:20.178868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:20.218862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b5c35f-c740-4fe0-ab78-b43d579c1e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715df260>]}
[0m07:38:20.230956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b5c35f-c740-4fe0-ab78-b43d579c1e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715ddbb0>]}
[0m07:38:20.231456 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m07:38:20.231826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b5c35f-c740-4fe0-ab78-b43d579c1e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7155e870>]}
[0m07:38:20.233917 [info ] [MainThread]: 
[0m07:38:20.234405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:38:20.238076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m07:38:20.246471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m07:38:20.257510 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m07:38:20.259223 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m07:38:20.259609 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:38:20.259982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m07:38:20.260319 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:38:20.260723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:20.263347 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m07:38:20.263659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:20.265860 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:38:20.267486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:20.637139 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m07:38:20.637810 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.638376 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:38:20.638826 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.640343 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m07:38:20.640776 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: No close available on handle
[0m07:38:20.641267 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.643848 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:38:20.644306 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.644723 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: No close available on handle
[0m07:38:20.685538 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m07:38:20.685991 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.686421 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:38:20.686756 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:38:20.687147 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: No close available on handle
[0m07:38:20.687719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:20.688000 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_ANALYTICS' was properly closed.
[0m07:38:20.689343 [debug] [MainThread]: Connection 'list_RETAIL_DW_ANALYTICS' was properly closed.
[0m07:38:20.689679 [debug] [MainThread]: Connection 'list_RETAIL_DW_STAGING_STAGING' was properly closed.
[0m07:38:20.690130 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: PIITFVT-FW65290.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m07:38:20.691017 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.4104401, "process_user_time": 3.025918, "process_kernel_time": 0.16443, "process_mem_max_rss": "207688", "process_out_blocks": "101", "command_success": false, "process_in_blocks": "0"}
[0m07:38:20.691531 [debug] [MainThread]: Command `dbt docs generate` failed at 07:38:20.691447 after 1.41 seconds
[0m07:38:20.691862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceb0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71619910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f94b90>]}
[0m07:38:20.692199 [debug] [MainThread]: Flushing usage events
[0m07:50:58.743100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6d5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90ff6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90b8bf0>]}


============================== 07:50:58.763147 | 90ea2813-6e44-4a36-81db-8ae98779feaa ==============================
[0m07:50:58.763147 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:50:58.763679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8081 --no-browser', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:51:00.745514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ea2813-6e44-4a36-81db-8ae98779feaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8dbec0>]}
[0m07:51:00.785672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90ea2813-6e44-4a36-81db-8ae98779feaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85c1d30>]}
[0m08:03:29.689959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb208c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f37dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef25f40>]}


============================== 08:03:29.713070 | f42443aa-1d75-434b-bd5f-f10084200584 ==============================
[0m08:03:29.713070 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:03:29.713849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:03:29.800475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42443aa-1d75-434b-bd5f-f10084200584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3167140>]}
[0m08:03:29.895076 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-drwlrlnr'
[0m08:03:29.895608 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:03:30.022367 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:03:30.023222 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:03:30.079003 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:03:30.084896 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:03:30.729672 [info ] [MainThread]: Installed from version 1.3.0
[0m08:03:30.730425 [info ] [MainThread]: Updated version available: 1.3.3
[0m08:03:30.730897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f42443aa-1d75-434b-bd5f-f10084200584', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eebac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e844da0>]}
[0m08:03:30.731367 [info ] [MainThread]: 
[0m08:03:30.731814 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m08:03:30.732781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0840464, "process_user_time": 1.949772, "process_kernel_time": 0.172751, "process_mem_max_rss": "171120", "process_out_blocks": "5550", "process_in_blocks": "0"}
[0m08:03:30.733312 [debug] [MainThread]: Command `dbt deps` succeeded at 08:03:30.733219 after 1.08 seconds
[0m08:03:30.733685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb208c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3167140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea35c40>]}
[0m08:03:30.734039 [debug] [MainThread]: Flushing usage events
[0m08:03:33.194538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa781580>]}


============================== 08:03:33.203101 | 92fe2a19-6484-40f2-ad61-09908e76be64 ==============================
[0m08:03:33.203101 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:03:33.203885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:03:34.919353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb842c0>]}
[0m08:03:34.960194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90490b30>]}
[0m08:03:34.960973 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:03:35.035752 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:03:35.177994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:35.178405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:35.218213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb840e0>]}
[0m08:03:35.321306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8fcfe0>]}
[0m08:03:35.321774 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:03:35.322382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2d6de0>]}
[0m08:03:35.324444 [info ] [MainThread]: 
[0m08:03:35.325079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:03:35.328819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:03:35.336714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:03:35.340995 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:03:35.342790 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:03:35.343188 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:03:35.343555 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:03:35.343895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:35.344249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:37.324886 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.980 seconds
[0m08:03:37.326567 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.983 seconds
[0m08:03:37.330046 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:03:37.332641 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:03:37.558948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m08:03:37.559617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m08:03:37.566730 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:03:37.568839 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:03:37.569294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m08:03:37.569693 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:03:37.570066 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:03:37.572692 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:03:37.573101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:37.573515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:37.573874 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:03:37.576823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:38.120556 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.547 seconds
[0m08:03:38.124712 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:03:38.127838 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.551 seconds
[0m08:03:38.131374 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:03:38.132459 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.559 seconds
[0m08:03:38.135862 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:03:38.353966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9cb2540>]}
[0m08:03:38.355272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:38.356201 [info ] [MainThread]: 
[0m08:03:38.367537 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:03:38.368009 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:03:38.368684 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:03:38.369154 [info ] [Thread-1 (]: 1 of 12 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m08:03:38.369574 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:03:38.370009 [info ] [Thread-2 (]: 2 of 12 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m08:03:38.370542 [info ] [Thread-3 (]: 3 of 12 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m08:03:38.371054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m08:03:38.371515 [info ] [Thread-4 (]: 4 of 12 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m08:03:38.372603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m08:03:38.372984 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m08:03:38.373388 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:03:38.373848 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:03:38.374234 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:03:38.374606 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:03:38.380245 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:03:38.380683 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:03:38.383030 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:03:38.385301 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:03:38.387777 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:03:38.390017 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:03:38.403432 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:03:38.414217 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m08:03:38.420577 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:03:38.431735 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m08:03:38.432144 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:03:38.435706 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m08:03:38.438422 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:03:38.439749 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m08:03:38.440243 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m08:03:38.440756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:38.441386 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m08:03:38.443084 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m08:03:38.444144 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m08:03:38.444747 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m08:03:38.445196 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m08:03:38.445558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:38.445923 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m08:03:38.446310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:03:38.447875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:39.268556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m08:03:39.270511 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m08:03:39.301110 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m08:03:39.303124 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m08:03:39.304891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m08:03:39.307921 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m08:03:39.540927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab3c470>]}
[0m08:03:39.542602 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d777440>]}
[0m08:03:39.544353 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9bd8b0>]}
[0m08:03:39.545468 [info ] [Thread-2 (]: 2 of 12 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.17s]
[0m08:03:39.546591 [info ] [Thread-4 (]: 4 of 12 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.17s]
[0m08:03:39.547664 [info ] [Thread-3 (]: 3 of 12 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.17s]
[0m08:03:39.548861 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:03:39.549813 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:03:39.550746 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:03:39.551550 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m08:03:39.552426 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m08:03:39.553240 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m08:03:39.554010 [info ] [Thread-2 (]: 5 of 12 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m08:03:39.554829 [info ] [Thread-4 (]: 6 of 12 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m08:03:39.555559 [info ] [Thread-3 (]: 7 of 12 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m08:03:39.556339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m08:03:39.556930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_products)
[0m08:03:39.557495 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m08:03:39.558025 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:03:39.558523 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m08:03:39.559028 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:03:39.562371 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:03:39.565258 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:03:39.567728 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:03:39.569066 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m08:03:39.571473 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m08:03:39.571823 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m08:03:39.572240 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m08:03:39.574495 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m08:03:39.577891 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m08:03:39.578799 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m08:03:39.579187 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m08:03:39.579647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:39.580263 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m08:03:39.580796 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m08:03:39.582238 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m08:03:39.582921 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m08:03:39.583402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:03:39.583750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:40.277159 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m08:03:40.278759 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m08:03:40.283071 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m08:03:40.286383 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m08:03:40.325859 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m08:03:40.329758 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m08:03:40.492234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd3b980>]}
[0m08:03:40.492889 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd3a7e0>]}
[0m08:03:40.493659 [info ] [Thread-2 (]: 5 of 12 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.94s]
[0m08:03:40.494288 [info ] [Thread-4 (]: 6 of 12 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.94s]
[0m08:03:40.495019 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m08:03:40.495585 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m08:03:40.496115 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_customer
[0m08:03:40.496601 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:03:40.497267 [info ] [Thread-2 (]: 8 of 12 START sql table model STAGING_ANALYTICS.dim_customer ................... [RUN]
[0m08:03:40.497986 [info ] [Thread-4 (]: 9 of 12 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m08:03:40.498526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m08:03:40.498950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.fact_inventory_snapshot)
[0m08:03:40.499325 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:03:40.499687 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:03:40.517200 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:03:40.518203 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:03:40.519336 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_customer
[0m08:03:40.521494 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m08:03:40.522000 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:03:40.524060 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:03:40.525385 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m08:03:40.525842 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m08:03:40.526213 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:40.527438 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m08:03:40.528312 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m08:03:40.528774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:03:40.539274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd485c0>]}
[0m08:03:40.539843 [info ] [Thread-3 (]: 7 of 12 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.98s]
[0m08:03:40.540522 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m08:03:40.540930 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m08:03:40.541430 [info ] [Thread-3 (]: 10 of 12 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m08:03:40.541976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m08:03:40.542357 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m08:03:40.545428 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:03:40.546442 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m08:03:40.548536 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m08:03:40.549718 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m08:03:40.550091 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m08:03:40.550436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:40.571062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.130 seconds
[0m08:03:40.572981 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m08:03:40.760751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d717560>]}
[0m08:03:40.761437 [info ] [Thread-1 (]: 1 of 12 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 2.39s]
[0m08:03:40.762207 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:03:40.762652 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_store
[0m08:03:40.763084 [info ] [Thread-1 (]: 11 of 12 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m08:03:40.763576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.dim_store)
[0m08:03:40.763948 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_store
[0m08:03:40.768180 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:03:40.769241 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_store
[0m08:03:40.821680 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m08:03:40.823356 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m08:03:40.823743 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m08:03:40.824112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:41.698774 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.172 seconds
[0m08:03:41.702482 [debug] [Thread-2 (]: On model.retail_dbt.dim_customer: Close
[0m08:03:41.772191 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.221 seconds
[0m08:03:41.777088 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m08:03:41.780706 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m08:03:41.784322 [debug] [Thread-4 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m08:03:41.893085 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd9d280>]}
[0m08:03:41.894778 [info ] [Thread-2 (]: 8 of 12 OK created sql table model STAGING_ANALYTICS.dim_customer .............. [[32mSUCCESS 1[0m in 1.39s]
[0m08:03:41.896818 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_customer
[0m08:03:41.898230 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m08:03:41.899112 [info ] [Thread-2 (]: 12 of 12 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m08:03:41.900002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now model.retail_dbt.fact_sales)
[0m08:03:41.900543 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:03:41.910400 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:03:41.912178 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m08:03:41.915299 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m08:03:41.918483 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m08:03:41.919034 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m08:03:41.919567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:41.992474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd9d5e0>]}
[0m08:03:41.993473 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e08abd0>]}
[0m08:03:41.994298 [info ] [Thread-3 (]: 10 of 12 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.45s]
[0m08:03:41.995062 [info ] [Thread-4 (]: 9 of 12 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.49s]
[0m08:03:41.995903 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m08:03:41.996616 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:03:42.154707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m08:03:42.160670 [debug] [Thread-1 (]: On model.retail_dbt.dim_store: Close
[0m08:03:42.428328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa116cc0>]}
[0m08:03:42.429842 [info ] [Thread-1 (]: 11 of 12 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.66s]
[0m08:03:42.431231 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_store
[0m08:03:43.769894 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.850 seconds
[0m08:03:43.773496 [debug] [Thread-2 (]: On model.retail_dbt.fact_sales: Close
[0m08:03:43.975191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92fe2a19-6484-40f2-ad61-09908e76be64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab0d7c0>]}
[0m08:03:43.976945 [info ] [Thread-2 (]: 12 of 12 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.07s]
[0m08:03:43.978781 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m08:03:43.981529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:43.982216 [debug] [MainThread]: Connection 'model.retail_dbt.dim_product' was properly closed.
[0m08:03:43.982781 [debug] [MainThread]: Connection 'model.retail_dbt.fact_sales' was properly closed.
[0m08:03:43.983315 [debug] [MainThread]: Connection 'model.retail_dbt.dim_store' was properly closed.
[0m08:03:43.983821 [debug] [MainThread]: Connection 'model.retail_dbt.fact_inventory_snapshot' was properly closed.
[0m08:03:43.984610 [info ] [MainThread]: 
[0m08:03:43.985522 [info ] [MainThread]: Finished running 6 view models, 6 table models in 0 hours 0 minutes and 8.66 seconds (8.66s).
[0m08:03:43.987654 [debug] [MainThread]: Command end result
[0m08:03:44.030335 [info ] [MainThread]: 
[0m08:03:44.030841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:44.031181 [info ] [MainThread]: 
[0m08:03:44.031550 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:03:44.032310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.879848, "process_user_time": 5.534932, "process_kernel_time": 0.503539, "process_mem_max_rss": "219668", "process_out_blocks": "26998", "process_in_blocks": "0"}
[0m08:03:44.032787 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:44.032692 after 10.88 seconds
[0m08:03:44.033172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa626480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa780a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaad2ae0>]}
[0m08:03:44.033522 [debug] [MainThread]: Flushing usage events
[0m08:03:46.529457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb526e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a50d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a85340>]}


============================== 08:03:46.535064 | 9f9fa25d-19db-48ea-9969-08c7ddf94851 ==============================
[0m08:03:46.535064 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:03:46.535778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m08:03:47.148637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa095b0>]}
[0m08:03:47.187929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdede50>]}
[0m08:03:47.188601 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:03:47.260521 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:03:47.392938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:47.393343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:47.433144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a54d2e0>]}
[0m08:03:47.542800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997cf950>]}
[0m08:03:47.543314 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:03:47.543916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995e5580>]}
[0m08:03:47.546273 [info ] [MainThread]: 
[0m08:03:47.546948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:03:47.550943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m08:03:47.558794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m08:03:47.564314 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:03:47.566113 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:03:47.566514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m08:03:47.566839 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:03:47.567218 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:03:47.568970 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:03:47.569315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:47.569672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:47.570003 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:03:47.573540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:48.174456 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.601 seconds
[0m08:03:48.178552 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:03:48.184871 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m08:03:48.186210 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.616 seconds
[0m08:03:48.188923 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:03:48.190990 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:03:48.689435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f9fa25d-19db-48ea-9969-08c7ddf94851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99659790>]}
[0m08:03:48.690075 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:48.690639 [info ] [MainThread]: 
[0m08:03:48.698989 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:48.699393 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:48.699757 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:48.700118 [info ] [Thread-1 (]: 1 of 16 START test not_null_fact_inventory_snapshot_date_key ................... [RUN]
[0m08:03:48.700500 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:48.700819 [info ] [Thread-2 (]: 2 of 16 START test not_null_fact_inventory_snapshot_product_key ................ [RUN]
[0m08:03:48.701249 [info ] [Thread-3 (]: 3 of 16 START test not_null_fact_inventory_snapshot_store_key .................. [RUN]
[0m08:03:48.701701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:03:48.702085 [info ] [Thread-4 (]: 4 of 16 START test not_null_fact_sales_customer_key ............................ [RUN]
[0m08:03:48.702526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:03:48.702935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:03:48.703308 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:48.703753 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac'
[0m08:03:48.704126 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:48.704485 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:48.717498 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:03:48.717853 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:48.721071 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:03:48.725134 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:03:48.728586 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:03:48.731843 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:48.732266 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:48.732595 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:48.739369 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:48.749471 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:03:48.751535 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:03:48.753559 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:03:48.755616 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:03:48.757679 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:03:48.758184 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m08:03:48.758739 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:03:48.759106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:48.759642 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:03:48.760147 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:03:48.760451 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m08:03:48.762057 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m08:03:48.762584 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m08:03:48.762985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:48.763327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:48.763662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:03:49.407924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m08:03:49.420849 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m08:03:49.423508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m08:03:49.425712 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m08:03:49.426644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m08:03:49.430065 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m08:03:49.432239 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m08:03:49.434281 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m08:03:49.628826 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fact_inventory_snapshot_product_key ...................... [[32mPASS[0m in 0.93s]
[0m08:03:49.630737 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fact_inventory_snapshot_store_key ........................ [[32mPASS[0m in 0.93s]
[0m08:03:49.632420 [info ] [Thread-1 (]: 1 of 16 PASS not_null_fact_inventory_snapshot_date_key ......................... [[32mPASS[0m in 0.93s]
[0m08:03:49.633847 [info ] [Thread-4 (]: 4 of 16 PASS not_null_fact_sales_customer_key .................................. [[32mPASS[0m in 0.93s]
[0m08:03:49.634787 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:49.635659 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:49.636520 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:49.637359 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:49.638124 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:49.638957 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:49.639766 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:49.640347 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:49.640873 [info ] [Thread-2 (]: 5 of 16 START test not_null_fact_sales_date_key ................................ [RUN]
[0m08:03:49.641515 [info ] [Thread-3 (]: 6 of 16 START test not_null_fact_sales_product_key ............................. [RUN]
[0m08:03:49.642105 [info ] [Thread-1 (]: 7 of 16 START test not_null_fact_sales_sales_line_key .......................... [RUN]
[0m08:03:49.642667 [info ] [Thread-4 (]: 8 of 16 START test not_null_fact_sales_store_key ............................... [RUN]
[0m08:03:49.643303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:03:49.643880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:03:49.644502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:03:49.645100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:03:49.645678 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:49.646154 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:49.646610 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:49.647055 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:49.651723 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:03:49.656425 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:03:49.659533 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:03:49.662582 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:03:49.664470 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:49.666669 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:03:49.667062 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:49.667404 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:49.667806 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:49.669673 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:03:49.671824 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:03:49.674231 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:03:49.675104 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:03:49.675925 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m08:03:49.676546 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:03:49.676853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:49.677442 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:03:49.677881 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m08:03:49.678394 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:03:49.679776 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m08:03:49.680366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:49.680735 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m08:03:49.681175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:49.682498 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:03:50.197653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m08:03:50.202337 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m08:03:50.251414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m08:03:50.256113 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m08:03:50.261298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m08:03:50.264510 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m08:03:50.267332 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m08:03:50.270616 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m08:03:50.398792 [info ] [Thread-2 (]: 5 of 16 PASS not_null_fact_sales_date_key ...................................... [[32mPASS[0m in 0.76s]
[0m08:03:50.399736 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:50.400135 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:50.400537 [info ] [Thread-2 (]: 9 of 16 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m08:03:50.401236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:03:50.401586 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:50.408559 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:03:50.409614 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:50.411867 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:03:50.413092 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:03:50.413463 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:50.413806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:50.448659 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.80s]
[0m08:03:50.449375 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:50.449792 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:50.450189 [info ] [Thread-3 (]: 10 of 16 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m08:03:50.450744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:03:50.451090 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:50.456045 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:03:50.457647 [info ] [Thread-1 (]: 7 of 16 PASS not_null_fact_sales_sales_line_key ................................ [[32mPASS[0m in 0.81s]
[0m08:03:50.458368 [info ] [Thread-4 (]: 8 of 16 PASS not_null_fact_sales_store_key ..................................... [[32mPASS[0m in 0.81s]
[0m08:03:50.458855 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:50.459374 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:50.459808 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:50.460161 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:50.460596 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:50.462690 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:03:50.463084 [info ] [Thread-1 (]: 11 of 16 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m08:03:50.463513 [info ] [Thread-4 (]: 12 of 16 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m08:03:50.464051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:03:50.464484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:03:50.464865 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:50.465689 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:03:50.465992 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:50.470291 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:03:50.470711 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:50.474975 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:03:50.475630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:50.477273 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:50.479575 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:03:50.480060 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:50.481975 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:03:50.483201 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:03:50.483756 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:50.484165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:50.485471 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:03:50.486380 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:50.486890 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:03:51.142198 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m08:03:51.147427 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m08:03:51.155518 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m08:03:51.158637 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m08:03:51.232749 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m08:03:51.236704 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m08:03:51.279251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m08:03:51.281225 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m08:03:51.350889 [info ] [Thread-2 (]: 9 of 16 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.95s]
[0m08:03:51.351812 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:51.352235 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:51.352691 [info ] [Thread-2 (]: 13 of 16 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m08:03:51.353393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:03:51.353802 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:51.358333 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:03:51.359356 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:51.361522 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:03:51.362792 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:03:51.363205 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:51.363564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:03:51.376779 [info ] [Thread-4 (]: 12 of 16 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.91s]
[0m08:03:51.377498 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:51.377945 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:51.378379 [info ] [Thread-4 (]: 14 of 16 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m08:03:51.378928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:03:51.379324 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:51.385232 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:03:51.386482 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:51.440231 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:03:51.442119 [info ] [Thread-3 (]: 10 of 16 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.99s]
[0m08:03:51.442927 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:51.443454 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:51.443913 [info ] [Thread-3 (]: 15 of 16 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m08:03:51.444701 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:03:51.445055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:03:51.445492 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:51.445906 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:51.446283 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:03:51.450302 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:03:51.456117 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:51.458320 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:03:51.459906 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:03:51.460331 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:51.460686 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:03:51.471667 [info ] [Thread-1 (]: 11 of 16 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 1.01s]
[0m08:03:51.472392 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:51.472812 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:51.473180 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m08:03:51.473639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:03:51.473968 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:51.479115 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:03:51.480453 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:51.482551 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:03:51.483957 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:03:51.484343 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m08:03:51.484705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:51.960164 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m08:03:51.965113 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m08:03:52.034548 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m08:03:52.036658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m08:03:52.041597 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m08:03:52.042884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m08:03:52.045486 [debug] [Thread-1 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m08:03:52.050751 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m08:03:52.163707 [info ] [Thread-2 (]: 13 of 16 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.81s]
[0m08:03:52.165867 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:52.239063 [info ] [Thread-3 (]: 15 of 16 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.79s]
[0m08:03:52.241291 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:52.245182 [info ] [Thread-4 (]: 14 of 16 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.87s]
[0m08:03:52.246519 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.77s]
[0m08:03:52.247373 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:52.248190 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:52.250685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:52.251174 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:03:52.251576 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:03:52.251953 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:03:52.252287 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m08:03:52.252682 [info ] [MainThread]: 
[0m08:03:52.253370 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m08:03:52.255714 [debug] [MainThread]: Command end result
[0m08:03:52.297783 [info ] [MainThread]: 
[0m08:03:52.298287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:52.298599 [info ] [MainThread]: 
[0m08:03:52.298957 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m08:03:52.299708 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.8048353, "process_user_time": 3.987863, "process_kernel_time": 0.227471, "process_mem_max_rss": "213636", "process_out_blocks": "2789", "process_in_blocks": "0"}
[0m08:03:52.300181 [debug] [MainThread]: Command `dbt test` succeeded at 08:03:52.300089 after 5.81 seconds
[0m08:03:52.300575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98107ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98105850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98106060>]}
[0m08:03:52.300916 [debug] [MainThread]: Flushing usage events
[0m08:03:55.444913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fef3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb486c380>]}


============================== 08:03:55.450453 | 6d762c5e-9398-4fcd-b811-b31112b2fb94 ==============================
[0m08:03:55.450453 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:03:55.451206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:03:56.075454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b5c2c0>]}
[0m08:03:56.114657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984cddf0>]}
[0m08:03:56.115319 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:03:56.188613 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:03:56.321176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:56.321622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:56.361576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9839daf0>]}
[0m08:03:56.373810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ecd490>]}
[0m08:03:56.374262 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:03:56.374811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98137c20>]}
[0m08:03:56.376881 [info ] [MainThread]: 
[0m08:03:56.377458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:03:56.381110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m08:03:56.381633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m08:03:56.391352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m08:03:56.396910 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:03:56.398708 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:03:56.400466 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:03:56.400867 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:03:56.401244 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:03:56.401593 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:03:56.401923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:56.402253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:56.402582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:57.122738 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.721 seconds
[0m08:03:57.125174 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.723 seconds
[0m08:03:57.129058 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:03:57.130431 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.728 seconds
[0m08:03:57.132955 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:03:57.137035 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:03:57.388945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d762c5e-9398-4fcd-b811-b31112b2fb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e81d90>]}
[0m08:03:57.389663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:57.390407 [info ] [MainThread]: 
[0m08:03:57.398763 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:03:57.399157 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:03:57.399913 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:03:57.400320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m08:03:57.400651 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:03:57.401129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_customers)
[0m08:03:57.401559 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m08:03:57.401950 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:03:57.402471 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:03:57.402847 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:03:57.403262 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:03:57.408617 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:03:57.409018 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:03:57.411402 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:03:57.413577 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:03:57.415980 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:03:57.417007 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:03:57.417766 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:03:57.418271 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:03:57.418638 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_orders
[0m08:03:57.418922 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:03:57.419559 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:03:57.419856 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:03:57.420254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_orders)
[0m08:03:57.420788 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:03:57.421147 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m08:03:57.421769 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:03:57.422134 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:03:57.422518 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m08:03:57.422961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m08:03:57.423378 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:03:57.425517 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:03:57.425940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m08:03:57.426447 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m08:03:57.426826 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.fact_inventory_snapshot)
[0m08:03:57.427353 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:03:57.429555 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:03:57.429986 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:03:57.430310 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_orders
[0m08:03:57.432444 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:03:57.444655 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:03:57.445371 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_orders
[0m08:03:57.445865 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m08:03:57.446493 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m08:03:57.446927 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m08:03:57.447438 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m08:03:57.447854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now snapshot.retail_dbt.snap_customers)
[0m08:03:57.448173 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:03:57.448661 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m08:03:57.449229 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m08:03:57.449527 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m08:03:57.450060 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:03:57.450629 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m08:03:57.454412 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m08:03:57.454825 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m08:03:57.455455 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:57.455808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m08:03:57.456403 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m08:03:57.456748 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m08:03:57.457105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:03:57.457498 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m08:03:57.457907 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:57.460873 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:03:57.461276 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:57.464115 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:03:57.464563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:03:57.473813 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:03:57.474483 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m08:03:57.474799 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:57.475511 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m08:03:57.476025 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m08:03:57.479306 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:03:57.479946 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m08:03:57.480419 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:57.480706 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:57.481335 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:57.481808 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:03:57.482470 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:03:57.482780 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:57.483096 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:03:57.483485 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:57.483860 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m08:03:57.484417 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:03:57.484758 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:57.488092 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:03:57.488555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now model.retail_dbt.dim_customer)
[0m08:03:57.488973 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:57.495172 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:03:57.495721 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:03:57.496114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:03:57.496679 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:57.500621 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:03:57.501046 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:57.501635 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:03:57.502090 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:57.506457 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:03:57.506921 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:57.507364 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m08:03:57.507910 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:03:57.508438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:03:57.509012 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m08:03:57.509601 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:57.509894 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:57.515686 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:03:57.516025 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_sales
[0m08:03:57.516633 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:03:57.517148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now model.retail_dbt.fact_sales)
[0m08:03:57.517817 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:03:57.518101 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:57.523277 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:03:57.523880 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:03:57.524690 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_sales
[0m08:03:57.525202 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_sales
[0m08:03:57.525929 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:57.526317 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m08:03:57.526615 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:57.526907 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:57.527179 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:57.527469 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:57.527835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:03:57.528186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:03:57.531299 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:03:57.531696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:03:57.532042 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:57.532389 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:57.532915 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:57.536099 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:03:57.539364 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:03:57.539821 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:57.543002 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:03:57.544017 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:03:57.544731 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:57.545064 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:57.545550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:03:57.545960 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:57.546488 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:03:57.546895 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:57.547223 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:57.547820 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:03:57.548240 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:57.548822 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:03:57.552114 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:03:57.552601 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:57.553009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:03:57.553428 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:57.553960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:03:57.554343 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:57.554727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:03:57.555158 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:57.555500 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:57.560021 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:03:57.560434 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:57.564326 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:03:57.564935 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:03:57.570311 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:03:57.570931 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:57.571693 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:57.572040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:03:57.572511 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:57.573043 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:03:57.573509 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:57.573818 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:57.574349 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:03:57.574750 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:57.578576 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:03:57.579178 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:03:57.579741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:03:57.580392 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:57.585416 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:03:57.585879 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:57.586458 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:03:57.586994 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:57.587586 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:03:57.588690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:57.588994 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:03:57.589298 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:03:57.589646 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m08:03:57.589945 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:03:57.592489 [debug] [MainThread]: Command end result
[0m08:03:57.690787 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m08:03:57.691147 [info ] [MainThread]: Building catalog
[0m08:03:57.700204 [debug] [ThreadPool]: Acquiring new snowflake connection 'RETAIL_DW.information_schema'
[0m08:03:57.715334 [debug] [ThreadPool]: Using snowflake connection "RETAIL_DW.information_schema"
[0m08:03:57.716179 [debug] [ThreadPool]: On RETAIL_DW.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "RETAIL_DW.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from RETAIL_DW.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from RETAIL_DW.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m08:03:57.717060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:06.385577 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 8.668 seconds
[0m08:04:06.467949 [debug] [ThreadPool]: On RETAIL_DW.information_schema: Close
[0m08:04:06.743279 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/retail_dbt/target/catalog.json
[0m08:04:06.744511 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.33551, "process_user_time": 3.580928, "process_kernel_time": 0.188099, "process_mem_max_rss": "211456", "process_out_blocks": "5855", "process_in_blocks": "0"}
[0m08:04:06.745064 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:04:06.744979 after 11.34 seconds
[0m08:04:06.745420 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:04:06.745730 [debug] [MainThread]: Connection 'RETAIL_DW.information_schema' was properly closed.
[0m08:04:06.746037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb489f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bd0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48229f0>]}
[0m08:04:06.746377 [debug] [MainThread]: Flushing usage events
[0m08:12:35.875093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd9daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8cdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8ce180>]}


============================== 08:12:35.881350 | ee3a158b-9c25-4487-b32e-201ec9b854fa ==============================
[0m08:12:35.881350 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:12:35.882102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:35.965089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee3a158b-9c25-4487-b32e-201ec9b854fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df28890>]}
[0m08:12:36.032735 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1giifjqg'
[0m08:12:36.033165 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:12:36.123395 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:12:36.124017 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:12:36.182708 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:12:36.186497 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:12:36.804459 [info ] [MainThread]: Installed from version 1.3.0
[0m08:12:36.805105 [info ] [MainThread]: Updated version available: 1.3.3
[0m08:12:36.805552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee3a158b-9c25-4487-b32e-201ec9b854fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc51040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb3fd40>]}
[0m08:12:36.805957 [info ] [MainThread]: 
[0m08:12:36.806520 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m08:12:36.807522 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9682707, "process_user_time": 1.664525, "process_kernel_time": 0.111436, "process_mem_max_rss": "170548", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m08:12:36.808024 [debug] [MainThread]: Command `dbt deps` succeeded at 08:12:36.807939 after 0.97 seconds
[0m08:12:36.808391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce7fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cde6f00>]}
[0m08:12:36.808771 [debug] [MainThread]: Flushing usage events
[0m08:12:39.574468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c256a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68b30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a0d100>]}


============================== 08:12:39.580012 | 3fa2a6aa-d128-437c-9dd8-e494f398fd7c ==============================
[0m08:12:39.580012 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:12:39.580535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:40.207623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f43c20>]}
[0m08:12:40.247012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7af530>]}
[0m08:12:40.247663 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:12:40.320824 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:12:40.460354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:40.460798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:40.500630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fe9eb0>]}
[0m08:12:40.613720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f9ecc0>]}
[0m08:12:40.614185 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:12:40.616989 [info ] [MainThread]: 
[0m08:12:40.617567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:12:40.621369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:12:40.628816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:12:40.633373 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:12:40.635331 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:12:40.635774 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:12:40.636141 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:12:40.636521 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:12:40.638273 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:12:40.638623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:40.638952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:40.639287 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:12:40.642738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:41.811098 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.172 seconds
[0m08:12:41.812427 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.173 seconds
[0m08:12:41.815510 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:12:41.816973 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.174 seconds
[0m08:12:41.818891 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:12:41.822310 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:12:42.021909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m08:12:42.028973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m08:12:42.032399 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:12:42.033002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m08:12:42.035064 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:12:42.035597 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:12:42.037777 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:12:42.038194 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:12:42.038586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:42.038940 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:12:42.039305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:42.040946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:42.630160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.591 seconds
[0m08:12:42.632065 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.591 seconds
[0m08:12:42.636240 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:12:42.638755 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.600 seconds
[0m08:12:42.641484 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:12:42.647016 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:12:42.839894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ef41a0>]}
[0m08:12:42.840577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:12:42.841009 [info ] [MainThread]: 
[0m08:12:42.849156 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:12:42.849567 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:12:42.849905 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:12:42.850345 [info ] [Thread-1 (]: 1 of 29 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m08:12:42.850790 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:12:42.851165 [info ] [Thread-2 (]: 2 of 29 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m08:12:42.851694 [info ] [Thread-3 (]: 3 of 29 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m08:12:42.852796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m08:12:42.853290 [info ] [Thread-4 (]: 4 of 29 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m08:12:42.853855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m08:12:42.854334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m08:12:42.854748 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:12:42.855212 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:12:42.855616 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:12:42.855979 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:12:42.861218 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:12:42.861651 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:12:42.863970 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:12:42.866204 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:12:42.868691 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:12:42.869517 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:12:42.892063 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m08:12:42.892437 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:12:42.892772 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:12:42.893083 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:12:42.915851 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m08:12:42.917699 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:12:42.919952 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m08:12:42.921041 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m08:12:42.921788 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m08:12:42.922288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:42.922869 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m08:12:42.923945 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m08:12:42.924532 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m08:12:42.925557 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:12:42.926096 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m08:12:42.926483 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m08:12:42.927925 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m08:12:42.928557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:42.928941 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:43.736637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.808 seconds
[0m08:12:43.738154 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m08:12:43.752341 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m08:12:43.766451 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m08:12:43.768333 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m08:12:43.770075 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m08:12:43.976967 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d7380>]}
[0m08:12:43.978470 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98562840>]}
[0m08:12:43.980030 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9853c4d0>]}
[0m08:12:43.981322 [info ] [Thread-2 (]: 2 of 29 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 1.12s]
[0m08:12:43.982252 [info ] [Thread-3 (]: 3 of 29 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 1.12s]
[0m08:12:43.983266 [info ] [Thread-4 (]: 4 of 29 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 1.12s]
[0m08:12:43.984277 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:12:43.985976 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:12:43.986830 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:12:43.987463 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_orders
[0m08:12:43.988085 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m08:12:43.988842 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stores
[0m08:12:43.989513 [info ] [Thread-2 (]: 5 of 29 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m08:12:43.990162 [info ] [Thread-3 (]: 6 of 29 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m08:12:43.990817 [info ] [Thread-4 (]: 7 of 29 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m08:12:43.991451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_orders)
[0m08:12:43.991993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m08:12:43.992539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_stores)
[0m08:12:43.992989 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:12:43.993400 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m08:12:43.993818 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:12:43.996936 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:12:43.999569 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:12:44.001811 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:12:44.004430 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_orders
[0m08:12:44.004733 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m08:12:44.005020 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stores
[0m08:12:44.007312 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m08:12:44.009571 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m08:12:44.011718 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m08:12:44.013276 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m08:12:44.014008 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m08:12:44.014318 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m08:12:44.014867 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m08:12:44.015301 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m08:12:44.015736 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:44.016118 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m08:12:44.016561 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:44.018130 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:44.455375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.533 seconds
[0m08:12:44.460343 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m08:12:44.614759 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m08:12:44.619773 [debug] [Thread-2 (]: On model.retail_dbt.stg_orders: Close
[0m08:12:44.624628 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m08:12:44.625729 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m08:12:44.629349 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m08:12:44.633204 [debug] [Thread-4 (]: On model.retail_dbt.stg_stores: Close
[0m08:12:44.649819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985c6720>]}
[0m08:12:44.650652 [info ] [Thread-1 (]: 1 of 29 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.80s]
[0m08:12:44.651747 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:12:44.652346 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m08:12:44.652942 [info ] [Thread-1 (]: 8 of 29 START snapshot ANALYTICS.snap_customers ................................ [RUN]
[0m08:12:44.653615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now snapshot.retail_dbt.snap_customers)
[0m08:12:44.654100 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m08:12:44.658017 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m08:12:44.693573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:44.693974 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:12:44.694367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:44.810430 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98417530>]}
[0m08:12:44.811221 [info ] [Thread-2 (]: 5 of 29 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.82s]
[0m08:12:44.812018 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_orders
[0m08:12:44.812469 [debug] [Thread-2 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:12:44.812959 [info ] [Thread-2 (]: 9 of 29 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m08:12:44.813522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.fact_inventory_snapshot)
[0m08:12:44.813913 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:12:44.825883 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:12:44.827941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98422b40>]}
[0m08:12:44.828679 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985ec1a0>]}
[0m08:12:44.829211 [info ] [Thread-3 (]: 6 of 29 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.84s]
[0m08:12:44.830054 [info ] [Thread-4 (]: 7 of 29 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.84s]
[0m08:12:44.830580 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m08:12:44.830898 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:12:44.831316 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stores
[0m08:12:44.831905 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m08:12:44.834135 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:12:44.834740 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m08:12:44.835102 [info ] [Thread-3 (]: 10 of 29 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m08:12:44.835678 [info ] [Thread-4 (]: 11 of 29 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m08:12:44.836126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m08:12:44.836506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m08:12:44.836881 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m08:12:44.837636 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m08:12:44.837915 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m08:12:44.840855 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:12:44.841307 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m08:12:44.844206 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:12:44.844875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:44.847738 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m08:12:44.903563 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m08:12:44.906932 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m08:12:44.909124 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m08:12:44.915790 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m08:12:44.916452 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m08:12:44.916803 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m08:12:44.917202 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m08:12:44.917584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:44.917914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:45.233631 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.539 seconds
[0m08:12:45.268502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:45.271069 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m08:12:46.199148 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.281 seconds
[0m08:12:46.201120 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.283 seconds
[0m08:12:46.205934 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m08:12:46.207045 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m08:12:46.210032 [debug] [Thread-3 (]: On model.retail_dbt.dim_product: Close
[0m08:12:46.214702 [debug] [Thread-2 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m08:12:46.294070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m08:12:46.301010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:46.301816 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:12:46.406210 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b03320>]}
[0m08:12:46.410448 [info ] [Thread-2 (]: 9 of 29 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.59s]
[0m08:12:46.413336 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9852fda0>]}
[0m08:12:46.415067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01202c0>]}
[0m08:12:46.415971 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:12:46.417118 [info ] [Thread-4 (]: 11 of 29 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.58s]
[0m08:12:46.418202 [info ] [Thread-3 (]: 10 of 29 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.58s]
[0m08:12:46.420006 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m08:12:46.420743 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:46.421991 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m08:12:46.422697 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:46.423321 [info ] [Thread-2 (]: 12 of 29 START test not_null_fact_inventory_snapshot_date_key .................. [RUN]
[0m08:12:46.424004 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:46.424641 [info ] [Thread-4 (]: 13 of 29 START test not_null_fact_inventory_snapshot_product_key ............... [RUN]
[0m08:12:46.425292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:12:46.425917 [info ] [Thread-3 (]: 14 of 29 START test not_null_fact_inventory_snapshot_store_key ................. [RUN]
[0m08:12:46.426706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:12:46.427275 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:46.427831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:12:46.428335 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:46.440226 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:12:46.440689 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:46.441875 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.140 seconds
[0m08:12:46.445090 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:12:46.448580 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:12:46.452911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:46.453676 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:46.454014 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:12:46.466668 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:12:46.467336 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:46.467674 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:46.470846 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:12:46.472935 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:12:46.473880 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:12:46.474251 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m08:12:46.474644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:46.475420 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:12:46.476601 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m08:12:46.477176 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:12:46.477702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:46.478087 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m08:12:46.479502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:46.622556 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.155 seconds
[0m08:12:46.626703 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:46.627131 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:12:46.755474 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.128 seconds
[0m08:12:46.760280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:46.760814 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:12:46.891768 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m08:12:46.900996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:46.901546 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:12:47.043188 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.141 seconds
[0m08:12:47.072125 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:47.072743 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:47.111316 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m08:12:47.115837 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m08:12:47.122430 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m08:12:47.124250 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m08:12:47.128493 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m08:12:47.130172 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m08:12:47.295600 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.222 seconds
[0m08:12:47.306454 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:47.307332 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:47.309161 [info ] [Thread-3 (]: 14 of 29 PASS not_null_fact_inventory_snapshot_store_key ....................... [[32mPASS[0m in 0.88s]
[0m08:12:47.311003 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:47.311862 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:47.312523 [info ] [Thread-3 (]: 15 of 29 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m08:12:47.313805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:12:47.314309 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:47.315254 [info ] [Thread-4 (]: 13 of 29 PASS not_null_fact_inventory_snapshot_product_key ..................... [[32mPASS[0m in 0.89s]
[0m08:12:47.326634 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:12:47.328062 [info ] [Thread-2 (]: 12 of 29 PASS not_null_fact_inventory_snapshot_date_key ........................ [[32mPASS[0m in 0.90s]
[0m08:12:47.328592 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:47.329425 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:47.330832 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:47.331368 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:47.331888 [info ] [Thread-4 (]: 16 of 29 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m08:12:47.332229 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:47.332672 [info ] [Thread-2 (]: 17 of 29 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m08:12:47.333129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:12:47.335292 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:12:47.335706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:12:47.336068 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:47.336542 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:47.341028 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:12:47.345327 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:12:47.346293 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:12:47.346900 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:47.347343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:47.347661 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:47.350996 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:12:47.351317 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:47.353441 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:12:47.354831 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:12:47.355249 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:47.355670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:47.356420 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:12:47.357831 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:47.358323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:47.448910 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.141 seconds
[0m08:12:47.449470 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m08:12:47.452003 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:47.452393 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m08:12:47.665244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m08:12:47.666508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:47.667500 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:12:48.045887 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m08:12:48.046617 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m08:12:48.048321 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m08:12:48.049818 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m08:12:48.053840 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m08:12:48.055478 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m08:12:48.247282 [info ] [Thread-3 (]: 15 of 29 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.93s]
[0m08:12:48.251086 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:48.253819 [info ] [Thread-2 (]: 17 of 29 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.92s]
[0m08:12:48.255492 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.587 seconds
[0m08:12:48.256915 [info ] [Thread-4 (]: 16 of 29 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.92s]
[0m08:12:48.257888 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:48.258707 [debug] [Thread-1 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:12:48.259625 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:48.260618 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m08:12:48.650923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m08:12:48.659846 [debug] [Thread-1 (]: On snapshot.retail_dbt.snap_customers: Close
[0m08:12:48.853179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985a6ff0>]}
[0m08:12:48.854084 [info ] [Thread-1 (]: 8 of 29 OK snapshotted ANALYTICS.snap_customers ................................ [[32mSUCCESS 0[0m in 4.20s]
[0m08:12:48.854862 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m08:12:48.855867 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_customer
[0m08:12:48.856386 [info ] [Thread-3 (]: 18 of 29 START sql table model STAGING_ANALYTICS.dim_customer .................. [RUN]
[0m08:12:48.857006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now model.retail_dbt.dim_customer)
[0m08:12:48.857378 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:12:48.862180 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:12:48.863906 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_customer
[0m08:12:48.866244 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m08:12:48.868567 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m08:12:48.869037 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m08:12:48.869510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:50.187274 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.317 seconds
[0m08:12:50.192309 [debug] [Thread-3 (]: On model.retail_dbt.dim_customer: Close
[0m08:12:50.387787 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985c7860>]}
[0m08:12:50.388632 [info ] [Thread-3 (]: 18 of 29 OK created sql table model STAGING_ANALYTICS.dim_customer ............. [[32mSUCCESS 1[0m in 1.53s]
[0m08:12:50.389291 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_customer
[0m08:12:50.390110 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_sales
[0m08:12:50.390739 [info ] [Thread-4 (]: 19 of 29 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m08:12:50.391256 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now model.retail_dbt.fact_sales)
[0m08:12:50.391716 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:12:50.399346 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:12:50.400548 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_sales
[0m08:12:50.402835 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m08:12:50.405412 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m08:12:50.405912 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m08:12:50.406410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:52.334222 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.927 seconds
[0m08:12:52.339028 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: Close
[0m08:12:52.530248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa2a6aa-d128-437c-9dd8-e494f398fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985ed6d0>]}
[0m08:12:52.531479 [info ] [Thread-4 (]: 19 of 29 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 2.14s]
[0m08:12:52.532577 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_sales
[0m08:12:52.534062 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:52.534816 [info ] [Thread-2 (]: 20 of 29 START test not_null_fact_sales_customer_key ........................... [RUN]
[0m08:12:52.535470 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:52.536086 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:52.536760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m08:12:52.537347 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:52.537978 [info ] [Thread-3 (]: 21 of 29 START test not_null_fact_sales_date_key ............................... [RUN]
[0m08:12:52.539157 [info ] [Thread-1 (]: 22 of 29 START test not_null_fact_sales_product_key ............................ [RUN]
[0m08:12:52.539743 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:52.540311 [info ] [Thread-4 (]: 23 of 29 START test not_null_fact_sales_sales_line_key ......................... [RUN]
[0m08:12:52.540994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:12:52.541854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:12:52.545953 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:12:52.546363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:12:52.546852 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:52.547350 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:52.547986 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:52.552143 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:12:52.556034 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:12:52.556652 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:52.560977 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:12:52.563635 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:12:52.564484 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:52.564925 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:52.566921 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:12:52.570613 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:12:52.571138 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:52.572042 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:12:52.574116 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:12:52.574813 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m08:12:52.575383 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:12:52.575940 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:12:52.576468 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:52.576861 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m08:12:52.577256 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m08:12:52.577880 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:12:52.579389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:52.579961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:52.580441 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m08:12:52.583191 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:53.222276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m08:12:53.224339 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m08:12:53.226153 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m08:12:53.228267 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m08:12:53.233351 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m08:12:53.234924 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m08:12:53.243544 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m08:12:53.245233 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m08:12:53.415737 [info ] [Thread-1 (]: 22 of 29 PASS not_null_fact_sales_product_key .................................. [[32mPASS[0m in 0.87s]
[0m08:12:53.416941 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:53.417709 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:53.418361 [info ] [Thread-1 (]: 24 of 29 START test not_null_fact_sales_store_key .............................. [RUN]
[0m08:12:53.419153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:12:53.419838 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:53.426064 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:12:53.427455 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:53.430004 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:12:53.431238 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:12:53.432436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m08:12:53.432935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:53.433761 [info ] [Thread-3 (]: 21 of 29 PASS not_null_fact_sales_date_key ..................................... [[32mPASS[0m in 0.89s]
[0m08:12:53.435089 [info ] [Thread-4 (]: 23 of 29 PASS not_null_fact_sales_sales_line_key ............................... [[32mPASS[0m in 0.89s]
[0m08:12:53.436232 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:53.436994 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:53.437431 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:53.438027 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:53.439185 [info ] [Thread-3 (]: 25 of 29 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m08:12:53.439976 [info ] [Thread-2 (]: 20 of 29 PASS not_null_fact_sales_customer_key ................................. [[32mPASS[0m in 0.90s]
[0m08:12:53.440380 [info ] [Thread-4 (]: 26 of 29 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m08:12:53.441080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:12:53.441604 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:53.441995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:12:53.442384 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:53.442871 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:53.443257 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:53.448189 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:12:53.448626 [info ] [Thread-2 (]: 27 of 29 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m08:12:53.452414 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:12:53.453055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:12:53.453668 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:53.457753 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:12:53.458076 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:53.460254 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:12:53.460592 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:53.462738 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:12:53.463197 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:53.466616 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:12:53.467533 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:12:53.468075 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:53.468520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:12:53.469231 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:12:53.470733 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:53.471720 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:12:53.472057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:12:53.472444 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:53.473900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:53.978835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m08:12:53.982221 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m08:12:54.062697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m08:12:54.066320 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m08:12:54.078215 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m08:12:54.081103 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m08:12:54.093375 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m08:12:54.095565 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m08:12:54.173791 [info ] [Thread-1 (]: 24 of 29 PASS not_null_fact_sales_store_key .................................... [[32mPASS[0m in 0.75s]
[0m08:12:54.175049 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:54.175847 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:54.176538 [info ] [Thread-1 (]: 28 of 29 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m08:12:54.177299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:12:54.177982 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:54.185040 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:12:54.187959 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:54.190293 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:12:54.192081 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:12:54.192561 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:12:54.192999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:54.260365 [info ] [Thread-2 (]: 27 of 29 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.81s]
[0m08:12:54.261087 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:54.261578 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:54.261953 [info ] [Thread-2 (]: 29 of 29 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m08:12:54.262397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:12:54.262825 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:54.268375 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:12:54.270224 [info ] [Thread-3 (]: 25 of 29 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.83s]
[0m08:12:54.271059 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:54.271563 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:54.273842 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:12:54.275099 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:12:54.275479 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m08:12:54.275860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:12:54.295757 [info ] [Thread-4 (]: 26 of 29 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.85s]
[0m08:12:54.296358 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:54.753976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m08:12:54.757180 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m08:12:54.821156 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m08:12:54.824620 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m08:12:54.949943 [info ] [Thread-1 (]: 28 of 29 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.77s]
[0m08:12:54.951202 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:55.016296 [info ] [Thread-2 (]: 29 of 29 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.75s]
[0m08:12:55.017559 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:55.019852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:55.020474 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef' was properly closed.
[0m08:12:55.020921 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:12:55.021344 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:12:55.021877 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:12:55.022473 [info ] [MainThread]: 
[0m08:12:55.023794 [info ] [MainThread]: Finished running 6 view models, 6 table models, 16 data tests, 1 snapshot in 0 hours 0 minutes and 14.40 seconds (14.40s).
[0m08:12:55.027644 [debug] [MainThread]: Command end result
[0m08:12:55.072485 [info ] [MainThread]: 
[0m08:12:55.073086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:55.073479 [info ] [MainThread]: 
[0m08:12:55.073979 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 TOTAL=29
[0m08:12:55.074995 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.535564, "process_user_time": 4.917796, "process_kernel_time": 0.286012, "process_mem_max_rss": "216072", "process_in_blocks": "40", "process_out_blocks": "2951"}
[0m08:12:55.075571 [debug] [MainThread]: Command `dbt build` succeeded at 08:12:55.075461 after 15.54 seconds
[0m08:12:55.076038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c6ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7af980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5732870>]}
[0m08:12:55.076447 [debug] [MainThread]: Flushing usage events
[0m08:12:57.638873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad19ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad16fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd605c0>]}


============================== 08:12:57.644661 | 20f548dc-ca4e-44b4-a61a-453c42c8be3c ==============================
[0m08:12:57.644661 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:12:57.645422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:12:58.280165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91869f70>]}
[0m08:12:58.320080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad787500>]}
[0m08:12:58.320852 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:12:58.396331 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:12:58.535496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:58.535974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:58.576450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dde360>]}
[0m08:12:58.589025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e63170>]}
[0m08:12:58.589518 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:12:58.590098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bfb9b0>]}
[0m08:12:58.592195 [info ] [MainThread]: 
[0m08:12:58.592808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:12:58.596497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m08:12:58.596983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m08:12:58.605201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m08:12:58.612206 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:12:58.613999 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:12:58.615859 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:12:58.616308 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:12:58.616702 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:12:58.617056 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:12:58.617408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:58.617742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:58.618061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:59.231362 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.613 seconds
[0m08:12:59.234295 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:12:59.242391 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.625 seconds
[0m08:12:59.244026 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:12:59.245666 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.628 seconds
[0m08:12:59.247562 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:12:59.444307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f548dc-ca4e-44b4-a61a-453c42c8be3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f93770>]}
[0m08:12:59.445360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:12:59.446294 [info ] [MainThread]: 
[0m08:12:59.457457 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:12:59.457940 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:12:59.458708 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:12:59.459153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m08:12:59.459492 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:12:59.459965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m08:12:59.460421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m08:12:59.460841 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:12:59.461322 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:12:59.461715 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:12:59.462088 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:12:59.467442 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:12:59.467946 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:12:59.470329 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:12:59.472583 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:12:59.474949 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:12:59.476108 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:12:59.476608 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:12:59.477245 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:12:59.477576 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:12:59.477858 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:12:59.478351 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:12:59.478773 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_orders
[0m08:12:59.479329 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:12:59.479872 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:12:59.480249 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_products
[0m08:12:59.480658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_orders)
[0m08:12:59.481120 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m08:12:59.481547 [debug] [Thread-4 (]: Began running node snapshot.retail_dbt.snap_customers
[0m08:12:59.481903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_products)
[0m08:12:59.482231 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:12:59.482590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_stores)
[0m08:12:59.482941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now snapshot.retail_dbt.snap_customers)
[0m08:12:59.483288 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_products
[0m08:12:59.485444 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:12:59.485892 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:12:59.486280 [debug] [Thread-4 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m08:12:59.488419 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:12:59.490778 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:12:59.493279 [debug] [Thread-4 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m08:12:59.493933 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_orders
[0m08:12:59.494621 [debug] [Thread-4 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m08:12:59.495182 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_orders
[0m08:12:59.495673 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:12:59.495964 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_products
[0m08:12:59.496354 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m08:12:59.496857 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now model.retail_dbt.fact_inventory_snapshot)
[0m08:12:59.497157 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m08:12:59.497721 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_products
[0m08:12:59.498265 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m08:12:59.498633 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:12:59.499005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_customer)
[0m08:12:59.499689 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m08:12:59.506019 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:12:59.513872 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:12:59.514266 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m08:12:59.514639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m08:12:59.518615 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:12:59.519300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_store)
[0m08:12:59.519704 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m08:12:59.520337 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:12:59.520643 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m08:12:59.523726 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:12:59.524375 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:12:59.524704 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m08:12:59.527460 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:12:59.528420 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m08:12:59.528801 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:59.529276 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:59.529600 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m08:12:59.530038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:12:59.530440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:12:59.530820 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m08:12:59.531339 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m08:12:59.531809 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:59.532151 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:59.532696 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m08:12:59.533119 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:59.542653 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:12:59.545725 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:12:59.546207 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:59.546701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:12:59.547437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:12:59.547841 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:59.548282 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:59.548593 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:59.549002 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:59.551990 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:12:59.558363 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:12:59.559048 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:12:59.559799 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:12:59.560541 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_sales
[0m08:12:59.561006 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:59.561488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now model.retail_dbt.fact_sales)
[0m08:12:59.561958 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:59.562275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:12:59.562578 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:59.562914 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:12:59.563445 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:12:59.563789 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:59.564294 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:12:59.569329 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:12:59.569777 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:59.575609 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:12:59.576346 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:12:59.576896 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:59.581234 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:12:59.581569 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_sales
[0m08:12:59.582079 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:59.582592 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_sales
[0m08:12:59.583165 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:12:59.583884 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:59.584177 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:59.584517 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:59.584803 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:59.585185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m08:12:59.585810 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:12:59.586175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:12:59.586549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:12:59.586884 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:59.587249 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:59.587597 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:59.587971 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:59.591207 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:12:59.591640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:12:59.594843 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:12:59.597902 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:12:59.598439 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:59.599395 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:59.602444 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:12:59.603203 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:12:59.603528 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:59.603804 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:59.604298 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:59.604875 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:12:59.605431 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:12:59.605906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:12:59.606197 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:59.606589 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:59.606967 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:59.607301 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:59.607809 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:12:59.608170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:12:59.608628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:12:59.611748 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:12:59.612186 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:59.612579 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:59.612937 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:59.613447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:12:59.618153 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:12:59.621956 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:12:59.622384 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:59.622695 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:59.623607 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:12:59.628901 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:12:59.629372 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:59.629755 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:59.630158 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:59.630795 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:12:59.631188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:12:59.631821 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:12:59.632204 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:59.632549 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:59.632900 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:59.633630 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:12:59.634001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:12:59.637729 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:12:59.638488 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:59.643751 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:12:59.644467 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:59.645093 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:12:59.645565 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:59.646107 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:12:59.647221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:59.647541 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:12:59.647846 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:12:59.648122 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m08:12:59.648397 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:12:59.650932 [debug] [MainThread]: Command end result
[0m08:12:59.749359 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m08:12:59.749830 [info ] [MainThread]: Building catalog
[0m08:12:59.759169 [debug] [ThreadPool]: Acquiring new snowflake connection 'RETAIL_DW.information_schema'
[0m08:12:59.774425 [debug] [ThreadPool]: Using snowflake connection "RETAIL_DW.information_schema"
[0m08:12:59.775308 [debug] [ThreadPool]: On RETAIL_DW.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "RETAIL_DW.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from RETAIL_DW.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from RETAIL_DW.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m08:12:59.776205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:09.154336 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 9.378 seconds
[0m08:13:09.223968 [debug] [ThreadPool]: On RETAIL_DW.information_schema: Close
[0m08:13:09.492724 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/retail_dbt/target/catalog.json
[0m08:13:09.494050 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.891836, "process_user_time": 3.625196, "process_kernel_time": 0.194225, "process_mem_max_rss": "212048", "process_out_blocks": "5856", "process_in_blocks": "0"}
[0m08:13:09.494662 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:13:09.494551 after 11.89 seconds
[0m08:13:09.495055 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:13:09.495394 [debug] [MainThread]: Connection 'RETAIL_DW.information_schema' was properly closed.
[0m08:13:09.495756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bfa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdc3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90aae390>]}
[0m08:13:09.496175 [debug] [MainThread]: Flushing usage events
[0m08:14:32.113446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8509ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87eb88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8554f860>]}


============================== 08:14:32.119965 | 34ac1370-b880-4345-aa53-a72c6e48ee94 ==============================
[0m08:14:32.119965 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:14:32.120726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:14:32.205679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ac1370-b880-4345-aa53-a72c6e48ee94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ea4aa0>]}
[0m08:14:32.277458 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-arkg6gg6'
[0m08:14:32.277926 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:14:32.428156 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:14:32.428861 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:14:32.489197 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:14:32.493559 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:14:33.243417 [info ] [MainThread]: Installed from version 1.3.0
[0m08:14:33.244289 [info ] [MainThread]: Updated version available: 1.3.3
[0m08:14:33.244893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '34ac1370-b880-4345-aa53-a72c6e48ee94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86801520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84db9f70>]}
[0m08:14:33.245419 [info ] [MainThread]: 
[0m08:14:33.245941 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m08:14:33.247299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1713835, "process_user_time": 1.730587, "process_kernel_time": 0.107527, "process_mem_max_rss": "170548", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m08:14:33.247908 [debug] [MainThread]: Command `dbt deps` succeeded at 08:14:33.247779 after 1.17 seconds
[0m08:14:33.248336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861d1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861d3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852152e0>]}
[0m08:14:33.248837 [debug] [MainThread]: Flushing usage events
[0m08:14:35.990250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2492990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a50230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c4f3e0>]}


============================== 08:14:35.996357 | 4d4b1db6-5abc-4d50-8cb3-4298230655ea ==============================
[0m08:14:35.996357 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:14:35.996953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:14:36.665599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb18cf860>]}
[0m08:14:36.704871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14fff80>]}
[0m08:14:36.705522 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:14:36.777997 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:14:36.915825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:14:36.916242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:14:36.956103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961e0fb0>]}
[0m08:14:37.066568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961e2150>]}
[0m08:14:37.067041 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:14:37.069931 [info ] [MainThread]: 
[0m08:14:37.070474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:14:37.074237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:14:37.083259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:14:37.086655 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:14:37.088527 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:14:37.088966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW'
[0m08:14:37.089251 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:14:37.089691 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:14:37.091452 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW"
[0m08:14:37.091801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:37.092206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:37.092542 [debug] [ThreadPool]: On list_RETAIL_DW: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW"} */
show terse schemas in database RETAIL_DW
    limit 10000
[0m08:14:37.096148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:37.880047 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.784 seconds
[0m08:14:37.882053 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.790 seconds
[0m08:14:37.885129 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:14:37.887762 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:14:37.894742 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.802 seconds
[0m08:14:37.896430 [debug] [ThreadPool]: On list_RETAIL_DW: Close
[0m08:14:38.082710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_ANALYTICS)
[0m08:14:38.089789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_ANALYTICS)
[0m08:14:38.091506 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:14:38.092122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RETAIL_DW, now list_RETAIL_DW_STAGING_STAGING)
[0m08:14:38.094169 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:14:38.094873 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:14:38.097041 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:14:38.097518 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:14:38.098276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:38.098788 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:14:38.099303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:38.102008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:38.618765 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.519 seconds
[0m08:14:38.622338 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:14:38.623703 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.522 seconds
[0m08:14:38.627883 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:14:38.632836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.535 seconds
[0m08:14:38.634407 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:14:38.818711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d28860>]}
[0m08:14:38.819501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:14:38.820222 [info ] [MainThread]: 
[0m08:14:38.828424 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:14:38.828812 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:14:38.829213 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:14:38.829656 [info ] [Thread-1 (]: 1 of 29 START sql table model STAGING_ANALYTICS.dim_date ....................... [RUN]
[0m08:14:38.830046 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:14:38.830436 [info ] [Thread-2 (]: 2 of 29 START sql view model STAGING_STAGING.stg_customers ..................... [RUN]
[0m08:14:38.830954 [info ] [Thread-3 (]: 3 of 29 START sql view model STAGING_STAGING.stg_inventory_snapshots ........... [RUN]
[0m08:14:38.832005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.dim_date)
[0m08:14:38.832393 [info ] [Thread-4 (]: 4 of 29 START sql view model STAGING_STAGING.stg_order_items ................... [RUN]
[0m08:14:38.832865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_customers)
[0m08:14:38.833270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.stg_inventory_snapshots)
[0m08:14:38.833639 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:14:38.834127 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:14:38.834517 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:14:38.834915 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:14:38.840693 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:14:38.841480 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:14:38.844517 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:14:38.847106 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:14:38.850697 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:14:38.853118 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:14:38.866465 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:14:38.873762 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:14:38.874182 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:14:38.880635 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_date"
[0m08:14:38.903069 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m08:14:38.904749 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:14:38.908286 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_order_items"
[0m08:14:38.911172 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_date"
[0m08:14:38.911880 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_date"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_date
         as
        (with dates as (
  select dateadd(day, seq4(), '2025-01-01'::date) as date_day
  from table(generator(rowcount => 3650))
)
select
  date_day as date_key,
  year(date_day) as year,
  month(date_day) as month,
  day(date_day) as day,
  dayofweek(date_day) as day_of_week,
  weekofyear(date_day) as week_of_year
from dates
        );
[0m08:14:38.912556 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_customers"
[0m08:14:38.913116 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_inventory_snapshots"
[0m08:14:38.913514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:38.914148 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_order_items"
[0m08:14:38.914739 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_customers
  
   as (
    select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.CUSTOMERS_RAW
  );
[0m08:14:38.915400 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory_snapshots"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
  
   as (
    select
  snapshot_date::date as snapshot_date,
  store_id,
  product_id,
  on_hand_qty::number as on_hand_qty,
  ingested_at
from RETAIL_DW.RAW.INVENTORY_SNAPSHOTS_RAW
  );
[0m08:14:38.916950 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_order_items"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_order_items
  
   as (
    select
  order_id,
  product_id,
  qty::number as qty,
  unit_price::number(10,2) as unit_price,
  discount_pct::number(5,2) as discount_pct,
  ingested_at
from RETAIL_DW.RAW.ORDER_ITEMS_RAW
  );
[0m08:14:38.917953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:38.918553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:14:38.919197 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:14:39.570893 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m08:14:39.572417 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m08:14:39.609136 [debug] [Thread-3 (]: On model.retail_dbt.stg_inventory_snapshots: Close
[0m08:14:39.609861 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m08:14:39.610606 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m08:14:39.615514 [debug] [Thread-4 (]: On model.retail_dbt.stg_order_items: Close
[0m08:14:39.816719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94737d10>]}
[0m08:14:39.819379 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff962d3260>]}
[0m08:14:39.820854 [info ] [Thread-4 (]: 4 of 29 OK created sql view model STAGING_STAGING.stg_order_items .............. [[32mSUCCESS 1[0m in 0.98s]
[0m08:14:39.822422 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95193ef0>]}
[0m08:14:39.823387 [info ] [Thread-3 (]: 3 of 29 OK created sql view model STAGING_STAGING.stg_inventory_snapshots ...... [[32mSUCCESS 1[0m in 0.98s]
[0m08:14:39.824424 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:14:39.825287 [info ] [Thread-2 (]: 2 of 29 OK created sql view model STAGING_STAGING.stg_customers ................ [[32mSUCCESS 1[0m in 0.99s]
[0m08:14:39.826218 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:14:39.826999 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_orders
[0m08:14:39.827844 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:14:39.828536 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m08:14:39.829427 [info ] [Thread-4 (]: 5 of 29 START sql view model STAGING_STAGING.stg_orders ........................ [RUN]
[0m08:14:39.830210 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m08:14:39.830917 [info ] [Thread-3 (]: 6 of 29 START sql view model STAGING_STAGING.stg_products ...................... [RUN]
[0m08:14:39.831632 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.stg_orders)
[0m08:14:39.832280 [info ] [Thread-2 (]: 7 of 29 START sql view model STAGING_STAGING.stg_stores ........................ [RUN]
[0m08:14:39.832998 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m08:14:39.833491 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:14:39.833984 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m08:14:39.834459 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m08:14:39.837793 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:14:39.838269 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:14:39.840816 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:14:39.843450 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:14:39.845325 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_orders
[0m08:14:39.847871 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_orders"
[0m08:14:39.848454 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m08:14:39.848746 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m08:14:39.851019 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m08:14:39.853243 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m08:14:39.854120 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.stg_orders"
[0m08:14:39.854968 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_orders"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_orders
  
   as (
    select
  order_id,
  customer_id,
  store_id,
  order_ts::timestamp_ntz as order_ts,
  status,
  ingested_at
from RETAIL_DW.RAW.ORDERS_RAW
  );
[0m08:14:39.855345 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:39.857221 [debug] [Thread-3 (]: Using snowflake connection "model.retail_dbt.stg_products"
[0m08:14:39.857932 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.stg_stores"
[0m08:14:39.858258 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_products
  
   as (
    select
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost::number(10,2) as cost,
  active_flag,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.PRODUCTS_RAW
  );
[0m08:14:39.858665 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
create or replace   view RETAIL_DW.STAGING_STAGING.stg_stores
  
   as (
    select
  store_id,
  store_name,
  city,
  state,
  region,
  updated_at::timestamp_ntz as updated_at,
  ingested_at
from RETAIL_DW.RAW.STORES_RAW
  );
[0m08:14:39.859065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:14:39.859409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:40.310873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.397 seconds
[0m08:14:40.316194 [debug] [Thread-1 (]: On model.retail_dbt.dim_date: Close
[0m08:14:40.479644 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m08:14:40.485286 [debug] [Thread-3 (]: On model.retail_dbt.stg_products: Close
[0m08:14:40.488459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m08:14:40.492322 [debug] [Thread-2 (]: On model.retail_dbt.stg_stores: Close
[0m08:14:40.507217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947e0fb0>]}
[0m08:14:40.508145 [info ] [Thread-1 (]: 1 of 29 OK created sql table model STAGING_ANALYTICS.dim_date .................. [[32mSUCCESS 1[0m in 1.68s]
[0m08:14:40.509319 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:14:40.509962 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:14:40.510538 [info ] [Thread-1 (]: 8 of 29 START sql table model STAGING_ANALYTICS.fact_inventory_snapshot ........ [RUN]
[0m08:14:40.511231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.fact_inventory_snapshot)
[0m08:14:40.511661 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:14:40.525401 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:14:40.526487 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m08:14:40.528524 [debug] [Thread-4 (]: On model.retail_dbt.stg_orders: Close
[0m08:14:40.530383 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:14:40.532883 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:14:40.534283 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.fact_inventory_snapshot"
[0m08:14:40.534669 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_inventory_snapshot"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
         as
        (select
  snapshot_date as date_key,
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  store_id,
  product_id,
  on_hand_qty
from RETAIL_DW.STAGING_STAGING.stg_inventory_snapshots
        );
[0m08:14:40.535043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:40.685687 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9461cda0>]}
[0m08:14:40.686734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9461dd90>]}
[0m08:14:40.687680 [info ] [Thread-3 (]: 6 of 29 OK created sql view model STAGING_STAGING.stg_products ................. [[32mSUCCESS 1[0m in 0.85s]
[0m08:14:40.688884 [info ] [Thread-2 (]: 7 of 29 OK created sql view model STAGING_STAGING.stg_stores ................... [[32mSUCCESS 1[0m in 0.85s]
[0m08:14:40.689638 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m08:14:40.690320 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m08:14:40.690943 [debug] [Thread-3 (]: Began running node snapshot.retail_dbt.snap_customers
[0m08:14:40.691888 [info ] [Thread-3 (]: 9 of 29 START snapshot ANALYTICS.snap_customers ................................ [RUN]
[0m08:14:40.692374 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_product
[0m08:14:40.692846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now snapshot.retail_dbt.snap_customers)
[0m08:14:40.693440 [info ] [Thread-2 (]: 10 of 29 START sql table model STAGING_ANALYTICS.dim_product ................... [RUN]
[0m08:14:40.694057 [debug] [Thread-3 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m08:14:40.694673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_product)
[0m08:14:40.698422 [debug] [Thread-3 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m08:14:40.698898 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_product
[0m08:14:40.714896 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:14:40.738658 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:40.739257 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:14:40.740020 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94606030>]}
[0m08:14:40.740335 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:14:40.740980 [info ] [Thread-4 (]: 5 of 29 OK created sql view model STAGING_STAGING.stg_orders ................... [[32mSUCCESS 1[0m in 0.91s]
[0m08:14:40.745431 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_product
[0m08:14:40.749039 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_orders
[0m08:14:40.751358 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_product"
[0m08:14:40.751791 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_store
[0m08:14:40.752506 [info ] [Thread-4 (]: 11 of 29 START sql table model STAGING_ANALYTICS.dim_store ..................... [RUN]
[0m08:14:40.753182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now model.retail_dbt.dim_store)
[0m08:14:40.753620 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_store
[0m08:14:40.757748 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:14:40.758395 [debug] [Thread-2 (]: Using snowflake connection "model.retail_dbt.dim_product"
[0m08:14:40.758882 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_product"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_product
         as
        (select
  md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
  product_id,
  sku,
  product_name,
  brand,
  category,
  cost,
  active_flag
from RETAIL_DW.STAGING_STAGING.stg_products
        );
[0m08:14:40.759241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:40.760655 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_store
[0m08:14:40.815412 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_store"
[0m08:14:40.817006 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.dim_store"
[0m08:14:40.817418 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_store"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_store
         as
        (select
  md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  store_id,
  store_name,
  city,
  state,
  region
from RETAIL_DW.STAGING_STAGING.stg_stores
        );
[0m08:14:40.817783 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:41.224105 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.483 seconds
[0m08:14:41.254385 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:41.255069 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
create or replace temporary table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m08:14:41.706433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.171 seconds
[0m08:14:41.711792 [debug] [Thread-1 (]: On model.retail_dbt.fact_inventory_snapshot: Close
[0m08:14:41.919797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94674fb0>]}
[0m08:14:41.921845 [info ] [Thread-1 (]: 8 of 29 OK created sql table model STAGING_ANALYTICS.fact_inventory_snapshot ... [[32mSUCCESS 1[0m in 1.41s]
[0m08:14:41.924008 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:14:41.925620 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:41.926465 [info ] [Thread-1 (]: 12 of 29 START test not_null_fact_inventory_snapshot_date_key .................. [RUN]
[0m08:14:41.927679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:14:41.928433 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:41.941824 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:14:41.943523 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:41.956823 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:14:41.958092 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:14:41.958474 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where date_key is null



      
    ) dbt_internal_test
[0m08:14:41.958861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:41.965351 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.206 seconds
[0m08:14:41.967231 [debug] [Thread-2 (]: On model.retail_dbt.dim_product: Close
[0m08:14:41.988376 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.171 seconds
[0m08:14:41.990102 [debug] [Thread-4 (]: On model.retail_dbt.dim_store: Close
[0m08:14:42.013645 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m08:14:42.016122 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.016512 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:14:42.149204 [debug] [Thread-3 (]: SQL status: SUCCESS 15 in 0.132 seconds
[0m08:14:42.149942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cd55b0>]}
[0m08:14:42.153385 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.154030 [info ] [Thread-2 (]: 10 of 29 OK created sql table model STAGING_ANALYTICS.dim_product .............. [[32mSUCCESS 1[0m in 1.46s]
[0m08:14:42.154656 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:14:42.155213 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_product
[0m08:14:42.156666 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:42.157292 [info ] [Thread-2 (]: 13 of 29 START test not_null_fact_inventory_snapshot_product_key ............... [RUN]
[0m08:14:42.157850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:14:42.158225 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:42.162629 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:14:42.163691 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:42.165716 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:14:42.166899 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:14:42.167255 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where product_key is null



      
    ) dbt_internal_test
[0m08:14:42.167653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:42.175425 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947271d0>]}
[0m08:14:42.176026 [info ] [Thread-4 (]: 11 of 29 OK created sql table model STAGING_ANALYTICS.dim_store ................ [[32mSUCCESS 1[0m in 1.42s]
[0m08:14:42.176645 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_store
[0m08:14:42.177059 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:42.177508 [info ] [Thread-4 (]: 14 of 29 START test not_null_fact_inventory_snapshot_store_key ................. [RUN]
[0m08:14:42.178015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:14:42.178368 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:42.181848 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:14:42.182827 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:42.184778 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:14:42.185985 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:14:42.186338 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
where store_key is null



      
    ) dbt_internal_test
[0m08:14:42.186692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:42.281846 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m08:14:42.285110 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.285484 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:14:42.442258 [debug] [Thread-3 (]: SQL status: SUCCESS 15 in 0.156 seconds
[0m08:14:42.448371 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.449057 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
[0m08:14:42.573406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m08:14:42.575529 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m08:14:42.583270 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3: Close
[0m08:14:42.593662 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.596573 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
describe table "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp"
[0m08:14:42.674878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m08:14:42.682043 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727: Close
[0m08:14:42.688898 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m08:14:42.691540 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693: Close
[0m08:14:42.713009 [debug] [Thread-3 (]: SQL status: SUCCESS 15 in 0.116 seconds
[0m08:14:42.734720 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.735238 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        

    with snapshot_query as (

        



select
  customer_id,
  full_name,
  email,
  phone,
  address_line1,
  city,
  state,
  zip,
  updated_at
from RETAIL_DW.STAGING_STAGING.stg_customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m08:14:42.785291 [info ] [Thread-1 (]: 12 of 29 PASS not_null_fact_inventory_snapshot_date_key ........................ [[32mPASS[0m in 0.86s]
[0m08:14:42.787217 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:42.787831 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:42.788392 [info ] [Thread-1 (]: 15 of 29 START test relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [RUN]
[0m08:14:42.790430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:14:42.790937 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:42.799552 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:14:42.800953 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:42.805351 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:14:42.806857 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:14:42.807240 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:42.807623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:42.871628 [info ] [Thread-2 (]: 13 of 29 PASS not_null_fact_inventory_snapshot_product_key ..................... [[32mPASS[0m in 0.71s]
[0m08:14:42.872679 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:42.873298 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:42.873863 [info ] [Thread-2 (]: 16 of 29 START test relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [RUN]
[0m08:14:42.874551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:14:42.875031 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:42.881293 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:14:42.882839 [info ] [Thread-4 (]: 14 of 29 PASS not_null_fact_inventory_snapshot_store_key ....................... [[32mPASS[0m in 0.70s]
[0m08:14:42.883581 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:42.883909 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:42.884313 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:42.886476 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:14:42.886903 [info ] [Thread-4 (]: 17 of 29 START test relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [RUN]
[0m08:14:42.887614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:14:42.887981 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:42.892439 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:14:42.893379 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:14:42.893785 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:42.894241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:42.895156 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:42.898187 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:14:42.903191 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:14:42.903606 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_inventory_snapshot
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:42.903974 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:42.957961 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.222 seconds
[0m08:14:42.962592 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:42.962998 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:14:43.081304 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.118 seconds
[0m08:14:43.082042 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.retail_dbt.snap_customers"
[0m08:14:43.089840 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:43.090252 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
BEGIN
[0m08:14:43.244485 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m08:14:43.245271 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:43.245947 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
merge into "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "RETAIL_DW"."ANALYTICS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FULL_NAME", "EMAIL", "PHONE", "ADDRESS_LINE1", "CITY", "STATE", "ZIP", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:14:43.474968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m08:14:43.479667 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b: Close
[0m08:14:43.545293 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m08:14:43.550290 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1: Close
[0m08:14:43.554752 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m08:14:43.557419 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47: Close
[0m08:14:43.671749 [info ] [Thread-1 (]: 15 of 29 PASS relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_  [[32mPASS[0m in 0.88s]
[0m08:14:43.673495 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:43.765610 [info ] [Thread-2 (]: 16 of 29 PASS relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.89s]
[0m08:14:43.766985 [info ] [Thread-4 (]: 17 of 29 PASS relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_  [[32mPASS[0m in 0.88s]
[0m08:14:43.769068 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:43.770101 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:43.801704 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.555 seconds
[0m08:14:43.802754 [debug] [Thread-3 (]: Using snowflake connection "snapshot.retail_dbt.snap_customers"
[0m08:14:43.803425 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.snap_customers"} */
COMMIT
[0m08:14:44.155439 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m08:14:44.163200 [debug] [Thread-3 (]: On snapshot.retail_dbt.snap_customers: Close
[0m08:14:44.363462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94778ef0>]}
[0m08:14:44.365541 [info ] [Thread-3 (]: 9 of 29 OK snapshotted ANALYTICS.snap_customers ................................ [[32mSUCCESS 0[0m in 3.67s]
[0m08:14:44.366906 [debug] [Thread-3 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m08:14:44.368905 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_customer
[0m08:14:44.369897 [info ] [Thread-1 (]: 18 of 29 START sql table model STAGING_ANALYTICS.dim_customer .................. [RUN]
[0m08:14:44.370717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now model.retail_dbt.dim_customer)
[0m08:14:44.371378 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:14:44.379663 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:14:44.382880 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_customer
[0m08:14:44.386126 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_customer"
[0m08:14:44.388236 [debug] [Thread-1 (]: Using snowflake connection "model.retail_dbt.dim_customer"
[0m08:14:44.388744 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customer"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.dim_customer
         as
        (with scd as (
  select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    customer_id,
    full_name,
    email,
    phone,
    address_line1,
    city,
    state,
    zip,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as is_current
  from RETAIL_DW.ANALYTICS.snap_customers
),

unknown as (
  select
    md5(cast(coalesce(cast('UNKNOWN' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('1900-01-01' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    'UNKNOWN' as customer_id,
    'Unknown Customer' as full_name,
    null as email,
    null as phone,
    null as address_line1,
    null as city,
    null as state,
    null as zip,
    '1900-01-01'::timestamp_ntz as dbt_valid_from,
    null::timestamp_ntz as dbt_valid_to,
    true as is_current
)

select * from scd
union all
select * from unknown
        );
[0m08:14:44.389227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:45.695568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m08:14:45.700303 [debug] [Thread-1 (]: On model.retail_dbt.dim_customer: Close
[0m08:14:45.898350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9479f8c0>]}
[0m08:14:45.900040 [info ] [Thread-1 (]: 18 of 29 OK created sql table model STAGING_ANALYTICS.dim_customer ............. [[32mSUCCESS 1[0m in 1.53s]
[0m08:14:45.901986 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_customer
[0m08:14:45.903881 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_sales
[0m08:14:45.904735 [info ] [Thread-4 (]: 19 of 29 START sql table model STAGING_ANALYTICS.fact_sales .................... [RUN]
[0m08:14:45.905874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now model.retail_dbt.fact_sales)
[0m08:14:45.906573 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:14:45.918703 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:14:45.920241 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_sales
[0m08:14:45.923070 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fact_sales"
[0m08:14:45.925993 [debug] [Thread-4 (]: Using snowflake connection "model.retail_dbt.fact_sales"
[0m08:14:45.926568 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fact_sales"} */
create or replace transient table RETAIL_DW.STAGING_ANALYTICS.fact_sales
         as
        (with oi as (
  select * from RETAIL_DW.STAGING_STAGING.stg_order_items
),
o as (
  select * from RETAIL_DW.STAGING_STAGING.stg_orders
),
j as (
  select
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.store_id,
    o.order_ts,
    o.status,
    oi.qty,
    oi.unit_price,
    oi.discount_pct,
    (oi.qty * oi.unit_price) as gross_sales,
    (oi.qty * oi.unit_price) * (oi.discount_pct/100.0) as discount_amount,
    (oi.qty * oi.unit_price) - ((oi.qty * oi.unit_price) * (oi.discount_pct/100.0)) as net_sales
  from oi
  join o using (order_id)
),

dim as (
  select
    customer_key,
    customer_id,
    dbt_valid_from,
    dbt_valid_to,
    is_current
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
),

unknown as (
  select customer_key
  from RETAIL_DW.STAGING_ANALYTICS.dim_customer
  where customer_id = 'UNKNOWN'
  qualify row_number() over (order by customer_key) = 1
)

select
  md5(cast(coalesce(cast(j.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sales_line_key,
  cast(j.order_ts as date) as date_key,

  md5(cast(coalesce(cast(j.store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
  md5(cast(coalesce(cast(j.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,

  coalesce(c_hist.customer_key, c_curr.customer_key, u.customer_key) as customer_key,

  j.order_id,
  j.product_id,
  j.customer_id,
  j.store_id,
  j.status,

  j.qty,
  j.unit_price,
  j.discount_pct,
  j.gross_sales,
  j.discount_amount,
  j.net_sales
from j

-- 1) Best match: as-of join to the correct SCD2 version
left join dim c_hist
  on j.customer_id = c_hist.customer_id
 and cast(j.order_ts as date) >= cast(c_hist.dbt_valid_from as date)
 and (
      cast(j.order_ts as date) < cast(c_hist.dbt_valid_to as date)
      or c_hist.dbt_valid_to is null
 )
 and c_hist.customer_id <> 'UNKNOWN'

-- 2) Fallback: current version if as-of didn't match
left join dim c_curr
  on j.customer_id = c_curr.customer_id
 and c_curr.is_current = true
 and c_curr.customer_id <> 'UNKNOWN'

-- 3) Final fallback: UNKNOWN row (ensures NOT NULL)
cross join unknown u
        );
[0m08:14:45.927102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:47.536724 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.609 seconds
[0m08:14:47.540394 [debug] [Thread-4 (]: On model.retail_dbt.fact_sales: Close
[0m08:14:47.731479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b1db6-5abc-4d50-8cb3-4298230655ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cfae10>]}
[0m08:14:47.732872 [info ] [Thread-4 (]: 19 of 29 OK created sql table model STAGING_ANALYTICS.fact_sales ............... [[32mSUCCESS 1[0m in 1.83s]
[0m08:14:47.734507 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_sales
[0m08:14:47.736242 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:47.736913 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:47.737548 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:47.738131 [info ] [Thread-2 (]: 20 of 29 START test not_null_fact_sales_customer_key ........................... [RUN]
[0m08:14:47.738828 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:47.739348 [info ] [Thread-1 (]: 21 of 29 START test not_null_fact_sales_date_key ............................... [RUN]
[0m08:14:47.739943 [info ] [Thread-3 (]: 22 of 29 START test not_null_fact_sales_product_key ............................ [RUN]
[0m08:14:47.740617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m08:14:47.741189 [info ] [Thread-4 (]: 23 of 29 START test not_null_fact_sales_sales_line_key ......................... [RUN]
[0m08:14:47.741798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:14:47.742367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:14:47.742908 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:47.743418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:14:47.743939 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:47.744435 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:47.749559 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:14:47.749930 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:47.753593 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:14:47.757076 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:14:47.760554 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:14:47.761614 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:47.763872 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:14:47.764514 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:47.764866 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:47.766825 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:14:47.767138 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:47.769147 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:14:47.769824 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:14:47.773226 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:14:47.773796 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where customer_key is null



      
    ) dbt_internal_test
[0m08:14:47.774444 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:14:47.775052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:47.775624 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:14:47.775948 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where date_key is null



      
    ) dbt_internal_test
[0m08:14:47.777078 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:14:47.778051 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where product_key is null



      
    ) dbt_internal_test
[0m08:14:47.778502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:47.778899 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_line_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is null



      
    ) dbt_internal_test
[0m08:14:47.779268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:14:47.780068 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:48.385633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m08:14:48.388578 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4: Close
[0m08:14:48.391075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m08:14:48.393840 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e: Close
[0m08:14:48.396721 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m08:14:48.398487 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac: Close
[0m08:14:48.403145 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m08:14:48.404797 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98: Close
[0m08:14:48.581307 [info ] [Thread-4 (]: 23 of 29 PASS not_null_fact_sales_sales_line_key ............................... [[32mPASS[0m in 0.84s]
[0m08:14:48.582405 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:48.583587 [info ] [Thread-2 (]: 20 of 29 PASS not_null_fact_sales_customer_key ................................. [[32mPASS[0m in 0.84s]
[0m08:14:48.584989 [info ] [Thread-1 (]: 21 of 29 PASS not_null_fact_sales_date_key ..................................... [[32mPASS[0m in 0.84s]
[0m08:14:48.585681 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:48.586460 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:48.587768 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:48.588743 [info ] [Thread-3 (]: 22 of 29 PASS not_null_fact_sales_product_key .................................. [[32mPASS[0m in 0.85s]
[0m08:14:48.589568 [info ] [Thread-4 (]: 24 of 29 START test not_null_fact_sales_store_key .............................. [RUN]
[0m08:14:48.590276 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:48.590872 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:48.591547 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:48.592110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:14:48.592643 [info ] [Thread-2 (]: 25 of 29 START test relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [RUN]
[0m08:14:48.593231 [info ] [Thread-1 (]: 26 of 29 START test relationships_fact_sales_date_key__date_key__ref_dim_date_ . [RUN]
[0m08:14:48.593737 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:48.594193 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:48.594635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:14:48.595177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:14:48.595624 [info ] [Thread-3 (]: 27 of 29 START test relationships_fact_sales_product_key__product_key__ref_dim_product_  [RUN]
[0m08:14:48.600500 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:14:48.600842 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:48.601237 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:48.601660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:14:48.606389 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:14:48.610197 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:14:48.610608 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:48.611148 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:48.615088 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:14:48.617316 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:14:48.617632 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:48.618275 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:48.620487 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:14:48.622663 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:14:48.623018 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:48.623543 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:14:48.627027 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:14:48.627577 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where store_key is null



      
    ) dbt_internal_test
[0m08:14:48.628476 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:14:48.628972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:48.629676 [debug] [Thread-1 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:14:48.630104 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:48.632111 [debug] [Thread-3 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:14:48.632471 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select date_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where date_key is not null
),

parent as (
    select date_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_date
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:48.632878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:48.633266 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where product_key is not null
),

parent as (
    select product_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:48.633629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:48.634994 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:14:49.146536 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m08:14:49.148906 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fact_sales_store_key.a27565925d: Close
[0m08:14:49.205081 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m08:14:49.207750 [debug] [Thread-2 (]: On test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef: Close
[0m08:14:49.211822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m08:14:49.213899 [debug] [Thread-3 (]: On test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946: Close
[0m08:14:49.293044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m08:14:49.296925 [debug] [Thread-1 (]: On test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b: Close
[0m08:14:49.341411 [info ] [Thread-4 (]: 24 of 29 PASS not_null_fact_sales_store_key .................................... [[32mPASS[0m in 0.75s]
[0m08:14:49.343568 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:49.344387 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:49.345063 [info ] [Thread-4 (]: 28 of 29 START test relationships_fact_sales_store_key__store_key__ref_dim_store_  [RUN]
[0m08:14:49.345951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:14:49.346590 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:49.355220 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:14:49.357090 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:49.360249 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:14:49.362358 [debug] [Thread-4 (]: Using snowflake connection "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:14:49.362882 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from RETAIL_DW.STAGING_ANALYTICS.fact_sales
    where store_key is not null
),

parent as (
    select store_key as to_field
    from RETAIL_DW.STAGING_ANALYTICS.dim_store
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:14:49.363450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:14:49.404092 [info ] [Thread-2 (]: 25 of 29 PASS relationships_fact_sales_customer_key__customer_key__ref_dim_customer_  [[32mPASS[0m in 0.81s]
[0m08:14:49.404943 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:49.405921 [info ] [Thread-3 (]: 27 of 29 PASS relationships_fact_sales_product_key__product_key__ref_dim_product_  [[32mPASS[0m in 0.80s]
[0m08:14:49.406468 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:49.407083 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:49.409219 [info ] [Thread-2 (]: 29 of 29 START test unique_fact_sales_sales_line_key ........................... [RUN]
[0m08:14:49.410091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:14:49.410543 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:49.416130 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:14:49.417616 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:49.419912 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:14:49.421195 [debug] [Thread-2 (]: Using snowflake connection "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:14:49.421570 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_line_key as unique_field,
    count(*) as n_records

from RETAIL_DW.STAGING_ANALYTICS.fact_sales
where sales_line_key is not null
group by sales_line_key
having count(*) > 1



      
    ) dbt_internal_test
[0m08:14:49.421973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:14:49.480596 [info ] [Thread-1 (]: 26 of 29 PASS relationships_fact_sales_date_key__date_key__ref_dim_date_ ....... [[32mPASS[0m in 0.89s]
[0m08:14:49.481359 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:49.957411 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m08:14:49.962202 [debug] [Thread-4 (]: On test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5: Close
[0m08:14:49.972587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m08:14:49.975312 [debug] [Thread-2 (]: On test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11: Close
[0m08:14:50.170089 [info ] [Thread-4 (]: 28 of 29 PASS relationships_fact_sales_store_key__store_key__ref_dim_store_ .... [[32mPASS[0m in 0.82s]
[0m08:14:50.173181 [info ] [Thread-2 (]: 29 of 29 PASS unique_fact_sales_sales_line_key ................................. [[32mPASS[0m in 0.76s]
[0m08:14:50.174349 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:50.175351 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:50.178456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:14:50.179174 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:14:50.179656 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:14:50.180129 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m08:14:50.180571 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:14:50.181195 [info ] [MainThread]: 
[0m08:14:50.182032 [info ] [MainThread]: Finished running 6 view models, 6 table models, 16 data tests, 1 snapshot in 0 hours 0 minutes and 13.11 seconds (13.11s).
[0m08:14:50.186128 [debug] [MainThread]: Command end result
[0m08:14:50.231264 [info ] [MainThread]: 
[0m08:14:50.231879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:14:50.232271 [info ] [MainThread]: 
[0m08:14:50.232693 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 TOTAL=29
[0m08:14:50.233533 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.281091, "process_user_time": 5.021871, "process_kernel_time": 0.319721, "process_mem_max_rss": "217212", "process_out_blocks": "2951", "process_in_blocks": "0"}
[0m08:14:50.234015 [debug] [MainThread]: Command `dbt build` succeeded at 08:14:50.233939 after 14.28 seconds
[0m08:14:50.234405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2492990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9652c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24f5340>]}
[0m08:14:50.234804 [debug] [MainThread]: Flushing usage events
[0m08:14:52.923808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5a06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c25130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0187c80>]}


============================== 08:14:52.929476 | 3995f41e-6eec-4e0d-8167-197c2d4f1147 ==============================
[0m08:14:52.929476 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:14:52.930301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/retail_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m08:14:53.548256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fb42c0>]}
[0m08:14:53.587676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84091550>]}
[0m08:14:53.588331 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:14:53.661525 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:14:53.794359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:14:53.794787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:14:53.834609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e6c6e0>]}
[0m08:14:53.846371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a15220>]}
[0m08:14:53.846821 [info ] [MainThread]: Found 12 models, 1 snapshot, 16 data tests, 6 sources, 575 macros
[0m08:14:53.847434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e3d850>]}
[0m08:14:53.849555 [info ] [MainThread]: 
[0m08:14:53.850172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:14:53.853877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_ANALYTICS'
[0m08:14:53.862528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_STAGING_STAGING'
[0m08:14:53.873574 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_STAGING"
[0m08:14:53.874783 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_STAGING_ANALYTICS"
[0m08:14:53.875197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RETAIL_DW_ANALYTICS'
[0m08:14:53.875482 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_STAGING"} */
show objects in RETAIL_DW.STAGING_STAGING limit 10000
[0m08:14:53.875899 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_STAGING_ANALYTICS"} */
show objects in RETAIL_DW.STAGING_ANALYTICS limit 10000
[0m08:14:53.878595 [debug] [ThreadPool]: Using snowflake connection "list_RETAIL_DW_ANALYTICS"
[0m08:14:53.878947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:53.879292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:53.879634 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_RETAIL_DW_ANALYTICS"} */
show objects in RETAIL_DW.ANALYTICS limit 10000
[0m08:14:53.883370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:54.471899 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.593 seconds
[0m08:14:54.472733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.589 seconds
[0m08:14:54.474394 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_STAGING: Close
[0m08:14:54.475654 [debug] [ThreadPool]: On list_RETAIL_DW_ANALYTICS: Close
[0m08:14:54.486583 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.607 seconds
[0m08:14:54.488117 [debug] [ThreadPool]: On list_RETAIL_DW_STAGING_ANALYTICS: Close
[0m08:14:54.698880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3995f41e-6eec-4e0d-8167-197c2d4f1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0db02f0>]}
[0m08:14:54.700640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:14:54.702147 [info ] [MainThread]: 
[0m08:14:54.715327 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_date
[0m08:14:54.715915 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m08:14:54.716962 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_inventory_snapshots
[0m08:14:54.717592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_STAGING, now model.retail_dbt.dim_date)
[0m08:14:54.718056 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_order_items
[0m08:14:54.718615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_ANALYTICS, now model.retail_dbt.stg_customers)
[0m08:14:54.719228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_RETAIL_DW_STAGING_ANALYTICS, now model.retail_dbt.stg_inventory_snapshots)
[0m08:14:54.719735 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_date
[0m08:14:54.720300 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.retail_dbt.stg_order_items'
[0m08:14:54.720728 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m08:14:54.721209 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_inventory_snapshots
[0m08:14:54.727239 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_date"
[0m08:14:54.727635 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_order_items
[0m08:14:54.730071 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m08:14:54.732379 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory_snapshots"
[0m08:14:54.734864 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_order_items"
[0m08:14:54.735894 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_date
[0m08:14:54.736670 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_date
[0m08:14:54.737248 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_orders
[0m08:14:54.737552 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_inventory_snapshots
[0m08:14:54.737836 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m08:14:54.738270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_date, now model.retail_dbt.stg_orders)
[0m08:14:54.738561 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_order_items
[0m08:14:54.739046 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_inventory_snapshots
[0m08:14:54.739596 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m08:14:54.739913 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_orders
[0m08:14:54.740427 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_order_items
[0m08:14:54.740785 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_products
[0m08:14:54.741244 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stores
[0m08:14:54.743466 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_orders"
[0m08:14:54.743914 [debug] [Thread-4 (]: Began running node model.retail_dbt.fact_inventory_snapshot
[0m08:14:54.744305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory_snapshots, now model.retail_dbt.stg_products)
[0m08:14:54.744656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_stores)
[0m08:14:54.745308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_order_items, now model.retail_dbt.fact_inventory_snapshot)
[0m08:14:54.745786 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_products
[0m08:14:54.746219 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stores
[0m08:14:54.746614 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_orders
[0m08:14:54.746886 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fact_inventory_snapshot
[0m08:14:54.749016 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m08:14:54.751143 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m08:14:54.751727 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_orders
[0m08:14:54.763282 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fact_inventory_snapshot"
[0m08:14:54.764192 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.snap_customers
[0m08:14:54.764720 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_products
[0m08:14:54.765070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_orders, now snapshot.retail_dbt.snap_customers)
[0m08:14:54.765774 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_products
[0m08:14:54.766136 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stores
[0m08:14:54.766455 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.snap_customers
[0m08:14:54.766744 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fact_inventory_snapshot
[0m08:14:54.767206 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_product
[0m08:14:54.767690 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stores
[0m08:14:54.771587 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.snap_customers
[0m08:14:54.772187 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fact_inventory_snapshot
[0m08:14:54.772552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.dim_product)
[0m08:14:54.773120 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_store
[0m08:14:54.773585 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.snap_customers
[0m08:14:54.774143 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_product
[0m08:14:54.774444 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:54.774806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stores, now model.retail_dbt.dim_store)
[0m08:14:54.775200 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:54.778333 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_product"
[0m08:14:54.778799 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_inventory_snapshot, now test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3)
[0m08:14:54.779159 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_store
[0m08:14:54.779503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.snap_customers, now test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727)
[0m08:14:54.779985 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:54.782992 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_store"
[0m08:14:54.783441 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:54.783840 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_product
[0m08:14:54.792704 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3"
[0m08:14:54.796028 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727"
[0m08:14:54.796680 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_product
[0m08:14:54.797351 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_store
[0m08:14:54.797789 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:54.798555 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_store
[0m08:14:54.798986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_product, now test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693)
[0m08:14:54.799347 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:54.799638 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:54.799967 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:54.800410 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:54.800947 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3
[0m08:14:54.801459 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727
[0m08:14:54.801816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_store, now test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b)
[0m08:14:54.805075 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693"
[0m08:14:54.805524 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customer
[0m08:14:54.805925 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:54.806291 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:54.806792 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_date_key.26b19ccab3, now model.retail_dbt.dim_customer)
[0m08:14:54.807202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_product_key.22379c7727, now test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1)
[0m08:14:54.813608 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b"
[0m08:14:54.813949 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:54.814298 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customer
[0m08:14:54.814681 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:54.815405 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693
[0m08:14:54.819481 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customer"
[0m08:14:54.823907 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1"
[0m08:14:54.824358 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:54.824728 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:54.825606 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b
[0m08:14:54.826024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_inventory_snapshot_store_key.2510fe2693, now test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47)
[0m08:14:54.826617 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customer
[0m08:14:54.826914 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:54.827213 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:54.827751 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customer
[0m08:14:54.828387 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1
[0m08:14:54.834136 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47"
[0m08:14:54.834789 [debug] [Thread-1 (]: Began running node model.retail_dbt.fact_sales
[0m08:14:54.835322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_product_key__product_key__ref_dim_product_.f73d93ffc1, now model.retail_dbt.fact_sales)
[0m08:14:54.835644 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fact_sales
[0m08:14:54.840811 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fact_sales"
[0m08:14:54.841287 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:54.841842 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47
[0m08:14:54.842344 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fact_sales
[0m08:14:54.842906 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fact_sales
[0m08:14:54.843716 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:54.844037 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:54.844347 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:54.844649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customer, now test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac)
[0m08:14:54.844937 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:54.845328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_date_key__date_key__ref_dim_date_.23e79f8b2b, now test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4)
[0m08:14:54.845687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_inventory_snapshot_store_key__store_key__ref_dim_store_.b513b09c47, now test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98)
[0m08:14:54.846021 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:54.846385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fact_sales, now test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e)
[0m08:14:54.846722 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:54.847074 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:54.850384 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac"
[0m08:14:54.850761 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:54.853821 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4"
[0m08:14:54.856935 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98"
[0m08:14:54.860242 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e"
[0m08:14:54.861133 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:54.862019 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac
[0m08:14:54.862341 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:54.862640 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:54.862986 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:54.863618 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4
[0m08:14:54.863921 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:54.864424 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98
[0m08:14:54.864812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_customer_key.c5a1d049ac, now test.retail_dbt.not_null_fact_sales_store_key.a27565925d)
[0m08:14:54.865225 [debug] [Thread-2 (]: Began running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:54.865778 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e
[0m08:14:54.866168 [debug] [Thread-3 (]: Began running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:54.866506 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:54.866861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_date_key.5bcf660bf4, now test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef)
[0m08:14:54.867277 [debug] [Thread-1 (]: Began running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:54.867655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_product_key.e4fd332b98, now test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b)
[0m08:14:54.870997 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fact_sales_store_key.a27565925d"
[0m08:14:54.871409 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:54.871824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_sales_line_key.118e05545e, now test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946)
[0m08:14:54.872254 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:54.876801 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef"
[0m08:14:54.877210 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:54.880955 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b"
[0m08:14:54.881442 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:54.886822 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946"
[0m08:14:54.887703 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fact_sales_store_key.a27565925d
[0m08:14:54.887997 [debug] [Thread-2 (]: Began executing node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:54.888684 [debug] [Thread-3 (]: Began executing node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:54.889023 [debug] [Thread-4 (]: Began running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:54.889712 [debug] [Thread-2 (]: Finished running node test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef
[0m08:14:54.890032 [debug] [Thread-1 (]: Began executing node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:54.890545 [debug] [Thread-3 (]: Finished running node test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b
[0m08:14:54.890924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fact_sales_store_key.a27565925d, now test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5)
[0m08:14:54.891334 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:54.891863 [debug] [Thread-1 (]: Finished running node test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946
[0m08:14:54.892354 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:54.892723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.relationships_fact_sales_customer_key__customer_key__ref_dim_customer_.b73e463cef, now test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11)
[0m08:14:54.896591 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5"
[0m08:14:54.896975 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:54.902080 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11"
[0m08:14:54.902783 [debug] [Thread-4 (]: Began executing node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:54.903362 [debug] [Thread-4 (]: Finished running node test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5
[0m08:14:54.903818 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:54.904348 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11
[0m08:14:54.905400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:14:54.905658 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_date_key__date_key__ref_dim_date_.bb89620e8b' was properly closed.
[0m08:14:54.905885 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_product_key__product_key__ref_dim_product_.57403d5946' was properly closed.
[0m08:14:54.906117 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fact_sales_sales_line_key.d5a9df5e11' was properly closed.
[0m08:14:54.906330 [debug] [MainThread]: Connection 'test.retail_dbt.relationships_fact_sales_store_key__store_key__ref_dim_store_.37cce23ce5' was properly closed.
[0m08:14:54.908803 [debug] [MainThread]: Command end result
[0m08:14:55.002804 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m08:14:55.003134 [info ] [MainThread]: Building catalog
[0m08:14:55.012323 [debug] [ThreadPool]: Acquiring new snowflake connection 'RETAIL_DW.information_schema'
[0m08:14:55.027496 [debug] [ThreadPool]: Using snowflake connection "RETAIL_DW.information_schema"
[0m08:14:55.028386 [debug] [ThreadPool]: On RETAIL_DW.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "RETAIL_DW.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from RETAIL_DW.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from RETAIL_DW.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_inventory_snapshots' and upper("table_name") = upper('stg_inventory_snapshots')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_sales' and upper("table_name") = upper('fact_sales')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDER_ITEMS_RAW' and upper("table_name") = upper('ORDER_ITEMS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'PRODUCTS_RAW' and upper("table_name") = upper('PRODUCTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMERS_RAW' and upper("table_name") = upper('CUSTOMERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_product' and upper("table_name") = upper('dim_product')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ORDERS_RAW' and upper("table_name") = upper('ORDERS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_stores' and upper("table_name") = upper('stg_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'dim_store' and upper("table_name") = upper('dim_store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'STORES_RAW' and upper("table_name") = upper('STORES_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_ANALYTICS' and upper("table_schema") = upper('STAGING_ANALYTICS')

                    and 
    "table_name" ilike 'fact_inventory_snapshot' and upper("table_name") = upper('fact_inventory_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'INVENTORY_SNAPSHOTS_RAW' and upper("table_name") = upper('INVENTORY_SNAPSHOTS_RAW')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGING_STAGING' and upper("table_schema") = upper('STAGING_STAGING')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m08:14:55.029255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:04.105188 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 9.076 seconds
[0m08:15:04.195796 [debug] [ThreadPool]: On RETAIL_DW.information_schema: Close
[0m08:15:04.462216 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/retail_dbt/target/catalog.json
[0m08:15:04.463516 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.5755415, "process_user_time": 3.597732, "process_kernel_time": 0.188347, "process_mem_max_rss": "211232", "process_out_blocks": "5855", "process_in_blocks": "0"}
[0m08:15:04.464077 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:15:04.463971 after 11.58 seconds
[0m08:15:04.464457 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:15:04.464746 [debug] [MainThread]: Connection 'RETAIL_DW.information_schema' was properly closed.
[0m08:15:04.465071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f911a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c5b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d06780>]}
[0m08:15:04.465423 [debug] [MainThread]: Flushing usage events
